{"version":3,"file":"9362.bundle.js","mappings":"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","sources":["webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat.resolvablePromise.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat.HomeScreenHeader.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat.BasePanelComponent.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat.AppContainer.js"],"sourcesContent":["import { b as MessageResponseTypes, a as ButtonItemType } from \"./chat.Messages.js\";\n\nimport { u as uuid, U as UUIDType } from \"./chat.uuid.js\";\n\nimport { t as streamItemID, J as createMessageResponseForItem, L as isGridResponseType, M as isCarouselResponseType, N as isShowPanelButtonType, q as isResponseWithNestedItems, O as isItemSupportedInResponseBody, P as isCardResponseType, Q as isButtonResponseType } from \"./chat.messageUtils.js\";\n\nimport { b as consoleError } from \"./chat.miscUtils.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function inputItemToLocalItem(message, originalUserText, id = uuid(UUIDType.LOCAL_MESSAGE)) {\n  const localMessage = {\n    item: {\n      response_type: MessageResponseTypes.TEXT,\n      ...message.input\n    },\n    ui_state: {\n      id: id,\n      originalUserText: originalUserText,\n      needsAnnouncement: false\n    },\n    fullMessageID: message.id\n  };\n  return localMessage;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function outputItemToLocalItem(messageItem, fullMessage, isLatestWelcomeNode = false, disableFadeAnimation = false) {\n  const id = streamItemID(fullMessage.id, messageItem) || uuid(UUIDType.LOCAL_MESSAGE);\n  const localMessage = {\n    ui_state: {\n      id: id,\n      needsAnnouncement: !fullMessage.history.from_history,\n      disableFadeAnimation: disableFadeAnimation\n    },\n    item: messageItem,\n    fullMessageID: fullMessage.id\n  };\n  if (isLatestWelcomeNode) {\n    localMessage.ui_state.isWelcomeResponse = true;\n  }\n  return localMessage;\n}\n\nfunction createLocalMessageForInlineError(text) {\n  const messageItem = {\n    response_type: MessageResponseTypes.INLINE_ERROR,\n    text: text\n  };\n  return createLocalMessageForItem(messageItem);\n}\n\nfunction createLocalMessageForItem(messageItem) {\n  const originalMessage = createMessageResponseForItem(messageItem);\n  const localMessage = outputItemToLocalItem(messageItem, originalMessage);\n  return {\n    originalMessage: originalMessage,\n    localMessage: localMessage\n  };\n}\n\nfunction createLocalMessageItemsForNestedMessageItems(localMessageItem, originalMessage, fromHistory, nestedLocalMessageItems, allowFooter) {\n  const {item: item} = localMessageItem;\n  if (isGridResponseType(item)) {\n    localMessageItem.ui_state.gridLocalMessageItemIDs = item.rows.map(row => row.cells.map(cell => {\n      const cellLocalMessageItemIDs = [];\n      createLocalMessageItemsForNestedType(\"items\", localMessageItem, cell.items, cellLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInBody(localMessageItem.item, nestedMessageItem), false);\n      return cellLocalMessageItemIDs;\n    }));\n  } else if (isCarouselResponseType(item)) {\n    localMessageItem.ui_state.itemsLocalMessageItemIDs = [];\n    createLocalMessageItemsForNestedType(\"items\", localMessageItem, item.items, localMessageItem.ui_state.itemsLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInBody(item, nestedMessageItem), allowFooter);\n  } else {\n    const bodyItems = item.body || item.panel?.body;\n    if (bodyItems) {\n      localMessageItem.ui_state.bodyLocalMessageItemIDs = [];\n      createLocalMessageItemsForNestedType(\"body\", localMessageItem, bodyItems, localMessageItem.ui_state.bodyLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInBody(item, nestedMessageItem), !isShowPanelButtonType(item));\n    }\n    if (!allowFooter) {\n      return;\n    }\n    const footerItems = item.footer || item.panel?.footer;\n    if (footerItems) {\n      localMessageItem.ui_state.footerLocalMessageItemIDs = [];\n      createLocalMessageItemsForNestedType(\"footer\", localMessageItem, footerItems, localMessageItem.ui_state.footerLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInFooter(item, nestedMessageItem), !isShowPanelButtonType(item));\n    }\n  }\n}\n\nfunction createLocalMessageItemsForNestedType(type, localMessageItem, items, nestedMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, isSupported, allowFooter) {\n  items.forEach(nestedMessageItem => {\n    if (isSupported(nestedMessageItem)) {\n      const nestedLocalMessageItem = outputItemToLocalItem(nestedMessageItem, originalMessage, false, true);\n      nestedMessageItemIDs.push(nestedLocalMessageItem.ui_state.id);\n      nestedLocalMessageItems.push(nestedLocalMessageItem);\n      if (isResponseWithNestedItems(nestedLocalMessageItem.item)) {\n        createLocalMessageItemsForNestedMessageItems(nestedLocalMessageItem, originalMessage, fromHistory, nestedLocalMessageItems, allowFooter);\n      }\n    } else {\n      consoleError(`The \"${localMessageItem.item.response_type}\" response type does not support \"${nestedMessageItem.response_type}\" in \"${type}\" array.`);\n    }\n  });\n}\n\nfunction isSupportedMessageItemInBody(rootMessageItem, nestedMessageItem) {\n  switch (rootMessageItem.response_type) {\n   case MessageResponseTypes.CARD:\n    return !isCardResponseType(nestedMessageItem) && isItemSupportedInResponseBody(nestedMessageItem);\n\n   case MessageResponseTypes.CAROUSEL:\n    return isCardResponseType(nestedMessageItem);\n\n   case MessageResponseTypes.BUTTON:\n    return rootMessageItem.button_type === ButtonItemType.SHOW_PANEL && isItemSupportedInResponseBody(nestedMessageItem);\n\n   case MessageResponseTypes.GRID:\n    return !isCardResponseType(nestedMessageItem) && isItemSupportedInResponseBody(nestedMessageItem);\n\n   default:\n    return false;\n  }\n}\n\nfunction isSupportedMessageItemInFooter(rootMessageItem, nestedMessageItem) {\n  if (isButtonResponseType(nestedMessageItem)) {\n    if (isShowPanelButtonType(rootMessageItem)) {\n      return !isShowPanelButtonType(nestedMessageItem);\n    }\n    return true;\n  }\n  return false;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const HA_SET_AGENT_AVAILABILITY = \"HA_SET_AGENT_AVAILABILITY\";\n\nconst HA_SET_IS_CONNECTING = \"HA_SET_IS_CONNECTING\";\n\nconst HA_SET_IS_RECONNECTING = \"HA_SET_IS_RECONNECTING\";\n\nconst HA_SET_AGENT_JOINED = \"HA_SET_AGENT_JOINED\";\n\nconst HA_SET_AGENT_LEFT_CHAT = \"HA_SET_AGENT_LEFT_CHAT\";\n\nconst HA_END_CHAT = \"HA_END_CHAT\";\n\nconst HA_UPDATE_CAPABILITIES = \"HA_UPDATE_CAPABILITIES\";\n\nconst HA_UPDATE_FILE_UPLOAD_IN_PROGRESS = \"HA_UPDATE_FILE_UPLOAD_IN_PROGRESS\";\n\nconst HA_SET_SHOW_SCREEN_SHARE_REQUEST = \"HA_SET_SHOW_SCREEN_SHARE_REQUEST\";\n\nconst HA_SET_IS_SCREEN_SHARING = \"HA_SET_IS_SCREEN_SHARING\";\n\nconst HA_SET_PERSISTED_STATE = \"HA_SET_PERSISTED_STATE\";\n\nconst HA_UPDATE_IS_SUSPENDED = \"HA_UPDATE_IS_SUSPENDED\";\n\nconst HA_UPDATE_IS_TYPING = \"HA_UPDATE_IS_TYPING\";\n\nfunction setIsConnecting(isConnecting, localMessageID) {\n  return {\n    type: HA_SET_IS_CONNECTING,\n    isConnecting: isConnecting,\n    localMessageID: localMessageID\n  };\n}\n\nfunction setIsReconnecting(isReconnecting) {\n  return {\n    type: HA_SET_IS_RECONNECTING,\n    isReconnecting: isReconnecting\n  };\n}\n\nfunction setAgentLeftChat() {\n  return {\n    type: HA_SET_AGENT_LEFT_CHAT\n  };\n}\n\nfunction endChat() {\n  return {\n    type: HA_END_CHAT\n  };\n}\n\nfunction setAgentAvailability(availability) {\n  return {\n    type: HA_SET_AGENT_AVAILABILITY,\n    availability: availability\n  };\n}\n\nfunction setAgentJoined(agentProfile) {\n  return {\n    type: HA_SET_AGENT_JOINED,\n    agentProfile: agentProfile\n  };\n}\n\nfunction updateCapabilities(capabilities) {\n  return {\n    type: HA_UPDATE_CAPABILITIES,\n    capabilities: capabilities\n  };\n}\n\nfunction updateFilesUploadInProgress(fileUploadInProgress) {\n  return {\n    type: HA_UPDATE_FILE_UPLOAD_IN_PROGRESS,\n    fileUploadInProgress: fileUploadInProgress\n  };\n}\n\nfunction setShowScreenShareRequest(showRequest) {\n  return {\n    type: HA_SET_SHOW_SCREEN_SHARE_REQUEST,\n    showRequest: showRequest\n  };\n}\n\nfunction setIsScreenSharing(isSharing) {\n  return {\n    type: HA_SET_IS_SCREEN_SHARING,\n    isSharing: isSharing\n  };\n}\n\nfunction setPersistedServiceDeskState(state) {\n  return {\n    type: HA_SET_PERSISTED_STATE,\n    state: state\n  };\n}\n\nfunction agentUpdateIsSuspended(isSuspended) {\n  return {\n    type: HA_UPDATE_IS_SUSPENDED,\n    isSuspended: isSuspended\n  };\n}\n\nfunction agentUpdateIsTyping(isTyping) {\n  return {\n    type: HA_UPDATE_IS_TYPING,\n    isTyping: isTyping\n  };\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function deepFreeze(object) {\n  Object.freeze(object);\n  Object.getOwnPropertyNames(object).forEach(prop => {\n    if (Object.prototype.hasOwnProperty.call(object, prop) && object[prop] !== null && (typeof object[prop] === \"object\" || typeof object[prop] === \"function\") && !Object.isFrozen(object[prop])) {\n      deepFreeze(object[prop]);\n    }\n  });\n  return object;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function resolvablePromise() {\n  let resolveFunction;\n  let rejectFunction;\n  const promise = new Promise((resolve, reject) => {\n    resolveFunction = resolve;\n    rejectFunction = reject;\n  });\n  promise.doResolve = resolveValue => {\n    promise.isResolved = true;\n    promise.isComplete = true;\n    resolveFunction(resolveValue);\n  };\n  promise.doReject = rejectValue => {\n    promise.isRejected = true;\n    promise.isComplete = true;\n    rejectFunction(rejectValue);\n  };\n  promise.isResolved = false;\n  promise.isRejected = false;\n  promise.isComplete = false;\n  return promise;\n}\n\nexport { setAgentAvailability as A, setAgentJoined as B, agentUpdateIsTyping as C, setAgentLeftChat as D, setPersistedServiceDeskState as E, HA_END_CHAT as H, agentUpdateIsSuspended as a, createLocalMessageForInlineError as b, createLocalMessageItemsForNestedMessageItems as c, deepFreeze as d, HA_UPDATE_FILE_UPLOAD_IN_PROGRESS as e, HA_SET_IS_SCREEN_SHARING as f, HA_UPDATE_CAPABILITIES as g, HA_SET_AGENT_LEFT_CHAT as h, inputItemToLocalItem as i, HA_UPDATE_IS_TYPING as j, HA_UPDATE_IS_SUSPENDED as k, HA_SET_PERSISTED_STATE as l, HA_SET_AGENT_JOINED as m, HA_SET_SHOW_SCREEN_SHARE_REQUEST as n, outputItemToLocalItem as o, HA_SET_AGENT_AVAILABILITY as p, HA_SET_IS_RECONNECTING as q, resolvablePromise as r, HA_SET_IS_CONNECTING as s, setIsConnecting as t, updateFilesUploadInProgress as u, endChat as v, setIsScreenSharing as w, setIsReconnecting as x, setShowScreenShareRequest as y, updateCapabilities as z };\n","import React, { forwardRef, useRef, useImperativeHandle, useCallback } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { H as HeaderExport } from \"./chat.Header.js\";\n\nimport { O as OverlayPanelName } from \"./chat.PageObjectId.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function HomeScreenHeader(props, ref) {\n  const {brandColor: brandColor, onClose: onClose, onRestart: onRestart, onCloseAndRestart: onCloseAndRestart} = props;\n  const showRestartButton = useSelector(state => state.config.public.showRestartButton || state.config.public.headerConfig?.showRestartButton);\n  const showBackButton = useSelector(state => state.persistedToBrowserStorage.chatState.homeScreenState.showBackToBot);\n  const displayName = useSelector(state => state.headerDisplayName);\n  const customMenuOptions = useSelector(state => state.customMenuOptions);\n  const useAITheme = useSelector(state => state.theme.useAITheme);\n  const headerRef = useRef();\n  useImperativeHandle(ref, () => headerRef.current);\n  const hideCloseAndRestartButton = !showBackButton;\n  const overflowClicked = useCallback(index => {\n    const {handler: handler} = customMenuOptions[index];\n    handler();\n  }, [ customMenuOptions ]);\n  const overflowItems = customMenuOptions?.map(option => option.text);\n  return React.createElement(\"div\", {\n    className: \"WACHomeScreenHeader\"\n  }, React.createElement(HeaderExport, {\n    ref: headerRef,\n    displayName: displayName,\n    showCenter: true,\n    showRestartButton: showRestartButton,\n    hideCloseAndRestartButton: hideCloseAndRestartButton,\n    onClickRestart: onRestart,\n    onClickClose: onClose,\n    onCloseAndRestart: onCloseAndRestart,\n    overflowClicked: overflowClicked,\n    overflowItems: overflowItems,\n    useAITheme: useAITheme,\n    brandColor: brandColor,\n    testIdPrefix: OverlayPanelName.HOME_SCREEN\n  }));\n}\n\nconst HomeScreenHeaderExport = React.memo(forwardRef(HomeScreenHeader));\n\nexport { HomeScreenHeaderExport as H };\n","import FocusTrap from \"focus-trap-react\";\n\nimport React, { useRef, useImperativeHandle } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { I as IS_MOBILE } from \"./chat.browserUtils.js\";\n\nimport { H as HeaderExport } from \"./chat.Header.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function BasePanelComponent({className: className, children: children, isOpen: isOpen, hidePanelHeader: hidePanelHeader, labelBackButton: labelBackButton, title: title, hideBackButton: hideBackButton, useAITheme: useAITheme, onClickCloseAndRestart: onClickCloseAndRestart, onClickRestart: onClickRestart, testIdPrefix: testIdPrefix, ...headerProps}, ref) {\n  const showRestartButton = useSelector(state => state.config.public.headerConfig?.showRestartButton);\n  const headerRef = useRef();\n  useImperativeHandle(ref, () => headerRef.current);\n  return React.createElement(FocusTrap, {\n    active: isOpen,\n    focusTrapOptions: {\n      clickOutsideDeactivates: true,\n      returnFocusOnDeactivate: !IS_MOBILE,\n      preventScroll: true\n    }\n  }, React.createElement(\"div\", {\n    className: className\n  }, !hidePanelHeader && React.createElement(HeaderExport, {\n    ...headerProps,\n    ref: headerRef,\n    showRestartButton: showRestartButton,\n    onClickRestart: onClickRestart,\n    onCloseAndRestart: onClickCloseAndRestart,\n    showBackButton: !hideBackButton,\n    labelBackButton: labelBackButton,\n    displayName: title,\n    useAITheme: useAITheme,\n    testIdPrefix: testIdPrefix,\n    showCenter: true\n  }), React.createElement(\"div\", {\n    className: \"WACPanelContent\"\n  }, children)));\n}\n\nconst BasePanelComponentExport = React.memo(React.forwardRef(BasePanelComponent));\n\nexport { BasePanelComponentExport as B };\n","import isEqual from \"lodash-es/isEqual.js\";\n\nimport React, { useRef, useCallback, useEffect, forwardRef, useImperativeHandle, useState, useContext, Component, Suspense, useMemo } from \"react\";\n\nimport dayjs from \"dayjs\";\n\nimport LocalizedFormat from \"dayjs/plugin/localizedFormat.js\";\n\nimport merge from \"lodash-es/merge.js\";\n\nimport cloneDeep from \"lodash-es/cloneDeep.js\";\n\nimport { a as actions, U as UPDATE_MAIN_HEADER_AVATAR, S as SET_STREAM_ID, b as SET_STOP_STREAMING_BUTTON_DISABLED, c as SET_STOP_STREAMING_BUTTON_VISIBLE, d as UPDATE_MAX_VISIBLE_HEADER_OBJECTS, e as UPDATE_CHAT_HEADER_CONFIG, f as STREAMING_ADD_CHUNK, g as STREAMING_MERGE_HISTORY, h as STREAMING_START, i as SET_RESPONSE_PANEL_CONTENT, j as SET_RESPONSE_PANEL_IS_OPEN, A as ADD_NESTED_MESSAGES, F as FILE_UPLOAD_INPUT_ERROR, C as CLEAR_INPUT_FILES, R as REMOVE_ALL_NOTIFICATIONS, k as REMOVE_NOTIFICATIONS, l as ADD_NOTIFICATION, m as REMOVE_LOCAL_MESSAGE_ITEM, n as REMOVE_INPUT_FILE, o as ADD_INPUT_FILE, p as SET_IS_BROWSER_PAGE_VISIBLE, q as UPDATE_INPUT_STATE, r as CHANGE_STEP_IN_TOUR, s as CLEAR_TOUR_DATA, t as SET_TOUR_DATA, u as SET_CUSTOM_PANEL_OPTIONS, v as SET_CUSTOM_PANEL_OPEN, w as SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN, x as CLOSE_IFRAME_PANEL, O as OPEN_IFRAME_CONTENT, y as SET_LAUNCHER_MINIMIZED, z as SET_CHAT_MESSAGES_PROPERTY, B as SET_LAUNCHER_CONFIG_PROPERTY, D as SET_LAUNCHER_PROPERTY, E as UPDATE_LAUNCHER_CONFIG, T as TOGGLE_HOME_SCREEN, G as SET_HOME_SCREEN_IS_OPEN, H as ACCEPTED_DISCLAIMER, I as ANNOUNCE_MESSAGE, M as MERGE_HISTORY, J as SET_MESSAGE_HISTORY_PROPERTY, K as SET_MESSAGE_UI_PROPERTY, L as UPDATE_HOME_SCREEN_CONFIG, N as UPDATE_CSS_VARIABLES, P as UPDATE_MAIN_HEADER_TITLE, Q as UPDATE_LAUNCHER_AVATAR_URL, V as UPDATE_BOT_AVATAR_URL, W as UPDATE_BOT_NAME, X as SET_INITIAL_VIEW_CHANGE_COMPLETE, Y as SET_VIEW_CHANGING, Z as SET_VIEW_STATE, _ as UPDATE_HAS_SENT_NON_WELCOME_MESSAGE, $ as UPDATE_PERSISTED_CHAT_STATE, a0 as SET_APP_STATE_VALUE, a1 as ADD_IS_HYDRATING_COUNTER, a2 as ADD_IS_LOADING_COUNTER, a3 as ADD_IS_TYPING_COUNTER, a4 as MESSAGE_SET_OPTION_SELECTED, a5 as ADD_MESSAGE, a6 as UPDATE_MESSAGE, a7 as UPDATE_LOCAL_MESSAGE_ITEM, a8 as REMOVE_MESSAGES, a9 as ADD_LOCAL_MESSAGE_ITEM, aa as HYDRATE_MESSAGE_HISTORY, ab as RESTART_CONVERSATION, ac as HYDRATE_CHAT, ad as CHANGE_STATE } from \"./chat.actions.js\";\n\nimport { a as selectInputState, b as selectIsInputToAgent, s as selectAgentDisplayState } from \"./chat.selectors.js\";\n\nimport { u as useLanguagePack, C as ChatWidthBreakpoint, L as LanguagePackContext } from \"./chat.AppState.js\";\n\nimport { l as loadLocale, b as loadLanguagePack, e as enLanguagePack, A as AnnounceOnMountComponentExport, V as VisuallyHidden } from \"./chat.VideoComponent.js\";\n\nimport { d as consoleDebug, e as debugLog, b as consoleError, c as consoleWarn, f as isEnableDebugLog, s as sleep, g as callOnError, h as debugStackTrace, j as consoleLog, k as safeFetchTextWithTimeout, l as getBotName, m as setEnableDebugLog, n as setEnableDebugStackTracesLog, a as createDidCatchErrorData } from \"./chat.miscUtils.js\";\n\nimport { V as ViewChangeReason, M as MessageSendSource, B as BusEventType, a as TourStartReason, d as MainWindowCloseReason, b as MainWindowOpenReason } from \"./chat.customElement.js\";\n\nimport { createIntl, useIntl, RawIntlProvider } from \"react-intl\";\n\nimport { V as ViewType, b as CarbonTheme, a as CornersType, O as OnErrorType, C as CSSVariable, F as FileStatusValue, L as LauncherType, W as WriteableElementName, l as loadHAA, c as lazyChat, d as lazyCatastrophicError, e as lazyDisclaimer, f as lazyHomeScreenContainer, g as lazyIFramePanel, h as lazyViewSourcePanel, i as lazyBodyAndFooterPanelComponent, j as lazyTourComponent } from \"./chat.dynamic-imports.js\";\n\nimport { d as deepFreeze, i as inputItemToLocalItem, r as resolvablePromise, o as outputItemToLocalItem, c as createLocalMessageItemsForNestedMessageItems, a as agentUpdateIsSuspended, b as createLocalMessageForInlineError, H as HA_END_CHAT, e as HA_UPDATE_FILE_UPLOAD_IN_PROGRESS, f as HA_SET_IS_SCREEN_SHARING, g as HA_UPDATE_CAPABILITIES, h as HA_SET_AGENT_LEFT_CHAT, j as HA_UPDATE_IS_TYPING, k as HA_UPDATE_IS_SUSPENDED, l as HA_SET_PERSISTED_STATE, m as HA_SET_AGENT_JOINED, n as HA_SET_SHOW_SCREEN_SHARE_REQUEST, p as HA_SET_AGENT_AVAILABILITY, q as HA_SET_IS_RECONNECTING, s as HA_SET_IS_CONNECTING } from \"./chat.resolvablePromise.js\";\n\nimport { A as AgentsOnlineStatus, M as MessageErrorState } from \"./chat.LocalMessageItem.js\";\n\nimport { D as DEFAULT_CUSTOM_PANEL_ID, W as WA_CONSOLE_PREFIX } from \"./chat.constants.js\";\n\nimport { C as CarbonThemeClassNames, B as ButtonKindEnum } from \"./chat.carbonTypes.js\";\n\nimport { h as createWelcomeRequest, f as arrayLastValue, j as isLiveAgentMessage, a as isRequest, k as createMessageRequestForText, l as addDefaultsToMessage, b as isResponse, m as createMessageResponseForText, n as isStreamCompleteItem, o as isStreamPartialItem, p as isStreamFinalResponse, r as renderAsUserDefinedMessage, q as isResponseWithNestedItems, s as asyncForEach, t as streamItemID, u as isPause, i as isConnectToAgent, v as hasTourUserDefinedType, w as hasServiceDesk, x as isTyping, y as asArray, T as THREAD_ID_MAIN, z as findLast, c as isOptionItem, A as isDateResponseType, B as isEventRequest, C as getLastBotResponseWithContext, D as createMessageRequestForChoice } from \"./chat.messageUtils.js\";\n\nimport { u as uuid, U as UUIDType } from \"./chat.uuid.js\";\n\nimport Color from \"color\";\n\nimport { b as MessageResponseTypes, M as MessageInputType, A as AgentMessageType } from \"./chat.Messages.js\";\n\nimport { a as IS_SESSION_STORAGE, b as IS_PHONE, I as IS_MOBILE, c as IS_IOS, d as IS_PHONE_IN_PORTRAIT_MODE } from \"./chat.browserUtils.js\";\n\nimport { createStore } from \"redux\";\n\nimport mergeWith from \"lodash-es/mergeWith.js\";\n\nimport \"intl-pluralrules\";\n\nimport cx from \"classnames\";\n\nimport { useSelector, connect, Provider, useDispatch } from \"react-redux\";\n\nimport { u as useServiceManager, A as AriaAnnouncerContext, d as doFocusRef, b as usePrevious, c as SCROLLBAR_WIDTH, S as ServiceManagerContext } from \"./chat.usePrevious.js\";\n\nimport { a as AriaAnnouncerComponent, M as MessageTypeComponent, W as WindowSizeContext } from \"./chat.MessageTypeComponent.js\";\n\nimport { u as useOnMount } from \"./chat.useOnMount.js\";\n\nimport AiLaunch from \"@carbon/icons-react/es/AiLaunch.js\";\n\nimport ArrowUpLeft from \"@carbon/icons-react/es/ArrowUpLeft.js\";\n\nimport ChatLaunch from \"@carbon/icons-react/es/ChatLaunch.js\";\n\nimport { Button } from \"@carbon/react\";\n\nimport { P as PageObjectId, O as OverlayPanelName, b as AnimationInType, A as AnimationOutType, a as OverlayPanel } from \"./chat.PageObjectId.js\";\n\nimport Close16 from \"@carbon/icons/es/close/16.js\";\n\nimport { c as carbonIconToReact, B as BotHeaderExport } from \"./chat.BotHeader.js\";\n\nimport { createComponent } from \"@lit/react\";\n\nimport CarbonTagElement from \"@carbon/web-components/es-custom/components/tag/tag.js\";\n\nimport { u as useAriaAnnouncer, M as MountChildrenOnDelay } from \"./chat.MountChildrenOnDelay.js\";\n\nimport FocusTrap from \"focus-trap-react\";\n\nimport { L as Loading } from \"./chat.IFrameComponent.js\";\n\nimport { a as HideComponentContext, H as HideComponent } from \"./chat.HideComponent.js\";\n\nimport { H as HomeScreenHeaderExport } from \"./chat.HomeScreenHeader.js\";\n\nimport { B as BasePanelComponentExport } from \"./chat.BasePanelComponent.js\";\n\nimport { a as WriteableElement, M as ModalPortalRootContext } from \"./chat.Header.js\";\n\nimport ReactDOM from \"react-dom\";\n\nimport \"dayjs/locale/en.js\";\n\nimport \"intl-messageformat\";\n\nimport \"@carbon/icons-react/es/Music.js\";\n\nimport \"@carbon/web-components/es-custom/components/ai-skeleton/ai-skeleton-placeholder.js\";\n\nimport \"@carbon/web-components/es-custom/components/ai-skeleton/ai-skeleton-text.js\";\n\nimport \"@carbon/web-components/es-custom/components/skeleton-text/skeleton-text.js\";\n\nimport \"@carbon/web-components/es-custom/components/skeleton-placeholder/skeleton-placeholder.js\";\n\nimport \"uuid\";\n\nimport \"detect-browser\";\n\nimport \"memoize-one\";\n\nimport \"compute-scroll-into-view\";\n\nimport \"tabbable\";\n\nimport \"@carbon/icons-react/es/Attachment.js\";\n\nimport \"tslib\";\n\nimport \"lit\";\n\nimport \"lit/decorators.js\";\n\nimport \"@carbon/web-components/es-custom/components/textarea/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/icon-button/index.js\";\n\nimport \"@carbon/icon-helpers\";\n\nimport \"@carbon/icons/es/thumbs-down/16.js\";\n\nimport \"@carbon/icons/es/thumbs-down--filled/16.js\";\n\nimport \"@carbon/icons/es/thumbs-up/16.js\";\n\nimport \"@carbon/icons/es/thumbs-up--filled/16.js\";\n\nimport \"lit/directives/unsafe-svg.js\";\n\nimport \"@carbon/web-components/es-custom/components/tag/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/chat-button/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/button/button.js\";\n\nimport \"bind-decorator\";\n\nimport \"@carbon/web-components/es-custom/components/button/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/layer/index.js\";\n\nimport \"@carbon/icons-react/es/Checkmark.js\";\n\nimport \"@carbon/icons-react/es/Headset.js\";\n\nimport \"@carbon/icons-react/es/HelpDesk.js\";\n\nimport \"@carbon/icons-react/es/Logout.js\";\n\nimport \"./chat.RichText.js\";\n\nimport \"lodash-es/throttle.js\";\n\nimport \"dompurify\";\n\nimport \"lit/directives/repeat.js\";\n\nimport \"lit/directives/unsafe-html.js\";\n\nimport \"./chat.htmlUtils.js\";\n\nimport \"./chat.stringUtils.js\";\n\nimport \"@carbon/icons-react/es/TouchInteraction.js\";\n\nimport \"@carbon/icons-react/es/Send.js\";\n\nimport \"@carbon/icons-react/es/ArrowRight.js\";\n\nimport \"@carbon/icons/es/launch/16.js\";\n\nimport \"@carbon/web-components/es-custom/components/link/link.js\";\n\nimport \"./chat.BodyWithFooterComponent.js\";\n\nimport \"lodash-es/debounce.js\";\n\nimport \"@carbon/icons-react/es/Link.js\";\n\nimport \"@carbon/icons-react/es/Maximize.js\";\n\nimport \"@carbon/icons/es/chevron--down/16.js\";\n\nimport \"@carbon/icons/es/chevron--up/16.js\";\n\nimport \"@carbon/web-components/es-custom/components/tag/operational-tag.js\";\n\nimport \"./chat.useCounter.js\";\n\nimport \"./chat.ChatButton.js\";\n\nimport \"@carbon/web-components/es-custom/components/chat-button/chat-button.js\";\n\nimport \"@carbon/web-components/es-custom/components/layer/layer.js\";\n\nimport \"@carbon/web-components/es-custom/components/dropdown/dropdown.js\";\n\nimport \"@carbon/web-components/es-custom/components/dropdown/dropdown-item.js\";\n\nimport \"csv-stringify/browser/esm/sync\";\n\nimport \"@carbon/web-components/es-custom/components/data-table/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/checkbox/index.js\";\n\nimport \"@carbon/icons/es/download/16.js\";\n\nimport \"lit-html/directives/repeat.js\";\n\nimport \"@carbon/web-components/es-custom/components/pagination/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/select/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/data-table/table-skeleton.js\";\n\nimport \"@carbon/icons-react/es/Restart.js\";\n\nimport \"@carbon/web-components/es-custom/components/inline-loading/index.js\";\n\nimport \"@carbon/icons/es/checkmark--filled/16.js\";\n\nimport \"@carbon/icons/es/chevron--right/16.js\";\n\nimport \"@carbon/icons/es/error--filled/16.js\";\n\nimport \"@carbon/icons-react/es/Home.js\";\n\nimport \"@carbon/icons-react/es/ErrorFilled.js\";\n\nimport \"@carbon/web-components/es-custom/components/loading/loading-icon.js\";\n\nimport \"@carbon/web-components/es-custom/components/loading/loading.js\";\n\nimport \"@carbon/web-components/es-custom/components/slug/index.js\";\n\nimport \"@carbon/icons-react/es/Close.js\";\n\nimport \"@carbon/icons-react/es/CloseLarge.js\";\n\nimport \"@carbon/icons-react/es/DownToBottom.js\";\n\nimport \"@carbon/icons-react/es/Menu.js\";\n\nimport \"@carbon/icons-react/es/SidePanelClose.js\";\n\nimport \"@carbon/icons-react/es/SubtractLarge.js\";\n\nimport \"@carbon/web-components/es-custom/components/ai-label/defs.js\";\n\nimport \"@carbon/web-components/es-custom/components/popover/defs.js\";\n\nimport \"@carbon/web-components/es-custom/components/skeleton-icon/index.js\";\n\nimport \"@carbon/web-components/es-custom/components/overflow-menu/index.js\";\n\nimport \"@carbon/icons-react/es/ChevronDown.js\";\n\nimport \"@carbon/icons-react/es/ChevronUp.js\";\n\nimport \"@floating-ui/react\";\n\nimport \"@carbon/web-components/es-custom/components/ai-label/ai-label-action-button.js\";\n\nimport \"@carbon/web-components/es-custom/components/ai-label/ai-label.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function withoutEmptyStarters(config) {\n  let newConfig = config;\n  if (config?.starters?.buttons?.length) {\n    newConfig = {\n      allow_return: true,\n      ...config,\n      starters: {\n        ...config.starters,\n        buttons: config.starters.buttons.filter(button => Boolean(button.label?.trim()))\n      }\n    };\n    if (!newConfig?.starters?.buttons?.length) {\n      newConfig.starters.is_on = false;\n    }\n  }\n  return newConfig;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function setIntl(serviceManager, locale, messages) {\n  serviceManager.intl = createIntl({\n    locale: locale,\n    messages: messages\n  });\n  serviceManager.store.dispatch(actions.setAppStateValue(\"languagePack\", messages));\n  serviceManager.store.dispatch(actions.setAppStateValue(\"locale\", locale));\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function createChatInstance({serviceManager: serviceManager, callRender: callRender}) {\n  let wasRendered = false;\n  function getMainWindow() {\n    return {\n      addClassName: name => serviceManager.mainWindow?.addClassName(name),\n      removeClassName: name => serviceManager.mainWindow?.removeClassName(name)\n    };\n  }\n  function getMessageInput() {\n    return {\n      getHTMLElement: () => serviceManager.mainWindow?.getMessageInput()?.getHTMLElement(),\n      setValue: value => serviceManager.mainWindow?.getMessageInput()?.setValue(value),\n      setEnableEnterKey: value => serviceManager.mainWindow?.getMessageInput()?.setEnableEnterKey(value),\n      addChangeListener: listener => serviceManager.mainWindow?.getMessageInput()?.addChangeListener(listener),\n      removeChangeListener: listener => serviceManager.mainWindow?.getMessageInput()?.removeChangeListener(listener)\n    };\n  }\n  function getHomeScreenInput() {\n    return {\n      getHTMLElement: () => serviceManager.mainWindow?.getHomeScreenInput()?.getHTMLElement(),\n      setValue: value => serviceManager.mainWindow?.getHomeScreenInput()?.setValue(value),\n      setEnableEnterKey: value => serviceManager.mainWindow?.getHomeScreenInput()?.setEnableEnterKey(value),\n      addChangeListener: listener => serviceManager.mainWindow?.getHomeScreenInput()?.addChangeListener(listener),\n      removeChangeListener: listener => serviceManager.mainWindow?.getHomeScreenInput()?.removeChangeListener(listener)\n    };\n  }\n  let instance = {\n    render: () => {\n      if (wasRendered) {\n        consoleError(\"The render function has already been called!\");\n        return Promise.resolve(instance);\n      }\n      wasRendered = true;\n      return callRender();\n    },\n    on: handlers => {\n      serviceManager.eventBus.on(handlers);\n      return instance;\n    },\n    off: handlers => {\n      serviceManager.eventBus.off(handlers);\n      return instance;\n    },\n    once: handlers => {\n      serviceManager.eventBus.once(handlers);\n      return instance;\n    },\n    updateLanguagePack: newPack => {\n      debugLog(\"Called instance.updateLanguagePack\", newPack);\n      return serviceManager.actions.updateLanguagePack(newPack);\n    },\n    updateLocale: newLocale => {\n      debugLog(\"Called instance.updateLocale\", newLocale);\n      const localePromise = loadLocale(newLocale);\n      const languagePackPromise = loadLanguagePack(serviceManager.store.getState().languagePack);\n      return Promise.all([ localePromise, languagePackPromise ]).then(([localePack, languagePack]) => {\n        dayjs.locale(localePack);\n        setIntl(serviceManager, localePack.name, languagePack);\n        serviceManager.messageService.pendingLocale = true;\n        serviceManager.messageService.localeIsExplicit = true;\n      });\n    },\n    updateCSSVariables: (variables, whiteLabelVariables) => {\n      debugLog(\"Called instance.updateCSSVariables\", variables);\n      return serviceManager.actions.updateCSSVariables(variables, whiteLabelVariables);\n    },\n    send: async (message, options) => {\n      debugLog(\"Called instance.send\", message, options);\n      if (selectInputState(serviceManager.store.getState()).isReadonly) {\n        throw new Error(\"You are unable to send messages in read only mode.\");\n      }\n      return serviceManager.actions.send(message, MessageSendSource.INSTANCE_SEND, options);\n    },\n    doAutoScroll: (options = {}) => {\n      debugLog(\"Called instance.doAutoScroll\", options);\n      serviceManager.mainWindow?.doAutoScroll?.(options);\n    },\n    destroy: () => {\n      debugLog(\"Called instance.destroy\");\n      serviceManager.store.dispatch(actions.setAppStateValue(\"isDestroyed\", true));\n      serviceManager.container?.remove();\n      instance = undefined;\n    },\n    updateAssistantInputFieldVisibility: isVisible => {\n      debugLog(\"Called instance.updateAssistantInputFieldVisibility\", isVisible);\n      serviceManager.store.dispatch(actions.updateInputState({\n        fieldVisible: isVisible\n      }, false));\n    },\n    updateInputIsDisabled: isDisabled => {\n      debugLog(\"Called instance.updateInputIsDisabled\", isDisabled);\n      serviceManager.store.dispatch(actions.updateInputState({\n        isReadonly: isDisabled\n      }, false));\n    },\n    updateBotUnreadIndicatorVisibility: isVisible => {\n      debugLog(\"Called instance.updateBotUnreadIndicatorVisibility\", isVisible);\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"showUnreadIndicator\", isVisible));\n    },\n    changeView: async newView => {\n      debugLog(\"Called instance.changeView\", newView);\n      let issueWithNewView = false;\n      if (!wasRendered) {\n        consoleError(`You tried to call \"changeView\" without ever having called the \"render\" method. There is no view to change!`);\n        issueWithNewView = true;\n      }\n      const viewTypeValues = Object.values(ViewType);\n      if (typeof newView === \"string\") {\n        if (!viewTypeValues.includes(newView)) {\n          consoleError(`You tried to change the view but the view you specified is not a valid view name. Please use` + ` the valid view names; ${viewTypeValues.join(\", \")}.`);\n          issueWithNewView = true;\n        }\n      } else if (typeof newView === \"object\") {\n        Object.keys(newView).forEach(key => {\n          if (!viewTypeValues.includes(key)) {\n            consoleError(`You tried to change the state of multiple views by providing an object, however you included the key` + ` \"${key}\" within the object which is not a valid view name. Please use the valid view names; ` + `${viewTypeValues.join(\", \")}.`);\n            issueWithNewView = true;\n          }\n        });\n      } else {\n        consoleError(\"You tried to change the view but the view you provided was not a string or an object. You can either change\" + ' to one of the supported views by providing a string, ex. \"launcher\", \"mainWindow\", or \"tour\". Or you can' + ' change the state of multiple views by providing an object, ex. { \"launcher\": true, \"mainWindow\": false,' + ' \"tour\": true }. Please use one of these supported options.');\n        issueWithNewView = true;\n      }\n      if (!issueWithNewView) {\n        await serviceManager.actions.changeView(newView, {\n          viewChangeReason: ViewChangeReason.CALLED_CHANGE_VIEW\n        });\n      }\n    },\n    notifications: {\n      addNotification: notification => {\n        debugLog(\"Called instance.addNotification\", notification);\n        serviceManager.actions.addNotification(notification);\n      },\n      removeNotifications: groupID => {\n        debugLog(\"Called instance.removeNotifications\", groupID);\n        serviceManager.actions.removeNotification(groupID);\n      },\n      removeAllNotifications: () => {\n        debugLog(\"Called instance.removeAllNotifications\");\n        serviceManager.actions.removeAllNotifications();\n      }\n    },\n    updateMainHeaderTitle: title => {\n      debugLog(\"Called instance.updateMainHeaderTitle\", title);\n      if (!title) {\n        title = null;\n      }\n      serviceManager.actions.updateMainHeaderTitle(title);\n    },\n    updateHomeScreenConfig: homeScreenConfig => {\n      debugLog(\"Called instance.updateHomeScreenConfig\", homeScreenConfig);\n      const homeScreenConfigClone = cloneDeep(homeScreenConfig);\n      const isAIThemeEnabled = serviceManager.store.getState().theme.useAITheme;\n      if (isAIThemeEnabled) {\n        if (homeScreenConfig?.background) {\n          consoleWarn(\"The home screen background can not be changed when the AI theme is enabled.\");\n          delete homeScreenConfigClone.background;\n        }\n      }\n      serviceManager.actions.updateHomeScreenConfig(withoutEmptyStarters(homeScreenConfigClone));\n    },\n    getState: () => serviceManager.actions.getPublicWebChatState(),\n    writeableElements: createWriteableElementsProxy(serviceManager),\n    scrollToMessage: (messageID, animate) => {\n      debugLog(\"Called instance.scrollToMessage\", messageID, animate);\n      serviceManager.mainWindow?.doScrollToMessage(messageID, animate);\n    },\n    updateLauncherConfig: config => serviceManager.actions.updateLauncherConfig(config),\n    customPanels: serviceManager.customPanelManager,\n    updateCustomMenuOptions: options => {\n      debugLog(\"Called instance.updateCustomMenuOptions\", options);\n      serviceManager.store.dispatch(actions.setAppStateValue(\"customMenuOptions\", options));\n    },\n    restartConversation: async () => {\n      debugLog(\"Called instance.restartConversation\");\n      return serviceManager.actions.restartConversation();\n    },\n    agentEndConversation: () => {\n      debugLog(\"Called instance.agentEndConversation\");\n      consoleWarn(`The instance.agentEndConversation method is deprecated. Use instance.serviceDesk.endConversation instead.`);\n      return serviceManager.actions.agentEndConversation(false);\n    },\n    updateIsTypingCounter(direction) {\n      debugLog(\"Called instance.updateIsTypingCounter\", direction);\n      const {store: store} = serviceManager;\n      if (direction === \"increase\") {\n        store.dispatch(actions.addIsTypingCounter(1));\n      } else if (direction === \"decrease\") {\n        if (store.getState().botMessageState.isTypingCounter <= 0) {\n          consoleError(\"You cannot decrease the typing counter when it is already <= 0\");\n          return;\n        }\n        store.dispatch(actions.addIsTypingCounter(-1));\n      } else {\n        consoleError(`[updateIsTypingCounter] Invalid direction: ${direction}. Valid values are \"increase\" and \"decrease\".`);\n      }\n    },\n    updateIsLoadingCounter(direction) {\n      debugLog(\"Called instance.updateIsLoadingCounter\", direction);\n      const {store: store} = serviceManager;\n      if (direction === \"increase\") {\n        store.dispatch(actions.addIsLoadingCounter(1));\n      } else if (direction === \"decrease\") {\n        if (store.getState().botMessageState.isLoadingCounter <= 0) {\n          consoleError(\"You cannot decrease the loading counter when it is already <= 0\");\n          return;\n        }\n        store.dispatch(actions.addIsLoadingCounter(-1));\n      } else {\n        consoleError(`[updateIsLoadingCounter] Invalid direction: ${direction}. Valid values are \"increase\" and \"decrease\".`);\n      }\n    },\n    updateIsChatLoadingCounter(direction) {\n      debugLog(\"Called instance.updateIsChatLoadingCounter\", direction);\n      const {store: store} = serviceManager;\n      if (direction === \"increase\") {\n        store.dispatch(actions.addIsHydratingCounter(1));\n      } else if (direction === \"decrease\") {\n        if (store.getState().botMessageState.isHydratingCounter <= 0) {\n          consoleError(\"You cannot decrease the hydrating counter when it is already <= 0\");\n          return;\n        }\n        store.dispatch(actions.addIsHydratingCounter(-1));\n      } else {\n        consoleError(`[updateIsChatLoadingCounter] Invalid direction: ${direction}. Valid values are \"increase\" and \"decrease\".`);\n      }\n    },\n    updateHeaderConfig: config => {\n      const configCopy = cloneDeep(config);\n      serviceManager.store.dispatch(actions.updateChatHeaderConfig(configCopy));\n    },\n    updateMainHeaderAvatar: config => {\n      serviceManager.store.dispatch(actions.updateMainHeaderAvatar(config));\n    },\n    updateBotName: name => serviceManager.actions.updateBotName(name),\n    updateBotAvatarURL: url => serviceManager.actions.updateBotAvatarURL(url),\n    elements: {\n      getMainWindow: getMainWindow,\n      getMessageInput: getMessageInput,\n      getHomeScreenInput: getHomeScreenInput\n    },\n    tours: {\n      startTour: async message => {\n        debugLog(\"Called instance.tours.startTour\", message);\n        await serviceManager.actions.send(message, MessageSendSource.START_TOUR_METHOD, {\n          skipTourCard: true\n        });\n      },\n      endTour: async () => {\n        debugLog(\"Called instance.tours.endTour\");\n        serviceManager.actions.endTour({\n          viewChangeReason: ViewChangeReason.CALLED_END_TOUR\n        });\n      },\n      goToNextStep: async () => {\n        debugLog(\"Called instance.tours.goToNextStep\");\n        serviceManager.actions.changeStepInTour({\n          nextStep: true\n        });\n      },\n      goToStep: async stepId => {\n        debugLog(\"Called instance.tours.goToStep\", stepId);\n        serviceManager.actions.goToSpecificTourStep(stepId);\n      }\n    },\n    messaging: {\n      addMessage: (message, options = {}) => {\n        debugLog(\"Called instance.messaging.addMessage\", message, options);\n        serviceManager.messageService.messageLoadingManager.end();\n        return serviceManager.actions.receive(message, options?.isLatestWelcomeNode ?? false, null, {\n          disableFadeAnimation: options?.disableFadeAnimation\n        });\n      },\n      addMessageChunk: async (chunk, options = {}) => {\n        debugLog(\"Called instance.messaging.addMessageChunk\", chunk, options);\n        serviceManager.messageService.messageLoadingManager.end();\n        await serviceManager.actions.receiveChunk(chunk, null, options);\n      },\n      removeMessages: async messageIDs => {\n        debugLog(\"Called instance.messaging.removeMessages\", messageIDs);\n        return serviceManager.actions.removeMessages(messageIDs);\n      },\n      clearConversation: () => {\n        debugLog(\"Called instance.messaging.clearConversation\");\n        return serviceManager.actions.restartConversation({\n          skipHydration: true,\n          endAgentConversation: false,\n          fireEvents: false\n        });\n      },\n      insertHistory: messages => {\n        debugLog(\"Called instance.messaging.insertHistory\", messages);\n        return serviceManager.actions.insertHistory(messages);\n      }\n    },\n    requestFocus: () => {\n      debugLog(\"Called instance.requestFocus\");\n      serviceManager.appWindow?.requestFocus();\n    },\n    serviceDesk: {\n      endConversation: () => {\n        debugLog(\"Called instance.serviceDesk.endConversation\");\n        return serviceManager.actions.agentEndConversation(false);\n      },\n      updateIsSuspended: async isSuspended => {\n        debugLog(\"Called instance.serviceDesk.updateIsSuspended\", isSuspended);\n        return serviceManager.actions.agentUpdateIsSuspended(isSuspended);\n      }\n    }\n  };\n  if (serviceManager.store.getState().config.public.debug) {\n    consoleDebug(\"[ChatInstanceImpl] Created chat instance\", instance);\n  }\n  return instance;\n}\n\nfunction createWriteableElementsProxy(serviceManager) {\n  const elementSet = new Set;\n  const handler = {\n    get(target, element) {\n      if (!elementSet.has(element)) {\n        elementSet.add(element);\n      }\n      return target[element];\n    }\n  };\n  return new Proxy(serviceManager.writeableElements, handler);\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const NODE_ENV = \"production\";\n\nconst VERSION = \"0.4.0\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ var NotificationType;\n\n(function(NotificationType) {\n  NotificationType[\"TEXT_NOTIFICATION\"] = \"text_notification\";\n})(NotificationType || (NotificationType = {}));\n\nconst BOUNCING_ANIMATION_TIMEOUTS = [ 15e3, 6e4 ];\n\nconst TIME_TO_ENTRANCE_ANIMATION_START = 15e3;\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const DEFAULT_LAUNCHER = {\n  config: {\n    is_on: true,\n    mobile: {\n      is_on: true,\n      title: \"\",\n      time_to_expand: TIME_TO_ENTRANCE_ANIMATION_START,\n      new_expand_time: false,\n      time_to_reduce: 1e4,\n      notification_type: NotificationType.TEXT_NOTIFICATION\n    },\n    desktop: {\n      is_on: true,\n      title: \"\",\n      new_expand_time: false,\n      time_to_expand: TIME_TO_ENTRANCE_ANIMATION_START,\n      notification_type: NotificationType.TEXT_NOTIFICATION\n    }\n  }\n};\n\ndeepFreeze(DEFAULT_LAUNCHER);\n\nconst DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS = {\n  title: null,\n  hideBackButton: false,\n  hidePanelHeader: false,\n  disableAnimation: false\n};\n\ndeepFreeze(DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS);\n\nconst DEFAULT_CUSTOM_PANEL_STATE = {\n  isOpen: false,\n  panelID: DEFAULT_CUSTOM_PANEL_ID,\n  options: DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS\n};\n\ndeepFreeze(DEFAULT_CUSTOM_PANEL_STATE);\n\nconst DEFAULT_IFRAME_PANEL_STATE = {\n  isOpen: false,\n  messageItem: null\n};\n\ndeepFreeze(DEFAULT_IFRAME_PANEL_STATE);\n\nconst DEFAULT_CITATION_PANEL_STATE = {\n  isOpen: false,\n  citationItem: null\n};\n\ndeepFreeze(DEFAULT_CITATION_PANEL_STATE);\n\nconst DEFAULT_TOUR_STATE = {\n  activeTourStepItems: null\n};\n\ndeepFreeze(DEFAULT_TOUR_STATE);\n\nconst DEFAULT_MESSAGE_PANEL_STATE = {\n  isOpen: false,\n  localMessageItem: null,\n  isMessageForInput: false\n};\n\ndeepFreeze(DEFAULT_MESSAGE_PANEL_STATE);\n\nconst VIEW_STATE_ALL_CLOSED = {\n  launcher: false,\n  mainWindow: false,\n  tour: false\n};\n\ndeepFreeze(VIEW_STATE_ALL_CLOSED);\n\nconst VIEW_STATE_LAUNCHER_OPEN = {\n  launcher: true,\n  mainWindow: false,\n  tour: false\n};\n\ndeepFreeze(VIEW_STATE_LAUNCHER_OPEN);\n\nconst VIEW_STATE_MAIN_WINDOW_OPEN = {\n  mainWindow: true,\n  launcher: false,\n  tour: false\n};\n\ndeepFreeze(VIEW_STATE_MAIN_WINDOW_OPEN);\n\nconst DEFAULT_PERSISTED_TO_BROWSER = {\n  chatState: {\n    version: VERSION,\n    disclaimersAccepted: {},\n    homeScreenState: {\n      isHomeScreenOpen: false,\n      showBackToBot: false\n    },\n    hasSentNonWelcomeMessage: false,\n    persistedTourState: {\n      activeTourID: null,\n      activeTourCurrentStepIndex: null\n    },\n    agentState: {\n      isConnected: false,\n      isSuspended: false,\n      agentProfiles: {}\n    }\n  },\n  launcherState: {\n    wasLoadedFromBrowser: false,\n    version: VERSION,\n    viewState: VIEW_STATE_ALL_CLOSED,\n    activeTour: false,\n    showUnreadIndicator: false,\n    mobileLauncherIsExtended: false,\n    mobileLauncherWasReduced: false,\n    mobileLauncherDisableBounce: false,\n    desktopLauncherIsExpanded: false,\n    desktopLauncherWasMinimized: false,\n    bounceTurn: 1,\n    hasSentNonWelcomeMessage: false\n  }\n};\n\ndeepFreeze(DEFAULT_PERSISTED_TO_BROWSER);\n\nconst DEFAULT_CHAT_MESSAGES_STATE = {\n  localMessageIDs: [],\n  messageIDs: [],\n  isTypingCounter: 0,\n  isLoadingCounter: 0,\n  isHydratingCounter: 0,\n  isScrollAnchored: false\n};\n\ndeepFreeze(DEFAULT_CHAT_MESSAGES_STATE);\n\nconst DEFAULT_MESSAGE_STATE = {\n  allMessageItemsByID: {},\n  allMessagesByID: {},\n  botMessageState: {\n    ...DEFAULT_CHAT_MESSAGES_STATE\n  }\n};\n\ndeepFreeze(DEFAULT_MESSAGE_STATE);\n\nconst DEFAULT_INPUT_STATE = () => ({\n  fieldVisible: true,\n  isReadonly: false,\n  files: [],\n  allowFileUploads: true,\n  allowMultipleFileUploads: false,\n  allowedFileUploadTypes: null,\n  stopStreamingButtonState: {\n    currentStreamID: null,\n    isVisible: false,\n    isDisabled: false\n  }\n});\n\nconst DEFAULT_AGENT_STATE = {\n  isConnecting: false,\n  isReconnecting: false,\n  numUnreadMessages: 0,\n  fileUploadInProgress: false,\n  showScreenShareRequest: false,\n  isScreenSharing: false,\n  isAgentTyping: false,\n  inputState: DEFAULT_INPUT_STATE()\n};\n\ndeepFreeze(DEFAULT_AGENT_STATE);\n\nconst DEFAULT_THEME_STATE = {\n  carbonTheme: CarbonTheme.G10,\n  useAITheme: false,\n  corners: CornersType.ROUND\n};\n\ndeepFreeze(DEFAULT_THEME_STATE);\n\nconst DEFAULT_LAYOUT_STATE = {\n  showFrame: true,\n  hasContentMaxWidth: true\n};\n\ndeepFreeze(DEFAULT_LAYOUT_STATE);\n\nfunction calcAnnouncementForWidgetOpen(previousState, newViewState) {\n  if (isEqual(previousState.persistedToBrowserStorage.launcherState.viewState, newViewState)) {\n    return previousState.announceMessage;\n  }\n  return {\n    messageID: newViewState.mainWindow ? \"window_ariaWindowOpened\" : \"window_ariaWindowClosed\"\n  };\n}\n\nfunction applyBotMessageState(state, newState) {\n  return {\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      ...newState\n    }\n  };\n}\n\nfunction handleViewStateChange(state, viewState) {\n  let {agentState: agentState} = state;\n  let {showUnreadIndicator: showUnreadIndicator} = state.persistedToBrowserStorage.launcherState;\n  if (viewState.mainWindow && state.isBrowserPageVisible) {\n    if (agentState.numUnreadMessages !== 0) {\n      agentState = {\n        ...agentState,\n        numUnreadMessages: 0\n      };\n    }\n    showUnreadIndicator = false;\n  }\n  return {\n    ...state,\n    announceMessage: calcAnnouncementForWidgetOpen(state, viewState),\n    agentState: agentState,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        viewState: viewState,\n        showUnreadIndicator: showUnreadIndicator\n      }\n    }\n  };\n}\n\nfunction setHomeScreenOpenState(state, isOpen, showBackToBot) {\n  if (showBackToBot === undefined) {\n    showBackToBot = state.persistedToBrowserStorage.chatState.homeScreenState.showBackToBot;\n  }\n  return {\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        homeScreenState: {\n          ...state.persistedToBrowserStorage.chatState.homeScreenState,\n          isHomeScreenOpen: isOpen,\n          showBackToBot: showBackToBot\n        }\n      }\n    }\n  };\n}\n\nfunction applyLocalMessageUIState(state, localMessageID, propertyName, propertyValue) {\n  const oldMessage = state.allMessageItemsByID[localMessageID];\n  if (oldMessage) {\n    return {\n      ...state,\n      allMessageItemsByID: {\n        ...state.allMessageItemsByID,\n        [localMessageID]: {\n          ...oldMessage,\n          ui_state: {\n            ...oldMessage.ui_state,\n            [propertyName]: propertyValue\n          }\n        }\n      }\n    };\n  }\n  return state;\n}\n\nfunction applyFullMessage(state, message) {\n  const newState = {\n    ...state,\n    allMessagesByID: {\n      ...state.allMessagesByID,\n      [message.id]: message\n    }\n  };\n  if (!state.allMessagesByID[message.id]) {\n    const currentMessageIDs = state.botMessageState.messageIDs;\n    const newMessageIDs = [ ...currentMessageIDs, message.id ];\n    return applyBotMessageState(newState, {\n      messageIDs: newMessageIDs\n    });\n  }\n  return newState;\n}\n\nvar white = \"#ffffff\";\n\nvar blue60 = \"#0f62fe\";\n\nvar gray10 = \"#f4f4f4\";\n\nvar gray80 = \"#393939\";\n\nvar gray100 = \"#161616\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const MIN_CONTRAST = 4.5;\n\nfunction hexCodeToRGB(color) {\n  if (color.length === 7) {\n    const red = color.substring(1, 3);\n    const blue = color.substring(3, 5);\n    const green = color.substring(5, 7);\n    return [ parseInt(red, 16), parseInt(blue, 16), parseInt(green, 16) ];\n  }\n  if (color.length === 4) {\n    const red = color.substring(1, 2);\n    const blue = color.substring(2, 3);\n    const green = color.substring(3, 4);\n    return [ parseInt(red + red, 16), parseInt(blue + blue, 16), parseInt(green + green, 16) ];\n  }\n  consoleError(`Unsupported color code: \"${color}\"`);\n  return [ 0, 0, 0 ];\n}\n\nfunction calculateContrast(color1, color2) {\n  const rgb1 = hexCodeToRGB(color1);\n  const rgb2 = hexCodeToRGB(color2);\n  const luminance1 = calculateRelativeLuminance(rgb1);\n  const luminance2 = calculateRelativeLuminance(rgb2);\n  let contrast;\n  if (luminance1 > luminance2) {\n    contrast = (luminance1 + .05) / (luminance2 + .05);\n  } else {\n    contrast = (luminance2 + .05) / (luminance1 + .05);\n  }\n  return contrast;\n}\n\nfunction calculateRelativeLuminance([r8, g8, b8]) {\n  const rRGB = r8 / 255;\n  const gRGB = g8 / 255;\n  const bRGB = b8 / 255;\n  const R = rRGB <= .03928 ? rRGB / 12.92 : ((rRGB + .055) / 1.055) ** 2.4;\n  const G = gRGB <= .03928 ? gRGB / 12.92 : ((gRGB + .055) / 1.055) ** 2.4;\n  const B = bRGB <= .03928 ? bRGB / 12.92 : ((bRGB + .055) / 1.055) ** 2.4;\n  const luminance = .2126 * R + .7152 * G + .0722 * B;\n  return luminance;\n}\n\nfunction whiteOrBlackText(background) {\n  return calculateContrast(gray100, background) >= MIN_CONTRAST ? gray100 : white;\n}\n\nfunction adjustLightness(token, shift) {\n  const original = Color(token).hsl().object();\n  return Color({\n    ...original,\n    l: original.l + shift\n  }).round().hex().toLowerCase();\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const CSS_VAR_PREFIX = \"--cds-\";\n\nconst CSS_CHAT_PREFIX = \"chat-\";\n\nconst HEXADECIMAL_REGEX = /#([a-f0-9]{3}){1,2}\\b/i;\n\nconst INTERNAL_OVERRIDES_LIGHT_THEME_MAP = {\n  \"$chat-button\": \"#000000\",\n  \"$chat-button-text-hover\": \"#525252\"\n};\n\nconst INTERNAL_OVERRIDES_DARK_THEME_MAP = {\n  \"$chat-button\": \"#ffffff\",\n  \"$chat-button-text-hover\": \"#f4f4f4\"\n};\n\nfunction convertCSSVariablesToString(cssVariables) {\n  const pieces = Object.keys(cssVariables).map(key => {\n    const value = cssVariables[key];\n    if (value === undefined) {\n      return \"\";\n    }\n    const fullName = key.startsWith(\"$\") ? `${CSS_VAR_PREFIX}${key.replace(/^\\$/, \"\")}` : `${CSS_VAR_PREFIX}${CSS_CHAT_PREFIX}${key}`;\n    return `${fullName}:${value};`;\n  });\n  let cssVariablesString = \"\";\n  const allValues = pieces.join(\"\");\n  const prefix = \"\";\n  if (allValues.length > 0) {\n    const rule = `${prefix}.WACContainer .cds--white, ${prefix}.WACContainer .cds--g10, ${prefix}.WACContainer .cds--g90, ${prefix}.WACContainer .cds--g100`;\n    cssVariablesString = `${rule}${`, :host`}{${allValues}}`;\n  }\n  return cssVariablesString;\n}\n\nfunction remoteStylesToCSSVars(whiteLabelVariables, carbonTheme) {\n  const cssOverrides = {};\n  const primaryColor = whiteLabelVariables[\"BASE-primary-color\"];\n  const secondaryColor = whiteLabelVariables[\"BASE-secondary-color\"];\n  const accentColor = whiteLabelVariables[\"BASE-accent-color\"];\n  if (primaryColor) {\n    cssOverrides[\"PRIMARY-color\"] = primaryColor;\n    cssOverrides[\"PRIMARY-color-text\"] = whiteOrBlackText(primaryColor);\n    cssOverrides[\"PRIMARY-color-hover\"] = adjustLightness(primaryColor, -8);\n    cssOverrides[\"PRIMARY-color-active\"] = adjustLightness(primaryColor, -10);\n    const useAccentColor = accentColor || blue60;\n    const tryFocusColor = carbonTheme === CarbonTheme.G90 || carbonTheme === CarbonTheme.G100 ? white : useAccentColor;\n    let useFocusColor;\n    if (calculateContrast(primaryColor, tryFocusColor) >= MIN_CONTRAST) {\n      useFocusColor = tryFocusColor;\n    } else if (tryFocusColor !== useAccentColor && calculateContrast(primaryColor, useAccentColor) >= MIN_CONTRAST) {\n      useFocusColor = useAccentColor;\n    } else if (tryFocusColor !== white && calculateContrast(primaryColor, white) >= MIN_CONTRAST) {\n      useFocusColor = white;\n    } else {\n      useFocusColor = gray100;\n    }\n    if (useFocusColor !== tryFocusColor) {\n      cssOverrides[\"PRIMARY-color-focus\"] = useFocusColor;\n    }\n  }\n  if (secondaryColor) {\n    cssOverrides[\"SECONDARY-color\"] = secondaryColor;\n    cssOverrides[\"SECONDARY-color-text\"] = whiteOrBlackText(secondaryColor);\n  } else if (carbonTheme === CarbonTheme.G90 || carbonTheme === CarbonTheme.G100) {\n    cssOverrides[\"SECONDARY-color\"] = `var(${CSS_VAR_PREFIX}layer-02)`;\n    cssOverrides[\"SECONDARY-color-text\"] = `var(${CSS_VAR_PREFIX}text-primary);`;\n  }\n  if (accentColor) {\n    const colorMap = ACCENT_COLOR_MAPS[carbonTheme];\n    const accentBlue20 = adjustLightness(accentColor, 40);\n    const accentBlue60Hover = adjustLightness(accentColor, -8);\n    const accentBlue80 = adjustLightness(accentColor, -20);\n    fillValues(cssOverrides, colorMap.blue20, accentBlue20);\n    fillValues(cssOverrides, colorMap.blue60, accentColor);\n    fillValues(cssOverrides, colorMap.blue60Hover, accentBlue60Hover);\n    fillValues(cssOverrides, colorMap.blue80, accentBlue80);\n    cssOverrides[\"LAUNCHER-color-background\"] = accentColor;\n    cssOverrides[\"LAUNCHER-color-background-hover\"] = accentBlue60Hover;\n    cssOverrides[\"LAUNCHER-color-background-active\"] = accentBlue80;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-background\"] = accentColor;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-hover\"] = accentBlue60Hover;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-active\"] = accentBlue80;\n    cssOverrides[\"ACCENT-color\"] = accentColor;\n    const accentColorRGB = hexCodeToRGB(accentColor);\n    cssOverrides[\"ACCENT-color-r\"] = accentColorRGB[0].toString();\n    cssOverrides[\"ACCENT-color-g\"] = accentColorRGB[1].toString();\n    cssOverrides[\"ACCENT-color-b\"] = accentColorRGB[2].toString();\n    cssOverrides[\"ACCENT-color-ghost-text\"] = accentColor;\n    const accentColorBW = whiteOrBlackText(accentColor);\n    cssOverrides[\"ACCENT-color-text\"] = accentColorBW;\n    cssOverrides[\"ACCENT-color-background-hover\"] = accentBlue60Hover;\n    cssOverrides[\"ACCENT-color-background-active\"] = accentBlue80;\n    cssOverrides[\"LAUNCHER-color-focus-border\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-color-avatar\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-text\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-focus-border\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-MOBILE-color-text\"] = accentColorBW;\n    cssOverrides[\"ACCENT-color-bw\"] = accentColorBW;\n    cssOverrides[\"ACCENT-color-bw-hover\"] = adjustLightness(accentColorBW, -8);\n    cssOverrides[\"ACCENT-color-bw-active\"] = adjustLightness(accentColorBW, -10);\n    cssOverrides[\"ACCENT-color-bw-inverse\"] = accentColorBW === gray100 ? white : gray100;\n    cssOverrides[\"ACCENT-color-bw-gray\"] = accentColorBW === gray100 ? gray80 : gray10;\n    cssOverrides[\"ACCENT-color-pastel\"] = accentColorBW === gray100 ? adjustLightness(accentColor, 20) : adjustLightness(accentColor, -15);\n  }\n  return cssOverrides;\n}\n\nconst ACCENT_COLOR_MAPS = {\n  white: {\n    blue20: [ \"$highlight\" ],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$icon-interactive\", \"$focus\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$button-tertiary-active\" ]\n  },\n  g10: {\n    blue20: [ \"$highlight\" ],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$icon-interactive\", \"$focus\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$button-tertiary-active\" ]\n  },\n  g90: {\n    blue20: [],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$focus-inverse\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$highlight\", \"$button-tertiary-active\" ]\n  },\n  g100: {\n    blue20: [],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$focus-inverse\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$highlight\", \"$button-tertiary-active\" ]\n  }\n};\n\nfunction fillValues(styles, propertyNames, value) {\n  propertyNames.forEach(propertyName => {\n    styles[propertyName] = value;\n  });\n}\n\nfunction mergeCSSVariables(publicVars, whiteLabelVariables, carbonTheme, useAITheme) {\n  carbonTheme = carbonTheme || CarbonTheme.G10;\n  useAITheme = useAITheme || false;\n  publicVars = publicVars || {};\n  const internalOverrides = createInternalCSSOverridesMap(carbonTheme, useAITheme);\n  const result = {\n    ...internalOverrides,\n    ...publicVars\n  };\n  Object.entries(result).forEach(([key, value]) => {\n    if (key.startsWith(\"$\") && !value.match(HEXADECIMAL_REGEX)) {\n      console.warn(`${WA_CONSOLE_PREFIX} You tried to call \"updateCSSVariables\" with an invalid value for \"${key}\": \"${publicVars[key]}\". You must use hexadecimal values for colors.`);\n      delete result[key];\n    }\n  });\n  const remoteVars = remoteStylesToCSSVars(whiteLabelVariables || {}, carbonTheme);\n  Object.entries(remoteVars).forEach(([key, value]) => {\n    if (value !== \"\" && publicVars[key] === undefined) {\n      result[key] = value;\n    }\n  });\n  return result;\n}\n\nfunction createInternalCSSOverridesMap(carbonTheme, useAITheme) {\n  let internalOverridesMap = {};\n  if (!useAITheme) {\n    if ([ CarbonTheme.G10, CarbonTheme.WHITE ].includes(carbonTheme)) {\n      internalOverridesMap = {\n        ...internalOverridesMap,\n        ...INTERNAL_OVERRIDES_LIGHT_THEME_MAP\n      };\n    } else if ([ CarbonTheme.G90, CarbonTheme.G100 ].includes(carbonTheme)) {\n      internalOverridesMap = {\n        ...internalOverridesMap,\n        ...INTERNAL_OVERRIDES_DARK_THEME_MAP\n      };\n    }\n  }\n  return internalOverridesMap;\n}\n\nfunction getThemeClassNames(themeState) {\n  let themeClassnames;\n  switch (themeState?.carbonTheme) {\n   case CarbonTheme.WHITE:\n    themeClassnames = CarbonThemeClassNames.WHITE;\n    break;\n\n   case CarbonTheme.G10:\n    themeClassnames = CarbonThemeClassNames.G10;\n    break;\n\n   case CarbonTheme.G90:\n    themeClassnames = CarbonThemeClassNames.G90;\n    break;\n\n   case CarbonTheme.G100:\n    themeClassnames = CarbonThemeClassNames.G100;\n    break;\n\n   default:\n    themeClassnames = CarbonThemeClassNames.G10;\n    break;\n  }\n  if (themeState?.useAITheme) {\n    themeClassnames += \" WAC--aiTheme\";\n  }\n  return themeClassnames;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function constructViewState(newView, appState) {\n  const {viewState: viewState} = appState.persistedToBrowserStorage.launcherState;\n  let newViewState;\n  if (typeof newView === \"string\") {\n    newViewState = {\n      ...VIEW_STATE_ALL_CLOSED,\n      [newView]: true\n    };\n  } else {\n    newViewState = {\n      ...viewState,\n      ...newView\n    };\n  }\n  return newViewState;\n}\n\nfunction validateViewState(viewState, appState) {\n  const {activeTour: activeTour} = appState.persistedToBrowserStorage.launcherState;\n  if (viewState.tour && !activeTour) {\n    consoleError(\"Error changing the view. The new view was supposed to show a tour however there is no active tour to show.\" + \" Changing the view has been canceled.\");\n    return false;\n  }\n  return true;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const VALID_PUBLIC_VARS_IN_AI_THEME_SET = new Set(Object.values(CSSVariable));\n\nconst UPDATE_CSS_VARS_AI_THEME_WARNING_MESSAGE = `[updateCSSVariables] The AI theme is enabled and only ${Object.values(CSSVariable).join(\", \")} can be updated.`;\n\nclass ChatActionsImpl {\n  constructor(serviceManager) {\n    this.hydrating = false;\n    this.restarting = false;\n    this.alreadyHydrated = false;\n    this.chunkQueue = [];\n    this.serviceManager = serviceManager;\n  }\n  async hydrateChat(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions) {\n    let fireReady = false;\n    try {\n      if (!this.hydrationPromise) {\n        this.hydrating = true;\n        this.hydrationPromise = this.doHydrateChat(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions);\n        fireReady = true;\n      }\n      await this.hydrationPromise;\n    } finally {\n      this.hydrating = false;\n    }\n    if (fireReady) {\n      await this.serviceManager.fire({\n        type: BusEventType.CHAT_READY\n      });\n    }\n  }\n  async doHydrateChat(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions) {\n    debugLog(\"Hydrating Carbon AI chat\", alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions);\n    let history;\n    const {serviceManager: serviceManager} = this;\n    serviceManager.store.dispatch(actions.addIsHydratingCounter(1));\n    if (!this.alreadyHydrated) {\n      history = await this.serviceManager.historyService.loadHistory();\n      if (serviceManager.humanAgentService) {\n        debugLog(\"Initializing the human agent service\");\n        await serviceManager.humanAgentService.initialize();\n      } else {\n        debugLog(\"No service desk integrations present\");\n      }\n    }\n    const {config: config} = serviceManager.store.getState();\n    if (!history) {\n      if (!alternateWelcomeRequest) {\n        const state = serviceManager.store.getState();\n        if (state.homeScreenConfig?.is_on) {\n          serviceManager.store.dispatch(actions.setHomeScreenIsOpen(true));\n        } else if (!config.public.messaging?.skipWelcome) {\n          await serviceManager.actions.send(createWelcomeRequest(), MessageSendSource.WELCOME_REQUEST, {\n            returnBeforeStreaming: true\n          }, true);\n        }\n      }\n    } else {\n      serviceManager.store.dispatch(actions.hydrateMessageHistory(history.messageHistory));\n      await this.createElementsForUserDefinedResponses(history.messageHistory);\n      if (history.latestPanelLocalMessageItem) {\n        this.openResponsePanel(history.latestPanelLocalMessageItem, true);\n      }\n    }\n    if (alternateWelcomeRequest) {\n      serviceManager.store.dispatch(actions.setHomeScreenIsOpen(false));\n      await serviceManager.actions.send(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions, true);\n    }\n    serviceManager.store.dispatch(actions.chatWasHydrated());\n    serviceManager.store.dispatch(actions.addIsHydratingCounter(-1));\n    if (history) {\n      const lastMessageID = arrayLastValue(history.messageHistory.botMessageState.localMessageIDs);\n      const lastMessage = history.messageHistory.allMessageItemsByID[lastMessageID];\n      const lastOriginalMessage = history.messageHistory.allMessagesByID[lastMessage?.fullMessageID];\n      if (!isLiveAgentMessage(lastMessage) && isRequest(lastOriginalMessage)) {\n        serviceManager.messageService.resendMessage(lastOriginalMessage, lastMessage.ui_state.id);\n      }\n    }\n    const allowReconnect = config.public.serviceDesk.allowReconnect ?? true;\n    this.serviceManager?.humanAgentService?.handleHydration(allowReconnect, Boolean(history));\n    this.alreadyHydrated = true;\n  }\n  getPublicWebChatState() {\n    const state = this.serviceManager.store.getState();\n    const {persistedToBrowserStorage: persistedToBrowserStorage} = state;\n    const {chatState: chatState, launcherState: launcherState} = persistedToBrowserStorage;\n    const publicWebChatState = {\n      isConnectedWithHumanAgent: chatState.agentState.isConnected,\n      isWebChatOpen: launcherState.viewState.mainWindow,\n      isConnectingWithHumanAgent: state.agentState.isConnecting,\n      isHomeScreenOpen: chatState.homeScreenState.isHomeScreenOpen,\n      isDebugEnabled: isEnableDebugLog(),\n      hasUserSentMessage: chatState.hasSentNonWelcomeMessage,\n      isTourActive: launcherState.activeTour,\n      viewState: {\n        ...launcherState.viewState\n      },\n      serviceDesk: {\n        isConnected: chatState.agentState.isConnected,\n        isConnecting: state.agentState.isConnecting,\n        isSuspended: chatState.agentState.isSuspended ?? false\n      },\n      locale: this.serviceManager.store.getState().locale,\n      intl: this.serviceManager.intl\n    };\n    return publicWebChatState;\n  }\n  async sendWithCatch(message, source, options = {}, ignoreHydration = false) {\n    try {\n      await this.send(message, source, options, ignoreHydration);\n    } catch (error) {\n      consoleError(\"An error occurred sending the message\", error);\n    }\n  }\n  async send(message, source, options = {}, ignoreHydration = false) {\n    const messageRequest = typeof message === \"string\" ? createMessageRequestForText(message) : message;\n    if (this.serviceManager.store.getState().persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen) {\n      this.serviceManager.store.dispatch(actions.setHomeScreenIsOpen(false));\n    }\n    if (this.serviceManager.store.getState().responsePanelState.isOpen) {\n      this.serviceManager.store.dispatch(actions.setResponsePanelIsOpen(false));\n    }\n    if (this.hydrationPromise || ignoreHydration) {\n      if (!ignoreHydration) {\n        await this.hydrationPromise;\n      }\n      await this.doSend(messageRequest, source, options);\n    } else {\n      await this.hydrateChat(messageRequest, source, options);\n    }\n  }\n  async doSend(message, source, options = {}) {\n    const {store: store} = this.serviceManager;\n    addDefaultsToMessage(message);\n    const originalUserText = message.history?.label || message.input.text;\n    if (options.silent) {\n      message.history.silent = true;\n    }\n    const localMessage = inputItemToLocalItem(message, originalUserText);\n    if (!message.history.silent) {\n      store.dispatch(actions.addLocalMessageItem(localMessage, message, true));\n    } else {\n      store.dispatch(actions.addMessage(message));\n    }\n    if (options.setValueSelectedForMessageID) {\n      store.dispatch(actions.messageSetOptionSelected(options.setValueSelectedForMessageID, message));\n    }\n    deepFreeze(message);\n    await this.serviceManager.messageService.send(cloneDeep(message), source, localMessage.ui_state.id, options);\n  }\n  async receive(message, isLatestWelcomeNode = false, requestMessage, requestOptions) {\n    const {restartCount: initialRestartCount} = this.serviceManager;\n    if (!message.id) {\n      message.id = uuid(UUIDType.MESSAGE);\n    }\n    const preReceiveEvent = {\n      type: BusEventType.PRE_RECEIVE,\n      data: message\n    };\n    await this.serviceManager.fire(preReceiveEvent);\n    if (initialRestartCount !== this.serviceManager.restartCount) {\n      return;\n    }\n    if (!isLatestWelcomeNode) {\n      this.serviceManager.store.dispatch(actions.updateHasSentNonWelcomeMessage(true));\n    }\n    if (initialRestartCount !== this.serviceManager.restartCount) {\n      return;\n    }\n    const {languagePack: languagePack} = this.serviceManager.store.getState();\n    if (isResponse(message)) {\n      this.processMessageResponse(message, isLatestWelcomeNode, requestMessage, requestOptions).catch(error => {\n        consoleError(\"Error processing the message response\", error);\n      });\n    } else {\n      const inlineError = createMessageResponseForText(languagePack.errors_singleMessage, message.thread_id, MessageResponseTypes.INLINE_ERROR);\n      this.receive(inlineError, false);\n    }\n    deepFreeze(message);\n    await this.serviceManager.fire({\n      type: BusEventType.RECEIVE,\n      data: message\n    });\n  }\n  async removeMessages(messageIDs) {\n    this.serviceManager.store.dispatch(actions.removeMessages(messageIDs));\n  }\n  async insertHistory(messages) {\n    const scrollBottom = this.serviceManager.mainWindow?.getMessagesScrollBottom();\n    const state = this.serviceManager.store.getState();\n    const notes = {\n      notes: [ {\n        body: messages\n      } ]\n    };\n    const history = await this.serviceManager.historyService.loadHistory(notes);\n    const currentAppStateMessages = {\n      allMessageItemsByID: state.allMessageItemsByID,\n      allMessagesByID: state.allMessagesByID,\n      botMessageState: state.botMessageState\n    };\n    const newAppStateMessages = merge({}, history.messageHistory, currentAppStateMessages);\n    newAppStateMessages.botMessageState.messageIDs = [ ...history.messageHistory.botMessageState.messageIDs, ...currentAppStateMessages.botMessageState.messageIDs ];\n    newAppStateMessages.botMessageState.localMessageIDs = [ ...history.messageHistory.botMessageState.localMessageIDs, ...currentAppStateMessages.botMessageState.localMessageIDs ];\n    this.serviceManager.store.dispatch(actions.hydrateMessageHistory(newAppStateMessages));\n    await this.createElementsForUserDefinedResponses(history.messageHistory);\n    this.serviceManager.mainWindow?.doAutoScroll({\n      scrollToBottom: scrollBottom\n    });\n  }\n  async receiveChunk(chunk, messageID, options = {}) {\n    const chunkPromise = resolvablePromise();\n    this.chunkQueue.push({\n      chunk: chunk,\n      messageID: messageID,\n      options: options,\n      chunkPromise: chunkPromise\n    });\n    if (this.chunkQueue.length === 1) {\n      this.processChunkQueue();\n    }\n    return chunkPromise;\n  }\n  async processChunkQueue() {\n    const {chunk: chunk, options: options, chunkPromise: chunkPromise} = this.chunkQueue[0];\n    let {messageID: messageID} = this.chunkQueue[0];\n    const isCompleteItem = isStreamCompleteItem(chunk);\n    const isPartialItem = isStreamPartialItem(chunk);\n    const {store: store} = this.serviceManager;\n    const isStopGeneratingVisible = store.getState().botInputState.stopStreamingButtonState.isVisible;\n    if (isPartialItem) {\n      const streamingData = chunk.partial_item.streaming_metadata;\n      if (streamingData.cancellable && !isStopGeneratingVisible) {\n        store.dispatch(actions.setStopStreamingButtonVisible(true));\n      }\n    }\n    if (isCompleteItem || isPartialItem) {\n      if (!messageID) {\n        messageID = chunk.streaming_metadata.response_id;\n      }\n      if (!store.getState().allMessagesByID[messageID]) {\n        store.dispatch(actions.streamingStart(messageID));\n      }\n      const item = chunk.partial_item || chunk.complete_item;\n      store.dispatch(actions.streamingAddChunk(messageID, item, isCompleteItem, options.disableFadeAnimation ?? true));\n      if (chunk.partial_response?.history) {\n        if (Object.keys(chunk.partial_response).length > 1) {\n          throw new Error(`The partial_response object only supports the \"history\" property.`);\n        }\n        store.dispatch(actions.streamingMergeHistory(messageID, chunk.partial_response?.history));\n      }\n      await this.handleUserDefinedResponseItemsChunk(messageID, chunk, item);\n    } else if (isStreamFinalResponse(chunk)) {\n      this.receive(chunk.final_response, options.isLatestWelcomeNode, null, {\n        disableFadeAnimation: true\n      });\n    }\n    if ((isCompleteItem || isStreamFinalResponse(chunk)) && isStopGeneratingVisible) {\n      store.dispatch(actions.setStopStreamingButtonDisabled(false));\n      store.dispatch(actions.setStopStreamingButtonVisible(false));\n    }\n    this.chunkQueue.shift();\n    chunkPromise.doResolve();\n    if (this.chunkQueue[0]) {\n      this.processChunkQueue();\n    }\n  }\n  getOrCreateUserDefinedElement(messageItemID) {\n    let userDefinedItem = this.serviceManager.userDefinedElementRegistry.get(messageItemID);\n    if (!userDefinedItem) {\n      userDefinedItem = {\n        element: document.createElement(\"div\"),\n        slotName: `slot-user-defined-${uuid()}`\n      };\n      userDefinedItem.element.setAttribute(\"slot\", userDefinedItem.slotName);\n      this.serviceManager.userDefinedElementRegistry.set(messageItemID, userDefinedItem);\n    }\n    return userDefinedItem;\n  }\n  async handleUserDefinedResponseItems(localMessage, originalMessage) {\n    if (renderAsUserDefinedMessage(localMessage.item)) {\n      let element;\n      let slotName;\n      if (!localMessage.item.user_defined?.silent) {\n        ({element: element, slotName: slotName} = this.getOrCreateUserDefinedElement(localMessage.ui_state.id));\n      }\n      const userDefinedResponseEvent = {\n        type: BusEventType.USER_DEFINED_RESPONSE,\n        data: {\n          message: localMessage.item,\n          fullMessage: originalMessage,\n          element: element,\n          slot: slotName\n        }\n      };\n      await this.serviceManager.fire(userDefinedResponseEvent);\n    } else if (isResponseWithNestedItems(localMessage.item)) {\n      const {itemsLocalMessageItemIDs: itemsLocalMessageItemIDs, bodyLocalMessageItemIDs: bodyLocalMessageItemIDs, footerLocalMessageItemIDs: footerLocalMessageItemIDs, gridLocalMessageItemIDs: gridLocalMessageItemIDs} = localMessage.ui_state;\n      const {allMessageItemsByID: allMessageItemsByID} = this.serviceManager.store.getState();\n      const createElementForNestedUserDefinedResponse = localMessageItemID => {\n        const nestedLocalMessage = allMessageItemsByID[localMessageItemID];\n        return this.handleUserDefinedResponseItems(nestedLocalMessage, originalMessage);\n      };\n      if (gridLocalMessageItemIDs?.length) {\n        await asyncForEach(gridLocalMessageItemIDs, row => asyncForEach(row, cell => asyncForEach(cell, itemID => createElementForNestedUserDefinedResponse(itemID))));\n      }\n      if (itemsLocalMessageItemIDs?.length) {\n        await asyncForEach(itemsLocalMessageItemIDs, createElementForNestedUserDefinedResponse);\n      }\n      if (bodyLocalMessageItemIDs?.length) {\n        await asyncForEach(bodyLocalMessageItemIDs, createElementForNestedUserDefinedResponse);\n      }\n      if (footerLocalMessageItemIDs?.length) {\n        await asyncForEach(footerLocalMessageItemIDs, createElementForNestedUserDefinedResponse);\n      }\n    }\n  }\n  async handleUserDefinedResponseItemsChunk(messageID, chunk, messageItem) {\n    if (renderAsUserDefinedMessage(messageItem)) {\n      const itemID = streamItemID(messageID, messageItem);\n      let element;\n      let slotName;\n      if (!messageItem.user_defined?.silent) {\n        ({element: element, slotName: slotName} = this.getOrCreateUserDefinedElement(itemID));\n      }\n      const userDefinedResponseEvent = {\n        type: BusEventType.CHUNK_USER_DEFINED_RESPONSE,\n        data: {\n          messageItem: messageItem,\n          chunk: chunk,\n          element: element,\n          slot: slotName\n        }\n      };\n      await this.serviceManager.fire(userDefinedResponseEvent);\n    }\n  }\n  async processMessageResponse(fullMessage, isLatestWelcomeNode, requestMessage, requestOptions = {}) {\n    const {store: store} = this.serviceManager;\n    const {config: config} = store.getState();\n    const initialRestartCount = this.serviceManager.restartCount;\n    const output = fullMessage.output.generic;\n    fullMessage.request_id = requestMessage?.id;\n    addDefaultsToMessage(fullMessage);\n    store.dispatch(actions.addMessage(fullMessage));\n    let previousItemID = null;\n    for (let index = 0; index < output.length && initialRestartCount === this.serviceManager.restartCount; index++) {\n      const messageItem = output[index];\n      if (messageItem) {\n        const pause = isPause(messageItem);\n        const agent = isConnectToAgent(messageItem);\n        const tour = hasTourUserDefinedType(messageItem);\n        const localMessageItem = outputItemToLocalItem(messageItem, fullMessage, isLatestWelcomeNode, requestOptions.disableFadeAnimation);\n        if (tour && (requestOptions.skipTourCard || messageItem.user_defined?.skip_card)) {\n          const startTourReason = requestOptions.skipTourCard ? TourStartReason.START_TOUR_METHOD : TourStartReason.SKIP_CARD;\n          const {viewState: viewState} = store.getState().persistedToBrowserStorage.launcherState;\n          if (viewState.mainWindow) {\n            const mainWindowCloseReason = requestOptions.skipTourCard ? MainWindowCloseReason.CALLED_START_TOUR : MainWindowCloseReason.TOUR_SKIP_CARD;\n            this.startTour(localMessageItem, startTourReason, {\n              mainWindowCloseReason: mainWindowCloseReason\n            }).catch(error => {\n              consoleError(\"Error starting the tour\", error);\n            });\n          } else {\n            const viewChangeReason = requestOptions.skipTourCard ? ViewChangeReason.CALLED_START_TOUR : ViewChangeReason.TOUR_SKIP_CARD;\n            this.startTour(localMessageItem, startTourReason, {\n              viewChangeReason: viewChangeReason\n            }).catch(error => {\n              consoleError(\"Error starting the tour\", error);\n            });\n          }\n        } else if (!tour && requestOptions.skipTourCard) {\n          consoleError(\"The message response received was not a tour, so the tour card was not skipped nor was a tour started by the startTour() call.\");\n        }\n        const nestedLocalMessageItems = [];\n        createLocalMessageItemsForNestedMessageItems(localMessageItem, fullMessage, false, nestedLocalMessageItems, true);\n        store.dispatch(actions.addNestedMessages(nestedLocalMessageItems));\n        if (agent && isResponse(fullMessage)) {\n          store.dispatch(actions.addIsTypingCounter(1));\n          if (!hasServiceDesk(config)) {\n            const message = 'Web chat received a \"connect_to_agent\" message but there is no service desk configured. Check your chat configuration.';\n            this.errorOccurred({\n              errorType: OnErrorType.INTEGRATION_ERROR,\n              message: message\n            });\n            store.dispatch(actions.setMessageHistoryProperty(localMessageItem.fullMessageID, \"agent_no_service_desk\", true));\n          }\n          const agentAvailability = await (this.serviceManager.humanAgentService?.checkAreAnyAgentsOnline(fullMessage));\n          if (initialRestartCount === this.serviceManager.restartCount) {\n            store.dispatch(actions.setMessageHistoryProperty(localMessageItem.fullMessageID, \"agent_availability\", agentAvailability));\n            let shouldAutoRequestAgent = false;\n            if (config.public.serviceDesk?.skipConnectAgentCard) {\n              shouldAutoRequestAgent = true;\n            }\n            store.dispatch(actions.addIsTypingCounter(-1));\n            if (shouldAutoRequestAgent && agentAvailability === AgentsOnlineStatus.ONLINE) {\n              this.serviceManager.humanAgentService.startChat(localMessageItem, fullMessage);\n            }\n          }\n        }\n        if (pause) {\n          const showIsTyping = isTyping(messageItem);\n          if (showIsTyping) {\n            store.dispatch(actions.addIsTypingCounter(1));\n          }\n          await sleep(messageItem.time);\n          if (showIsTyping && initialRestartCount === this.serviceManager.restartCount) {\n            store.dispatch(actions.addIsTypingCounter(-1));\n          }\n        } else {\n          await this.handleUserDefinedResponseItems(localMessageItem, fullMessage);\n          if (!localMessageItem.item.user_defined?.silent && initialRestartCount === this.serviceManager.restartCount) {\n            this.serviceManager.store.dispatch(actions.addLocalMessageItem(localMessageItem, fullMessage, false, previousItemID));\n            previousItemID = localMessageItem.ui_state.id;\n          }\n        }\n      }\n    }\n  }\n  openResponsePanel(localMessageItem, isMessageForInput) {\n    this.serviceManager.store.dispatch(actions.setResponsePanelContent(localMessageItem, isMessageForInput));\n    this.serviceManager.store.dispatch(actions.setResponsePanelIsOpen(true));\n  }\n  async insertLocalMessageResponse(message) {\n    message.id = uuid(UUIDType.MESSAGE);\n    await this.processMessageResponse(message, false, null, {});\n  }\n  updateLanguagePack(changes) {\n    const {languagePack: languagePack, locale: locale} = this.serviceManager.store.getState();\n    const messages = {\n      ...languagePack,\n      ...changes\n    };\n    setIntl(this.serviceManager, locale, messages);\n  }\n  addNotification(notification) {\n    this.serviceManager.store.dispatch(actions.addNotification(notification));\n  }\n  removeNotification(groupID) {\n    this.serviceManager.store.dispatch(actions.removeNotifications({\n      groupID: groupID\n    }));\n  }\n  removeAllNotifications() {\n    this.serviceManager.store.dispatch(actions.removeAllNotifications());\n  }\n  updateCSSVariables(publicVars, whiteLabelVariables = {}) {\n    const {store: store} = this.serviceManager;\n    const {theme: theme} = store.getState();\n    const {carbonTheme: carbonTheme, useAITheme: useAITheme} = theme;\n    if (useAITheme) {\n      const usePublicVars = publicVars;\n      publicVars = {};\n      whiteLabelVariables = {};\n      usePublicVars && Object.entries(usePublicVars).forEach(([variable]) => {\n        if (VALID_PUBLIC_VARS_IN_AI_THEME_SET.has(variable)) {\n          publicVars[variable] = usePublicVars[variable];\n        } else {\n          consoleWarn(UPDATE_CSS_VARS_AI_THEME_WARNING_MESSAGE);\n        }\n      });\n    } else {\n      publicVars = {\n        ...publicVars\n      };\n      whiteLabelVariables = {\n        ...whiteLabelVariables\n      };\n    }\n    const allVariables = mergeCSSVariables(publicVars, whiteLabelVariables, carbonTheme, useAITheme);\n    store.dispatch(actions.updateCSSVariables(allVariables, publicVars, whiteLabelVariables));\n  }\n  updateBotName(name) {\n    this.serviceManager.store.dispatch(actions.updateBotName(name));\n  }\n  updateMainHeaderTitle(title) {\n    this.serviceManager.store.dispatch(actions.updateMainHeaderTitle(title));\n  }\n  updateBotAvatarURL(url) {\n    this.serviceManager.store.dispatch(actions.updateBotAvatarURL(url));\n  }\n  updateHomeScreenConfig(homeScreenConfig) {\n    this.serviceManager.store.dispatch(actions.updateHomeScreenConfig(homeScreenConfig));\n  }\n  updateLauncherConfig(launcherConfig) {\n    this.serviceManager.store.dispatch(actions.updateLauncherConfig(launcherConfig));\n  }\n  async changeView(newView, reason, tryHydrating = true, forceViewChange = false) {\n    const {store: store} = this.serviceManager;\n    const {viewState: viewState} = store.getState().persistedToBrowserStorage.launcherState;\n    let newViewState = constructViewState(newView, store.getState());\n    if (!validateViewState(newViewState, store.getState())) {\n      return viewState;\n    }\n    if (!isEqual(newViewState, viewState) || forceViewChange) {\n      await this.fireViewChangeEventsAndChangeView(newViewState, reason);\n      newViewState = store.getState().persistedToBrowserStorage.launcherState.viewState;\n      if (tryHydrating && (newViewState.mainWindow || newViewState.tour) && !store.getState().isHydrated) {\n        this.hydrateChat().catch(error => {\n          consoleError(\"Error hydrating the chat\", error);\n        });\n      }\n    }\n    return newViewState;\n  }\n  async fireViewChangeEventsAndChangeView(newViewState, reason) {\n    const {store: store} = this.serviceManager;\n    if (store.getState().viewChanging) {\n      throw new Error(\"The view may not be changed while a view change event is already running. Please make sure to resolve any promises from these events.\");\n    }\n    store.dispatch(actions.setViewChanging(true));\n    const {viewState: viewState} = store.getState().persistedToBrowserStorage.launcherState;\n    const {viewChangeReason: viewChangeReason} = reason;\n    const oldViewState = deepFreeze(viewState);\n    try {\n      const preViewChangeEvent = {\n        type: BusEventType.VIEW_PRE_CHANGE,\n        reason: viewChangeReason,\n        oldViewState: oldViewState,\n        newViewState: newViewState,\n        cancelViewChange: false\n      };\n      await this.serviceManager.fire(preViewChangeEvent);\n      if (preViewChangeEvent.cancelViewChange) {\n        debugLog(\"The view changing was cancelled by a view:pre:change event.\");\n        return;\n      }\n      if (!validateViewState(preViewChangeEvent.newViewState, store.getState())) {\n        return;\n      }\n      newViewState = preViewChangeEvent.newViewState;\n      store.dispatch(actions.setViewState(deepFreeze(newViewState)));\n      const viewChangeEvent = {\n        type: BusEventType.VIEW_CHANGE,\n        reason: viewChangeReason,\n        oldViewState: oldViewState,\n        newViewState: newViewState,\n        cancelViewChange: false\n      };\n      await this.serviceManager.fire(viewChangeEvent);\n      if (viewChangeEvent.cancelViewChange) {\n        store.dispatch(actions.setViewState(oldViewState));\n        debugLog(\"The view changing was cancelled by a view:change event.\");\n        return;\n      }\n      if (!validateViewState(viewChangeEvent.newViewState, store.getState())) {\n        store.dispatch(actions.setViewState(oldViewState));\n        return;\n      }\n      newViewState = viewChangeEvent.newViewState;\n      store.dispatch(actions.setViewState(deepFreeze(newViewState)));\n    } finally {\n      store.dispatch(actions.setViewChanging(false));\n    }\n  }\n  async startTour(message, startTourReason, changeViewReason) {\n    this.serviceManager.store.dispatch(actions.setTourData(message.fullMessageID));\n    const newViewState = await this.changeView(ViewType.TOUR, changeViewReason);\n    if (newViewState.tour) {\n      await this.serviceManager.fire({\n        type: BusEventType.TOUR_START,\n        reason: startTourReason\n      });\n      await this.serviceManager.fire({\n        type: BusEventType.TOUR_STEP,\n        step: this.serviceManager.store.getState().tourState.activeTourStepItems[0]\n      });\n    }\n  }\n  async endTour(reason) {\n    const {viewState: viewState} = this.serviceManager.store.getState().persistedToBrowserStorage.launcherState;\n    let newViewState = viewState;\n    if (viewState.tour) {\n      newViewState = await this.changeView(ViewType.LAUNCHER, reason);\n    }\n    if (!newViewState.tour) {\n      this.serviceManager.store.dispatch(actions.clearTourData());\n      return true;\n    }\n    return false;\n  }\n  goToSpecificTourStep(stepId) {\n    const {activeTourStepItems: activeTourStepItems} = this.serviceManager.store.getState().tourState;\n    const newStepIndex = activeTourStepItems.findIndex(stepItem => stepItem.step_id === stepId);\n    if (newStepIndex) {\n      this.changeStepInTour({\n        newStepIndex: newStepIndex\n      });\n    } else {\n      consoleError(`No step with the id \"${stepId}\" was found within the current tour. As a result, goToTourStep() did not change the current tour step.`);\n    }\n  }\n  async changeStepInTour(changeStepOptions) {\n    const {store: store} = this.serviceManager;\n    const {activeTourStepItems: activeTourStepItems} = store.getState().tourState;\n    const {activeTourCurrentStepIndex: activeTourCurrentStepIndex} = store.getState().persistedToBrowserStorage.chatState.persistedTourState;\n    let {newStepIndex: newStepIndex} = changeStepOptions;\n    if (changeStepOptions.nextStep) {\n      newStepIndex = activeTourCurrentStepIndex + 1;\n    } else if (changeStepOptions.previousStep) {\n      newStepIndex = activeTourCurrentStepIndex - 1;\n    }\n    store.dispatch(actions.changeStepInTour(newStepIndex));\n    const actualNewStepIndex = store.getState().persistedToBrowserStorage.chatState.persistedTourState.activeTourCurrentStepIndex;\n    if (actualNewStepIndex === newStepIndex) {\n      await this.serviceManager.fire({\n        type: BusEventType.TOUR_STEP,\n        step: activeTourStepItems[actualNewStepIndex]\n      });\n    } else {\n      consoleWarn(\"The tour tried to change to a step that was out of bounds for the step array, so no step change was made.\");\n    }\n  }\n  errorOccurred(error) {\n    consoleError(\"An error has occurred\", error);\n    if (error.catastrophicErrorType) {\n      this.serviceManager.store.dispatch(actions.setAppStateValue(\"catastrophicErrorType\", error.catastrophicErrorType));\n    }\n    callOnError(this.serviceManager.additionalChatParameters.onError, error);\n  }\n  async restartConversation(options = {}) {\n    const {skipHydration: skipHydration = false, endAgentConversation: endAgentConversation = true, fireEvents: fireEvents = true} = options;\n    debugLog(\"Restarting conversation\");\n    if (this.restarting) {\n      consoleWarn(\"You cannot restart a conversation while a previous restart is still pending.\");\n      return;\n    }\n    this.restarting = true;\n    try {\n      const {serviceManager: serviceManager} = this;\n      const {store: store} = serviceManager;\n      if (fireEvents) {\n        await serviceManager.fire({\n          type: BusEventType.PRE_RESTART_CONVERSATION\n        });\n      }\n      serviceManager.restartCount++;\n      if (this.hydrating) {\n        await this.hydrationPromise;\n      }\n      const currentState = store.getState();\n      const {persistedToBrowserStorage: persistedToBrowserStorage} = currentState;\n      const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n      const {isConnecting: isConnecting} = currentState.agentState;\n      const {isConnected: isConnected} = currentState.persistedToBrowserStorage.chatState.agentState;\n      if ((isConnected || isConnecting) && endAgentConversation) {\n        await serviceManager.humanAgentService.endChat(true, false, false);\n      }\n      if (viewState.tour) {\n        await this.serviceManager.actions.changeView(ViewType.MAIN_WINDOW, {\n          mainWindowOpenReason: MainWindowOpenReason.CALLED_RESTART_CONVERSATION\n        }, false);\n      }\n      this.serviceManager.instance.updateAssistantInputFieldVisibility(true);\n      this.serviceManager.messageService.cancelAllMessageRequests();\n      store.dispatch(actions.restartConversation());\n      if (!skipHydration) {\n        this.hydrationPromise = null;\n      }\n      if (fireEvents) {\n        await serviceManager.fire({\n          type: BusEventType.RESTART_CONVERSATION\n        });\n      }\n      if (this.hydrating) {\n        await this.hydrationPromise;\n      }\n      if (!skipHydration && !serviceManager.store.getState().isHydrated) {\n        this.hydrationPromise = null;\n        if (store.getState().persistedToBrowserStorage.launcherState.viewState.mainWindow) {\n          await serviceManager.actions.hydrateChat();\n        }\n      } else {\n        store.dispatch(actions.chatWasHydrated());\n      }\n    } finally {\n      this.restarting = false;\n    }\n  }\n  async destroySession(keepOpenState) {\n    const {store: store} = this.serviceManager;\n    const {persistedToBrowserStorage: persistedToBrowserStorage} = store.getState();\n    const originalViewState = persistedToBrowserStorage.launcherState.viewState;\n    const newPersistedToBrowserStorage = cloneDeep(DEFAULT_PERSISTED_TO_BROWSER);\n    if (keepOpenState) {\n      newPersistedToBrowserStorage.launcherState.viewState = originalViewState;\n      if (originalViewState.tour) {\n        newPersistedToBrowserStorage.launcherState.viewState = {\n          ...originalViewState,\n          tour: false,\n          mainWindow: true\n        };\n      }\n    } else {\n      newPersistedToBrowserStorage.launcherState.viewState = VIEW_STATE_LAUNCHER_OPEN;\n    }\n    this.serviceManager.messageService.cancelAllMessageRequests();\n    this.serviceManager.userSessionStorageService.clearLauncherSession();\n    this.serviceManager.userSessionStorageService.clearChatSession();\n    this.serviceManager.store.dispatch(actions.setAppStateValue(\"persistedToBrowserStorage\", newPersistedToBrowserStorage));\n  }\n  agentEndConversation(endedByUser) {\n    return this.serviceManager.humanAgentService.endChat(endedByUser);\n  }\n  agentUpdateIsSuspended(isSuspended) {\n    this.serviceManager.store.dispatch(agentUpdateIsSuspended(isSuspended));\n  }\n  async createElementsForUserDefinedResponses(messages) {\n    await asyncForEach(Object.values(messages.allMessageItemsByID), localMessage => {\n      const originalMessage = messages.allMessagesByID[localMessage.fullMessageID];\n      return this.handleUserDefinedResponseItems(localMessage, originalMessage);\n    });\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const HANDLER_NOT_FUNCTION = \"The event handler is not a function.\";\n\nclass EventBus {\n  constructor() {\n    this.handlersByType = new Map;\n    this.eventsTypesRunning = new Set;\n    this.eventsRunningCount = 0;\n  }\n  async fire(busEvent, instance) {\n    logEvent(\"Before fire\", busEvent);\n    const {type: type} = busEvent;\n    if (!type) {\n      throw new Error(`Attempted to fire an event with no type! ${JSON.stringify(busEvent)}`);\n    }\n    function wrappedHandler(handler) {\n      const result = handler(busEvent, instance);\n      if (result && !(result instanceof Promise)) {\n        consoleWarn(`An event handler for event ${type} returned a non-promise. This might be a mistake.`, result);\n      }\n      return result;\n    }\n    if (this.eventsTypesRunning.has(type)) {\n      throw new Error(`An event of type ${type} is already running. Please make sure that you have resolved the Promises for any earlier events that were fired.`);\n    }\n    try {\n      this.eventsRunningCount++;\n      try {\n        this.eventsTypesRunning.add(type);\n        const handlersForType = this.handlersByType.get(type);\n        if (handlersForType && handlersForType.length) {\n          const handlersCopy = handlersForType.slice();\n          await asyncForEach(handlersCopy, wrappedHandler);\n        }\n      } finally {\n        this.eventsTypesRunning.delete(type);\n      }\n    } finally {\n      this.eventsRunningCount--;\n      if (this.waitForEmptyPromise && this.eventsRunningCount === 0) {\n        this.waitForEmptyPromise.doResolve();\n      }\n    }\n    logEvent(\"After fire\", busEvent);\n  }\n  fireSync(busEvent, instance) {\n    logEvent(\"Before fire\", busEvent);\n    const {type: type} = busEvent;\n    const handlersForType = this.handlersByType.get(type);\n    if (handlersForType && handlersForType.length) {\n      const handlersCopy = handlersForType.slice();\n      handlersCopy.forEach(handler => handler(busEvent, instance));\n    }\n    logEvent(\"After fire\", busEvent);\n  }\n  async waitForEmpty() {\n    if (this.eventsRunningCount === 0) {\n      return;\n    }\n    if (!this.waitForEmptyPromise) {\n      this.waitForEmptyPromise = resolvablePromise();\n    }\n    await this.waitForEmptyPromise;\n    this.waitForEmptyPromise = null;\n  }\n  on(handlers) {\n    const data = asArray(handlers);\n    data.forEach(({type: type, handler: handler}) => {\n      if (!type) {\n        throw new Error(`Attempted to listen to an event with no type: \"${type}\"!`);\n      }\n      if (typeof handler === \"function\") {\n        if (!this.handlersByType.has(type)) {\n          this.handlersByType.set(type, []);\n        }\n        const handlersForType = this.handlersByType.get(type);\n        debugStackTrace(`[EventBus] Adding ${type} event handler`, handler);\n        handlersForType.push(handler);\n      } else {\n        consoleError(HANDLER_NOT_FUNCTION, handler);\n      }\n    });\n    return this;\n  }\n  off(handlers) {\n    const data = asArray(handlers);\n    data.forEach(({type: type, handler: handler}) => {\n      const handlersForType = this.handlersByType.get(type);\n      if (handlersForType) {\n        if (handler) {\n          const index = handlersForType.indexOf(handler);\n          if (index !== -1) {\n            const removed = handlersForType.splice(index, 1);\n            debugStackTrace(`[EventBus] Removing ${type} event handlers`, removed);\n          }\n        } else {\n          debugStackTrace(`[EventBus] Removing all ${type} event handlers`);\n          this.handlersByType.set(type, []);\n        }\n      }\n    });\n    return this;\n  }\n  once(handlers) {\n    const data = asArray(handlers);\n    data.forEach(({type: type, handler: handler}) => {\n      if (typeof handler === \"function\") {\n        const onceHandler = (event, instance) => {\n          this.off({\n            type: type,\n            handler: onceHandler\n          });\n          return handler(event, instance);\n        };\n        this.on({\n          type: type,\n          handler: onceHandler\n        });\n      } else {\n        consoleError(HANDLER_NOT_FUNCTION, handler);\n      }\n    });\n    return this;\n  }\n  logListeners() {\n    this.handlersByType.forEach((listeners, type) => {\n      console.group(`Event ${type} (${listeners.length})`);\n      listeners.forEach(listener => {\n        consoleLog(\"Listener\", listener);\n      });\n      console.groupEnd();\n    });\n  }\n  clear() {\n    this.handlersByType.clear();\n    return this;\n  }\n}\n\nfunction logEvent(message, busEvent) {\n  if (isEnableDebugLog()) {\n    const eventCopy = cloneDeep(busEvent);\n    debugLog(`[EventBus] ${message}`, eventCopy);\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function createCustomPanelInstance(serviceManager) {\n  const customPanelInstance = {\n    open(options = DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS) {\n      const {store: store} = serviceManager;\n      store.dispatch(actions.setCustomPanelConfigOptions(options));\n      store.dispatch(actions.setCustomPanelOpen(true));\n    },\n    close() {\n      serviceManager.store.dispatch(actions.setCustomPanelOpen(false));\n    }\n  };\n  return Object.freeze(customPanelInstance);\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function createCustomPanelManager(serviceManger) {\n  const panels = {\n    [DEFAULT_CUSTOM_PANEL_ID]: createCustomPanelInstance(serviceManger)\n  };\n  return Object.freeze({\n    getPanel() {\n      return panels[DEFAULT_CUSTOM_PANEL_ID];\n    }\n  });\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ async function notesToLoadedHistory(notes, serviceManager) {\n  const allLocalMessagesByID = {};\n  const allMessagesByID = {};\n  const loadingState = {\n    serviceManager: serviceManager,\n    allMessages: [],\n    allMessagesByID: allMessagesByID,\n    allLocalMessagesByID: allLocalMessagesByID,\n    threadMessagesByThreadID: {},\n    responsesByRequestID: {},\n    relatedMessageByID: {},\n    localMessagesByOriginalMessageID: {},\n    lastThreadID: null,\n    loadedHistory: {\n      messageHistory: {\n        allMessageItemsByID: allLocalMessagesByID,\n        allMessagesByID: allMessagesByID,\n        botMessageState: null\n      },\n      latestTransferToAgentResponse: null,\n      latestPanelLocalMessageItem: null\n    }\n  };\n  await notesToMessages(notes, loadingState);\n  if (!loadingState.allMessages.length) {\n    return null;\n  }\n  createLocalMessages(loadingState);\n  createChatStates(loadingState);\n  markIsLatestWelcomeNode(loadingState);\n  markSelectedOptions(loadingState);\n  return loadingState.loadedHistory;\n}\n\nasync function notesToMessages(notes, loadingState) {\n  const {allMessages: allMessages, allMessagesByID: allMessagesByID, responsesByRequestID: responsesByRequestID, relatedMessageByID: relatedMessageByID, serviceManager: serviceManager, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  if (!notes?.length) {\n    return;\n  }\n  notes.forEach(note => {\n    const sessionHistory = note.body;\n    const pushAndPrepareMessage = historyItem => {\n      const {message: message} = historyItem;\n      if (!isEventRequest(message) && (isRequest(message) || isResponse(message))) {\n        addMessage(message, loadingState, historyItem);\n      }\n    };\n    sessionHistory.forEach(pushAndPrepareMessage);\n  });\n  for (let index = allMessages.length - 1; index >= 0; index--) {\n    const message = allMessages[index];\n    if (message.history?.file_upload_status === FileStatusValue.UPLOADING) {\n      message.history.file_upload_status = FileStatusValue.COMPLETE;\n      message.history.error_state = MessageErrorState.FAILED;\n    }\n    if (isResponse(message) && message.history.silent) {\n      allMessages.splice(index, 1);\n      delete allMessagesByID[message.id];\n    } else {\n      localMessagesByOriginalMessageID[message.id] = [];\n      if (isResponse(message) && message.request_id) {\n        responsesByRequestID[message.request_id] = message;\n      }\n      if (message.history.related_message_id) {\n        relatedMessageByID[message.history.related_message_id] = message;\n      }\n    }\n  }\n  if (!allMessages.length) {\n    return;\n  }\n  Object.freeze(allMessages);\n  const beginEvent = {\n    type: BusEventType.HISTORY_BEGIN,\n    messages: allMessages\n  };\n  await serviceManager.eventBus.fire(beginEvent, serviceManager.instance);\n  allMessages.forEach(deepFreeze);\n  await serviceManager.eventBus.fire({\n    type: BusEventType.HISTORY_END,\n    messages: allMessages\n  }, serviceManager.instance);\n}\n\nfunction addMessage(message, loadingState, historyItem) {\n  message.history = message.history || {};\n  message.history.from_history = true;\n  message.history.timestamp = new Date(historyItem.time).getTime();\n  if (message.thread_id !== THREAD_ID_MAIN) {\n    loadingState.lastThreadID = message.thread_id;\n  }\n  loadingState.allMessagesByID[message.id] = message;\n  loadingState.allMessages.push(message);\n}\n\nfunction createLocalMessages(loadingState) {\n  const {allMessages: allMessages, allLocalMessagesByID: allLocalMessagesByID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  allMessages.forEach(message => {\n    if (isRequest(message)) {\n      if (!message.history?.silent) {\n        const text = message.history?.label || message.input.text;\n        const localMessage = inputItemToLocalItem(message, text);\n        localMessagesByOriginalMessageID[message.id].push(localMessage);\n        allLocalMessagesByID[localMessage.ui_state.id] = localMessage;\n      }\n    } else {\n      const items = getResponseItems(message);\n      if (items?.length) {\n        items.forEach(messageItem => {\n          if (!isPause(messageItem)) {\n            const localMessage = outputItemToLocalItem(messageItem, message, false);\n            localMessagesByOriginalMessageID[message.id].push(localMessage);\n            allLocalMessagesByID[localMessage.ui_state.id] = localMessage;\n            if (isResponseWithNestedItems(localMessage.item)) {\n              const nestedLocalMessageItems = [];\n              createLocalMessageItemsForNestedMessageItems(localMessage, message, true, nestedLocalMessageItems, true);\n              nestedLocalMessageItems.forEach(localMessageItem => {\n                const localMessageID = localMessageItem.ui_state.id;\n                loadingState.loadedHistory.messageHistory.allMessageItemsByID[localMessageID] = localMessageItem;\n              });\n            }\n          }\n        });\n      }\n    }\n    addMessageToThread(message, loadingState);\n  });\n}\n\nfunction getResponseItems(message) {\n  if (isResponse(message)) {\n    return message.output.generic;\n  }\n  return null;\n}\n\nfunction addMessageToThread(message, loadingState) {\n  const {threadMessagesByThreadID: threadMessagesByThreadID} = loadingState;\n  let thread = threadMessagesByThreadID[THREAD_ID_MAIN];\n  if (!thread) {\n    thread = [];\n    threadMessagesByThreadID[THREAD_ID_MAIN] = thread;\n  }\n  thread.push(message);\n}\n\nfunction createChatStates(loadingState) {\n  const {loadedHistory: loadedHistory, threadMessagesByThreadID: threadMessagesByThreadID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  loadedHistory.messageHistory.botMessageState = toChatMessageState(threadMessagesByThreadID[THREAD_ID_MAIN], localMessagesByOriginalMessageID);\n}\n\nfunction toChatMessageState(messages, localMessagesByFullMessageID) {\n  const localMessageIDs = [];\n  const messageIDs = [];\n  if (messages) {\n    messages.forEach(message => {\n      messageIDs.push(message.id);\n      localMessagesByFullMessageID[message.id].forEach(localMessage => {\n        localMessageIDs.push(localMessage.ui_state.id);\n      });\n    });\n  }\n  return {\n    ...DEFAULT_CHAT_MESSAGES_STATE,\n    localMessageIDs: localMessageIDs,\n    messageIDs: messageIDs\n  };\n}\n\nfunction markIsLatestWelcomeNode(loadingState) {\n  const {responsesByRequestID: responsesByRequestID, threadMessagesByThreadID: threadMessagesByThreadID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  const mainThreadMessages = threadMessagesByThreadID[THREAD_ID_MAIN];\n  const welcomeRequest = findLast(mainThreadMessages, message => isRequest(message) && message.history.is_welcome_request);\n  if (welcomeRequest) {\n    const welcomeResponse = responsesByRequestID[welcomeRequest.id];\n    if (welcomeResponse) {\n      localMessagesByOriginalMessageID[welcomeResponse.id].forEach(localMessage => {\n        localMessage.ui_state.isWelcomeResponse = true;\n      });\n    }\n  }\n}\n\nfunction markSelectedOptions({allMessages: allMessages, relatedMessageByID: relatedMessageByID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID}) {\n  allMessages.forEach(message => {\n    if (isResponse(message)) {\n      localMessagesByOriginalMessageID[message.id].forEach(localMessage => {\n        if (isOptionItem(localMessage.item)) {\n          const relatedRequest = relatedMessageByID[message.id];\n          if (isRequest(relatedRequest)) {\n            localMessage.ui_state.optionSelected = relatedRequest;\n          }\n        } else if (isDateResponseType(localMessage)) {\n          const relatedRequest = relatedMessageByID[message.id];\n          if (isRequest(relatedRequest)) {\n            localMessage.ui_state.originalUserText = relatedRequest.history.label;\n          }\n        }\n      });\n    }\n  });\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ class HistoryService {\n  constructor(serviceManager) {\n    this.serviceManager = serviceManager;\n  }\n  async loadHistory(useHistory) {\n    const state = this.serviceManager.store.getState();\n    const {config: config, persistedToBrowserStorage: persistedToBrowserStorage} = state;\n    const publicConfig = config.public;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    try {\n      let resultData;\n      if (useHistory) {\n        resultData = useHistory;\n      } else if (publicConfig.messaging?.customLoadHistory) {\n        const items = await publicConfig.messaging.customLoadHistory(this.serviceManager.instance);\n        const note = {\n          body: items\n        };\n        resultData = {\n          notes: [ note ]\n        };\n      }\n      if (resultData) {\n        const historyNotes = resultData?.notes;\n        return notesToLoadedHistory(historyNotes, this.serviceManager);\n      }\n      if (viewState.tour) {\n        await this.serviceManager.actions.changeView(ViewType.MAIN_WINDOW, {\n          mainWindowOpenReason: MainWindowOpenReason.SESSION_HISTORY\n        }, false);\n        this.serviceManager.store.dispatch(actions.clearTourData());\n      }\n    } catch (error) {\n      consoleError(\"An error occurred while attempting to load the conversation history\", error);\n    }\n    return null;\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ class MessageLoadingManager {\n  start(onExceededMaxSilentLoading, onEnd, onTimeout, msMaxSilentLoading, msMaxAttempt) {\n    this.hasExceededMaxSilentLoading = false;\n    this.onEnd = onEnd;\n    this.onSilentLoading = setTimeout(() => {\n      this.hasExceededMaxSilentLoading = true;\n      onExceededMaxSilentLoading();\n    }, msMaxSilentLoading);\n    this.onMaxAttempt = setTimeout(() => {\n      onTimeout();\n    }, msMaxAttempt);\n  }\n  end() {\n    if (this.onMaxAttempt) {\n      clearTimeout(this.onMaxAttempt);\n    }\n    if (this.onSilentLoading) {\n      clearTimeout(this.onSilentLoading);\n    }\n    if (this.onEnd) {\n      this.onEnd(this.hasExceededMaxSilentLoading);\n    }\n    this.hasExceededMaxSilentLoading = null;\n    this.onEnd = null;\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const MS_BETWEEN_RETRIES = [ 1e3, 3e3, 5e3 ];\n\nconst MS_MAX_ATTEMPT = 150 * 1e3;\n\nconst MS_MAX_SILENT_ERROR = 6e3;\n\nconst MS_MAX_SILENT_LOADING = 4e3;\n\nvar RetryType;\n\n(function(RetryType) {\n  RetryType[RetryType[\"SILENT\"] = 1] = \"SILENT\";\n  RetryType[RetryType[\"VISIBLE\"] = 2] = \"VISIBLE\";\n})(RetryType || (RetryType = {}));\n\nclass MessageService {\n  constructor(serviceManager, publicConfig) {\n    this.pendingLocale = false;\n    this.localeIsExplicit = false;\n    this.serviceManager = serviceManager;\n    this.messageLoadingManager = new MessageLoadingManager;\n    this.queue = {\n      waiting: [],\n      current: null\n    };\n    const timeoutOverride = publicConfig.messaging?.messageTimeoutSecs;\n    this.timeoutMS = timeoutOverride ? timeoutOverride * 1e3 : MS_MAX_ATTEMPT;\n  }\n  async processSuccess(current, received) {\n    const {requestOptions: requestOptions, isProcessed: isProcessed} = current;\n    const isWelcomeNode = Boolean(current.message.history.is_welcome_request);\n    if (isProcessed) {\n      return;\n    }\n    this.setMessageErrorState(current, MessageErrorState.NONE);\n    const {message: message} = current;\n    if (received) {\n      if (message.input.message_type !== MessageInputType.EVENT) {\n        if (!isWelcomeNode) {\n          this.messageLoadingManager.end();\n        }\n        received.history = received.history || {};\n        received.history.timestamp = received.history.timestamp || Date.now();\n        current.trackData.lastRequestTime = Date.now() - current.timeLastRequest;\n        current.trackData.totalRequestTime = Date.now() - current.timeFirstRequest;\n        await this.serviceManager.actions.receive(received, isWelcomeNode, message, requestOptions);\n      }\n      this.messageLoadingManager.end();\n    }\n    if (current.isProcessed) {\n      return;\n    }\n    {\n      current.sendMessagePromise.doResolve();\n      current.isProcessed = true;\n    }\n    this.moveToNextQueueItem();\n  }\n  addErrorMessage() {\n    const {store: store} = this.serviceManager;\n    const errorMessage = store.getState().languagePack.errors_singleMessage;\n    const {originalMessage: originalMessage, localMessage: localMessage} = createLocalMessageForInlineError(errorMessage);\n    store.dispatch(actions.addLocalMessageItem(localMessage, originalMessage, true));\n  }\n  async resendMessage(message, localMessageID) {\n    await this.send(cloneDeep(message), MessageSendSource.HYDRATE_RESEND, localMessageID, {\n      skipQueue: true,\n      silent: true\n    });\n  }\n  sendToAssistantAndUpdateErrorState(current) {\n    if (current.isProcessed) {\n      return;\n    }\n    this.sendToAssistant(current);\n    const now = Date.now();\n    const msSinceStarted = now - current.timeFirstRequest;\n    const isSilentErrorWindow = MS_MAX_SILENT_ERROR > msSinceStarted;\n    const type = isSilentErrorWindow ? RetryType.SILENT : RetryType.VISIBLE;\n    if (type === RetryType.VISIBLE) {\n      this.setMessageErrorState(current, MessageErrorState.RETRYING);\n      this.queue.waiting.forEach(waitingMessage => {\n        this.setMessageErrorState(waitingMessage, MessageErrorState.WAITING);\n      });\n    }\n  }\n  async processError(pendingRequest, resultText, allowRetry) {\n    const {message: message, timeFirstRequest: timeFirstRequest, timeLastRequest: timeLastRequest, tryCount: tryCount, isProcessed: isProcessed, trackData: trackData, requestOptions: requestOptions} = pendingRequest;\n    const isWelcome = message.history.is_welcome_request;\n    const now = Date.now();\n    const msSinceStarted = now - timeFirstRequest;\n    const isInAttemptWindow = this.timeoutMS > msSinceStarted && tryCount < MS_BETWEEN_RETRIES.length;\n    if (isProcessed) {\n      return;\n    }\n    trackData.lastRequestTime = Date.now() - timeLastRequest;\n    trackData.totalRequestTime = Date.now() - timeFirstRequest;\n    if (isInAttemptWindow && allowRetry) {\n      trackData.numErrors++;\n      const retryDelay = MS_BETWEEN_RETRIES[pendingRequest.tryCount++];\n      setTimeout(() => {\n        this.sendToAssistantAndUpdateErrorState(pendingRequest);\n      }, retryDelay);\n    } else {\n      let catastrophicErrorType = false;\n      if (isWelcome) {\n        catastrophicErrorType = true;\n      } else if (requestOptions.silent) {\n        this.addErrorMessage();\n      }\n      this.serviceManager.actions.errorOccurred({\n        errorType: OnErrorType.MESSAGE_COMMUNICATION,\n        message: \"An error occurred sending a message\",\n        otherData: resultText,\n        catastrophicErrorType: catastrophicErrorType\n      });\n      this.rejectFinalErrorOnMessage(pendingRequest, resultText);\n    }\n  }\n  rejectFinalErrorOnMessage(pendingRequest, resultText = \"An undefined error occurred trying to send your message.\") {\n    const {sendMessagePromise: sendMessagePromise} = pendingRequest;\n    this.setMessageErrorState(pendingRequest, MessageErrorState.FAILED);\n    const {message: message} = pendingRequest;\n    if (pendingRequest === this.queue.current && message.input.message_type !== MessageInputType.EVENT && !message.history.is_welcome_request) {\n      this.messageLoadingManager.end();\n    }\n    sendMessagePromise.doReject(new Error(resultText));\n    pendingRequest.isProcessed = true;\n    if (pendingRequest === this.queue.current) {\n      this.moveToNextQueueItem();\n    }\n  }\n  async sendToAssistant(current) {\n    const {store: store} = this.serviceManager;\n    const state = store.getState();\n    const {customSendMessage: customSendMessage} = state.config.public.messaging;\n    current.timeLastRequest = Date.now();\n    if (current.isProcessed) {\n      return;\n    }\n    try {\n      const message = cloneDeep(current.message);\n      current.message = message;\n      store.dispatch(actions.updateMessage(message));\n      const controller = new AbortController;\n      current.sendMessageController = controller;\n      debugLog(\"Called customSendMessage\", message);\n      await customSendMessage(message, {\n        signal: controller.signal\n      }, this.serviceManager.instance);\n      await this.processSuccess(current, null);\n    } catch (error) {\n      consoleError(\"An error occurred while sending a message\", error);\n      const resultText = error && (typeof error === \"string\" ? error : JSON.stringify(error)) || \"There was an unidentified error.\";\n      this.processError(current, resultText, !customSendMessage);\n    }\n  }\n  async runQueueIfReady() {\n    if (!this.queue.current && this.queue.waiting.length > 0) {\n      const {eventBus: eventBus, store: store} = this.serviceManager;\n      this.clearCurrentQueueItem();\n      this.queue.current = this.queue.waiting.shift();\n      const {current: current} = this.queue;\n      const {message: message, source: source} = current;\n      const state = store.getState();\n      const {config: config} = store.getState();\n      const {public: publicConfig} = config;\n      current.timeFirstRequest = Date.now();\n      if (message.input.message_type !== MessageInputType.EVENT) {\n        const lastResponse = getLastBotResponseWithContext(state);\n        if (lastResponse) {\n          message.thread_id = THREAD_ID_MAIN;\n        }\n        if (!message.history.is_welcome_request) {\n          const LOADING_INDICATOR_TIMER = !publicConfig.messaging?.messageLoadingIndicatorTimeoutSecs && publicConfig.messaging?.messageLoadingIndicatorTimeoutSecs !== 0 ? MS_MAX_SILENT_LOADING : publicConfig.messaging.messageLoadingIndicatorTimeoutSecs * 1e3;\n          this.messageLoadingManager.start(() => {\n            this.serviceManager.store.dispatch(actions.addIsLoadingCounter(1));\n          }, didExceedMaxLoading => {\n            if (didExceedMaxLoading) {\n              this.serviceManager.store.dispatch(actions.addIsLoadingCounter(-1));\n            }\n          }, () => {\n            this.cancelMessageRequestByID(message.id, true);\n          }, LOADING_INDICATOR_TIMER, this.timeoutMS);\n        }\n        if (current.isProcessed) {\n          return;\n        }\n        const originalUserText = message.history?.label || message.input.text;\n        await eventBus.fire({\n          type: BusEventType.PRE_SEND,\n          data: message,\n          source: source\n        }, this.serviceManager.instance);\n        if (current.isProcessed) {\n          return;\n        }\n        const localMessage = inputItemToLocalItem(message, originalUserText, current.localMessageID);\n        if (!message.history.silent) {\n          store.dispatch(actions.updateLocalMessageItem(localMessage));\n          store.dispatch(actions.updateMessage(message));\n        }\n        deepFreeze(message);\n        await eventBus.fire({\n          type: BusEventType.SEND,\n          data: message,\n          source: source\n        }, this.serviceManager.instance);\n      }\n      this.sendToAssistant(current);\n    }\n  }\n  addToMessageQueue(message, source, localMessageID, sendMessagePromise, requestOptions = {}) {\n    const newPendingMessage = {\n      localMessageID: localMessageID,\n      message: message,\n      sendMessagePromise: sendMessagePromise,\n      requestOptions: requestOptions || {},\n      timeFirstRequest: 0,\n      timeLastRequest: 0,\n      trackData: {\n        numErrors: 0,\n        lastRequestTime: 0,\n        totalRequestTime: 0\n      },\n      tryCount: 0,\n      isProcessed: false,\n      source: source\n    };\n    this.queue.waiting.push(newPendingMessage);\n    if (this.queue.current) {\n      if (message.history?.error_state === MessageErrorState.RETRYING) {\n        this.setMessageErrorState(newPendingMessage, MessageErrorState.WAITING);\n      }\n    }\n  }\n  clearCurrentQueueItem() {\n    if (this.queue.current) {\n      this.queue.current = null;\n    }\n  }\n  moveToNextQueueItem() {\n    this.clearCurrentQueueItem();\n    this.runQueueIfReady();\n  }\n  setMessageErrorState(pendingRequest, errorState) {\n    const {message: message} = pendingRequest;\n    const {allMessagesByID: allMessagesByID} = this.serviceManager.store.getState();\n    const messageToUpdate = allMessagesByID[message.id];\n    if (messageToUpdate) {\n      const currentState = messageToUpdate.history?.error_state;\n      const errorSame = currentState === errorState || errorState === MessageErrorState.NONE && !currentState;\n      if (!errorSame) {\n        let announceMessageID;\n        switch (errorState) {\n         case MessageErrorState.FAILED:\n          {\n            announceMessageID = \"errors_ariaMessageFailed\";\n            break;\n          }\n        }\n        if (announceMessageID) {\n          this.serviceManager.store.dispatch(actions.announceMessage({\n            messageID: announceMessageID\n          }));\n        }\n        this.serviceManager.store.dispatch(actions.setMessageErrorState(message.id, errorState));\n        const {allMessagesByID: allMessagesByID} = this.serviceManager.store.getState();\n        pendingRequest.message = allMessagesByID[message.id];\n      }\n    }\n  }\n  send(message, source, localMessageID, requestOptions) {\n    message.history.timestamp = message.history.timestamp || Date.now();\n    message.input = message.input || {};\n    message.input.message_type = message.input.message_type || MessageInputType.TEXT;\n    const sendMessagePromise = resolvablePromise();\n    this.addToMessageQueue(message, source, localMessageID, sendMessagePromise, requestOptions);\n    this.runQueueIfReady();\n    return sendMessagePromise;\n  }\n  cancelAllMessageRequests() {\n    while (this.queue.waiting.length) {\n      this.cancelMessageRequestByID(this.queue.waiting[0].message.id, false);\n    }\n    if (this.queue.current) {\n      this.cancelMessageRequestByID(this.queue.current.message.id, false);\n      this.clearCurrentQueueItem();\n    }\n  }\n  async cancelMessageRequestByID(messageID, logError) {\n    let pendingRequest;\n    if (this.queue.current?.message.id === messageID) {\n      pendingRequest = this.queue.current;\n    } else {\n      const index = this.queue.waiting.findIndex(item => item.message.id === messageID);\n      if (index !== -1) {\n        pendingRequest = this.queue.waiting[index];\n        this.queue.waiting.splice(index, 1);\n      }\n    }\n    if (pendingRequest) {\n      const {lastResponse: lastResponse, sendMessageController: sendMessageController} = pendingRequest;\n      sendMessageController?.abort(\"Message was cancelled\");\n      this.rejectFinalErrorOnMessage(pendingRequest, \"Message was cancelled\");\n      if (logError) {\n        this.serviceManager.actions.errorOccurred({\n          errorType: OnErrorType.MESSAGE_COMMUNICATION,\n          message: \"Message was cancelled\",\n          otherData: await safeFetchTextWithTimeout(lastResponse)\n        });\n      }\n    }\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ class NamespaceService {\n  constructor(namespace) {\n    this.originalName = namespace;\n    this.attributeSafe = namespace;\n    this.suffix = getSuffix(namespace);\n  }\n}\n\nfunction getSuffix(namespace) {\n  const computedName = computeNamespaceName(namespace);\n  return computedName?.length ? `--${namespace}` : \"\";\n}\n\nfunction computeNamespaceName(namespace) {\n  return namespace ? namespace.trim() : \"\";\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ class ServiceManager {\n  constructor() {\n    this.userDefinedElementRegistry = new Map;\n    this.restartCount = 0;\n  }\n  async fire(busEvent) {\n    return this.eventBus.fire(busEvent, this.instance);\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ let innerStorage = {};\n\nconst storage$1 = {\n  getItem(key) {\n    return innerStorage[key];\n  },\n  setItem(key, value) {\n    innerStorage[key] = value;\n  },\n  removeItem(key) {\n    delete innerStorage[key];\n  },\n  length: Object.keys(innerStorage).length,\n  clear() {\n    innerStorage = {};\n  },\n  key(index) {\n    return Object.keys(innerStorage)[index];\n  }\n};\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const storage = IS_SESSION_STORAGE() ? window.sessionStorage : storage$1;\n\nclass UserSessionStorageService {\n  constructor(serviceManager) {\n    this.serviceManager = serviceManager;\n    this.prefix = `CARBON_CHAT_SESSION${this.serviceManager?.namespace?.suffix || \"\"}`;\n  }\n  loadChatSession() {\n    try {\n      const chatSessionString = storage.getItem(this.getChatSessionKey());\n      const chatSession = chatSessionString ? JSON.parse(chatSessionString) : null;\n      if (chatSession?.version === VERSION) {\n        return chatSession;\n      }\n      this.clearChatSession();\n      return null;\n    } catch (error) {\n      this.clearChatSession();\n      return null;\n    }\n  }\n  loadLauncherSession() {\n    try {\n      const launcherSessionString = storage.getItem(this.getLauncherSessionKey());\n      const launcherSession = launcherSessionString ? JSON.parse(launcherSessionString) : null;\n      if (launcherSession?.version === VERSION) {\n        launcherSession.wasLoadedFromBrowser = true;\n        return launcherSession;\n      }\n      this.clearLauncherSession();\n      return null;\n    } catch (error) {\n      this.clearLauncherSession();\n      return null;\n    }\n  }\n  persistChatSession(session) {\n    try {\n      storage.setItem(this.getChatSessionKey(), JSON.stringify(session));\n    } catch (error) {\n      consoleError(\"Error in persistChatSession\", error);\n    }\n  }\n  persistLauncherSession(session) {\n    try {\n      storage.setItem(this.getLauncherSessionKey(), JSON.stringify(session));\n    } catch (error) {\n      consoleError(\"Error in persistLauncherSession\", error);\n    }\n  }\n  clearChatSession() {\n    try {\n      storage.removeItem(this.getChatSessionKey());\n    } catch (error) {\n      consoleError(\"Error in clearChatSession\", error);\n    }\n  }\n  clearLauncherSession() {\n    try {\n      storage.removeItem(this.getLauncherSessionKey());\n    } catch (error) {\n      consoleError(\"Error in clearLauncherSession\", error);\n    }\n  }\n  getChatSessionKey() {\n    return this.prefix;\n  }\n  getLauncherSessionKey() {\n    return this.prefix;\n  }\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function replaceCurrentArrayValue(currentValue, newValue) {\n  if (Array.isArray(newValue)) {\n    return newValue;\n  }\n  return undefined;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const agentReducers = {\n  [HA_SET_IS_CONNECTING]: (state, action) => {\n    const {isConnecting: isConnecting, localMessageID: localMessageID} = action;\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        isConnecting: isConnecting,\n        activeLocalMessageID: localMessageID,\n        numUnreadMessages: isConnecting ? 0 : state.agentState.numUnreadMessages\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isSuspended: isConnecting ? state.persistedToBrowserStorage.chatState.agentState.isSuspended : false\n          }\n        }\n      }\n    };\n  },\n  [HA_SET_IS_RECONNECTING]: (state, action) => {\n    const {isReconnecting: isReconnecting} = action;\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        isReconnecting: isReconnecting\n      }\n    };\n  },\n  [HA_SET_AGENT_AVAILABILITY]: (state, action) => {\n    if (!state.agentState.isConnecting) {\n      return state;\n    }\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        availability: state.agentState.isConnecting ? action.availability : null\n      }\n    };\n  },\n  [HA_SET_SHOW_SCREEN_SHARE_REQUEST]: (state, {showRequest: showRequest}) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      showScreenShareRequest: showRequest\n    }\n  }),\n  [HA_SET_AGENT_JOINED]: (state, action) => {\n    const agentProfiles = {\n      ...state.persistedToBrowserStorage.chatState.agentState.agentProfiles\n    };\n    const {agentProfile: agentProfile} = action;\n    if (agentProfile) {\n      agentProfiles[agentProfile.id] = agentProfile;\n    }\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        isConnecting: false,\n        isReconnecting: false,\n        availability: null\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isConnected: true,\n            agentProfile: agentProfile,\n            agentProfiles: agentProfiles\n          }\n        }\n      }\n    };\n  },\n  [HA_SET_PERSISTED_STATE]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        agentState: {\n          ...state.persistedToBrowserStorage.chatState.agentState,\n          serviceDeskState: action.state\n        }\n      }\n    }\n  }),\n  [HA_UPDATE_IS_SUSPENDED]: (state, action) => {\n    if (!state.agentState.isConnecting && !state.persistedToBrowserStorage.chatState.agentState.isConnected) {\n      return state;\n    }\n    return {\n      ...state,\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isSuspended: action.isSuspended\n          }\n        }\n      }\n    };\n  },\n  [HA_UPDATE_IS_TYPING]: (state, action) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      isAgentTyping: action.isTyping\n    }\n  }),\n  [HA_SET_AGENT_LEFT_CHAT]: state => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState\n    },\n    agentState: {\n      ...state.agentState,\n      isAgentTyping: false\n    },\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        agentState: {\n          ...state.persistedToBrowserStorage.chatState.agentState,\n          agentProfile: null\n        }\n      }\n    }\n  }),\n  [HA_UPDATE_CAPABILITIES]: (state, action) => {\n    const newInputState = {\n      ...state.agentState.inputState,\n      ...action.capabilities\n    };\n    if (!newInputState.allowFileUploads) {\n      newInputState.files = [];\n    }\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        inputState: newInputState\n      }\n    };\n  },\n  [HA_SET_IS_SCREEN_SHARING]: (state, {isSharing: isSharing}) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      isScreenSharing: isSharing\n    }\n  }),\n  [HA_UPDATE_FILE_UPLOAD_IN_PROGRESS]: (state, action) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      fileUploadInProgress: action.fileUploadInProgress\n    }\n  }),\n  [HA_END_CHAT]: state => {\n    let newState = applyLocalMessageUIState(state, state.agentState.activeLocalMessageID, \"wasAgentChatEnded\", true);\n    newState = {\n      ...newState,\n      agentState: {\n        ...newState.agentState,\n        isConnecting: false,\n        isReconnecting: false,\n        availability: null,\n        activeLocalMessageID: null,\n        isAgentTyping: false,\n        inputState: {\n          ...newState.agentState.inputState,\n          isReadonly: false\n        }\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isConnected: false,\n            isSuspended: false,\n            agentProfile: null\n          }\n        }\n      }\n    };\n    return newState;\n  }\n};\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function populateTourStepItems(state) {\n  const {activeTourID: activeTourID} = state.persistedToBrowserStorage.chatState.persistedTourState;\n  if (activeTourID) {\n    const originalMessage = state.allMessagesByID[activeTourID];\n    const tourMessageItem = originalMessage?.output?.generic?.find(message => Boolean(message.user_defined?.steps));\n    if (tourMessageItem) {\n      return {\n        ...state,\n        tourState: {\n          ...state.tourState,\n          activeTourStepItems: tourMessageItem.user_defined?.steps\n        }\n      };\n    }\n  }\n  return clearTourState(state);\n}\n\nfunction clearTourState(state) {\n  return {\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        persistedTourState: {\n          activeTourID: null,\n          activeTourCurrentStepIndex: null\n        }\n      },\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        activeTour: false\n      }\n    },\n    tourState: {\n      ...state.tourState,\n      activeTourStepItems: null\n    }\n  };\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const EXCLUDE_AGENT_UNREAD = new Set([ AgentMessageType.USER_ENDED_CHAT, AgentMessageType.CHAT_WAS_ENDED, AgentMessageType.RELOAD_WARNING ]);\n\nconst reducers = {\n  [CHANGE_STATE]: (state, action) => merge({}, state, action.partialState),\n  [HYDRATE_CHAT]: state => ({\n    ...state,\n    isHydrated: true\n  }),\n  [RESTART_CONVERSATION]: state => {\n    let newState = {\n      ...state,\n      botMessageState: {\n        ...state.botMessageState,\n        localMessageIDs: [],\n        messageIDs: [],\n        isTypingCounter: 0,\n        isScrollAnchored: false\n      },\n      allMessageItemsByID: {},\n      allMessagesByID: {},\n      iFramePanelState: {\n        ...DEFAULT_IFRAME_PANEL_STATE\n      },\n      viewSourcePanelState: {\n        ...DEFAULT_CITATION_PANEL_STATE\n      },\n      customPanelState: {\n        ...DEFAULT_CUSTOM_PANEL_STATE\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          homeScreenState: {\n            ...state.persistedToBrowserStorage.chatState.homeScreenState,\n            showBackToBot: false\n          }\n        }\n      },\n      isHydrated: false,\n      catastrophicErrorType: null\n    };\n    newState = clearTourState(newState);\n    if (newState.homeScreenConfig.is_on) {\n      newState = setHomeScreenOpenState(newState, true);\n    }\n    return newState;\n  },\n  [HYDRATE_MESSAGE_HISTORY]: (state, action) => {\n    let newState = {\n      ...state,\n      ...action.messageHistory\n    };\n    if (state.persistedToBrowserStorage.chatState.persistedTourState.activeTourID) {\n      newState = populateTourStepItems(newState);\n    }\n    return newState;\n  },\n  [ADD_LOCAL_MESSAGE_ITEM]: (state, action) => {\n    const {messageItem: messageItem, message: message, addMessage: addMessage, addAfterID: addAfterID} = action;\n    const {id: id} = messageItem.ui_state;\n    const isSilent = message.history.silent;\n    let newState = state;\n    if (addMessage) {\n      newState = applyFullMessage(newState, message);\n    }\n    const currentIndex = newState.botMessageState.localMessageIDs.findIndex(existingID => existingID === id);\n    const newLocalMessageIDs = [ ...newState.botMessageState.localMessageIDs ];\n    let insertAtIndex = currentIndex;\n    if (currentIndex !== -1) {\n      newLocalMessageIDs.splice(currentIndex, 1);\n    } else {\n      insertAtIndex = newLocalMessageIDs.length;\n    }\n    if (addAfterID) {\n      const afterIDIndex = newLocalMessageIDs.findIndex(existingID => existingID === addAfterID);\n      if (afterIDIndex !== -1) {\n        insertAtIndex = afterIDIndex + 1;\n      }\n    }\n    newLocalMessageIDs.splice(insertAtIndex, 0, id);\n    if (!isSilent) {\n      newState = {\n        ...newState,\n        allMessageItemsByID: {\n          ...newState.allMessageItemsByID,\n          [id]: messageItem\n        },\n        botMessageState: {\n          ...newState.botMessageState,\n          localMessageIDs: newLocalMessageIDs\n        }\n      };\n      if (newState.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen) {\n        newState = setHomeScreenOpenState(newState, false);\n      }\n      const isBotMessage = !messageItem.item.agent_message_type;\n      const isMainWindowOpen = state.persistedToBrowserStorage.launcherState.viewState.mainWindow;\n      if (!isBotMessage && (!isMainWindowOpen || !state.isBrowserPageVisible)) {\n        const fromAgent = !isRequest(message);\n        if (fromAgent && !EXCLUDE_AGENT_UNREAD.has(messageItem.item.agent_message_type)) {\n          newState = {\n            ...newState,\n            agentState: {\n              ...newState.agentState,\n              numUnreadMessages: newState.agentState.numUnreadMessages + 1\n            }\n          };\n        }\n      }\n    }\n    return newState;\n  },\n  [REMOVE_MESSAGES]: (state, {messageIDs: messageIDs}) => {\n    const idsSet = new Set(messageIDs);\n    const newAllMessages = {\n      ...state.allMessagesByID\n    };\n    const newAllMessageItems = {\n      ...state.allMessageItemsByID\n    };\n    const newMessageIDs = state.botMessageState.messageIDs.filter(messageID => !idsSet.has(messageID));\n    const newMessageItemsIDs = state.botMessageState.localMessageIDs.filter(messageItemID => {\n      const messageItem = newAllMessageItems[messageItemID];\n      const removeItem = idsSet.has(messageItem?.fullMessageID);\n      if (removeItem) {\n        delete newAllMessageItems[messageItemID];\n      }\n      return !removeItem;\n    });\n    messageIDs.forEach(messageID => {\n      delete newAllMessages[messageID];\n    });\n    const newState = {\n      ...state,\n      allMessagesByID: newAllMessages,\n      allMessageItemsByID: newAllMessageItems,\n      botMessageState: {\n        ...state.botMessageState,\n        messageIDs: newMessageIDs,\n        localMessageIDs: newMessageItemsIDs\n      }\n    };\n    return newState;\n  },\n  [UPDATE_LOCAL_MESSAGE_ITEM]: (state, action) => {\n    const {messageItem: messageItem} = action;\n    return {\n      ...state,\n      allMessageItemsByID: {\n        ...state.allMessageItemsByID,\n        [messageItem.ui_state.id]: messageItem\n      }\n    };\n  },\n  [UPDATE_MESSAGE]: (state, action) => {\n    const {message: message} = action;\n    return {\n      ...state,\n      allMessagesByID: {\n        ...state.allMessagesByID,\n        [message.id]: message\n      }\n    };\n  },\n  [ADD_MESSAGE]: (state, action) => {\n    const {message: message} = action;\n    const messageID = message.id;\n    let newState = state;\n    if (isResponse(message)) {\n      const itemIDsInNewMessage = [];\n      message.output.generic.forEach(item => {\n        const id = streamItemID(messageID, item);\n        if (id) {\n          itemIDsInNewMessage.push(id);\n        }\n      });\n      const newAllMessageItemsByID = {\n        ...state.allMessageItemsByID\n      };\n      const existingItemIDs = [];\n      let firstFoundIndex;\n      const newLocalMessageIDs = state.botMessageState.localMessageIDs.filter((itemID, index) => {\n        const item = state.allMessageItemsByID[itemID];\n        const isItemInMessage = item.fullMessageID === messageID;\n        if (isItemInMessage) {\n          if (firstFoundIndex === undefined) {\n            firstFoundIndex = index;\n          }\n          if (!itemIDsInNewMessage.includes(itemID)) {\n            delete newAllMessageItemsByID[itemID];\n          } else {\n            existingItemIDs.push(itemID);\n          }\n        }\n        return !isItemInMessage;\n      });\n      if (existingItemIDs.length) {\n        const itemIDsToInsert = itemIDsInNewMessage.filter(itemID => existingItemIDs.includes(itemID));\n        if (itemIDsToInsert.length) {\n          newLocalMessageIDs.splice(firstFoundIndex, 0, ...itemIDsToInsert);\n        }\n      }\n      newState = {\n        ...newState,\n        allMessageItemsByID: newAllMessageItemsByID,\n        botMessageState: {\n          ...newState.botMessageState,\n          localMessageIDs: newLocalMessageIDs\n        }\n      };\n    }\n    return applyFullMessage(newState, message);\n  },\n  [MESSAGE_SET_OPTION_SELECTED]: (state, action) => {\n    const newMessagesByID = {\n      ...state.allMessageItemsByID\n    };\n    newMessagesByID[action.messageID] = {\n      ...state.allMessageItemsByID[action.messageID],\n      ui_state: {\n        ...state.allMessageItemsByID[action.messageID].ui_state,\n        optionSelected: action.sentMessage\n      }\n    };\n    return {\n      ...state,\n      allMessageItemsByID: newMessagesByID\n    };\n  },\n  [ADD_IS_TYPING_COUNTER]: (state, action) => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      isTypingCounter: Math.max(state.botMessageState.isTypingCounter + action.addToIsTyping, 0)\n    }\n  }),\n  [ADD_IS_LOADING_COUNTER]: (state, action) => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      isLoadingCounter: Math.max(state.botMessageState.isLoadingCounter + action.addToIsLoading, 0)\n    }\n  }),\n  [ADD_IS_HYDRATING_COUNTER]: (state, action) => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      isHydratingCounter: Math.max(state.botMessageState.isHydratingCounter + action.addToIsHydrating, 0)\n    }\n  }),\n  [SET_APP_STATE_VALUE]: (state, action) => ({\n    ...state,\n    [action.key]: action.value\n  }),\n  [UPDATE_PERSISTED_CHAT_STATE]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        ...action.chatState\n      }\n    }\n  }),\n  [UPDATE_HAS_SENT_NON_WELCOME_MESSAGE]: (state, action) => {\n    if (state.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage === action.hasSentNonWelcomeMessage) {\n      return state;\n    }\n    return {\n      ...state,\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          hasSentNonWelcomeMessage: action.hasSentNonWelcomeMessage\n        },\n        launcherState: {\n          ...state.persistedToBrowserStorage.launcherState,\n          hasSentNonWelcomeMessage: action.hasSentNonWelcomeMessage\n        }\n      }\n    };\n  },\n  [SET_VIEW_STATE]: (state, action) => handleViewStateChange(state, action.viewState),\n  [SET_VIEW_CHANGING]: (state, action) => ({\n    ...state,\n    viewChanging: action.viewChanging\n  }),\n  [SET_INITIAL_VIEW_CHANGE_COMPLETE]: (state, action) => ({\n    ...state,\n    initialViewChangeComplete: action.changeComplete\n  }),\n  [UPDATE_BOT_NAME]: (state, action) => ({\n    ...state,\n    botName: action.name,\n    headerDisplayName: state.theme.useAITheme ? state.headerDisplayName : action.name\n  }),\n  [UPDATE_BOT_AVATAR_URL]: (state, action) => ({\n    ...state,\n    botAvatarURL: action.url\n  }),\n  [UPDATE_LAUNCHER_AVATAR_URL]: (state, action) => ({\n    ...state,\n    launcher: {\n      ...state.launcher,\n      config: {\n        ...state.launcher.config,\n        mobile: {\n          ...state.launcher.config.mobile,\n          avatar_url_override: action.source\n        },\n        desktop: {\n          ...state.launcher.config.desktop,\n          avatar_url_override: action.source\n        }\n      }\n    }\n  }),\n  [UPDATE_MAIN_HEADER_TITLE]: (state, action) => ({\n    ...state,\n    headerDisplayName: action.title\n  }),\n  [UPDATE_CSS_VARIABLES]: (state, action) => {\n    const {config: config} = state;\n    const {variables: variables} = action;\n    const newConfig = {\n      public: {\n        ...config.public\n      }\n    };\n    return {\n      ...state,\n      config: newConfig,\n      cssVariableOverrides: variables\n    };\n  },\n  [UPDATE_HOME_SCREEN_CONFIG]: (state, action) => {\n    const newHomeScreenConfig = action.homeScreenConfig;\n    return {\n      ...state,\n      homeScreenConfig: mergeWith({}, state.homeScreenConfig, newHomeScreenConfig, replaceCurrentArrayValue)\n    };\n  },\n  [SET_MESSAGE_UI_PROPERTY]: (state, action) => applyLocalMessageUIState(state, action.localMessageID, action.propertyName, action.propertyValue),\n  [SET_MESSAGE_HISTORY_PROPERTY]: (state, action) => {\n    const {messageID: messageID, propertyName: propertyName, propertyValue: propertyValue} = action;\n    const oldMessage = state.allMessagesByID[messageID];\n    if (oldMessage) {\n      return {\n        ...state,\n        allMessagesByID: {\n          ...state.allMessagesByID,\n          [messageID]: {\n            ...oldMessage,\n            history: {\n              ...oldMessage.history,\n              [propertyName]: propertyValue\n            }\n          }\n        }\n      };\n    }\n    return state;\n  },\n  [MERGE_HISTORY]: (state, action) => {\n    const oldMessage = state.allMessagesByID[action.messageID];\n    if (oldMessage) {\n      return {\n        ...state,\n        allMessagesByID: {\n          ...state.allMessagesByID,\n          [action.messageID]: {\n            ...oldMessage,\n            history: merge({}, oldMessage.history, action.history)\n          }\n        }\n      };\n    }\n    return state;\n  },\n  [ANNOUNCE_MESSAGE]: (state, action) => ({\n    ...state,\n    announceMessage: action.message\n  }),\n  [ACCEPTED_DISCLAIMER]: state => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        disclaimersAccepted: {\n          ...state.persistedToBrowserStorage.chatState.disclaimersAccepted,\n          [window.location.hostname]: true\n        }\n      }\n    }\n  }),\n  [SET_HOME_SCREEN_IS_OPEN]: (state, {isOpen: isOpen}) => setHomeScreenOpenState(state, isOpen),\n  [TOGGLE_HOME_SCREEN]: state => setHomeScreenOpenState(state, !state.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen, true),\n  [UPDATE_LAUNCHER_CONFIG]: (state, action) => {\n    const newConfig = merge({}, state.launcher.config, action.launcherConfig);\n    return {\n      ...state,\n      launcher: {\n        ...state.launcher,\n        config: newConfig\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        launcherState: {\n          ...state.persistedToBrowserStorage.launcherState,\n          desktopLauncherIsExpanded: newConfig.is_on && newConfig.desktop.is_on ? state.persistedToBrowserStorage.launcherState.desktopLauncherIsExpanded : false,\n          mobileLauncherIsExtended: newConfig.is_on && newConfig.mobile.is_on ? state.persistedToBrowserStorage.launcherState.mobileLauncherIsExtended : false\n        }\n      }\n    };\n  },\n  [SET_LAUNCHER_PROPERTY]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        [action.propertyName]: action.propertyValue\n      }\n    }\n  }),\n  [SET_LAUNCHER_CONFIG_PROPERTY]: (state, action) => {\n    const newState = {\n      ...state,\n      launcher: {\n        ...state.launcher,\n        config: {\n          ...state.launcher.config\n        }\n      }\n    };\n    if (!action.launcherType || action.launcherType === LauncherType.DESKTOP) {\n      newState.launcher.config.desktop = {\n        ...state.launcher.config.desktop,\n        [action.propertyName]: action.propertyValue\n      };\n    }\n    if (!action.launcherType || action.launcherType === LauncherType.MOBILE) {\n      newState.launcher.config.mobile = {\n        ...state.launcher.config.mobile,\n        [action.propertyName]: action.propertyValue\n      };\n    }\n    return newState;\n  },\n  [SET_CHAT_MESSAGES_PROPERTY]: (state, action) => applyBotMessageState(state, {\n    [action.propertyName]: action.propertyValue\n  }),\n  [SET_LAUNCHER_MINIMIZED]: state => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        desktopLauncherIsExpanded: false,\n        desktopLauncherWasMinimized: true\n      }\n    }\n  }),\n  [OPEN_IFRAME_CONTENT]: (state, {messageItem: messageItem}) => ({\n    ...state,\n    iFramePanelState: {\n      ...state.iFramePanelState,\n      messageItem: messageItem,\n      isOpen: true\n    },\n    announceMessage: {\n      messageID: \"iframe_ariaOpenedPanel\"\n    }\n  }),\n  [CLOSE_IFRAME_PANEL]: state => ({\n    ...state,\n    iFramePanelState: {\n      ...state.iFramePanelState,\n      isOpen: false\n    },\n    announceMessage: {\n      messageID: \"iframe_ariaClosedPanel\"\n    }\n  }),\n  [SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN]: (state, action) => ({\n    ...state,\n    viewSourcePanelState: {\n      ...state.viewSourcePanelState,\n      citationItem: action.citationItem,\n      relatedSearchResult: action.relatedSearchResult,\n      isOpen: action.isOpen\n    }\n  }),\n  [SET_CUSTOM_PANEL_OPEN]: (state, action) => ({\n    ...state,\n    customPanelState: {\n      ...state.customPanelState,\n      isOpen: action.isOpen\n    }\n  }),\n  [SET_CUSTOM_PANEL_OPTIONS]: (state, action) => ({\n    ...state,\n    customPanelState: {\n      ...state.customPanelState,\n      options: action.options\n    }\n  }),\n  [SET_TOUR_DATA]: (state, action) => {\n    const newStateWithPersistedTourData = {\n      ...state,\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          persistedTourState: {\n            activeTourID: action.newActiveTourMessageID,\n            activeTourCurrentStepIndex: 0\n          }\n        },\n        launcherState: {\n          ...state.persistedToBrowserStorage.launcherState,\n          activeTour: true\n        }\n      }\n    };\n    return populateTourStepItems(newStateWithPersistedTourData);\n  },\n  [CLEAR_TOUR_DATA]: state => clearTourState(state),\n  [CHANGE_STEP_IN_TOUR]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        persistedTourState: {\n          ...state.persistedToBrowserStorage.chatState.persistedTourState,\n          activeTourCurrentStepIndex: Math.max(Math.min(action.newStepNumber, state.tourState.activeTourStepItems.length - 1), 0)\n        }\n      }\n    }\n  }),\n  [UPDATE_INPUT_STATE]: (state, action) => {\n    const currentInputState = getInputState(state, action.isInputToAgent);\n    const newInputState = {\n      ...currentInputState,\n      ...action.newState\n    };\n    const newState = applyInputState(state, newInputState, action.isInputToAgent);\n    return newState;\n  },\n  [SET_IS_BROWSER_PAGE_VISIBLE]: (state, action) => {\n    let numUnreadMessages;\n    const isMainWindowOpen = state.persistedToBrowserStorage.launcherState.viewState.mainWindow;\n    if (isMainWindowOpen && action.isVisible) {\n      numUnreadMessages = 0;\n    } else {\n      numUnreadMessages = state.agentState.numUnreadMessages;\n    }\n    return {\n      ...state,\n      isBrowserPageVisible: action.isVisible,\n      agentState: {\n        ...state.agentState,\n        numUnreadMessages: numUnreadMessages\n      }\n    };\n  },\n  [ADD_INPUT_FILE]: (state, {file: file, isInputToAgent: isInputToAgent}) => {\n    const currentInputState = getInputState(state, isInputToAgent);\n    return applyInputState(state, {\n      ...currentInputState,\n      files: [ ...currentInputState.files, file ]\n    }, isInputToAgent);\n  },\n  [REMOVE_INPUT_FILE]: (state, {fileID: fileID, isInputToAgent: isInputToAgent}) => {\n    const currentInputState = getInputState(state, isInputToAgent);\n    const newUploads = [ ...currentInputState.files ];\n    const index = newUploads.findIndex(file => file.id === fileID);\n    if (index !== -1) {\n      newUploads.splice(index, 1);\n    }\n    return applyInputState(state, {\n      ...currentInputState,\n      files: newUploads\n    }, isInputToAgent);\n  },\n  [REMOVE_LOCAL_MESSAGE_ITEM]: (state, {localMessageItemID: localMessageItemID}) => {\n    const newLocalMessageIDs = state.botMessageState.localMessageIDs.filter(id => id !== localMessageItemID);\n    const allMessageItemsByID = {\n      ...state.allMessageItemsByID\n    };\n    if (allMessageItemsByID[localMessageItemID]) {\n      delete allMessageItemsByID[localMessageItemID];\n    }\n    return {\n      ...state,\n      allMessageItemsByID: allMessageItemsByID,\n      botMessageState: {\n        ...state.botMessageState,\n        localMessageIDs: newLocalMessageIDs\n      }\n    };\n  },\n  [ADD_NOTIFICATION]: (state, {notification: notification, notificationID: notificationID}) => ({\n    ...state,\n    notifications: state.notifications.concat({\n      id: notificationID,\n      notification: notification\n    })\n  }),\n  [REMOVE_NOTIFICATIONS]: (state, {groupID: groupID, notificationID: notificationID}) => ({\n    ...state,\n    notifications: state.notifications.filter(notification => {\n      if (notificationID) {\n        return notification.id !== notificationID;\n      }\n      return notification.notification.groupID !== groupID;\n    })\n  }),\n  [REMOVE_ALL_NOTIFICATIONS]: state => ({\n    ...state,\n    notifications: []\n  }),\n  [CLEAR_INPUT_FILES]: (state, {isInputToAgent: isInputToAgent}) => {\n    const currentInputState = getInputState(state, isInputToAgent);\n    return applyInputState(state, {\n      ...currentInputState,\n      files: []\n    }, isInputToAgent);\n  },\n  [FILE_UPLOAD_INPUT_ERROR]: (state, {fileID: fileID, errorMessage: errorMessage, isInputToAgent: isInputToAgent}) => {\n    const currentInputSate = getInputState(state, isInputToAgent);\n    const newUploads = [ ...currentInputSate.files ];\n    const index = newUploads.findIndex(file => file.id === fileID);\n    if (index !== -1) {\n      newUploads[index] = {\n        ...newUploads[index],\n        isError: true,\n        errorMessage: errorMessage,\n        status: FileStatusValue.COMPLETE\n      };\n    }\n    return applyInputState(state, {\n      ...currentInputSate,\n      files: newUploads\n    }, isInputToAgent);\n  },\n  [ADD_NESTED_MESSAGES]: (state, {localMessageItems: localMessageItems}) => {\n    const allMessageItemsByID = {\n      ...state.allMessageItemsByID\n    };\n    localMessageItems.forEach(localMessageItem => {\n      allMessageItemsByID[localMessageItem.ui_state.id] = localMessageItem;\n    });\n    return {\n      ...state,\n      allMessageItemsByID: allMessageItemsByID\n    };\n  },\n  [SET_RESPONSE_PANEL_IS_OPEN]: (state, {isOpen: isOpen}) => ({\n    ...state,\n    responsePanelState: {\n      ...state.responsePanelState,\n      isOpen: isOpen\n    }\n  }),\n  [SET_RESPONSE_PANEL_CONTENT]: (state, {localMessageItem: localMessageItem, isMessageForInput: isMessageForInput}) => ({\n    ...state,\n    responsePanelState: {\n      ...state.responsePanelState,\n      localMessageItem: localMessageItem,\n      isMessageForInput: isMessageForInput\n    }\n  }),\n  [STREAMING_START]: (state, {messageID: messageID}) => {\n    const streamIntoResponse = {\n      id: messageID,\n      output: {\n        generic: []\n      },\n      history: {\n        timestamp: Date.now()\n      }\n    };\n    return applyFullMessage(state, streamIntoResponse);\n  },\n  [STREAMING_MERGE_HISTORY]: (state, {messageID: messageID, history: history}) => {\n    const existingMessage = state.allMessagesByID[messageID];\n    const newMessage = merge({}, existingMessage, {\n      history: history\n    });\n    if (existingMessage) {\n      return {\n        ...state,\n        allMessagesByID: {\n          ...state.allMessagesByID,\n          [messageID]: newMessage\n        }\n      };\n    }\n    return state;\n  },\n  [STREAMING_ADD_CHUNK]: (state, {chunkItem: chunkItem, fullMessageID: fullMessageID, isCompleteItem: isCompleteItem, disableFadeAnimation: disableFadeAnimation}) => {\n    const message = state.allMessagesByID[fullMessageID];\n    const localItemID = streamItemID(fullMessageID, chunkItem);\n    const existingLocalMessageItem = state.allMessageItemsByID[localItemID];\n    let {localMessageIDs: localMessageIDs} = state.botMessageState;\n    let newItem;\n    if (!existingLocalMessageItem) {\n      newItem = outputItemToLocalItem(chunkItem, message, false);\n      newItem.ui_state.needsAnnouncement = false;\n      newItem.ui_state.disableFadeAnimation = disableFadeAnimation;\n      newItem.ui_state.isIntermediateStreaming = true;\n      if (isCompleteItem) {\n        newItem.ui_state.streamingState = {\n          chunks: [],\n          isDone: true\n        };\n      } else {\n        newItem.ui_state.streamingState = {\n          chunks: [ chunkItem ],\n          isDone: false\n        };\n      }\n      localMessageIDs = [ ...localMessageIDs, localItemID ];\n      if (!newItem.item.response_type) {\n        throw new Error(`New chunk item does not have a response_type: ${JSON.stringify(chunkItem)}`);\n      }\n    } else if (isCompleteItem) {\n      newItem = outputItemToLocalItem(chunkItem, message, false);\n      newItem.ui_state.needsAnnouncement = false;\n      newItem.ui_state.disableFadeAnimation = disableFadeAnimation;\n      newItem.ui_state.streamingState = {\n        chunks: [],\n        isDone: true\n      };\n    } else {\n      newItem = {\n        ...existingLocalMessageItem,\n        ui_state: {\n          ...existingLocalMessageItem?.ui_state,\n          streamingState: {\n            ...existingLocalMessageItem?.ui_state.streamingState,\n            chunks: [ ...existingLocalMessageItem?.ui_state.streamingState?.chunks || [], chunkItem ]\n          }\n        }\n      };\n    }\n    return {\n      ...state,\n      allMessageItemsByID: {\n        ...state.allMessageItemsByID,\n        [localItemID]: newItem\n      },\n      botMessageState: {\n        ...state.botMessageState,\n        localMessageIDs: localMessageIDs\n      }\n    };\n  },\n  [UPDATE_CHAT_HEADER_CONFIG]: (state, {chatHeaderConfig: chatHeaderConfig}) => ({\n    ...state,\n    chatHeaderState: {\n      ...state.chatHeaderState,\n      config: {\n        ...state.chatHeaderState.config,\n        ...chatHeaderConfig\n      }\n    }\n  }),\n  [UPDATE_MAX_VISIBLE_HEADER_OBJECTS]: (state, {maxTotal: maxTotal}) => ({\n    ...state,\n    chatHeaderState: {\n      ...state.chatHeaderState,\n      maxVisibleHeaderObjects: maxTotal\n    }\n  }),\n  [SET_STOP_STREAMING_BUTTON_VISIBLE]: (state, {isVisible: isVisible}) => ({\n    ...state,\n    botInputState: {\n      ...state.botInputState,\n      stopStreamingButtonState: {\n        ...state.botInputState.stopStreamingButtonState,\n        isVisible: isVisible\n      }\n    }\n  }),\n  [SET_STOP_STREAMING_BUTTON_DISABLED]: (state, {isDisabled: isDisabled}) => ({\n    ...state,\n    botInputState: {\n      ...state.botInputState,\n      stopStreamingButtonState: {\n        ...state.botInputState.stopStreamingButtonState,\n        isDisabled: isDisabled\n      }\n    }\n  }),\n  [SET_STREAM_ID]: (state, {currentStreamID: currentStreamID}) => ({\n    ...state,\n    botInputState: {\n      ...state.botInputState,\n      stopStreamingButtonState: {\n        ...state.botInputState.stopStreamingButtonState,\n        currentStreamID: currentStreamID\n      }\n    }\n  }),\n  [UPDATE_MAIN_HEADER_AVATAR]: (state, {config: config}) => ({\n    ...state,\n    headerAvatarConfig: config\n  })\n};\n\nfunction applyInputState(state, newInputState, isInputToAgent) {\n  if (isInputToAgent) {\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        inputState: newInputState\n      }\n    };\n  }\n  return {\n    ...state,\n    botInputState: newInputState\n  };\n}\n\nfunction getInputState(state, isInputToAgent) {\n  return isInputToAgent ? state.agentState.inputState : state.botInputState;\n}\n\nObject.assign(reducers, agentReducers);\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function doCreateStore(config, serviceManager) {\n  let useAITheme;\n  if (config.public.themeConfig?.useAITheme !== undefined) {\n    useAITheme = config.public.themeConfig?.useAITheme;\n  } else {\n    useAITheme = DEFAULT_THEME_STATE.useAITheme;\n  }\n  const themeState = {\n    carbonTheme: config.public.themeConfig?.carbonTheme || DEFAULT_THEME_STATE.carbonTheme,\n    useAITheme: useAITheme,\n    corners: getThemeCornersType(config)\n  };\n  const botName = getBotName(themeState.useAITheme, config);\n  const initialState = {\n    ...DEFAULT_MESSAGE_STATE,\n    notifications: [],\n    botInputState: {\n      ...DEFAULT_INPUT_STATE(),\n      isReadonly: config.public.isReadonly,\n      fieldVisible: !config.public.isReadonly\n    },\n    agentState: {\n      ...DEFAULT_AGENT_STATE\n    },\n    botName: botName,\n    headerDisplayName: null,\n    botAvatarURL: config.public.botAvatarURL || null,\n    headerAvatarConfig: null,\n    chatWidthBreakpoint: null,\n    chatWidth: null,\n    chatHeight: null,\n    cssVariableOverrides: mergeCSSVariables({}, {}, themeState.carbonTheme, themeState.useAITheme),\n    isHydrated: false,\n    languagePack: enLanguagePack,\n    locale: \"en\",\n    config: config,\n    originalConfig: config,\n    suspendScrollDetection: false,\n    homeScreenConfig: withoutEmptyStarters({}),\n    persistedToBrowserStorage: {\n      ...DEFAULT_PERSISTED_TO_BROWSER,\n      chatState: {\n        ...DEFAULT_PERSISTED_TO_BROWSER.chatState,\n        homeScreenState: {\n          ...DEFAULT_PERSISTED_TO_BROWSER.chatState.homeScreenState\n        }\n      }\n    },\n    launcher: merge({}, DEFAULT_LAUNCHER, {\n      config: merge({}, {}, {\n        mobile: {}\n      }, {\n        is_on: config.public.showLauncher\n      })\n    }),\n    iFramePanelState: DEFAULT_IFRAME_PANEL_STATE,\n    viewSourcePanelState: DEFAULT_CITATION_PANEL_STATE,\n    isDestroyed: false,\n    customPanelState: DEFAULT_CUSTOM_PANEL_STATE,\n    viewChanging: false,\n    initialViewChangeComplete: false,\n    targetViewState: config.public.openChatByDefault ? VIEW_STATE_MAIN_WINDOW_OPEN : VIEW_STATE_LAUNCHER_OPEN,\n    responsePanelState: DEFAULT_MESSAGE_PANEL_STATE,\n    customMenuOptions: null,\n    tourState: DEFAULT_TOUR_STATE,\n    isBrowserPageVisible: true,\n    showNonHeaderBackgroundCover: false,\n    theme: themeState,\n    layout: getLayoutState(config),\n    chatHeaderState: {\n      config: null,\n      maxVisibleHeaderObjects: 0\n    }\n  };\n  const sessionStorageLauncherState = serviceManager.userSessionStorageService?.loadLauncherSession();\n  if (sessionStorageLauncherState) {\n    initialState.targetViewState = sessionStorageLauncherState.viewState;\n    sessionStorageLauncherState.viewState = VIEW_STATE_ALL_CLOSED;\n    initialState.persistedToBrowserStorage.launcherState = sessionStorageLauncherState;\n  }\n  const enhancer = config.public.debug || NODE_ENV === \"development\" ? window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__({\n    name: \"CarbonAIChat\",\n    instanceId: `Chat${serviceManager.namespace.suffix}`\n  }) : undefined;\n  return createStore(reducerFunction, initialState, enhancer);\n}\n\nfunction getThemeCornersType(config) {\n  if (getLayoutState(config).showFrame === false || IS_PHONE || config.public.themeConfig?.corners === CornersType.SQUARE) {\n    return CornersType.SQUARE;\n  }\n  return DEFAULT_THEME_STATE.corners;\n}\n\nfunction getLayoutState(config) {\n  if (config.public.themeConfig?.useAITheme) {\n    return {\n      showFrame: config.public.layout?.showFrame ?? true,\n      hasContentMaxWidth: config.public.layout?.hasContentMaxWidth ?? true\n    };\n  }\n  return merge({}, DEFAULT_LAYOUT_STATE, config.public.layout);\n}\n\nfunction reducerFunction(state, action) {\n  return action && reducers[action.type] ? reducers[action.type](state, action) : state;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const UNREAD_COUNT_TITLE_TIME = 1e4;\n\nfunction copyToSessionStorage(serviceManager) {\n  let previousPersistedToBrowserStorage = serviceManager.store.getState().persistedToBrowserStorage;\n  return () => {\n    const {persistedToBrowserStorage: persistedToBrowserStorage} = serviceManager.store.getState();\n    const persistChatSession = previousPersistedToBrowserStorage !== persistedToBrowserStorage;\n    if (persistChatSession) {\n      previousPersistedToBrowserStorage = persistedToBrowserStorage;\n      serviceManager.userSessionStorageService.persistChatSession(persistedToBrowserStorage.chatState);\n      serviceManager.userSessionStorageService.persistLauncherSession(persistedToBrowserStorage.launcherState);\n    }\n  };\n}\n\nfunction createHandleWindowTitle(serviceManager) {\n  const {store: store} = serviceManager;\n  let originalTitle;\n  let changeTitleTimer;\n  let previousState = store.getState();\n  return () => {\n    const state = store.getState();\n    const {agentState: agentState} = store.getState();\n    const {numUnreadMessages: numUnreadMessages} = agentState;\n    if (numUnreadMessages !== previousState.agentState.numUnreadMessages) {\n      if (!numUnreadMessages) {\n        clearTimeout(changeTitleTimer);\n        if (originalTitle) {\n          window.document.title = originalTitle;\n          originalTitle = null;\n        }\n      } else {\n        clearTimeout(changeTitleTimer);\n        if (!originalTitle) {\n          originalTitle = window.document.title;\n        }\n        window.document.title = state.languagePack.agent_newMessage;\n        changeTitleTimer = setTimeout(() => {\n          window.document.title = `(${numUnreadMessages}) ${originalTitle}`;\n        }, UNREAD_COUNT_TITLE_TIME);\n      }\n    }\n    previousState = state;\n  };\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ async function createServiceManager(appConfig, additionalChatParameters) {\n  const publicConfig = appConfig.public;\n  const serviceManager = new ServiceManager;\n  serviceManager.additionalChatParameters = additionalChatParameters;\n  serviceManager.namespace = new NamespaceService(publicConfig.namespace);\n  serviceManager.userSessionStorageService = new UserSessionStorageService(serviceManager);\n  serviceManager.actions = new ChatActionsImpl(serviceManager);\n  serviceManager.eventBus = new EventBus;\n  serviceManager.store = doCreateStore(appConfig, serviceManager);\n  serviceManager.historyService = new HistoryService(serviceManager);\n  serviceManager.messageService = new MessageService(serviceManager, publicConfig);\n  serviceManager.store.subscribe(copyToSessionStorage(serviceManager));\n  if (!publicConfig.disableWindowTitleChanges) {\n    serviceManager.store.subscribe(createHandleWindowTitle(serviceManager));\n  }\n  serviceManager.customPanelManager = createCustomPanelManager(serviceManager);\n  setIntl(serviceManager, serviceManager.store.getState().locale, serviceManager.store.getState().languagePack);\n  serviceManager.writeableElements = {\n    [WriteableElementName.AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.WELCOME_NODE_BEFORE_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HEADER_BOTTOM_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.BEFORE_INPUT_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HOME_SCREEN_HEADER_BOTTOM_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HOME_SCREEN_AFTER_STARTERS_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HOME_SCREEN_BEFORE_INPUT_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.CUSTOM_PANEL_ELEMENT]: document.createElement(\"div\")\n  };\n  if (publicConfig.debug) {\n    setEnableDebugLog(true);\n  }\n  if (publicConfig.debugStackTraces) {\n    setEnableDebugStackTracesLog(true);\n  }\n  return serviceManager;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const DEFAULT_PUBLIC_CONFIG = {\n  openChatByDefault: false,\n  showLauncher: true,\n  shouldTakeFocusIfOpensAutomatically: true,\n  serviceDesk: {},\n  messaging: {},\n  themeConfig: {\n    useAITheme: true\n  }\n};\n\nasync function instantiateWidget(pagePublicConfig, chatConstructorPromise, render, element) {\n  const config = cloneDeep(pagePublicConfig);\n  if (!config.messaging?.customSendMessage) {\n    throw new Error(`You must set messaging.customSendMessage in your configuration object.`);\n  }\n  if (config?.debug) {\n    consoleDebug(\"[ChatEntry] Called instantiateWidget\", config);\n  }\n  if (document.location.protocol !== \"https:\") {\n    consoleWarn('Your page is not running with \"https\"; your data will not be sent  securely.');\n  }\n  if (document.compatMode !== \"CSS1Compat\") {\n    consoleWarn('Your page is running in quirks mode; you may experience layout issues with the chat. Add \"<!DOCTYPE html>\" to the page to run in standards mode.');\n  }\n  const {onError: onError, ...publicConfig} = config;\n  const Chat = await chatConstructorPromise(publicConfig);\n  const additionalChatParameters = {\n    onError: onError,\n    render: render\n  };\n  return new Chat(publicConfig, element, additionalChatParameters);\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ dayjs.extend(LocalizedFormat);\n\nlet Chat$1 = class Chat {\n  constructor(publicConfigProvided, customHostElement, additionalChatParametersProvided) {\n    if (publicConfigProvided?.debug) {\n      consoleDebug(\"Constructed chat widget\", publicConfigProvided);\n    }\n    const publicConfig = merge({}, DEFAULT_PUBLIC_CONFIG, publicConfigProvided);\n    this.additionalChatParameters = additionalChatParametersProvided || {};\n    this.appConfig = {\n      public: publicConfig\n    };\n    this.customHostElement = customHostElement;\n  }\n  async start() {\n    try {\n      const result = await this.startInternal();\n      return result.instance;\n    } catch (error) {\n      consoleError(\"There was an error starting your chat\", error);\n      return null;\n    }\n  }\n  async startInternal() {\n    const doesHaveServiceDesk = hasServiceDesk(this.appConfig);\n    this.serviceManager = await createServiceManager(this.appConfig, this.additionalChatParameters);\n    const [languagePack, localePack, render, createHumanAgentService] = await Promise.all([ loadLanguagePack(this.serviceManager.store.getState().languagePack), loadLocale(this.serviceManager.store.getState().locale), Promise.resolve(this.additionalChatParameters.render), doesHaveServiceDesk ? loadHAA() : Promise.resolve(null) ]);\n    this.serviceManager.customHostElement = this.customHostElement;\n    if (createHumanAgentService) {\n      this.serviceManager.humanAgentService = createHumanAgentService(this.serviceManager);\n    }\n    setIntl(this.serviceManager, localePack.name, languagePack);\n    dayjs.locale(localePack);\n    const reallyRenderAndReturnInstance = async () => {\n      await render({\n        serviceManager: this.serviceManager\n      });\n      const initialState = this.serviceManager.store.getState();\n      const {wasLoadedFromBrowser: wasLoadedFromBrowser} = initialState.persistedToBrowserStorage.launcherState;\n      const {targetViewState: targetViewState} = initialState;\n      const {openChatByDefault: openChatByDefault} = initialState.config.public;\n      if (targetViewState.mainWindow) {\n        let mainWindowOpenReason = MainWindowOpenReason.SESSION_HISTORY;\n        if (openChatByDefault && !wasLoadedFromBrowser) {\n          mainWindowOpenReason = MainWindowOpenReason.OPEN_BY_DEFAULT;\n        }\n        await this.serviceManager.actions.changeView(targetViewState, {\n          mainWindowOpenReason: mainWindowOpenReason\n        });\n      } else {\n        const viewChangeReason = ViewChangeReason.WEB_CHAT_LOADED;\n        const tryHydrating = targetViewState.tour;\n        const forceViewChange = isEqual(targetViewState, VIEW_STATE_ALL_CLOSED);\n        await this.serviceManager.actions.changeView(targetViewState, {\n          viewChangeReason: viewChangeReason\n        }, tryHydrating, forceViewChange);\n      }\n      this.serviceManager.store.dispatch(actions.setInitialViewChangeComplete(true));\n      return this.serviceManager.instance;\n    };\n    const renderAndReturnInstance = () => {\n      const promise = reallyRenderAndReturnInstance();\n      this.serviceManager.renderPromise = promise;\n      return promise;\n    };\n    this.serviceManager.instance = createChatInstance({\n      serviceManager: this.serviceManager,\n      callRender: renderAndReturnInstance\n    });\n    return {\n      instance: this.serviceManager.instance,\n      serviceManager: this.serviceManager\n    };\n  }\n};\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function AriaAnnouncerProvider(props) {\n  const intl = useIntl();\n  const {store: store} = useServiceManager();\n  const announcerRef = useRef();\n  const announcerFunction = useCallback(value => {\n    if (!announcerRef.current) {\n      setTimeout(() => announcerRef.current.announceValue(value));\n    } else {\n      announcerRef.current.announceValue(value);\n    }\n  }, []);\n  const previousAnnounceMessageRef = useRef();\n  useEffect(() => {\n    const unsubscribe = store.subscribe(() => {\n      const currentAnnounceMessage = store.getState().announceMessage;\n      if (currentAnnounceMessage !== previousAnnounceMessageRef.current) {\n        announcerFunction(currentAnnounceMessage);\n        previousAnnounceMessageRef.current = currentAnnounceMessage;\n      }\n    });\n    return unsubscribe;\n  }, [ store, announcerFunction ]);\n  return React.createElement(AriaAnnouncerContext.Provider, {\n    value: announcerFunction\n  }, props.children, React.createElement(AriaAnnouncerComponent, {\n    intl: intl,\n    ref: announcerRef\n  }));\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function useEffectDidUpdate(effect, deps) {\n  const hasRunRef = useRef(false);\n  useEffect(() => {\n    if (hasRunRef.current) {\n      return effect();\n    }\n    hasRunRef.current = true;\n    return undefined;\n  }, deps);\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function getLauncherButtonAriaLabel(languagePack, isLauncherHidden, isTourActive) {\n  if (isTourActive) {\n    return isLauncherHidden ? languagePack.launcher_isTourOpen : languagePack.launcher_isTourClosed;\n  }\n  return isLauncherHidden ? languagePack.launcher_isOpen : languagePack.launcher_isClosed;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function Launcher(props, ref) {\n  const {onToggleOpen: onToggleOpen, languagePack: languagePack, unreadAgentCount: unreadAgentCount, intl: intl, showUnreadIndicator: showUnreadIndicator, className: className, tabIndex: tabIndex, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const launcherAvatarURL = useSelector(state => state.theme.useAITheme ? undefined : state.launcher.config.desktop.avatar_url_override);\n  const useAITheme = useSelector(state => state.theme.useAITheme);\n  const buttonRef = React.createRef();\n  useImperativeHandle(ref, () => ({\n    requestFocus: () => {\n      doFocusRef(buttonRef);\n    }\n  }));\n  let ariaLabel = getLauncherButtonAriaLabel(languagePack, launcherHidden, activeTour);\n  if (unreadAgentCount !== 0) {\n    ariaLabel += `. ${intl.formatMessage({\n      id: \"icon_ariaUnreadMessages\"\n    }, {\n      count: unreadAgentCount\n    })}`;\n  }\n  let launcherAvatar = useAITheme ? React.createElement(AiLaunch, {\n    size: 24,\n    className: \"WACLauncher_svg\"\n  }) : React.createElement(ChatLaunch, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  });\n  if (launcherAvatarURL) {\n    launcherAvatar = React.createElement(\"img\", {\n      className: \"WACLauncher__Avatar\",\n      src: launcherAvatarURL,\n      alt: \"\",\n      \"aria-hidden\": true\n    });\n  }\n  return React.createElement(\"div\", {\n    className: cx(\"WACLauncher__ButtonContainer\", \"WACLauncher__ButtonContainer--round\", className, {\n      \"WACLauncher__ButtonContainer--hidden\": launcherHidden\n    })\n  }, React.createElement(Button, {\n    \"aria-label\": ariaLabel,\n    className: cx(\"WACLauncher__Button\", {\n      WACLauncher__TourButton: activeTour\n    }),\n    \"data-testid\": PageObjectId.LAUNCHER,\n    kind: ButtonKindEnum.PRIMARY,\n    type: \"button\",\n    onClick: onToggleOpen,\n    ref: buttonRef,\n    tabIndex: tabIndex\n  }, activeTour ? React.createElement(ArrowUpLeft, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  }) : launcherAvatar, (unreadAgentCount !== 0 || showUnreadIndicator) && React.createElement(\"div\", {\n    className: \"WAC__countIndicator\"\n  }, unreadAgentCount !== 0 ? unreadAgentCount : \"\")));\n}\n\nconst LauncherExport = forwardRef(Launcher);\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const Tag = createComponent({\n  tagName: \"cds-custom-tag\",\n  elementClass: CarbonTagElement,\n  react: React\n});\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const CloseIcon = carbonIconToReact(Close16);\n\nfunction LauncherComplex(props) {\n  const {languagePack: languagePack, intl: intl, launcherConfig: launcherConfig, launcherComplexRef: launcherComplexRef, launcherRef: launcherRef, onOpen: onOpen, onMinimize: onMinimize, unreadAgentCount: unreadAgentCount, showUnreadIndicator: showUnreadIndicator, desktopLauncherIsExpanded: desktopLauncherIsExpanded, launcherHidden: launcherHidden, activeTour: activeTour, className: className} = props;\n  const {launcher_desktopGreeting: launcher_desktopGreeting, launcher_closeButton: launcher_closeButton, launcher_ariaIsExpanded: launcher_ariaIsExpanded} = languagePack;\n  function getLauncherContent() {\n    if (launcherConfig.desktop.title) {\n      return launcherConfig.desktop.title;\n    }\n    return launcher_desktopGreeting;\n  }\n  const handleTagKeyDown = e => {\n    if (e.key === \"Enter\" || e.key === \" \") {\n      e.preventDefault();\n      onMinimize();\n    }\n  };\n  return React.createElement(\"div\", {\n    className: cx(\"WACLauncher__ButtonContainer\", \"WACLauncherComplex__Container\", className, {\n      \"WACLauncher__ButtonContainer--hidden\": launcherHidden\n    }),\n    ref: launcherComplexRef\n  }, React.createElement(\"button\", {\n    className: \"WACLauncherComplex__ContentButton\",\n    type: \"button\",\n    onClick: onOpen,\n    disabled: !desktopLauncherIsExpanded\n  }, React.createElement(\"div\", {\n    className: cx(\"WACWidget__textEllipsis\", {\n      WACLauncherComplex__Text: !launcherHidden\n    })\n  }, getLauncherContent())), React.createElement(LauncherExport, {\n    languagePack: languagePack,\n    intl: intl,\n    ref: launcherRef,\n    onToggleOpen: onOpen,\n    className: \"WACLauncherComplex__SmallLauncherContainer\",\n    unreadAgentCount: unreadAgentCount,\n    showUnreadIndicator: showUnreadIndicator,\n    launcherHidden: launcherHidden,\n    activeTour: activeTour\n  }), React.createElement(Tag, {\n    className: \"WACLauncher__CloseButton\",\n    \"aria-label\": launcher_ariaIsExpanded,\n    onClick: onMinimize,\n    onKeyDown: handleTagKeyDown,\n    tabIndex: desktopLauncherIsExpanded ? 0 : -1\n  }, React.createElement(CloseIcon, {\n    slot: \"icon\",\n    className: \"WACLauncher__CloseButtonIcon\"\n  }), launcher_closeButton));\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const TIME_FOR_MINIMIZE_ANIMATION = 400;\n\nconst TIME_FOR_BOUNCE_ANIMATION = 500;\n\nconst LauncherDesktopContainer = props => {\n  const {launcherRef: launcherRef, onDoToggle: onDoToggle, requestFocus: requestFocus, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const serviceManager = useServiceManager();\n  const languagePack = useLanguagePack();\n  const intl = useIntl();\n  const browserLauncherState = useSelector(state => state.persistedToBrowserStorage.launcherState);\n  const {desktopLauncherWasMinimized: desktopLauncherWasMinimized, desktopLauncherIsExpanded: desktopLauncherIsExpanded, bounceTurn: bounceTurn, showUnreadIndicator: showUnreadIndicator, viewState: viewState} = browserLauncherState;\n  const launcherState = useSelector(state => state.launcher);\n  const launcherConfig = launcherState.config;\n  const {time_to_expand: time_to_expand, new_expand_time: new_expand_time} = launcherConfig.desktop;\n  const isExpandedLauncherEnabled = launcherConfig.desktop.is_on;\n  const unreadAgentCount = useSelector(state => state.agentState.numUnreadMessages);\n  const [smallLauncherClassName, setSmallLauncherClassName] = useState(\"\");\n  const [complexLauncherClassName, setComplexLauncherClassName] = useState(\"\");\n  const launcherComplexRef = useRef();\n  const launcherHiddenRef = useRef();\n  launcherHiddenRef.current = launcherHidden;\n  const animateOnceVisible = useRef(false);\n  const bounceTurnRef = useRef();\n  bounceTurnRef.current = bounceTurn;\n  const animationStartTimerRef = useRef();\n  const animationFinishedTimerRef = useRef();\n  const firstBounceAnimationStartTimerRef = useRef();\n  const firstBounceAnimationFinishedTimerRef = useRef();\n  const secondBounceAnimationStartTimerRef = useRef();\n  const secondBounceAnimationFinishedTimerRef = useRef();\n  const determineLauncherHeight = useCallback(() => {\n    const expandedLauncherHeight = `${launcherComplexRef.current?.offsetHeight}px`;\n    if (launcherComplexRef.current?.style?.setProperty) {\n      launcherComplexRef.current.style.setProperty(\"--cds-chat-LAUNCHER-desktop-expanded-height\", expandedLauncherHeight);\n    }\n  }, []);\n  const startExpandLauncher = useCallback(() => {\n    if (!launcherHiddenRef.current) {\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"desktopLauncherIsExpanded\", true));\n      determineLauncherHeight();\n      setComplexLauncherClassName(\"WACLauncherComplex__Container--introAnimation\");\n    }\n  }, [ determineLauncherHeight, serviceManager.store ]);\n  const setExpandAnimationTimers = useCallback(() => {\n    animationStartTimerRef.current = setTimeout(() => {\n      startExpandLauncher();\n    }, time_to_expand);\n  }, [ time_to_expand, startExpandLauncher ]);\n  const clearExpandAnimationTimers = useCallback(() => {\n    clearTimeout(animationStartTimerRef.current);\n    clearTimeout(animationFinishedTimerRef.current);\n  }, []);\n  const startBounceAnimation = useCallback(() => {\n    if (!launcherHiddenRef.current) {\n      setSmallLauncherClassName(\"WACLauncher__ButtonContainer--bounceAnimation\");\n    }\n  }, []);\n  const finishBounceAnimation = useCallback(() => {\n    if (!launcherHiddenRef.current) {\n      setSmallLauncherClassName(\"WACLauncher__ButtonContainer--noAnimation\");\n      bounceTurnRef.current++;\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"bounceTurn\", bounceTurnRef.current));\n    }\n  }, [ serviceManager.store ]);\n  const setBounceAnimationTimers = useCallback(() => {\n    if (bounceTurnRef.current === 1) {\n      firstBounceAnimationStartTimerRef.current = setTimeout(() => {\n        startBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0]);\n      firstBounceAnimationFinishedTimerRef.current = setTimeout(() => {\n        finishBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0] + TIME_FOR_BOUNCE_ANIMATION);\n      secondBounceAnimationStartTimerRef.current = setTimeout(() => {\n        startBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0] + BOUNCING_ANIMATION_TIMEOUTS[1]);\n      secondBounceAnimationFinishedTimerRef.current = setTimeout(() => {\n        finishBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0] + BOUNCING_ANIMATION_TIMEOUTS[1] + TIME_FOR_BOUNCE_ANIMATION);\n    } else if (bounceTurnRef.current === 2) {\n      secondBounceAnimationStartTimerRef.current = setTimeout(() => {\n        startBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[1]);\n      secondBounceAnimationFinishedTimerRef.current = setTimeout(() => {\n        finishBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[1] + TIME_FOR_BOUNCE_ANIMATION);\n    }\n  }, [ finishBounceAnimation, startBounceAnimation ]);\n  const clearBounceAnimationTimers = useCallback(() => {\n    clearTimeout(firstBounceAnimationStartTimerRef.current);\n    clearTimeout(firstBounceAnimationFinishedTimerRef.current);\n    clearTimeout(secondBounceAnimationStartTimerRef.current);\n    clearTimeout(secondBounceAnimationFinishedTimerRef.current);\n  }, []);\n  const setDefaultLauncherState = useCallback(() => {\n    clearExpandAnimationTimers();\n    serviceManager.store.dispatch(actions.setLauncherMinimized());\n    clearBounceAnimationTimers();\n    serviceManager.store.dispatch(actions.setLauncherProperty(\"bounceTurn\", 3));\n    animateOnceVisible.current = false;\n    setSmallLauncherClassName(\"WACLauncher__ButtonContainer--noAnimation\");\n  }, [ clearBounceAnimationTimers, clearExpandAnimationTimers, serviceManager.store ]);\n  useOnMount(() => {\n    if (desktopLauncherIsExpanded) {\n      animateOnceVisible.current = true;\n    } else if (!desktopLauncherWasMinimized && isExpandedLauncherEnabled) {\n      setExpandAnimationTimers();\n      return () => {\n        clearExpandAnimationTimers();\n      };\n    } else if (desktopLauncherWasMinimized && bounceTurn !== 3) {\n      setBounceAnimationTimers();\n      return () => {\n        clearBounceAnimationTimers();\n      };\n    }\n    return undefined;\n  });\n  useEffect(() => {\n    if (viewState.launcher && animateOnceVisible.current) {\n      determineLauncherHeight();\n      setComplexLauncherClassName(\"WACLauncherComplex__Container--simpleAnimation\");\n      animateOnceVisible.current = false;\n    }\n  }, [ determineLauncherHeight, viewState.launcher ]);\n  useEffect(() => {\n    if (viewState.mainWindow || viewState.tour) {\n      setDefaultLauncherState();\n    }\n  }, [ viewState, setDefaultLauncherState ]);\n  useEffect(() => {\n    if (new_expand_time) {\n      clearBounceAnimationTimers();\n      clearExpandAnimationTimers();\n      setExpandAnimationTimers();\n      serviceManager.store.dispatch(actions.setLauncherConfigProperty(\"new_expand_time\", false, LauncherType.DESKTOP));\n    }\n  }, [ animationFinishedTimerRef, animationStartTimerRef, new_expand_time, setExpandAnimationTimers, clearExpandAnimationTimers, clearBounceAnimationTimers, serviceManager.store ]);\n  const prevLauncherTitle = usePrevious(launcherConfig.desktop.title);\n  useEffect(() => {\n    if (prevLauncherTitle !== launcherConfig.desktop.title && (launcherConfig.desktop.title || prevLauncherTitle)) {\n      determineLauncherHeight();\n    }\n  }, [ determineLauncherHeight, launcherConfig, prevLauncherTitle ]);\n  const onMinimize = useCallback(() => {\n    setComplexLauncherClassName(\"WACLauncherComplex__Container--closeAnimation\");\n    setTimeout(() => {\n      setSmallLauncherClassName(\"WACLauncher__ButtonContainer--noAnimation\");\n      serviceManager.store.dispatch(actions.setLauncherMinimized());\n      setTimeout(requestFocus);\n    }, TIME_FOR_MINIMIZE_ANIMATION);\n  }, [ requestFocus, serviceManager.store ]);\n  const onOpen = useCallback(() => {\n    setDefaultLauncherState();\n    onDoToggle();\n  }, [ onDoToggle, setDefaultLauncherState ]);\n  let launcher;\n  if (desktopLauncherIsExpanded) {\n    launcher = React.createElement(LauncherComplex, {\n      languagePack: languagePack,\n      intl: intl,\n      launcherComplexRef: launcherComplexRef,\n      launcherRef: launcherRef,\n      launcherConfig: launcherConfig,\n      onOpen: onOpen,\n      onMinimize: onMinimize,\n      unreadAgentCount: unreadAgentCount,\n      showUnreadIndicator: showUnreadIndicator,\n      desktopLauncherIsExpanded: desktopLauncherIsExpanded,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour,\n      className: complexLauncherClassName\n    });\n  } else {\n    launcher = React.createElement(LauncherExport, {\n      languagePack: languagePack,\n      intl: intl,\n      ref: launcherRef,\n      onToggleOpen: onOpen,\n      unreadAgentCount: unreadAgentCount,\n      showUnreadIndicator: showUnreadIndicator,\n      className: smallLauncherClassName,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour\n    });\n  }\n  return launcher;\n};\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function animateWithClass(element, className, endAnimationNameOrDelay, endAnimationCallback) {\n  if (element) {\n    element.classList.add(className);\n    if (typeof endAnimationNameOrDelay === \"number\") {\n      setTimeout(() => {\n        element.classList.remove(className);\n        if (endAnimationCallback) {\n          endAnimationCallback();\n        }\n      }, endAnimationNameOrDelay);\n    } else {\n      const listener = event => {\n        if (!endAnimationNameOrDelay || event.animationName === endAnimationNameOrDelay) {\n          element.removeEventListener(\"animationend\", listener);\n          element.removeEventListener(\"animationcancel\", listener);\n          element.classList.remove(className);\n          if (endAnimationCallback) {\n            endAnimationCallback();\n          }\n        }\n      };\n      element.addEventListener(\"animationend\", listener);\n      element.addEventListener(\"animationcancel\", listener);\n    }\n  }\n}\n\nfunction setAnimationTimeouts(element, animation, timeouts, options) {\n  const {startingIndex: startingIndex, beforeAll: beforeAll, afterAll: afterAll, beforeEach: beforeEach, afterEach: afterEach} = options;\n  let index = startingIndex || 0;\n  let terminate = false;\n  let timeoutID = null;\n  function playAnimation() {\n    if (beforeAll && index === 0) {\n      beforeAll();\n    }\n    const isComplete = index === timeouts.length;\n    if (!isComplete && !terminate) {\n      timeoutID = setTimeout(setAnimationListener, timeouts[index]);\n    } else if (isComplete && afterAll) {\n      afterAll();\n    }\n  }\n  function replayAnimation() {\n    if (afterEach) {\n      afterEach();\n    }\n    index++;\n    element.removeEventListener(\"animationend\", replayAnimation);\n    element.classList.remove(animation);\n    playAnimation();\n  }\n  function setAnimationListener() {\n    if (beforeEach) {\n      beforeEach();\n    }\n    element.addEventListener(\"animationend\", replayAnimation);\n    element.classList.add(animation);\n  }\n  playAnimation();\n  return () => {\n    terminate = true;\n    clearTimeout(timeoutID);\n    element.classList.remove(animation);\n    element.removeEventListener(\"animationend\", replayAnimation);\n  };\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const MAX_EXTENDED_LAUNCHER_WIDTH = 400;\n\nfunction LauncherExtended(props, ref) {\n  const {unreadAgentCount: unreadAgentCount, showUnreadIndicator: showUnreadIndicator, launcherConfig: launcherConfig, isExtended: isExtended, playExtendAnimation: playExtendAnimation, onToggleOpen: onToggleOpen, onSwipeRight: onSwipeRight, onReduceEnd: onReduceEnd, className: className, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const ariaAnnouncer = useAriaAnnouncer();\n  const languagePack = useLanguagePack();\n  const intl = useIntl();\n  const launcherAvatarURL = useSelector(state => state.theme.useAITheme ? undefined : state.launcher.config.mobile.avatar_url_override);\n  const [animateExtendedState, setAnimateExtendedState] = useState(playExtendAnimation);\n  const [showGreetingMessage, setShowGreetingMessage] = useState(false);\n  const prevIsExtended = usePrevious(isExtended);\n  const buttonRef = useRef();\n  const extendedContainerRef = useRef();\n  const greetingMessageRef = useRef();\n  const textHolderRef = useRef();\n  const touchStartRef = useRef({\n    touchStartX: null,\n    touchStartY: null\n  });\n  const shouldReduceExtendedLauncher = !isExtended && prevIsExtended;\n  const extendWithAnimation = isExtended && animateExtendedState;\n  const extendWithoutAnimation = isExtended && !animateExtendedState;\n  const launcherGreetingMessage = launcherConfig.mobile.title || languagePack.launcher_mobileGreeting;\n  let ariaLabel = getLauncherButtonAriaLabel(languagePack, launcherHidden, activeTour);\n  if (unreadAgentCount !== 0) {\n    ariaLabel += `. ${intl.formatMessage({\n      id: \"icon_ariaUnreadMessages\"\n    }, {\n      count: unreadAgentCount\n    })}`;\n  }\n  let launcherAvatar = React.createElement(ChatLaunch, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  });\n  if (launcherAvatarURL) {\n    launcherAvatar = React.createElement(\"img\", {\n      className: \"WACLauncher__Avatar\",\n      src: launcherAvatarURL,\n      \"aria-hidden\": true,\n      alt: \"\"\n    });\n  }\n  useImperativeHandle(ref, () => ({\n    requestFocus: () => {\n      doFocusRef(buttonRef);\n    },\n    launcherContainerElement: () => extendedContainerRef.current\n  }));\n  useEffect(() => {\n    const textHolderElement = textHolderRef.current;\n    const greetingMessageElement = greetingMessageRef.current;\n    const extendedContainerElement = extendedContainerRef.current;\n    calculateAndSetMaxExtendedLauncherWidth(textHolderElement, greetingMessageElement, extendedContainerElement);\n  }, [ ariaAnnouncer, extendWithoutAnimation, launcherGreetingMessage ]);\n  useEffect(() => {\n    if (isExtended) {\n      if (animateExtendedState) {\n        doFadeAnimationForElements({\n          fadeInElement: greetingMessageRef.current,\n          fadeInTime: 300\n        }, () => {\n          setAnimateExtendedState(false);\n        });\n      } else {\n        setShowGreetingMessage(true);\n      }\n      const buttonEl = buttonRef.current;\n      const handleTouchMove = event => {\n        checkIfUserSwipedRight(event.touches[0], touchStartRef.current, onSwipeRight);\n      };\n      const handleTouchStart = event => {\n        const {clientX: clientX, clientY: clientY} = event.touches[0];\n        const touchStart = touchStartRef.current;\n        touchStart.touchStartX = clientX;\n        touchStart.touchStartY = clientY;\n        buttonRef.current.addEventListener(\"touchmove\", handleTouchMove);\n      };\n      buttonEl.addEventListener(\"touchstart\", handleTouchStart);\n      return () => {\n        buttonEl.removeEventListener(\"touchmove\", handleTouchMove);\n        buttonEl.removeEventListener(\"touchstart\", handleTouchStart);\n      };\n    } else if (shouldReduceExtendedLauncher) {\n      const reduceAnimationEndListener = () => {\n        onReduceEnd();\n        setAnimateExtendedState(true);\n        extendedContainerRef.current.removeEventListener(\"animationend\", reduceAnimationEndListener);\n      };\n      extendedContainerRef.current.addEventListener(\"animationend\", reduceAnimationEndListener);\n      doFadeAnimationForElements({\n        fadeOutElement: greetingMessageRef.current\n      });\n    }\n    return undefined;\n  }, [ animateExtendedState, ariaAnnouncer, isExtended, launcherGreetingMessage, onReduceEnd, onSwipeRight, shouldReduceExtendedLauncher ]);\n  return React.createElement(\"div\", {\n    className: cx(\"WACLauncher__ButtonContainer WACLauncher__ButtonContainer--round WACLauncherExtended__Container\", className, {\n      \"WACLauncher__ButtonContainer--hidden\": launcherHidden,\n      \"WACLauncherExtended__Button--extended\": extendWithoutAnimation,\n      \"WACLauncherExtended__Button--extendedAnimation\": extendWithAnimation,\n      \"WACLauncherExtended__Button--reducedAnimation\": shouldReduceExtendedLauncher\n    }),\n    ref: extendedContainerRef\n  }, React.createElement(Button, {\n    \"aria-label\": ariaLabel,\n    className: cx(\"WACLauncher__Button\", \"WACLauncherExtended__Button\", {\n      WACLauncher__TourButton: activeTour\n    }),\n    kind: activeTour ? ButtonKindEnum.GHOST : ButtonKindEnum.PRIMARY,\n    type: \"button\",\n    ref: buttonRef,\n    onClick: onToggleOpen\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__WrapperContainer\"\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__Wrapper\"\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__TextHolder\",\n    ref: textHolderRef\n  }, React.createElement(\"div\", {\n    className: cx(\"WACLauncherExtended__Greeting\", {\n      \"WACLauncherExtended__Element--hidden\": !showGreetingMessage\n    }),\n    ref: greetingMessageRef\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__GreetingText\",\n    \"aria-hidden\": !isExtended\n  }, launcherGreetingMessage))), React.createElement(\"div\", {\n    className: \"WACLauncher__IconHolder\"\n  }, activeTour ? React.createElement(ArrowUpLeft, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  }) : launcherAvatar))), (unreadAgentCount !== 0 || showUnreadIndicator) && React.createElement(\"div\", {\n    className: \"WAC__countIndicator\"\n  }, unreadAgentCount !== 0 ? unreadAgentCount : \"\")));\n}\n\nfunction calculateAndSetMaxExtendedLauncherWidth(textHolderEl, greetingMessageEl, extendedContainerEl) {\n  const nonTextSpace = 68;\n  const maxLauncherExtendedWidth = getMaxLauncherExtendedWidth();\n  const maxTextHolderWidth = maxLauncherExtendedWidth - nonTextSpace + 12;\n  textHolderEl.style.setProperty(\"width\", `${maxTextHolderWidth}px`);\n  greetingMessageEl.style.setProperty(\"width\", `${maxTextHolderWidth - 12}px`);\n  greetingMessageEl.style.setProperty(\"display\", \"flex\");\n  const {clientWidth: clientWidth} = greetingMessageEl.querySelector(\".WACLauncherExtended__GreetingText\");\n  let launcherExtendedWidth = clientWidth + nonTextSpace + 1;\n  if (launcherExtendedWidth > MAX_EXTENDED_LAUNCHER_WIDTH) {\n    launcherExtendedWidth = MAX_EXTENDED_LAUNCHER_WIDTH;\n  }\n  greetingMessageEl.removeAttribute(\"style\");\n  textHolderEl.removeAttribute(\"style\");\n  extendedContainerEl.style.setProperty(\"--cds-chat--LAUNCHER-EXTENDED-width\", `${launcherExtendedWidth}px`);\n}\n\nfunction doFadeAnimationForElements({fadeOutElement: fadeOutElement, fadeInElement: fadeInElement, fadeInTime: fadeInTime = 600}, callback) {\n  if (fadeOutElement) {\n    fadeOutElement.classList.remove(\"WACLauncherExtended__Element--hidden\");\n    animateWithClass(fadeOutElement, \"WACLauncherExtended__Element--FadeOut\", 500, () => {\n      fadeOutElement.classList.add(\"WACLauncherExtended__Element--hidden\");\n      fadeOutElement.classList.remove(\"WACLauncherExtended__Element--FadeOut\");\n      if (!fadeInElement && callback) {\n        callback();\n      }\n    });\n  }\n  if (fadeInElement) {\n    setTimeout(() => {\n      fadeInElement.classList.remove(\"WACLauncherExtended__Element--hidden\");\n      animateWithClass(fadeInElement, \"WACLauncherExtended__Element--FadeIn\", 600, () => {\n        fadeInElement.classList.remove(\"WACLauncherExtended__Element--FadeIn\");\n        if (callback) {\n          callback();\n        }\n      });\n    }, fadeInTime);\n  }\n}\n\nfunction checkIfUserSwipedRight(touchList, touchStartCoordinates, callback) {\n  const {touchStartX: touchStartX, touchStartY: touchStartY} = touchStartCoordinates;\n  if (touchStartX === null || touchStartY === null) {\n    return;\n  }\n  const {clientX: touchEndX, clientY: touchEndY} = touchList;\n  const differenceX = touchEndX - touchStartX;\n  const differenceY = touchEndY - touchStartY;\n  if (Math.abs(differenceX) > Math.abs(differenceY)) {\n    if (differenceX > 0) {\n      callback();\n    }\n  }\n  touchStartCoordinates.touchStartX = null;\n  touchStartCoordinates.touchStartY = null;\n}\n\nfunction getMaxLauncherExtendedWidth() {\n  const launcherPosition = IS_MOBILE ? 32 : 64;\n  const {width: width, height: height} = window.screen;\n  const lowestValue = Math.min(height, width);\n  const extendedWidth = lowestValue - launcherPosition;\n  return Math.min(extendedWidth, MAX_EXTENDED_LAUNCHER_WIDTH);\n}\n\nconst LauncherExtendedExport = React.memo(forwardRef(LauncherExtended));\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function LauncherMobileContainer(props) {\n  const {launcherRef: launcherRef, onToggleOpen: onToggleOpen, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const serviceManager = useServiceManager();\n  const {config: launcherConfig} = useSelector(state => state.launcher);\n  const unreadAgentCount = useSelector(state => state.agentState.numUnreadMessages);\n  const {mobileLauncherIsExtended: isExtended, mobileLauncherWasReduced: wasReduced, mobileLauncherDisableBounce: disableBounce, bounceTurn: bounceTurn, showUnreadIndicator: showUnreadIndicator, viewState: viewState} = useSelector(state => state.persistedToBrowserStorage.launcherState);\n  const [isStartingBounceAnimation, setIsStartingBounceAnimation] = useState(false);\n  const prevIsExtended = usePrevious(isExtended);\n  const prevWasReduced = usePrevious(wasReduced);\n  const initialBounceTurn = useRef(bounceTurn).current;\n  const previouslyPlayedExtendAnimation = useRef(wasReduced).current;\n  const extendLauncherTimeoutIDRef = useRef(null);\n  const reduceLauncherTimeoutIDRef = useRef(null);\n  const endBounceAnimationRef = useRef(null);\n  const shouldBounceRef = useRef(previouslyPlayedExtendAnimation && !disableBounce);\n  const {time_to_expand: time_to_expand, new_expand_time: new_expand_time, time_to_reduce: time_to_reduce} = launcherConfig.mobile;\n  const isExpandedLauncherEnabled = launcherConfig.mobile.is_on;\n  const playExtendAnimation = prevIsExtended === undefined && !isExtended;\n  const isExtending = prevIsExtended !== undefined && !prevIsExtended && isExtended;\n  const hasReduced = prevWasReduced !== undefined && !prevWasReduced && wasReduced;\n  const disableIntroAnimation = isExtending || hasReduced || isStartingBounceAnimation;\n  const setLauncherStateAsReduced = useCallback(() => {\n    if (!wasReduced) {\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherWasReduced\", true));\n    }\n  }, [ wasReduced, serviceManager ]);\n  const reduceLauncher = useCallback(() => {\n    clearTimeouts();\n    if (isExtended) {\n      document.removeEventListener(\"scroll\", reduceLauncher);\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherIsExtended\", false));\n    }\n  }, [ isExtended, serviceManager ]);\n  const setExpandAnimationTimeout = useCallback(() => {\n    extendLauncherTimeoutIDRef.current = setTimeout(() => {\n      if (!isExtended && !isExtending) {\n        serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherWasReduced\", false));\n        serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherIsExtended\", true));\n      }\n    }, time_to_expand);\n  }, [ isExtended, isExtending, serviceManager.store, time_to_expand ]);\n  const setDefaultLauncherState = useCallback(() => {\n    const endBounceAnimation = endBounceAnimationRef.current;\n    if (endBounceAnimation) {\n      endBounceAnimation();\n      endBounceAnimationRef.current = null;\n    }\n    serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherDisableBounce\", true));\n    reduceLauncher();\n    setLauncherStateAsReduced();\n  }, [ reduceLauncher, serviceManager.store, setLauncherStateAsReduced ]);\n  useOnMount(() => {\n    if (!wasReduced && playExtendAnimation && isExpandedLauncherEnabled) {\n      setExpandAnimationTimeout();\n    } else if (shouldBounceRef.current) {\n      const launcherContainerElement = launcherRef?.current?.launcherContainerElement();\n      if (launcherContainerElement) {\n        const startRecurringBounceAnimation = () => {\n          if (shouldBounceRef.current) {\n            let turnCounter = initialBounceTurn;\n            launcherContainerElement.removeEventListener(\"animationend\", startRecurringBounceAnimation);\n            setIsStartingBounceAnimation(true);\n            endBounceAnimationRef.current = setAnimationTimeouts(launcherContainerElement, \"WACLauncher__ButtonContainer--bounceAnimation\", BOUNCING_ANIMATION_TIMEOUTS, {\n              startingIndex: initialBounceTurn - 1,\n              afterEach: () => {\n                turnCounter++;\n                serviceManager.store.dispatch(actions.setLauncherProperty(\"bounceTurn\", turnCounter));\n              },\n              afterAll: () => {\n                serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherDisableBounce\", true));\n              }\n            });\n          }\n        };\n        launcherContainerElement.addEventListener(\"animationend\", startRecurringBounceAnimation);\n      }\n    }\n  });\n  useEffect(() => {\n    if (viewState.mainWindow || viewState.tour) {\n      setDefaultLauncherState();\n    }\n  }, [ viewState, setDefaultLauncherState ]);\n  useEffect(() => {\n    if (new_expand_time) {\n      if (shouldBounceRef.current) {\n        shouldBounceRef.current = false;\n      }\n      const endBounceAnimation = endBounceAnimationRef.current;\n      if (endBounceAnimation) {\n        endBounceAnimation();\n        endBounceAnimationRef.current = null;\n      }\n      if (extendLauncherTimeoutIDRef.current) {\n        clearTimeout(extendLauncherTimeoutIDRef.current);\n      }\n      setExpandAnimationTimeout();\n      serviceManager.store.dispatch(actions.setLauncherConfigProperty(\"new_expand_time\", false, LauncherType.MOBILE));\n    }\n  }, [ setExpandAnimationTimeout, new_expand_time, serviceManager.store, shouldBounceRef ]);\n  function clearTimeouts() {\n    const extendLauncherTimeoutID = extendLauncherTimeoutIDRef.current;\n    const reduceLauncherTimeoutID = reduceLauncherTimeoutIDRef.current;\n    if (reduceLauncherTimeoutID) {\n      clearTimeout(reduceLauncherTimeoutID);\n      reduceLauncherTimeoutIDRef.current = null;\n    }\n    if (extendLauncherTimeoutID) {\n      clearTimeout(extendLauncherTimeoutID);\n      extendLauncherTimeoutIDRef.current = null;\n    }\n  }\n  const handleToggleOpen = useCallback(() => {\n    setDefaultLauncherState();\n    onToggleOpen();\n  }, [ onToggleOpen, setDefaultLauncherState ]);\n  const handleSwipeRight = useCallback(() => {\n    reduceLauncher();\n  }, [ reduceLauncher ]);\n  useEffect(() => {\n    if (isExtended) {\n      reduceLauncherTimeoutIDRef.current = setTimeout(() => {\n        reduceLauncher();\n      }, time_to_reduce);\n      document.addEventListener(\"scroll\", reduceLauncher);\n    }\n  }, [ isExtended, reduceLauncher, time_to_reduce, serviceManager ]);\n  return React.createElement(LauncherExtendedExport, {\n    className: cx({\n      \"WACLauncher__ButtonContainer--noAnimation\": disableIntroAnimation\n    }),\n    ref: launcherRef,\n    launcherConfig: launcherConfig,\n    showUnreadIndicator: showUnreadIndicator,\n    unreadAgentCount: unreadAgentCount,\n    isExtended: isExtended,\n    playExtendAnimation: playExtendAnimation,\n    onToggleOpen: handleToggleOpen,\n    onSwipeRight: handleSwipeRight,\n    onReduceEnd: setLauncherStateAsReduced,\n    launcherHidden: launcherHidden,\n    activeTour: activeTour\n  });\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function LauncherContainer() {\n  const serviceManager = useServiceManager();\n  const launcherRef = useRef();\n  const viewState = useSelector(state => state.persistedToBrowserStorage.launcherState.viewState);\n  const initialViewChangeComplete = useSelector(state => state.initialViewChangeComplete);\n  const launcherHidden = !viewState.launcher;\n  const activeTour = useSelector(state => state.persistedToBrowserStorage.launcherState.activeTour);\n  const requestFocus = useCallback(() => {\n    launcherRef.current?.requestFocus();\n  }, [ launcherRef ]);\n  const onDoToggle = useCallback(() => {\n    if (activeTour) {\n      return serviceManager.actions.changeView(ViewType.TOUR, {\n        viewChangeReason: ViewChangeReason.LAUNCHER_CLICKED\n      });\n    }\n    return serviceManager.actions.changeView(ViewType.MAIN_WINDOW, {\n      mainWindowOpenReason: MainWindowOpenReason.DEFAULT_LAUNCHER\n    });\n  }, [ activeTour, serviceManager.actions ]);\n  useEffectDidUpdate(() => {\n    if (viewState.launcher && !viewState.mainWindow && !viewState.tour && initialViewChangeComplete) {\n      launcherRef.current?.requestFocus();\n    }\n  }, [ viewState ]);\n  let launcherContainer;\n  if (IS_PHONE) {\n    launcherContainer = React.createElement(LauncherMobileContainer, {\n      launcherRef: launcherRef,\n      onToggleOpen: onDoToggle,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour\n    });\n  } else {\n    launcherContainer = React.createElement(LauncherDesktopContainer, {\n      launcherRef: launcherRef,\n      onDoToggle: onDoToggle,\n      requestFocus: requestFocus,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour\n    });\n  }\n  return launcherContainer;\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function HydrationPanel({onClose: onClose, languagePack: languagePack, isHydrated: isHydrated, headerDisplayName: headerDisplayName, useHomeScreenVersion: useHomeScreenVersion}) {\n  const isHidden = useContext(HideComponentContext);\n  let header;\n  if (useHomeScreenVersion) {\n    header = React.createElement(HomeScreenHeaderExport, {\n      onClose: onClose\n    });\n  } else {\n    header = React.createElement(BotHeaderExport, {\n      onClose: onClose,\n      headerDisplayName: headerDisplayName,\n      onToggleHomeScreen: null,\n      includeWriteableElement: false,\n      testIdPrefix: OverlayPanelName.HYDRATING\n    });\n  }\n  return React.createElement(\"div\", {\n    className: \"WAC WAC__hydratingContainer\"\n  }, header, React.createElement(\"div\", {\n    className: cx(\"WAC__hydrating\", \"WACPanelContent\", {\n      \"WAC__hydrating--homeScreen\": useHomeScreenVersion\n    })\n  }, !isHidden && React.createElement(MountChildrenOnDelay, {\n    delay: 400\n  }, !isHydrated && React.createElement(AnnounceOnMountComponentExport, {\n    announceOnce: languagePack.window_ariaWindowLoading\n  }), React.createElement(Loading, {\n    active: true,\n    overlay: false,\n    assistiveText: languagePack.window_ariaWindowLoading\n  }))));\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function CustomPanel(props) {\n  const {useAITheme: useAITheme, onPanelOpenEnd: onPanelOpenEnd, onPanelCloseEnd: onPanelCloseEnd, onPanelOpenStart: onPanelOpenStart, onPanelCloseStart: onPanelCloseStart, onClose: onClose, onCloseAndRestart: onCloseAndRestart, onClickRestart: onClickRestart} = props;\n  const languagePack = useLanguagePack();\n  const {isOpen: isOpen, options: options} = useSelector(state => state.customPanelState);\n  const {title: title, hidePanelHeader: hidePanelHeader, disableDefaultCloseAction: disableDefaultCloseAction, disableAnimation: disableAnimation, onClickBack: onClickBack, onClickClose: onClickClose, onClickCloseAndRestart: onClickCloseAndRestart} = options;\n  const serviceManager = useServiceManager();\n  const ariaAnnouncer = useAriaAnnouncer();\n  const prevIsOpen = usePrevious(isOpen);\n  const openAnimation = disableAnimation ? AnimationInType.NONE : AnimationInType.SLIDE_IN_FROM_BOTTOM;\n  const closeAnimation = disableAnimation ? AnimationOutType.NONE : AnimationOutType.SLIDE_OUT_TO_BOTTOM;\n  useEffect(() => {\n    if (prevIsOpen !== isOpen && isOpen) {\n      if (!hidePanelHeader && title) {\n        ariaAnnouncer(title);\n      }\n    }\n  }, [ ariaAnnouncer, hidePanelHeader, isOpen, prevIsOpen, title ]);\n  const onClickBackLocal = useCallback(() => {\n    serviceManager.store.dispatch(actions.setCustomPanelOpen(false));\n    onClickBack?.();\n  }, [ serviceManager, onClickBack ]);\n  const onClickCloseLocal = useCallback(() => {\n    if (!disableDefaultCloseAction) {\n      checkAllowClose(serviceManager.store.getState().viewChanging);\n      onClose();\n    }\n    onClickClose?.();\n  }, [ disableDefaultCloseAction, onClickClose, onClose, serviceManager ]);\n  const onCloseAndRestartLocal = useCallback(() => {\n    if (!disableDefaultCloseAction) {\n      checkAllowClose(serviceManager.store.getState().viewChanging);\n      onCloseAndRestart();\n    }\n    onClickCloseAndRestart?.();\n  }, [ disableDefaultCloseAction, onClickCloseAndRestart, onCloseAndRestart, serviceManager ]);\n  return React.createElement(OverlayPanel, {\n    className: \"WAC__overlay--covering\",\n    onOpenStart: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_PRE_OPEN\n      }, serviceManager.instance);\n      onPanelOpenStart();\n    },\n    onOpenEnd: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_OPEN\n      }, serviceManager.instance);\n      onPanelOpenEnd();\n    },\n    onCloseStart: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_PRE_CLOSE\n      }, serviceManager.instance);\n      onPanelCloseStart();\n    },\n    onCloseEnd: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_CLOSE\n      }, serviceManager.instance);\n      onPanelCloseEnd();\n      serviceManager.store.dispatch(actions.setCustomPanelConfigOptions(DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS));\n    },\n    animationOnOpen: openAnimation,\n    animationOnClose: closeAnimation,\n    shouldOpen: isOpen,\n    serviceManager: serviceManager,\n    overlayPanelName: OverlayPanelName.CUSTOM\n  }, React.createElement(BasePanelComponentExport, {\n    className: \"WACCustomPanel\",\n    eventName: \"Custom panel opened\",\n    eventDescription: \"A user opened a custom panel.\",\n    labelBackButton: languagePack.general_returnToAssistant,\n    isOpen: isOpen,\n    title: title,\n    useAITheme: useAITheme,\n    onClickBack: onClickBackLocal,\n    onClickClose: onClickCloseLocal,\n    onClickCloseAndRestart: onCloseAndRestartLocal,\n    onClickRestart: onClickRestart,\n    hidePanelHeader: hidePanelHeader,\n    hideBackButton: options.hideBackButton,\n    hideCloseButton: options.hideCloseButton,\n    hideCloseAndRestartButton: options.hideCloseAndRestartButton,\n    testIdPrefix: OverlayPanelName.CUSTOM\n  }, React.createElement(WriteableElement, {\n    slotName: \"customPanelElement\",\n    className: \"WACCustomPanel__ContentContainer\"\n  })));\n}\n\nfunction checkAllowClose(viewChanging) {\n  if (viewChanging) {\n    const message = \"You are attempting to close Carbon AI chat from a custom panel while Carbon AI chat is currently running a view\" + \" change event which is not permitted. Please use the disableDefaultCloseAction option to disable\" + \" this behavior for the custom panel and then use onClickClose to resolve your Promise that is handling\" + \" the event; that Promise will allow you to close Carbon AI chat.\";\n    consoleError(message);\n    throw new Error(message);\n  }\n}\n\nconst CustomPanelExport = React.memo(CustomPanel);\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function addClassNameToState(name) {\n  return previousState => {\n    const currentIndex = previousState.extraClassNames.indexOf(name);\n    if (currentIndex === -1) {\n      return {\n        extraClassNames: [ ...previousState.extraClassNames, name ]\n      };\n    }\n    return null;\n  };\n}\n\nfunction removeClassNameFromState(name) {\n  return previousState => ({\n    extraClassNames: previousState.extraClassNames.filter(value => value !== name)\n  });\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const Chat = lazyChat();\n\nconst CatastrophicError = lazyCatastrophicError();\n\nconst Disclaimer = lazyDisclaimer();\n\nconst HomeScreenContainer = lazyHomeScreenContainer();\n\nconst IFramePanel = lazyIFramePanel();\n\nconst ViewSourcePanel = lazyViewSourcePanel();\n\nconst BodyAndFooterPanelComponent = lazyBodyAndFooterPanelComponent();\n\nconst WIDTH_BREAKPOINT_STANDARD = \"WAC--standardWidth\";\n\nconst WIDTH_BREAKPOINT_NARROW = \"WAC--narrowWidth\";\n\nconst WIDTH_BREAKPOINT_WIDE = \"WAC--wideWidth\";\n\nclass MainWindow extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      closing: false,\n      open: this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow,\n      modalPortalHostElement: null,\n      numPanelsOpen: 0,\n      numPanelsAnimating: 0,\n      numPanelsCovering: 0,\n      isHydrationAnimationComplete: this.props.isHydrated,\n      shouldAutoFocus: this.props.config.public.shouldTakeFocusIfOpensAutomatically,\n      extraClassNames: [],\n      areModulesLoaded: false\n    };\n    this.mainWindowRef = React.createRef();\n    this.containerRef = React.createRef();\n    this.botChatRef = React.createRef();\n    this.homeScreenInputRef = React.createRef();\n    this.disclaimerRef = React.createRef();\n    this.brandingRef = React.createRef();\n    this.animationContainerRef = React.createRef();\n    this.iframePanelRef = React.createRef();\n    this.viewSourcePanelRef = React.createRef();\n    this.previousBodyVisibility = undefined;\n    this.previousBodyPosition = undefined;\n    this.onResize = () => {\n      let appChatWidthBreakpoint;\n      const height = this.containerRef?.current?.offsetHeight;\n      const width = this.containerRef?.current?.offsetWidth;\n      if (width >= 672 + 16 + 16) {\n        appChatWidthBreakpoint = ChatWidthBreakpoint.WIDE;\n      } else if (width >= 360) {\n        appChatWidthBreakpoint = ChatWidthBreakpoint.STANDARD;\n      } else {\n        appChatWidthBreakpoint = ChatWidthBreakpoint.NARROW;\n      }\n      this.props.serviceManager.store.dispatch(actions.setAppStateValue(\"chatWidth\", width));\n      this.props.serviceManager.store.dispatch(actions.setAppStateValue(\"chatHeight\", height));\n      this.props.serviceManager.store.dispatch(actions.setAppStateValue(\"chatWidthBreakpoint\", appChatWidthBreakpoint));\n    };\n    this.onVisualViewportResize = () => {\n      this.updateFromVisualViewport();\n    };\n    this.updateFromVisualViewport = () => {\n      const element = this.props.serviceManager.container;\n      const {visualViewport: visualViewport} = window;\n      if (visualViewport) {\n        element.style.setProperty(\"--cds-chat-viewport-height\", `${visualViewport.height}px`);\n        element.style.setProperty(\"--cds-chat-viewport-width\", `${visualViewport.width}px`);\n        element.style.setProperty(\"--cds-chat-viewport-offsetTop\", `${visualViewport.offsetTop}px`);\n        element.style.setProperty(\"--cds-chat-viewport-offsetLeft\", `${visualViewport.offsetLeft}px`);\n      } else {\n        const height = \"100vh\";\n        element.style.setProperty(\"--cds-chat-viewport-height\", height);\n        element.style.setProperty(\"--cds-chat-viewport-width\", \"100vw\");\n        element.style.setProperty(\"--cds-chat-viewport-offsetTop\", \"0\");\n        element.style.setProperty(\"--cds-chat-viewport-offsetLeft\", \"0\");\n      }\n    };\n    this.setModalPortalHostElement = ref => {\n      if (this.state.modalPortalHostElement !== ref) {\n        this.setState({\n          modalPortalHostElement: ref\n        });\n      }\n    };\n    this.onSendInput = async (text, source, options) => {\n      const isInputToAgent = selectIsInputToAgent(this.props);\n      const {serviceManager: serviceManager} = this.props;\n      const state = serviceManager.store.getState();\n      const {files: files} = selectInputState(state);\n      if (isInputToAgent) {\n        serviceManager.humanAgentService.sendMessageToAgent(text, files);\n      } else {\n        const messageRequest = createMessageRequestForText(text);\n        serviceManager.actions.sendWithCatch(messageRequest, source, {\n          ...options\n        });\n      }\n      if (files.length) {\n        serviceManager.store.dispatch(actions.clearInputFiles(isInputToAgent));\n      }\n    };\n    this.onSendHomeButtonInput = input => {\n      const messageRequest = createMessageRequestForChoice(input);\n      this.props.serviceManager.actions.sendWithCatch(messageRequest, MessageSendSource.HOME_SCREEN_STARTER);\n    };\n    this.removeChatFromDom = () => {\n      this.containerRef.current.removeEventListener(\"animationend\", this.removeChatFromDom);\n      this.setState({\n        open: false,\n        closing: false\n      });\n    };\n    this.onRestart = async () => {\n      await this.props.serviceManager.actions.restartConversation();\n      this.requestFocus();\n    };\n    this.onClose = async () => this.doClose(false);\n    this.onCloseAndRestart = async () => this.doClose(true);\n    this.onToggleHomeScreen = () => {\n      this.props.serviceManager.store.dispatch(actions.toggleHomeScreen());\n    };\n    this.requestFocus = () => {\n      try {\n        if (this.state.shouldAutoFocus && !IS_MOBILE) {\n          if (this.getShowDisclaimer()) {\n            if (this.disclaimerRef.current) {\n              doFocusRef(this.disclaimerRef);\n            }\n          } else if (this.getShowHomeScreen()) {\n            if (this.homeScreenInputRef.current) {\n              this.homeScreenInputRef.current.takeFocus();\n            }\n          } else if (this.props.iFramePanelState.isOpen) {\n            if (this.iframePanelRef.current) {\n              this.iframePanelRef.current.requestFocus();\n            }\n          } else if (this.botChatRef.current) {\n            this.botChatRef.current.requestInputFocus();\n          }\n        }\n      } catch (error) {\n        consoleError(\"An error occurred in MainWindow.requestFocus\", error);\n      }\n    };\n    this.onUserTyping = isTyping => {\n      if (this.props.serviceManager.store.getState().persistedToBrowserStorage.chatState.agentState.isConnected) {\n        this.props.serviceManager.humanAgentService.userTyping(isTyping);\n      }\n    };\n    this.onAcceptDisclaimer = () => {\n      this.props.serviceManager.store.dispatch(actions.acceptDisclaimer());\n    };\n    this.onPanelOpenStart = coverBackground => {\n      this.setState(prevState => ({\n        numPanelsOpen: prevState.numPanelsOpen + 1,\n        numPanelsAnimating: prevState.numPanelsAnimating + 1,\n        numPanelsCovering: prevState.numPanelsCovering + (coverBackground ? 1 : 0)\n      }), this.requestFocus);\n    };\n    this.onPanelOpenEnd = () => {\n      this.setState(prevState => ({\n        numPanelsAnimating: prevState.numPanelsAnimating - 1\n      }));\n    };\n    this.onPanelCloseStart = () => {\n      this.setState(prevState => ({\n        numPanelsAnimating: prevState.numPanelsAnimating + 1\n      }), this.requestFocus);\n    };\n    this.onPanelCloseEnd = coverBackground => {\n      this.setState(prevState => ({\n        numPanelsOpen: prevState.numPanelsOpen - 1,\n        numPanelsAnimating: prevState.numPanelsAnimating - 1,\n        numPanelsCovering: prevState.numPanelsCovering - (coverBackground ? 1 : 0)\n      }));\n    };\n    this.onHydrationPanelClose = () => {\n      this.setState({\n        isHydrationAnimationComplete: true\n      }, this.requestFocus);\n    };\n  }\n  componentDidMount() {\n    const {persistedToBrowserStorage: persistedToBrowserStorage, config: config, serviceManager: serviceManager, mainWindowRef: mainWindowRef} = this.props;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    const {public: publicConfig} = config;\n    serviceManager.mainWindow = this;\n    mainWindowRef.current = this;\n    this.mainWindowObserver = new ResizeObserver(this.onResize);\n    this.mainWindowObserver.observe(this.containerRef.current);\n    if (IS_MOBILE && !publicConfig.disableCustomElementMobileEnhancements) {\n      const {visualViewport: visualViewport} = window;\n      if (visualViewport) {\n        visualViewport.addEventListener(\"resize\", this.onVisualViewportResize);\n        visualViewport.addEventListener(\"scroll\", this.updateFromVisualViewport);\n      }\n      this.updateFromVisualViewport();\n      this.updateBody(false);\n    }\n    this.containerRef.current.style.setProperty(\"--cds-chat-scrollbar-width\", `${SCROLLBAR_WIDTH()}px`);\n    if (viewState.mainWindow) {\n      this.loadPanels();\n    }\n  }\n  componentWillUnmount() {\n    this.mainWindowObserver.unobserve(this.containerRef.current);\n  }\n  destroy() {\n    if (IS_MOBILE && !this.props.config.public.disableCustomElementMobileEnhancements) {\n      const {visualViewport: visualViewport} = window;\n      if (visualViewport) {\n        visualViewport.removeEventListener(\"resize\", this.onVisualViewportResize);\n        visualViewport.removeEventListener(\"scroll\", this.updateFromVisualViewport);\n      }\n    }\n    this.updateBody(true);\n  }\n  componentDidUpdate(oldProps, oldState) {\n    const newProps = this.props;\n    const newState = this.state;\n    const {persistedToBrowserStorage: persistedToBrowserStorage, useCustomHostElement: useCustomHostElement, isDestroyed: isDestroyed} = newProps;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    const {open: open} = newState;\n    const prevViewState = oldProps.persistedToBrowserStorage.launcherState.viewState;\n    if (viewState.mainWindow !== prevViewState.mainWindow) {\n      this.updateBody(false);\n      this.updateFromVisualViewport();\n    }\n    if (isDestroyed && !oldProps.isDestroyed) {\n      this.destroy();\n    }\n    if ((oldState.areModulesLoaded !== newState.areModulesLoaded || oldProps.isHydrated !== newProps.isHydrated) && newProps.isHydrated && newState.areModulesLoaded) {\n      this.setState({\n        isHydrationAnimationComplete: true\n      }, () => {\n        requestAnimationFrame(() => {\n          this.requestFocus();\n        });\n      });\n    }\n    if (viewState.mainWindow && (!prevViewState.mainWindow || !open)) {\n      this.setState({\n        open: true\n      }, () => {\n        this.requestFocus();\n      });\n      this.loadPanels();\n    } else if (!viewState.mainWindow && prevViewState.mainWindow && oldState.open && open) {\n      this.setState({\n        closing: true\n      });\n      if (useCustomHostElement) {\n        this.removeChatFromDom();\n      } else {\n        this.containerRef.current.addEventListener(\"animationend\", this.removeChatFromDom);\n        this.requestFocus();\n      }\n    }\n    if (newProps.config.public.shouldTakeFocusIfOpensAutomatically) {\n      if (!oldProps.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage && newProps.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage && !this.state.shouldAutoFocus) {\n        this.setState({\n          shouldAutoFocus: true\n        });\n      } else if (oldProps.botMessageState.localMessageIDs.length > newProps.botMessageState.localMessageIDs.length && this.state.shouldAutoFocus) {\n        this.setState({\n          shouldAutoFocus: false\n        });\n      } else if (oldProps.botMessageState.localMessageIDs.length < newProps.botMessageState.localMessageIDs.length && !this.state.shouldAutoFocus) {\n        this.setState({\n          shouldAutoFocus: true\n        });\n      }\n    }\n    const newLastItemID = arrayLastValue(newProps.botMessageState.localMessageIDs);\n    const oldLastItemID = arrayLastValue(oldProps.botMessageState.localMessageIDs);\n    if (newLastItemID !== oldLastItemID && newState.shouldAutoFocus) {\n      const lastMessageItem = newProps.allMessageItemsByID[newLastItemID];\n      const lastMessage = newProps.allMessagesByID[lastMessageItem?.fullMessageID];\n      if (!lastMessage?.history?.from_history) {\n        this.requestFocus();\n      }\n    }\n  }\n  componentDidCatch(error, errorInfo) {\n    this.props.serviceManager.actions.errorOccurred(createDidCatchErrorData(\"MainWindow\", error, errorInfo, true));\n  }\n  loadPanels() {\n    Promise.all([ Chat.preload(), CatastrophicError.preload(), Disclaimer.preload(), HomeScreenContainer.preload(), IFramePanel.preload(), ViewSourcePanel.preload(), BodyAndFooterPanelComponent.preload() ]).then(() => {\n      this.setState({\n        areModulesLoaded: true\n      });\n    });\n  }\n  updateBody(unmounting) {\n    if (IS_IOS && !this.props.config.public.disableCustomElementMobileEnhancements) {\n      if ((window.screen.width <= 500 || window.screen.height <= 500) && this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow && !unmounting) {\n        this.previousBodyVisibility = document.body.style.getPropertyValue(\"visibility\");\n        this.previousBodyPosition = document.body.style.getPropertyValue(\"position\");\n        document.body.style.setProperty(\"visibility\", \"hidden\", \"important\");\n        document.body.style.setProperty(\"position\", \"fixed\", \"important\");\n      } else {\n        document.body.style.setProperty(\"visibility\", this.previousBodyVisibility);\n        document.body.style.setProperty(\"position\", this.previousBodyPosition);\n      }\n    }\n  }\n  async doClose(fromCloseAndRestart) {\n    const {serviceManager: serviceManager} = this.props;\n    const {activeTour: activeTour} = serviceManager.store.getState().persistedToBrowserStorage.launcherState;\n    if (fromCloseAndRestart) {\n      const newViewState = await serviceManager.actions.changeView(ViewType.LAUNCHER, {\n        mainWindowCloseReason: MainWindowCloseReason.MAIN_WINDOW_CLOSED_AND_RESTARTED\n      });\n      if (!newViewState.mainWindow) {\n        await serviceManager.actions.restartConversation();\n      }\n    } else {\n      await serviceManager.actions.changeView(activeTour ? ViewType.TOUR : ViewType.LAUNCHER, {\n        mainWindowCloseReason: MainWindowCloseReason.DEFAULT_MINIMIZE\n      });\n    }\n  }\n  getShowHomeScreen() {\n    return this.props.homeScreenConfig.is_on && this.props.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen && !this.getShowDisclaimer();\n  }\n  getShowDisclaimer() {\n    return this.props.config.public.disclaimer?.is_on && !this.props.persistedToBrowserStorage.chatState.disclaimersAccepted[window.location.hostname];\n  }\n  doAutoScroll(options) {\n    this.botChatRef?.current?.doAutoScroll(options);\n  }\n  getMessagesScrollBottom() {\n    return this.botChatRef?.current?.getMessagesScrollBottom();\n  }\n  doScrollToMessage(messageID, animate = true) {\n    this.botChatRef.current?.doScrollToMessage(messageID, animate);\n  }\n  getMessageInput() {\n    return this.botChatRef.current?.getMessageInput();\n  }\n  getHomeScreenInput() {\n    return this.homeScreenInputRef.current?.getMessageInput();\n  }\n  addClassName(name) {\n    this.setState(addClassNameToState(name));\n  }\n  removeClassName(name) {\n    this.setState(removeClassNameFromState(name));\n  }\n  renderChat() {\n    const {isHydrated: isHydrated, config: config, chatWidthBreakpoint: chatWidthBreakpoint} = this.props;\n    const {areModulesLoaded: areModulesLoaded} = this.state;\n    const showCovering = this.state.numPanelsCovering > 0 && config.public.layout?.hasContentMaxWidth && chatWidthBreakpoint === ChatWidthBreakpoint.WIDE;\n    return React.createElement(\"div\", {\n      className: \"WACWidget--content\"\n    }, this.renderCustomPanel(), this.renderHydrationPanel(), isHydrated && areModulesLoaded && React.createElement(React.Fragment, null, this.renderDisclaimerPanel(), this.renderResponsePanel(), this.renderHomeScreenPanel(), this.renderIFramePanel(), this.renderViewSourcePanel(), showCovering && React.createElement(\"div\", {\n      className: \"WACBackgroundCover\"\n    }), this.renderBotChat()));\n  }\n  renderBotChat() {\n    const {botName: botName, languagePack: languagePack, config: config, serviceManager: serviceManager, botMessageState: botMessageState, agentState: agentState, allMessageItemsByID: allMessageItemsByID, isHydrated: isHydrated, locale: locale, theme: theme, headerDisplayName: headerDisplayName, headerAvatarConfig: headerAvatar} = this.props;\n    const {numPanelsAnimating: numPanelsAnimating, numPanelsOpen: numPanelsOpen, isHydrationAnimationComplete: isHydrationAnimationComplete} = this.state;\n    const inputState = selectInputState(this.props);\n    const agentDisplayState = selectAgentDisplayState(this.props);\n    const showDisclaimer = this.getShowDisclaimer();\n    let hideBotContainer;\n    if (!isHydrationAnimationComplete) {\n      hideBotContainer = true;\n    } else if (numPanelsAnimating > 0) {\n      hideBotContainer = false;\n    } else if (numPanelsOpen > 0) {\n      hideBotContainer = true;\n    }\n    return React.createElement(HideComponent, {\n      className: \"WACBotContainer\",\n      hidden: hideBotContainer\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(Chat, {\n      botName: botName,\n      headerDisplayName: headerDisplayName,\n      headerAvatarConfig: headerAvatar,\n      ref: this.botChatRef,\n      languagePack: languagePack,\n      config: config,\n      serviceManager: serviceManager,\n      onClose: this.onClose,\n      onCloseAndRestart: this.onCloseAndRestart,\n      messageState: botMessageState,\n      onSendInput: text => this.onSendInput(text, MessageSendSource.MESSAGE_INPUT),\n      agentState: agentState,\n      agentDisplayState: agentDisplayState,\n      allMessageItemsByID: allMessageItemsByID,\n      onRestart: this.onRestart,\n      isHydrated: isHydrated,\n      isHydrationAnimationComplete: isHydrationAnimationComplete && !showDisclaimer,\n      inputState: inputState,\n      onToggleHomeScreen: this.onToggleHomeScreen,\n      onUserTyping: this.onUserTyping,\n      locale: locale,\n      useAITheme: theme.useAITheme,\n      carbonTheme: theme.carbonTheme\n    })));\n  }\n  renderInnerHydrationPanel() {\n    const {botMessageState: botMessageState, serviceManager: serviceManager, languagePack: languagePack, headerDisplayName: headerDisplayName, persistedToBrowserStorage: persistedToBrowserStorage, homeScreenConfig: homeScreenConfig} = this.props;\n    const {areModulesLoaded: areModulesLoaded} = this.state;\n    const useHomeScreenVersion = homeScreenConfig.is_on && !persistedToBrowserStorage.launcherState.hasSentNonWelcomeMessage;\n    return React.createElement(HydrationPanel, {\n      headerDisplayName: headerDisplayName,\n      isHydrated: botMessageState.isHydratingCounter === 0 && areModulesLoaded,\n      serviceManager: serviceManager,\n      onClose: this.onClose,\n      languagePack: languagePack,\n      useHomeScreenVersion: useHomeScreenVersion\n    });\n  }\n  renderHydrationPanel() {\n    const {botMessageState: botMessageState, serviceManager: serviceManager, catastrophicErrorType: catastrophicErrorType, persistedToBrowserStorage: persistedToBrowserStorage} = this.props;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    const {areModulesLoaded: areModulesLoaded} = this.state;\n    return React.createElement(OverlayPanel, {\n      onOpenStart: () => this.onPanelOpenStart(false),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => {\n        this.onHydrationPanelClose();\n        this.onPanelCloseEnd(false);\n      },\n      animationOnOpen: AnimationInType.NONE,\n      animationOnClose: AnimationOutType.NONE,\n      shouldOpen: (botMessageState.isHydratingCounter > 0 || !areModulesLoaded) && !catastrophicErrorType && viewState.mainWindow,\n      shouldHide: false,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.HYDRATING\n    }, this.renderInnerHydrationPanel());\n  }\n  renderCatastrophicPanel() {\n    const {serviceManager: serviceManager, botName: botName, languagePack: languagePack, headerDisplayName: headerDisplayName} = this.props;\n    return React.createElement(OverlayPanel, {\n      animationOnOpen: AnimationInType.NONE,\n      animationOnClose: AnimationOutType.NONE,\n      shouldOpen: true,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.CATASTROPHIC\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(CatastrophicError, {\n      onClose: this.onClose,\n      headerDisplayName: headerDisplayName,\n      languagePack: languagePack,\n      onRestart: this.onRestart,\n      showHeader: true,\n      botName: botName\n    })));\n  }\n  renderDisclaimerPanel() {\n    const {serviceManager: serviceManager, config: config} = this.props;\n    const showDisclaimer = this.getShowDisclaimer();\n    return config.public.disclaimer?.is_on ? React.createElement(OverlayPanel, {\n      onOpenStart: () => this.onPanelOpenStart(false),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => this.onPanelCloseEnd(false),\n      animationOnOpen: AnimationInType.FADE_IN,\n      animationOnClose: AnimationOutType.FADE_OUT,\n      shouldOpen: showDisclaimer,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.DISCLAIMER\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(Disclaimer, {\n      onAcceptDisclaimer: this.onAcceptDisclaimer,\n      onClose: this.onClose,\n      disclaimerHTML: config.public.disclaimer?.disclaimerHTML,\n      disclaimerAcceptButtonRef: this.disclaimerRef\n    }))) : null;\n  }\n  renderHomeScreenPanel() {\n    const {isHydrationAnimationComplete: isHydrationAnimationComplete} = this.state;\n    const showHomeScreen = this.getShowHomeScreen();\n    return React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(HomeScreenContainer, {\n      onPanelOpenStart: () => this.onPanelOpenStart(false),\n      onPanelOpenEnd: this.onPanelOpenEnd,\n      onPanelCloseStart: this.onPanelCloseStart,\n      onPanelCloseEnd: () => this.onPanelCloseEnd(false),\n      onClose: this.onClose,\n      onCloseAndRestart: this.onCloseAndRestart,\n      onSendBotInput: text => this.onSendInput(text, MessageSendSource.HOME_SCREEN_INPUT),\n      onSendButtonInput: this.onSendHomeButtonInput,\n      onRestart: this.onRestart,\n      showHomeScreen: showHomeScreen,\n      isHydrationAnimationComplete: isHydrationAnimationComplete,\n      homeScreenInputRef: this.homeScreenInputRef,\n      onToggleHomeScreen: this.onToggleHomeScreen,\n      requestFocus: this.requestFocus\n    }));\n  }\n  renderIFramePanel() {\n    const {serviceManager: serviceManager, iFramePanelState: iFramePanelState} = this.props;\n    return React.createElement(OverlayPanel, {\n      className: \"WAC__overlay--covering\",\n      onOpenStart: () => this.onPanelOpenStart(true),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => this.onPanelCloseEnd(true),\n      animationOnOpen: AnimationInType.SLIDE_IN_FROM_BOTTOM,\n      animationOnClose: AnimationOutType.SLIDE_OUT_TO_BOTTOM,\n      shouldOpen: iFramePanelState.isOpen,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.IFRAME\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(IFramePanel, {\n      useAITheme: this.props.theme.useAITheme,\n      ref: this.iframePanelRef,\n      onClickClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onClickCloseAndRestart: this.onCloseAndRestart\n    })));\n  }\n  renderViewSourcePanel() {\n    const {serviceManager: serviceManager, viewSourcePanelState: viewSourcePanelState} = this.props;\n    return React.createElement(OverlayPanel, {\n      className: \"WAC__overlay--covering\",\n      onOpenStart: () => this.onPanelOpenStart(true),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => this.onPanelCloseEnd(true),\n      animationOnOpen: AnimationInType.SLIDE_IN_FROM_BOTTOM,\n      animationOnClose: AnimationOutType.SLIDE_OUT_TO_BOTTOM,\n      shouldOpen: viewSourcePanelState.isOpen,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.CONVERSATIONAL_SEARCH_CITATION\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(ViewSourcePanel, {\n      ref: this.viewSourcePanelRef,\n      onClickClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onClickCloseAndRestart: this.onCloseAndRestart\n    })));\n  }\n  renderCustomPanel() {\n    return React.createElement(CustomPanelExport, {\n      useAITheme: this.props.theme.useAITheme,\n      onClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onCloseAndRestart: this.onCloseAndRestart,\n      onPanelOpenStart: () => this.onPanelOpenStart(true),\n      onPanelOpenEnd: this.onPanelOpenEnd,\n      onPanelCloseStart: this.onPanelCloseStart,\n      onPanelCloseEnd: () => this.onPanelCloseEnd(true)\n    });\n  }\n  renderResponsePanel() {\n    if (!this.props.responsePanelState.localMessageItem) {\n      return null;\n    }\n    const {isOpen: isOpen, localMessageItem: localMessageItem, isMessageForInput: isMessageForInput} = this.props.responsePanelState;\n    const panelOptions = (localMessageItem?.item).panel;\n    const eventName = `\"Show panel\" opened`;\n    const eventDescription = \"Panel opened through panel response type\";\n    const overlayPanelName = OverlayPanelName.PANEL_RESPONSE;\n    return React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(BodyAndFooterPanelComponent, {\n      eventName: eventName,\n      eventDescription: eventDescription,\n      overlayPanelName: overlayPanelName,\n      testIdPrefix: overlayPanelName,\n      isOpen: isOpen,\n      isMessageForInput: isMessageForInput,\n      localMessageItem: localMessageItem,\n      title: panelOptions?.title,\n      showAnimations: panelOptions?.show_animations,\n      useAITheme: this.props.theme.useAITheme,\n      requestFocus: this.requestFocus,\n      onClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onCloseAndRestart: this.onCloseAndRestart,\n      onClickBack: () => this.props.serviceManager.store.dispatch(actions.setResponsePanelIsOpen(false)),\n      onPanelOpenStart: () => this.onPanelOpenStart(true),\n      onPanelOpenEnd: this.onPanelOpenEnd,\n      onPanelCloseStart: this.onPanelCloseStart,\n      onPanelCloseEnd: () => {\n        this.onPanelCloseEnd(true);\n        this.props.serviceManager.store.dispatch(actions.setResponsePanelContent(null, false));\n      },\n      renderMessageComponent: childProps => React.createElement(MessageTypeComponent, {\n        ...childProps\n      })\n    }));\n  }\n  renderWidget() {\n    const {serviceManager: serviceManager, useCustomHostElement: useCustomHostElement, locale: locale, catastrophicErrorType: catastrophicErrorType, config: config, isHydrated: isHydrated, theme: theme, chatWidthBreakpoint: chatWidthBreakpoint, layout: layout, languagePack: languagePack} = this.props;\n    const {closing: closing, open: open, extraClassNames: extraClassNames} = this.state;\n    const localeClassName = `WACLocale-${locale || \"en\"}`;\n    const showGlass = config.public.enableFocusTrap && open && !config.public.hideCloseButton && !config.public.headerConfig.hideMinimizeButton;\n    const trapActive = Boolean(showGlass && isHydrated);\n    const isWideWidth = chatWidthBreakpoint === ChatWidthBreakpoint.WIDE;\n    return React.createElement(FocusTrap, {\n      active: trapActive\n    }, React.createElement(\"div\", {\n      className: cx(\"WACMainWindow\", \"WACWidget__FocusTrapContainer\", ...extraClassNames),\n      ref: this.mainWindowRef\n    }, showGlass && React.createElement(\"div\", {\n      className: \"WACWidget__FocusTrapGlass\"\n    }), React.createElement(\"div\", {\n      id: `WACWidget${serviceManager.namespace.suffix}`,\n      className: cx(`WACWidget ${localeClassName}`, {\n        \"WACWidget--rounded\": theme.corners === CornersType.ROUND,\n        \"WACWidget--defaultElement\": !useCustomHostElement,\n        \"WACWidget--launched\": !closing,\n        \"WACWidget--closing\": closing,\n        \"WACWidget--closed\": !open,\n        \"WACWidget--maxWidth\": isWideWidth && layout.hasContentMaxWidth,\n        [WIDTH_BREAKPOINT_NARROW]: chatWidthBreakpoint === ChatWidthBreakpoint.NARROW,\n        [WIDTH_BREAKPOINT_STANDARD]: chatWidthBreakpoint === ChatWidthBreakpoint.STANDARD,\n        [WIDTH_BREAKPOINT_WIDE]: isWideWidth\n      }),\n      ref: this.containerRef\n    }, React.createElement(VisuallyHidden, null, React.createElement(\"h1\", null, languagePack.window_title)), catastrophicErrorType && this.renderCatastrophicPanel(), !catastrophicErrorType && React.createElement(\"div\", {\n      ref: this.animationContainerRef,\n      className: \"WACWidget__animationContainer\",\n      onScroll: () => {\n        if (this.animationContainerRef.current.scrollTop !== 0) {\n          this.animationContainerRef.current.scrollTop = 0;\n        }\n      }\n    }, this.renderChat()), React.createElement(\"div\", {\n      className: \"WACMainWindowModalHost\",\n      ref: this.setModalPortalHostElement\n    }))));\n  }\n  render() {\n    return React.createElement(ModalPortalRootContext.Provider, {\n      value: this.state.modalPortalHostElement\n    }, this.renderWidget());\n  }\n}\n\nvar MainWindow$1 = connect(state => state, null, null, {\n  forwardRef: true\n})(MainWindow);\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const TourContainerLazy = lazyTourComponent();\n\nfunction App({serviceManager: serviceManager, hostElement: hostElement, applicationStyles: applicationStyles, fontStyles: fontStyles}) {\n  const {store: store} = serviceManager;\n  const {config: config} = store.getState();\n  if (config.public.debug) {\n    consoleDebug(\"[render] Called render\");\n  }\n  const combinedStyles = `${fontStyles ? `${fontStyles} ` : \"\"}${applicationStyles}`;\n  return React.createElement(Provider, {\n    store: store\n  }, React.createElement(AppContainer$1, {\n    serviceManager: serviceManager,\n    hostElement: hostElement,\n    applicationStyles: combinedStyles\n  }));\n}\n\nfunction AppContainer$1({serviceManager: serviceManager, hostElement: hostElement, applicationStyles: applicationStyles}) {\n  const languagePack = useSelector(state => state.languagePack);\n  const cssVariableOverrides = useSelector(state => state.cssVariableOverrides);\n  const theme = useSelector(state => state.theme);\n  const config = useSelector(state => state.config);\n  const layout = useSelector(state => state.layout);\n  const {namespace: namespace} = serviceManager;\n  const {originalName: originalName} = namespace;\n  const dispatch = useDispatch();\n  const [windowSize, setWindowSize] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight\n  });\n  const cssVariableOverrideString = useMemo(() => convertCSSVariablesToString(cssVariableOverrides), [ cssVariableOverrides ]);\n  const dir = document.dir || \"auto\";\n  useOnMount(() => {\n    const windowListener = () => {\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    };\n    window.addEventListener(\"resize\", windowListener);\n    const visibilityListener = () => {\n      dispatch(actions.setIsBrowserPageVisible(document.visibilityState === \"visible\"));\n    };\n    document.addEventListener(\"visibilitychange\", visibilityListener);\n    return () => {\n      window.removeEventListener(\"resize\", windowListener);\n      document.removeEventListener(\"visibilitychange\", visibilityListener);\n    };\n  });\n  return React.createElement(\"div\", {\n    className: \"WACContainer\",\n    \"data-namespace\": originalName,\n    ref: node => {\n      if (node && hostElement) {\n        node.style.setProperty(\"height\", \"100%\", \"important\");\n        node.style.setProperty(\"width\", \"100%\", \"important\");\n      }\n    }\n  }, React.createElement(\"div\", {\n    className: \"WACContainer--styles\"\n  }, React.createElement(\"style\", {\n    \"data-base-styles\": \"true\",\n    nonce: config.public.cspNonce\n  }, applicationStyles || `.WACContainer { visibility: hidden; }`), React.createElement(\"style\", {\n    \"data-variables-custom\": \"true\",\n    nonce: config.public.cspNonce\n  }, cssVariableOverrideString)), React.createElement(\"div\", {\n    className: cx(`WACContainer--render`, getThemeClassNames(theme), {\n      \"WACContainer-disableMobileEnhancements\": hostElement && config.public.disableCustomElementMobileEnhancements,\n      \"WAC-isPhone\": IS_PHONE && !config.public.disableCustomElementMobileEnhancements,\n      \"WAC-isPhonePortraitMode\": IS_PHONE_IN_PORTRAIT_MODE && !config.public.disableCustomElementMobileEnhancements,\n      \"WAC--frameless\": !layout?.showFrame\n    }),\n    dir: dir\n  }, React.createElement(WindowSizeContext.Provider, {\n    value: windowSize\n  }, React.createElement(ServiceManagerContext.Provider, {\n    value: serviceManager\n  }, React.createElement(RawIntlProvider, {\n    value: serviceManager.intl\n  }, React.createElement(LanguagePackContext.Provider, {\n    value: languagePack\n  }, React.createElement(AriaAnnouncerProvider, null, React.createElement(MainContainer, {\n    serviceManager: serviceManager,\n    hostElement: hostElement\n  }))))))));\n}\n\nfunction MainContainer(props) {\n  const {hostElement: hostElement, serviceManager: serviceManager} = props;\n  const showLauncher = useSelector(state => state.launcher.config.is_on);\n  const {viewState: viewState} = useSelector(state => state.persistedToBrowserStorage.launcherState);\n  const tourContainerRef = useRef();\n  const mainWindowRef = useRef();\n  const showTour = viewState.tour;\n  const showedTourOnce = useRef(showTour);\n  showedTourOnce.current = showTour || showedTourOnce.current;\n  const intl = useIntl();\n  const namespace = serviceManager.namespace.originalName;\n  const languageKey = namespace ? \"window_ariaChatRegionNamespace\" : \"window_ariaChatRegion\";\n  const regionLabel = intl.formatMessage({\n    id: languageKey\n  }, {\n    namespace: namespace\n  });\n  useOnMount(() => {\n    function requestFocus() {\n      try {\n        const {persistedToBrowserStorage: persistedToBrowserStorage} = serviceManager.store.getState();\n        const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n        if (viewState.tour) {\n          tourContainerRef.current?.requestFocus();\n        } else if (viewState.mainWindow) {\n          mainWindowRef.current?.requestFocus();\n        }\n      } catch (error) {\n        consoleError(\"An error occurred in App.requestFocus\", error);\n      }\n    }\n    serviceManager.appWindow = {\n      requestFocus: requestFocus\n    };\n  });\n  return React.createElement(\"div\", {\n    className: \"WACWidget__regionContainer\",\n    role: \"region\",\n    \"aria-label\": regionLabel\n  }, React.createElement(MainWindow$1, {\n    mainWindowRef: mainWindowRef,\n    useCustomHostElement: Boolean(hostElement),\n    serviceManager: serviceManager\n  }), showedTourOnce.current && React.createElement(Suspense, {\n    fallback: null\n  }, React.createElement(TourContainerLazy, {\n    ref: tourContainerRef\n  })), showLauncher && React.createElement(LauncherContainer, null));\n}\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function UserDefinedResponsePortalsContainer({chatInstance: chatInstance, renderUserDefinedResponse: renderUserDefinedResponse, userDefinedResponseEventsBySlot: userDefinedResponseEventsBySlot}) {\n  return renderUserDefinedResponse ? Object.entries(userDefinedResponseEventsBySlot).map(([slot, slotState]) => {\n    const {element: element} = slotState;\n    if (!element) {\n      return null;\n    }\n    return React.createElement(UserDefinedResponseComponentPortal, {\n      key: slot,\n      hostElement: element\n    }, renderUserDefinedResponse(slotState, chatInstance));\n  }) : null;\n}\n\nfunction UserDefinedResponseComponentPortal({hostElement: hostElement, children: children}) {\n  return ReactDOM.createPortal(children, hostElement);\n}\n\nconst UserDefinedResponsePortalsContainerExport = React.memo(UserDefinedResponsePortalsContainer);\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function WriteableElementsPortalsContainer({chatInstance: chatInstance, renderResponseMap: renderResponseMap}) {\n  return React.createElement(React.Fragment, null, Object.keys(chatInstance.writeableElements).map(key => {\n    const responseItem = renderResponseMap[key];\n    return responseItem ? React.createElement(WriteableElementsComponentPortal, {\n      key: key,\n      hostElement: chatInstance.writeableElements[key]\n    }, responseItem) : null;\n  }));\n}\n\nfunction WriteableElementsComponentPortal({hostElement: hostElement, children: children}) {\n  return ReactDOM.createPortal(children, hostElement);\n}\n\nconst WriteableElementsPortalsContainerExport = React.memo(WriteableElementsPortalsContainer);\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function AppContainer({config: config, onBeforeRender: onBeforeRender, onAfterRender: onAfterRender, renderUserDefinedResponse: renderUserDefinedResponse, renderWriteableElements: renderWriteableElements, container: container, setParentInstance: setParentInstance, element: element}) {\n  const [instance, setInstance] = useState(null);\n  const [renderProps, setRenderProps] = useState(null);\n  const [applicationStyles, setApplicationStyles] = useState(null);\n  const setInstances = instance => {\n    setInstance(instance);\n    setParentInstance?.(instance);\n  };\n  const [userDefinedResponseEventsBySlot, setUserDefinedResponseEventsBySlot] = useState({});\n  const managedWebChatRef = useRef(null);\n  const previousConfigRef = useRef(null);\n  useEffect(() => {\n    const previousConfig = previousConfigRef.current;\n    previousConfigRef.current = config;\n    async function render({serviceManager: serviceManager}) {\n      const applicationStyles = await loadStyles();\n      serviceManager.container = container;\n      if (serviceManager.customHostElement) {\n        container.style.setProperty(\"width\", \"100%\", \"important\");\n        container.style.setProperty(\"height\", \"100%\", \"important\");\n      } else {\n        container.style.setProperty(\"width\", \"0\", \"important\");\n        container.style.setProperty(\"height\", \"0\", \"important\");\n      }\n      setApplicationStyles(applicationStyles);\n      setRenderProps({\n        serviceManager: serviceManager\n      });\n      await sleep(0);\n    }\n    if (!isEqual(previousConfig, config)) {\n      const managedWebChat = {\n        instance: null,\n        shouldDestroy: false,\n        config: config\n      };\n      if (config) {\n        loadChat({\n          managedWebChatRef: managedWebChatRef,\n          managedWebChat: managedWebChat,\n          render: render,\n          setInstance: setInstances,\n          onBeforeRender: onBeforeRender,\n          onAfterRender: onAfterRender,\n          setUserDefinedResponseEventsBySlot: setUserDefinedResponseEventsBySlot,\n          element: element\n        });\n      }\n      return () => {\n        destroyWebChat(managedWebChat, setInstances);\n        previousConfigRef.current = null;\n      };\n    }\n    return undefined;\n  }, [ config, container ]);\n  if (renderProps && instance) {\n    return React.createElement(React.Fragment, null, React.createElement(App, {\n      serviceManager: renderProps.serviceManager,\n      hostElement: renderProps.serviceManager.customHostElement,\n      applicationStyles: applicationStyles\n    }), renderUserDefinedResponse && React.createElement(UserDefinedResponsePortalsContainerExport, {\n      chatInstance: instance,\n      renderUserDefinedResponse: renderUserDefinedResponse,\n      userDefinedResponseEventsBySlot: userDefinedResponseEventsBySlot\n    }), renderWriteableElements && React.createElement(WriteableElementsPortalsContainerExport, {\n      chatInstance: instance,\n      renderResponseMap: renderWriteableElements\n    }));\n  }\n  return null;\n}\n\nasync function destroyWebChat(managedWebChat, setInstance) {\n  if (managedWebChat) {\n    if (managedWebChat.instance) {\n      managedWebChat.instance.destroy();\n      await sleep(0);\n    }\n    managedWebChat.shouldDestroy = true;\n    managedWebChat.instance = null;\n  }\n  setInstance(null);\n  await sleep(0);\n}\n\nfunction addUserDefinedResponseHandler(webChatInstance, setUserDefinedResponseEventsBySlot) {\n  function userDefinedResponseHandler(event) {\n    setUserDefinedResponseEventsBySlot(userDefinedEventsBySlot => ({\n      ...userDefinedEventsBySlot,\n      [event.data.slot]: {\n        fullMessage: event.data.fullMessage,\n        messageItem: event.data.message,\n        element: event.data.element\n      }\n    }));\n  }\n  function userDefinedChunkHandler(event) {\n    if (\"complete_item\" in event.data.chunk) {\n      const messageItem = event.data.chunk.complete_item;\n      setUserDefinedResponseEventsBySlot(userDefinedEventsBySlot => ({\n        ...userDefinedEventsBySlot,\n        [event.data.slot]: {\n          messageItem: messageItem,\n          element: event.data.element\n        }\n      }));\n    } else if (\"partial_item\" in event.data.chunk) {\n      const itemChunk = event.data.chunk.partial_item;\n      setUserDefinedResponseEventsBySlot(userDefinedEventsBySlot => ({\n        ...userDefinedEventsBySlot,\n        [event.data.slot]: {\n          partialItems: [ ...userDefinedEventsBySlot[event.data.slot]?.partialItems || [], itemChunk ],\n          element: event.data.element\n        }\n      }));\n    }\n  }\n  function restartHandler() {\n    setUserDefinedResponseEventsBySlot({});\n  }\n  webChatInstance.on({\n    type: BusEventType.CHUNK_USER_DEFINED_RESPONSE,\n    handler: userDefinedChunkHandler\n  });\n  webChatInstance.on({\n    type: BusEventType.USER_DEFINED_RESPONSE,\n    handler: userDefinedResponseHandler\n  });\n  webChatInstance.on({\n    type: BusEventType.RESTART_CONVERSATION,\n    handler: restartHandler\n  });\n}\n\nasync function loadChat({managedWebChatRef: managedWebChatRef, managedWebChat: managedWebChat, render: render, setInstance: setInstance, onBeforeRender: onBeforeRender, onAfterRender: onAfterRender, setUserDefinedResponseEventsBySlot: setUserDefinedResponseEventsBySlot, element: element}) {\n  await destroyWebChat(managedWebChatRef.current, setInstance);\n  managedWebChatRef.current = managedWebChat;\n  if (managedWebChat.shouldDestroy) {\n    await destroyWebChat(managedWebChat, setInstance);\n    return;\n  }\n  const widget = await instantiateWidget(managedWebChat.config, () => Promise.resolve(Chat$1), Promise.resolve(render), element);\n  const instance = await widget.start();\n  addUserDefinedResponseHandler(instance, setUserDefinedResponseEventsBySlot);\n  onBeforeRender?.(instance);\n  await instance.render();\n  onAfterRender?.(instance);\n  setInstance(instance);\n  managedWebChat.instance = instance;\n  if (managedWebChat.shouldDestroy) {\n    await destroyWebChat(managedWebChat, setInstance);\n  }\n}\n\nconst AppContainerExport = React.memo(AppContainer);\n\nconst loadBaseStyles = async () => {\n  const {default: styles} = await import(\"./chat.export.js\");\n  return styles;\n};\n\nconst loadCarbon = async () => {\n  const {default: carbon} = await import(\"./chat.export.carbon.js\");\n  return carbon;\n};\n\nasync function loadStyles() {\n  const [styles, carbonStyles] = await Promise.all([ loadBaseStyles(), loadCarbon() ]);\n  return carbonStyles + styles;\n}\n\nexport { AppContainerExport as AppContainer };\n"],"names":["inputItemToLocalItem","message","originalUserText","id","uuid","UUIDType","LOCAL_MESSAGE","item","response_type","MessageResponseTypes","TEXT","input","ui_state","needsAnnouncement","fullMessageID","outputItemToLocalItem","messageItem","fullMessage","isLatestWelcomeNode","disableFadeAnimation","localMessage","streamItemID","history","from_history","isWelcomeResponse","createLocalMessageForInlineError","text","originalMessage","createMessageResponseForItem","createLocalMessageForItem","INLINE_ERROR","createLocalMessageItemsForNestedMessageItems","localMessageItem","fromHistory","nestedLocalMessageItems","allowFooter","isGridResponseType","gridLocalMessageItemIDs","rows","map","row","cells","cell","cellLocalMessageItemIDs","createLocalMessageItemsForNestedType","items","nestedMessageItem","isSupportedMessageItemInBody","isCarouselResponseType","itemsLocalMessageItemIDs","bodyItems","body","panel","bodyLocalMessageItemIDs","isShowPanelButtonType","footerItems","footer","footerLocalMessageItemIDs","rootMessageItem","isButtonResponseType","isSupportedMessageItemInFooter","type","nestedMessageItemIDs","isSupported","forEach","nestedLocalMessageItem","push","isResponseWithNestedItems","consoleError","CARD","isCardResponseType","isItemSupportedInResponseBody","CAROUSEL","BUTTON","button_type","ButtonItemType","SHOW_PANEL","GRID","HA_SET_AGENT_AVAILABILITY","HA_SET_IS_CONNECTING","HA_SET_IS_RECONNECTING","HA_SET_AGENT_JOINED","HA_SET_AGENT_LEFT_CHAT","HA_END_CHAT","HA_UPDATE_CAPABILITIES","HA_UPDATE_FILE_UPLOAD_IN_PROGRESS","HA_SET_SHOW_SCREEN_SHARE_REQUEST","HA_SET_IS_SCREEN_SHARING","HA_SET_PERSISTED_STATE","HA_UPDATE_IS_SUSPENDED","HA_UPDATE_IS_TYPING","setIsConnecting","isConnecting","localMessageID","setIsReconnecting","isReconnecting","setAgentLeftChat","endChat","setAgentAvailability","availability","setAgentJoined","agentProfile","updateCapabilities","capabilities","updateFilesUploadInProgress","fileUploadInProgress","setShowScreenShareRequest","showRequest","setIsScreenSharing","isSharing","setPersistedServiceDeskState","state","agentUpdateIsSuspended","isSuspended","agentUpdateIsTyping","isTyping","deepFreeze","object","Object","freeze","getOwnPropertyNames","prop","prototype","hasOwnProperty","call","isFrozen","resolvablePromise","resolveFunction","rejectFunction","promise","Promise","resolve","reject","doResolve","resolveValue","isResolved","isComplete","doReject","rejectValue","isRejected","HomeScreenHeader","props","ref","brandColor","onClose","onRestart","onCloseAndRestart","showRestartButton","useSelector","config","public","headerConfig","showBackButton","persistedToBrowserStorage","chatState","homeScreenState","showBackToBot","displayName","headerDisplayName","customMenuOptions","useAITheme","theme","headerRef","useRef","useImperativeHandle","current","hideCloseAndRestartButton","overflowClicked","useCallback","index","handler","overflowItems","option","React","className","HeaderExport","showCenter","onClickRestart","onClickClose","testIdPrefix","OverlayPanelName","HOME_SCREEN","HomeScreenHeaderExport","forwardRef","BasePanelComponent","children","isOpen","hidePanelHeader","labelBackButton","title","hideBackButton","onClickCloseAndRestart","headerProps","FocusTrap","active","focusTrapOptions","clickOutsideDeactivates","returnFocusOnDeactivate","IS_MOBILE","preventScroll","BasePanelComponentExport","withoutEmptyStarters","newConfig","starters","buttons","length","allow_return","filter","button","Boolean","label","trim","is_on","setIntl","serviceManager","locale","messages","intl","createIntl","store","dispatch","actions","setAppStateValue","createWriteableElementsProxy","elementSet","Set","get","target","element","has","add","Proxy","writeableElements","VERSION","NotificationType","BOUNCING_ANIMATION_TIMEOUTS","DEFAULT_LAUNCHER","mobile","time_to_expand","new_expand_time","time_to_reduce","notification_type","TEXT_NOTIFICATION","desktop","DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS","disableAnimation","DEFAULT_CUSTOM_PANEL_STATE","panelID","DEFAULT_CUSTOM_PANEL_ID","options","DEFAULT_IFRAME_PANEL_STATE","DEFAULT_CITATION_PANEL_STATE","citationItem","DEFAULT_TOUR_STATE","activeTourStepItems","DEFAULT_MESSAGE_PANEL_STATE","isMessageForInput","VIEW_STATE_ALL_CLOSED","launcher","mainWindow","tour","VIEW_STATE_LAUNCHER_OPEN","VIEW_STATE_MAIN_WINDOW_OPEN","DEFAULT_PERSISTED_TO_BROWSER","version","disclaimersAccepted","isHomeScreenOpen","hasSentNonWelcomeMessage","persistedTourState","activeTourID","activeTourCurrentStepIndex","agentState","isConnected","agentProfiles","launcherState","wasLoadedFromBrowser","viewState","activeTour","showUnreadIndicator","mobileLauncherIsExtended","mobileLauncherWasReduced","mobileLauncherDisableBounce","desktopLauncherIsExpanded","desktopLauncherWasMinimized","bounceTurn","DEFAULT_CHAT_MESSAGES_STATE","localMessageIDs","messageIDs","isTypingCounter","isLoadingCounter","isHydratingCounter","isScrollAnchored","DEFAULT_MESSAGE_STATE","allMessageItemsByID","allMessagesByID","botMessageState","DEFAULT_AGENT_STATE","numUnreadMessages","showScreenShareRequest","isScreenSharing","isAgentTyping","inputState","fieldVisible","isReadonly","files","allowFileUploads","allowMultipleFileUploads","allowedFileUploadTypes","stopStreamingButtonState","currentStreamID","isVisible","isDisabled","DEFAULT_THEME_STATE","carbonTheme","CarbonTheme","G10","corners","CornersType","ROUND","DEFAULT_LAYOUT_STATE","showFrame","hasContentMaxWidth","applyBotMessageState","newState","setHomeScreenOpenState","undefined","applyLocalMessageUIState","propertyName","propertyValue","oldMessage","applyFullMessage","white","gray100","MIN_CONTRAST","hexCodeToRGB","color","red","substring","blue","green","parseInt","calculateContrast","color1","color2","rgb1","rgb2","luminance1","calculateRelativeLuminance","luminance2","contrast","r8","g8","b8","rRGB","gRGB","bRGB","whiteOrBlackText","background","adjustLightness","token","shift","original","Color","hsl","l","round","hex","toLowerCase","CSS_VAR_PREFIX","HEXADECIMAL_REGEX","INTERNAL_OVERRIDES_LIGHT_THEME_MAP","INTERNAL_OVERRIDES_DARK_THEME_MAP","ACCENT_COLOR_MAPS","blue20","blue60","blue60Hover","blue80","g10","g90","g100","fillValues","styles","propertyNames","value","mergeCSSVariables","publicVars","whiteLabelVariables","internalOverrides","internalOverridesMap","WHITE","includes","G90","G100","createInternalCSSOverridesMap","result","entries","key","startsWith","match","console","warn","WA_CONSOLE_PREFIX","remoteVars","cssOverrides","primaryColor","secondaryColor","accentColor","useAccentColor","tryFocusColor","useFocusColor","colorMap","accentBlue20","accentBlue60Hover","accentBlue80","accentColorRGB","toString","accentColorBW","remoteStylesToCSSVars","getThemeClassNames","themeState","themeClassnames","CarbonThemeClassNames","validateViewState","appState","VALID_PUBLIC_VARS_IN_AI_THEME_SET","values","CSSVariable","UPDATE_CSS_VARS_AI_THEME_WARNING_MESSAGE","join","ChatActionsImpl","constructor","this","hydrating","restarting","alreadyHydrated","chunkQueue","hydrateChat","alternateWelcomeRequest","alternateWelcomeRequestSource","alternateOptions","fireReady","hydrationPromise","doHydrateChat","fire","BusEventType","CHAT_READY","debugLog","addIsHydratingCounter","historyService","loadHistory","humanAgentService","initialize","getState","hydrateMessageHistory","messageHistory","createElementsForUserDefinedResponses","latestPanelLocalMessageItem","openResponsePanel","homeScreenConfig","setHomeScreenIsOpen","messaging","skipWelcome","send","createWelcomeRequest","MessageSendSource","WELCOME_REQUEST","returnBeforeStreaming","chatWasHydrated","lastMessageID","arrayLastValue","lastMessage","lastOriginalMessage","isLiveAgentMessage","isRequest","messageService","resendMessage","allowReconnect","serviceDesk","handleHydration","getPublicWebChatState","isConnectedWithHumanAgent","isWebChatOpen","isConnectingWithHumanAgent","isDebugEnabled","isEnableDebugLog","hasUserSentMessage","isTourActive","sendWithCatch","source","ignoreHydration","error","messageRequest","createMessageRequestForText","responsePanelState","setResponsePanelIsOpen","doSend","addDefaultsToMessage","silent","addMessage","addLocalMessageItem","setValueSelectedForMessageID","messageSetOptionSelected","cloneDeep","receive","requestMessage","requestOptions","restartCount","initialRestartCount","MESSAGE","preReceiveEvent","PRE_RECEIVE","data","updateHasSentNonWelcomeMessage","languagePack","isResponse","processMessageResponse","catch","inlineError","createMessageResponseForText","errors_singleMessage","thread_id","RECEIVE","removeMessages","insertHistory","scrollBottom","getMessagesScrollBottom","notes","currentAppStateMessages","newAppStateMessages","merge","doAutoScroll","scrollToBottom","receiveChunk","chunk","messageID","chunkPromise","processChunkQueue","isCompleteItem","isStreamCompleteItem","isPartialItem","isStreamPartialItem","isStopGeneratingVisible","botInputState","partial_item","streaming_metadata","cancellable","setStopStreamingButtonVisible","response_id","streamingStart","complete_item","streamingAddChunk","partial_response","keys","Error","streamingMergeHistory","handleUserDefinedResponseItemsChunk","isStreamFinalResponse","final_response","setStopStreamingButtonDisabled","getOrCreateUserDefinedElement","messageItemID","userDefinedItem","userDefinedElementRegistry","document","createElement","slotName","setAttribute","set","handleUserDefinedResponseItems","renderAsUserDefinedMessage","user_defined","userDefinedResponseEvent","USER_DEFINED_RESPONSE","slot","createElementForNestedUserDefinedResponse","localMessageItemID","nestedLocalMessage","asyncForEach","itemID","CHUNK_USER_DEFINED_RESPONSE","output","generic","request_id","previousItemID","pause","isPause","agent","isConnectToAgent","hasTourUserDefinedType","skipTourCard","skip_card","startTourReason","TourStartReason","START_TOUR_METHOD","SKIP_CARD","mainWindowCloseReason","MainWindowCloseReason","CALLED_START_TOUR","TOUR_SKIP_CARD","startTour","viewChangeReason","ViewChangeReason","addNestedMessages","addIsTypingCounter","hasServiceDesk","errorOccurred","errorType","OnErrorType","INTEGRATION_ERROR","setMessageHistoryProperty","agentAvailability","checkAreAnyAgentsOnline","shouldAutoRequestAgent","skipConnectAgentCard","AgentsOnlineStatus","ONLINE","startChat","showIsTyping","sleep","time","setResponsePanelContent","insertLocalMessageResponse","updateLanguagePack","changes","addNotification","notification","removeNotification","groupID","removeNotifications","removeAllNotifications","updateCSSVariables","usePublicVars","variable","consoleWarn","allVariables","updateBotName","name","updateMainHeaderTitle","updateBotAvatarURL","url","updateHomeScreenConfig","updateLauncherConfig","launcherConfig","changeView","newView","reason","tryHydrating","forceViewChange","newViewState","constructViewState","isEqual","fireViewChangeEventsAndChangeView","isHydrated","viewChanging","setViewChanging","oldViewState","preViewChangeEvent","VIEW_PRE_CHANGE","cancelViewChange","setViewState","viewChangeEvent","VIEW_CHANGE","changeViewReason","setTourData","ViewType","TOUR","TOUR_START","TOUR_STEP","step","tourState","endTour","LAUNCHER","clearTourData","goToSpecificTourStep","stepId","newStepIndex","findIndex","stepItem","step_id","changeStepInTour","changeStepOptions","nextStep","previousStep","actualNewStepIndex","catastrophicErrorType","callOnError","additionalChatParameters","onError","restartConversation","skipHydration","endAgentConversation","fireEvents","PRE_RESTART_CONVERSATION","currentState","MAIN_WINDOW","mainWindowOpenReason","MainWindowOpenReason","CALLED_RESTART_CONVERSATION","instance","updateAssistantInputFieldVisibility","cancelAllMessageRequests","RESTART_CONVERSATION","destroySession","keepOpenState","originalViewState","newPersistedToBrowserStorage","userSessionStorageService","clearLauncherSession","clearChatSession","agentEndConversation","endedByUser","HANDLER_NOT_FUNCTION","EventBus","handlersByType","Map","eventsTypesRunning","eventsRunningCount","busEvent","logEvent","JSON","stringify","handlersForType","handlersCopy","slice","delete","waitForEmptyPromise","fireSync","waitForEmpty","on","handlers","asArray","debugStackTrace","off","indexOf","removed","splice","once","onceHandler","event","logListeners","listeners","group","listener","consoleLog","groupEnd","clear","eventCopy","createCustomPanelInstance","customPanelInstance","open","setCustomPanelConfigOptions","setCustomPanelOpen","close","HistoryService","useHistory","publicConfig","resultData","customLoadHistory","historyNotes","async","allLocalMessagesByID","loadingState","allMessages","threadMessagesByThreadID","responsesByRequestID","relatedMessageByID","localMessagesByOriginalMessageID","lastThreadID","loadedHistory","latestTransferToAgentResponse","note","historyItem","isEventRequest","timestamp","Date","getTime","THREAD_ID_MAIN","file_upload_status","FileStatusValue","UPLOADING","COMPLETE","error_state","MessageErrorState","FAILED","related_message_id","beginEvent","HISTORY_BEGIN","eventBus","HISTORY_END","notesToMessages","getResponseItems","thread","addMessageToThread","createLocalMessages","localMessagesByFullMessageID","toChatMessageState","createChatStates","mainThreadMessages","welcomeRequest","findLast","is_welcome_request","welcomeResponse","markIsLatestWelcomeNode","isOptionItem","relatedRequest","optionSelected","isDateResponseType","markSelectedOptions","notesToLoadedHistory","SESSION_HISTORY","MessageLoadingManager","start","onExceededMaxSilentLoading","onEnd","onTimeout","msMaxSilentLoading","msMaxAttempt","hasExceededMaxSilentLoading","onSilentLoading","setTimeout","onMaxAttempt","end","clearTimeout","MS_BETWEEN_RETRIES","RetryType","MessageService","pendingLocale","localeIsExplicit","messageLoadingManager","queue","waiting","timeoutOverride","messageTimeoutSecs","timeoutMS","processSuccess","received","isProcessed","isWelcomeNode","setMessageErrorState","NONE","message_type","MessageInputType","EVENT","now","trackData","lastRequestTime","timeLastRequest","totalRequestTime","timeFirstRequest","sendMessagePromise","moveToNextQueueItem","addErrorMessage","errorMessage","HYDRATE_RESEND","skipQueue","sendToAssistantAndUpdateErrorState","sendToAssistant","SILENT","VISIBLE","RETRYING","waitingMessage","WAITING","processError","pendingRequest","resultText","allowRetry","tryCount","isWelcome","msSinceStarted","isInAttemptWindow","numErrors","retryDelay","MESSAGE_COMMUNICATION","otherData","rejectFinalErrorOnMessage","customSendMessage","updateMessage","controller","AbortController","sendMessageController","signal","runQueueIfReady","clearCurrentQueueItem","getLastBotResponseWithContext","LOADING_INDICATOR_TIMER","messageLoadingIndicatorTimeoutSecs","addIsLoadingCounter","didExceedMaxLoading","cancelMessageRequestByID","PRE_SEND","updateLocalMessageItem","SEND","addToMessageQueue","newPendingMessage","errorState","messageToUpdate","announceMessageID","announceMessage","logError","lastResponse","abort","safeFetchTextWithTimeout","NamespaceService","namespace","originalName","attributeSafe","suffix","computedName","computeNamespaceName","getSuffix","ServiceManager","innerStorage","storage$1","getItem","setItem","removeItem","storage","IS_SESSION_STORAGE","window","sessionStorage","UserSessionStorageService","prefix","loadChatSession","chatSessionString","getChatSessionKey","chatSession","parse","loadLauncherSession","launcherSessionString","getLauncherSessionKey","launcherSession","persistChatSession","session","persistLauncherSession","replaceCurrentArrayValue","currentValue","newValue","Array","isArray","agentReducers","action","activeLocalMessageID","serviceDeskState","newInputState","populateTourStepItems","tourMessageItem","find","steps","clearTourState","EXCLUDE_AGENT_UNREAD","AgentMessageType","USER_ENDED_CHAT","CHAT_WAS_ENDED","RELOAD_WARNING","reducers","CHANGE_STATE","partialState","HYDRATE_CHAT","iFramePanelState","viewSourcePanelState","customPanelState","HYDRATE_MESSAGE_HISTORY","ADD_LOCAL_MESSAGE_ITEM","addAfterID","isSilent","currentIndex","existingID","newLocalMessageIDs","insertAtIndex","afterIDIndex","isBotMessage","agent_message_type","isMainWindowOpen","isBrowserPageVisible","REMOVE_MESSAGES","idsSet","newAllMessages","newAllMessageItems","newMessageIDs","newMessageItemsIDs","UPDATE_LOCAL_MESSAGE_ITEM","UPDATE_MESSAGE","ADD_MESSAGE","itemIDsInNewMessage","newAllMessageItemsByID","existingItemIDs","firstFoundIndex","isItemInMessage","itemIDsToInsert","MESSAGE_SET_OPTION_SELECTED","newMessagesByID","sentMessage","ADD_IS_TYPING_COUNTER","Math","max","addToIsTyping","ADD_IS_LOADING_COUNTER","addToIsLoading","ADD_IS_HYDRATING_COUNTER","addToIsHydrating","SET_APP_STATE_VALUE","UPDATE_PERSISTED_CHAT_STATE","UPDATE_HAS_SENT_NON_WELCOME_MESSAGE","SET_VIEW_STATE","previousState","handleViewStateChange","SET_VIEW_CHANGING","SET_INITIAL_VIEW_CHANGE_COMPLETE","initialViewChangeComplete","changeComplete","UPDATE_BOT_NAME","botName","UPDATE_BOT_AVATAR_URL","botAvatarURL","UPDATE_LAUNCHER_AVATAR_URL","avatar_url_override","UPDATE_MAIN_HEADER_TITLE","UPDATE_CSS_VARIABLES","variables","cssVariableOverrides","UPDATE_HOME_SCREEN_CONFIG","newHomeScreenConfig","mergeWith","SET_MESSAGE_UI_PROPERTY","SET_MESSAGE_HISTORY_PROPERTY","MERGE_HISTORY","ANNOUNCE_MESSAGE","ACCEPTED_DISCLAIMER","location","hostname","SET_HOME_SCREEN_IS_OPEN","TOGGLE_HOME_SCREEN","UPDATE_LAUNCHER_CONFIG","SET_LAUNCHER_PROPERTY","SET_LAUNCHER_CONFIG_PROPERTY","launcherType","LauncherType","DESKTOP","MOBILE","SET_CHAT_MESSAGES_PROPERTY","SET_LAUNCHER_MINIMIZED","OPEN_IFRAME_CONTENT","CLOSE_IFRAME_PANEL","SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN","relatedSearchResult","SET_CUSTOM_PANEL_OPEN","SET_CUSTOM_PANEL_OPTIONS","SET_TOUR_DATA","newActiveTourMessageID","CLEAR_TOUR_DATA","CHANGE_STEP_IN_TOUR","min","newStepNumber","UPDATE_INPUT_STATE","applyInputState","getInputState","isInputToAgent","SET_IS_BROWSER_PAGE_VISIBLE","ADD_INPUT_FILE","file","currentInputState","REMOVE_INPUT_FILE","fileID","newUploads","REMOVE_LOCAL_MESSAGE_ITEM","ADD_NOTIFICATION","notificationID","notifications","concat","REMOVE_NOTIFICATIONS","REMOVE_ALL_NOTIFICATIONS","CLEAR_INPUT_FILES","FILE_UPLOAD_INPUT_ERROR","currentInputSate","isError","status","ADD_NESTED_MESSAGES","localMessageItems","SET_RESPONSE_PANEL_IS_OPEN","SET_RESPONSE_PANEL_CONTENT","STREAMING_START","STREAMING_MERGE_HISTORY","existingMessage","newMessage","STREAMING_ADD_CHUNK","chunkItem","localItemID","existingLocalMessageItem","newItem","streamingState","chunks","isDone","isIntermediateStreaming","UPDATE_CHAT_HEADER_CONFIG","chatHeaderConfig","chatHeaderState","UPDATE_MAX_VISIBLE_HEADER_OBJECTS","maxTotal","maxVisibleHeaderObjects","SET_STOP_STREAMING_BUTTON_VISIBLE","SET_STOP_STREAMING_BUTTON_DISABLED","SET_STREAM_ID","UPDATE_MAIN_HEADER_AVATAR","headerAvatarConfig","getThemeCornersType","getLayoutState","IS_PHONE","themeConfig","SQUARE","layout","reducerFunction","assign","DEFAULT_PUBLIC_CONFIG","openChatByDefault","showLauncher","shouldTakeFocusIfOpensAutomatically","dayjs","LocalizedFormat","Chat$1","publicConfigProvided","customHostElement","additionalChatParametersProvided","debug","consoleDebug","appConfig","startInternal","doesHaveServiceDesk","getBotName","initialState","chatWidthBreakpoint","chatWidth","chatHeight","enLanguagePack","originalConfig","suspendScrollDetection","isDestroyed","targetViewState","showNonHeaderBackgroundCover","sessionStorageLauncherState","enhancer","__REDUX_DEVTOOLS_EXTENSION__","instanceId","createStore","doCreateStore","subscribe","previousPersistedToBrowserStorage","copyToSessionStorage","disableWindowTitleChanges","originalTitle","changeTitleTimer","agent_newMessage","createHandleWindowTitle","customPanelManager","serviceManger","panels","getPanel","createCustomPanelManager","WriteableElementName","AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT","WELCOME_NODE_BEFORE_ELEMENT","HEADER_BOTTOM_ELEMENT","BEFORE_INPUT_ELEMENT","HOME_SCREEN_HEADER_BOTTOM_ELEMENT","HOME_SCREEN_AFTER_STARTERS_ELEMENT","HOME_SCREEN_BEFORE_INPUT_ELEMENT","CUSTOM_PANEL_ELEMENT","setEnableDebugLog","debugStackTraces","setEnableDebugStackTracesLog","createServiceManager","localePack","render","createHumanAgentService","all","loadLanguagePack","loadLocale","loadHAA","reallyRenderAndReturnInstance","OPEN_BY_DEFAULT","WEB_CHAT_LOADED","setInitialViewChangeComplete","callRender","wasRendered","newPack","updateLocale","newLocale","localePromise","languagePackPromise","then","selectInputState","INSTANCE_SEND","destroy","container","remove","updateInputState","updateInputIsDisabled","updateBotUnreadIndicatorVisibility","setLauncherProperty","issueWithNewView","viewTypeValues","CALLED_CHANGE_VIEW","homeScreenConfigClone","scrollToMessage","animate","doScrollToMessage","customPanels","updateCustomMenuOptions","updateIsTypingCounter","direction","updateIsLoadingCounter","updateIsChatLoadingCounter","updateHeaderConfig","configCopy","updateChatHeaderConfig","updateMainHeaderAvatar","elements","getMainWindow","addClassName","removeClassName","getMessageInput","getHTMLElement","setValue","setEnableEnterKey","addChangeListener","removeChangeListener","getHomeScreenInput","tours","CALLED_END_TOUR","goToNextStep","goToStep","addMessageChunk","clearConversation","requestFocus","appWindow","endConversation","updateIsSuspended","createChatInstance","renderAndReturnInstance","renderPromise","AriaAnnouncerProvider","useIntl","useServiceManager","announcerRef","announcerFunction","announceValue","previousAnnounceMessageRef","useEffect","currentAnnounceMessage","AriaAnnouncerContext","Provider","AriaAnnouncerComponent","getLauncherButtonAriaLabel","isLauncherHidden","launcher_isTourOpen","launcher_isTourClosed","launcher_isOpen","launcher_isClosed","Launcher","onToggleOpen","unreadAgentCount","tabIndex","launcherHidden","launcherAvatarURL","buttonRef","doFocusRef","ariaLabel","formatMessage","count","launcherAvatar","AiLaunch","size","ChatLaunch","src","alt","cx","Button","WACLauncher__TourButton","PageObjectId","kind","ButtonKindEnum","PRIMARY","onClick","ArrowUpLeft","LauncherExport","Tag","createComponent","tagName","elementClass","CarbonTagElement","react","CloseIcon","carbonIconToReact","Close16","LauncherComplex","launcherComplexRef","launcherRef","onOpen","onMinimize","launcher_desktopGreeting","launcher_closeButton","launcher_ariaIsExpanded","disabled","WACLauncherComplex__Text","onKeyDown","e","preventDefault","LauncherDesktopContainer","onDoToggle","useLanguagePack","browserLauncherState","isExpandedLauncherEnabled","smallLauncherClassName","setSmallLauncherClassName","useState","complexLauncherClassName","setComplexLauncherClassName","launcherHiddenRef","animateOnceVisible","bounceTurnRef","animationStartTimerRef","animationFinishedTimerRef","firstBounceAnimationStartTimerRef","firstBounceAnimationFinishedTimerRef","secondBounceAnimationStartTimerRef","secondBounceAnimationFinishedTimerRef","determineLauncherHeight","expandedLauncherHeight","offsetHeight","style","setProperty","startExpandLauncher","setExpandAnimationTimers","clearExpandAnimationTimers","startBounceAnimation","finishBounceAnimation","setBounceAnimationTimers","clearBounceAnimationTimers","setDefaultLauncherState","setLauncherMinimized","useOnMount","setLauncherConfigProperty","prevLauncherTitle","usePrevious","animateWithClass","endAnimationNameOrDelay","endAnimationCallback","classList","animationName","removeEventListener","addEventListener","LauncherExtended","isExtended","playExtendAnimation","onSwipeRight","onReduceEnd","ariaAnnouncer","useAriaAnnouncer","animateExtendedState","setAnimateExtendedState","showGreetingMessage","setShowGreetingMessage","prevIsExtended","extendedContainerRef","greetingMessageRef","textHolderRef","touchStartRef","touchStartX","touchStartY","shouldReduceExtendedLauncher","extendWithAnimation","extendWithoutAnimation","launcherGreetingMessage","launcher_mobileGreeting","launcherContainerElement","textHolderEl","greetingMessageEl","extendedContainerEl","maxTextHolderWidth","launcherPosition","width","height","screen","extendedWidth","getMaxLauncherExtendedWidth","clientWidth","querySelector","launcherExtendedWidth","removeAttribute","calculateAndSetMaxExtendedLauncherWidth","doFadeAnimationForElements","fadeInElement","fadeInTime","buttonEl","handleTouchMove","touchList","touchStartCoordinates","callback","clientX","touchEndX","clientY","touchEndY","differenceX","differenceY","abs","checkIfUserSwipedRight","touches","handleTouchStart","touchStart","reduceAnimationEndListener","fadeOutElement","GHOST","LauncherExtendedExport","LauncherMobileContainer","wasReduced","disableBounce","isStartingBounceAnimation","setIsStartingBounceAnimation","prevWasReduced","initialBounceTurn","previouslyPlayedExtendAnimation","extendLauncherTimeoutIDRef","reduceLauncherTimeoutIDRef","endBounceAnimationRef","shouldBounceRef","isExtending","disableIntroAnimation","setLauncherStateAsReduced","reduceLauncher","extendLauncherTimeoutID","reduceLauncherTimeoutID","clearTimeouts","setExpandAnimationTimeout","endBounceAnimation","startRecurringBounceAnimation","turnCounter","animation","timeouts","startingIndex","beforeAll","afterAll","beforeEach","afterEach","terminate","timeoutID","playAnimation","setAnimationListener","replayAnimation","setAnimationTimeouts","handleToggleOpen","handleSwipeRight","LauncherContainer","LAUNCHER_CLICKED","launcherContainer","effect","deps","hasRunRef","useEffectDidUpdate","HydrationPanel","useHomeScreenVersion","isHidden","useContext","HideComponentContext","header","BotHeaderExport","onToggleHomeScreen","includeWriteableElement","HYDRATING","MountChildrenOnDelay","delay","AnnounceOnMountComponentExport","announceOnce","window_ariaWindowLoading","Loading","overlay","assistiveText","CustomPanel","onPanelOpenEnd","onPanelCloseEnd","onPanelOpenStart","onPanelCloseStart","disableDefaultCloseAction","onClickBack","prevIsOpen","openAnimation","AnimationInType","SLIDE_IN_FROM_BOTTOM","closeAnimation","AnimationOutType","SLIDE_OUT_TO_BOTTOM","onClickBackLocal","onClickCloseLocal","checkAllowClose","onCloseAndRestartLocal","OverlayPanel","onOpenStart","CUSTOM_PANEL_PRE_OPEN","onOpenEnd","CUSTOM_PANEL_OPEN","onCloseStart","CUSTOM_PANEL_PRE_CLOSE","onCloseEnd","CUSTOM_PANEL_CLOSE","animationOnOpen","animationOnClose","shouldOpen","overlayPanelName","CUSTOM","eventName","eventDescription","general_returnToAssistant","hideCloseButton","WriteableElement","CustomPanelExport","Chat","lazyChat","CatastrophicError","lazyCatastrophicError","Disclaimer","lazyDisclaimer","HomeScreenContainer","lazyHomeScreenContainer","IFramePanel","lazyIFramePanel","ViewSourcePanel","lazyViewSourcePanel","BodyAndFooterPanelComponent","lazyBodyAndFooterPanelComponent","WIDTH_BREAKPOINT_STANDARD","WIDTH_BREAKPOINT_NARROW","WIDTH_BREAKPOINT_WIDE","MainWindow","Component","super","arguments","closing","modalPortalHostElement","numPanelsOpen","numPanelsAnimating","numPanelsCovering","isHydrationAnimationComplete","shouldAutoFocus","extraClassNames","areModulesLoaded","mainWindowRef","containerRef","botChatRef","homeScreenInputRef","disclaimerRef","brandingRef","animationContainerRef","iframePanelRef","viewSourcePanelRef","previousBodyVisibility","previousBodyPosition","onResize","appChatWidthBreakpoint","offsetWidth","ChatWidthBreakpoint","WIDE","STANDARD","NARROW","onVisualViewportResize","updateFromVisualViewport","visualViewport","offsetTop","offsetLeft","setModalPortalHostElement","setState","onSendInput","selectIsInputToAgent","sendMessageToAgent","clearInputFiles","onSendHomeButtonInput","createMessageRequestForChoice","HOME_SCREEN_STARTER","removeChatFromDom","doClose","toggleHomeScreen","getShowDisclaimer","getShowHomeScreen","takeFocus","requestInputFocus","onUserTyping","userTyping","onAcceptDisclaimer","acceptDisclaimer","coverBackground","prevState","onHydrationPanelClose","componentDidMount","mainWindowObserver","ResizeObserver","observe","disableCustomElementMobileEnhancements","updateBody","SCROLLBAR_WIDTH","loadPanels","componentWillUnmount","unobserve","componentDidUpdate","oldProps","oldState","newProps","useCustomHostElement","prevViewState","requestAnimationFrame","newLastItemID","lastMessageItem","componentDidCatch","errorInfo","createDidCatchErrorData","preload","unmounting","IS_IOS","getPropertyValue","fromCloseAndRestart","MAIN_WINDOW_CLOSED_AND_RESTARTED","DEFAULT_MINIMIZE","disclaimer","addClassNameToState","removeClassNameFromState","renderChat","showCovering","renderCustomPanel","renderHydrationPanel","renderDisclaimerPanel","renderResponsePanel","renderHomeScreenPanel","renderIFramePanel","renderViewSourcePanel","renderBotChat","headerAvatar","agentDisplayState","selectAgentDisplayState","showDisclaimer","hideBotContainer","HideComponent","hidden","Suspense","fallback","messageState","MESSAGE_INPUT","renderInnerHydrationPanel","shouldHide","renderCatastrophicPanel","CATASTROPHIC","showHeader","FADE_IN","FADE_OUT","DISCLAIMER","disclaimerHTML","disclaimerAcceptButtonRef","showHomeScreen","onSendBotInput","HOME_SCREEN_INPUT","onSendButtonInput","IFRAME","CONVERSATIONAL_SEARCH_CITATION","panelOptions","PANEL_RESPONSE","showAnimations","show_animations","renderMessageComponent","childProps","MessageTypeComponent","renderWidget","localeClassName","showGlass","enableFocusTrap","hideMinimizeButton","trapActive","isWideWidth","VisuallyHidden","window_title","onScroll","scrollTop","ModalPortalRootContext","MainWindow$1","connect","TourContainerLazy","lazyTourComponent","App","hostElement","applicationStyles","fontStyles","combinedStyles","AppContainer$1","useDispatch","windowSize","setWindowSize","innerWidth","innerHeight","cssVariableOverrideString","useMemo","cssVariables","cssVariablesString","allValues","replace","convertCSSVariablesToString","dir","windowListener","visibilityListener","setIsBrowserPageVisible","visibilityState","node","nonce","cspNonce","IS_PHONE_IN_PORTRAIT_MODE","WindowSizeContext","ServiceManagerContext","RawIntlProvider","LanguagePackContext","MainContainer","tourContainerRef","showTour","showedTourOnce","languageKey","regionLabel","role","UserDefinedResponsePortalsContainer","chatInstance","renderUserDefinedResponse","userDefinedResponseEventsBySlot","slotState","UserDefinedResponseComponentPortal","ReactDOM","UserDefinedResponsePortalsContainerExport","WriteableElementsPortalsContainer","renderResponseMap","responseItem","WriteableElementsComponentPortal","WriteableElementsPortalsContainerExport","AppContainer","onBeforeRender","onAfterRender","renderWriteableElements","setParentInstance","setInstance","renderProps","setRenderProps","setApplicationStyles","setInstances","setUserDefinedResponseEventsBySlot","managedWebChatRef","previousConfigRef","previousConfig","managedWebChat","shouldDestroy","destroyWebChat","widget","pagePublicConfig","chatConstructorPromise","protocol","compatMode","instantiateWidget","webChatInstance","userDefinedEventsBySlot","itemChunk","partialItems","addUserDefinedResponseHandler","loadChat","carbonStyles","loadBaseStyles","loadCarbon","loadStyles","AppContainerExport","default","carbon"],"sourceRoot":""}