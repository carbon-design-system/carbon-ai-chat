{"version":3,"file":"2288.bundle.js","mappings":"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","sources":["webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/schema/outputItemToLocalItem.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/BasePanelComponent.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/homeScreenUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/intlUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/ChatInstanceImpl.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/environmentVariables.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/types/config/LauncherConfig.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/reducerUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/colors.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/styleUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/viewStateUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/events/ChatActionsImpl.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/events/EventBus.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/CustomPanelInstance.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/HistoryService.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/schema/historyToMessages.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/messageServiceUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/MessageService.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/NamespaceService.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/ServiceManager.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/mockStorage.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/UserSessionStorageService.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/customizers.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/agentReducers.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/tourReducerUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/reducers.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/doCreateStore.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/chatEntryFunctions.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/Chat.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/loadServices.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/subscriptions.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/services/CustomPanelManager.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/aria/AriaAnnouncerProvider.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/launcherUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/Launcher.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/LauncherComplex.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/LauncherDesktopContainer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/animationUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/LauncherExtended.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/LauncherMobileContainer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/launcher/LauncherContainer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/hooks/useEffectDidUpdate.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/HydrationPanel.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/panels/CustomPanel.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/containers/main/MainWindow.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/types/utilities/HasAddRemoveClassName.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/containers/App.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/react/components/UserDefinedResponsePortalsContainer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/react/components/WriteableElementsPortalsContainer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/react/components/AppContainer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/hocs/withAriaAnnouncer.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/types/messaging/LocalMessageItem.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/resolvablePromise.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/aria/AriaAnnouncerComponent.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/homeScreen/HomeScreenHeader.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/contexts/WindowSizeContext.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/util/AnnounceOnMountComponent.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/selectors.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/components/header/BotHeader.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/utils/lang/objectUtils.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/schema/inputItemToLocalItem.js","webpack://@carbon/ai-chat-examples-demo/../packages/ai-chat/dist/es/chat/shared/store/agentActions.js"],"sourcesContent":["import { MessageResponseTypes, ButtonItemType } from \"../../../types/messaging/Messages.js\";\n\nimport { uuid } from \"../utils/lang/uuid.js\";\n\nimport { streamItemID, createMessageResponseForItem, isGridResponseType, isCarouselResponseType, isShowPanelButtonType, isResponseWithNestedItems, isItemSupportedInResponseBody, isCardResponseType, isButtonResponseType } from \"../utils/messageUtils.js\";\n\nimport { consoleError } from \"../utils/miscUtils.js\";\n\nimport { UUIDType } from \"../utils/lang/UUIDType.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function outputItemToLocalItem(messageItem, fullMessage, isLatestWelcomeNode = false, disableFadeAnimation = false) {\n  const id = streamItemID(fullMessage.id, messageItem) || uuid(UUIDType.LOCAL_MESSAGE);\n  const localMessage = {\n    ui_state: {\n      id: id,\n      needsAnnouncement: !fullMessage.history.from_history,\n      disableFadeAnimation: disableFadeAnimation\n    },\n    item: messageItem,\n    fullMessageID: fullMessage.id\n  };\n  if (isLatestWelcomeNode) {\n    localMessage.ui_state.isWelcomeResponse = true;\n  }\n  return localMessage;\n}\n\nfunction createLocalMessageForInlineError(text) {\n  const messageItem = {\n    response_type: MessageResponseTypes.INLINE_ERROR,\n    text: text\n  };\n  return createLocalMessageForItem(messageItem);\n}\n\nfunction createLocalMessageForItem(messageItem) {\n  const originalMessage = createMessageResponseForItem(messageItem);\n  const localMessage = outputItemToLocalItem(messageItem, originalMessage);\n  return {\n    originalMessage: originalMessage,\n    localMessage: localMessage\n  };\n}\n\nfunction createLocalMessageItemsForNestedMessageItems(localMessageItem, originalMessage, fromHistory, nestedLocalMessageItems, allowFooter) {\n  const {item: item} = localMessageItem;\n  if (isGridResponseType(item)) {\n    localMessageItem.ui_state.gridLocalMessageItemIDs = item.rows.map(row => row.cells.map(cell => {\n      const cellLocalMessageItemIDs = [];\n      createLocalMessageItemsForNestedType(\"items\", localMessageItem, cell.items, cellLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInBody(localMessageItem.item, nestedMessageItem), false);\n      return cellLocalMessageItemIDs;\n    }));\n  } else if (isCarouselResponseType(item)) {\n    localMessageItem.ui_state.itemsLocalMessageItemIDs = [];\n    createLocalMessageItemsForNestedType(\"items\", localMessageItem, item.items, localMessageItem.ui_state.itemsLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInBody(item, nestedMessageItem), allowFooter);\n  } else {\n    const bodyItems = item.body || item.panel?.body;\n    if (bodyItems) {\n      localMessageItem.ui_state.bodyLocalMessageItemIDs = [];\n      createLocalMessageItemsForNestedType(\"body\", localMessageItem, bodyItems, localMessageItem.ui_state.bodyLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInBody(item, nestedMessageItem), !isShowPanelButtonType(item));\n    }\n    if (!allowFooter) {\n      return;\n    }\n    const footerItems = item.footer || item.panel?.footer;\n    if (footerItems) {\n      localMessageItem.ui_state.footerLocalMessageItemIDs = [];\n      createLocalMessageItemsForNestedType(\"footer\", localMessageItem, footerItems, localMessageItem.ui_state.footerLocalMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, nestedMessageItem => isSupportedMessageItemInFooter(item, nestedMessageItem), !isShowPanelButtonType(item));\n    }\n  }\n}\n\nfunction createLocalMessageItemsForNestedType(type, localMessageItem, items, nestedMessageItemIDs, originalMessage, fromHistory, nestedLocalMessageItems, isSupported, allowFooter) {\n  items.forEach(nestedMessageItem => {\n    if (isSupported(nestedMessageItem)) {\n      const nestedLocalMessageItem = outputItemToLocalItem(nestedMessageItem, originalMessage, false, true);\n      nestedMessageItemIDs.push(nestedLocalMessageItem.ui_state.id);\n      nestedLocalMessageItems.push(nestedLocalMessageItem);\n      if (isResponseWithNestedItems(nestedLocalMessageItem.item)) {\n        createLocalMessageItemsForNestedMessageItems(nestedLocalMessageItem, originalMessage, fromHistory, nestedLocalMessageItems, allowFooter);\n      }\n    } else {\n      consoleError(`The \"${localMessageItem.item.response_type}\" response type does not support \"${nestedMessageItem.response_type}\" in \"${type}\" array.`);\n    }\n  });\n}\n\nfunction isSupportedMessageItemInBody(rootMessageItem, nestedMessageItem) {\n  switch (rootMessageItem.response_type) {\n   case MessageResponseTypes.CARD:\n    return !isCardResponseType(nestedMessageItem) && isItemSupportedInResponseBody(nestedMessageItem);\n\n   case MessageResponseTypes.CAROUSEL:\n    return isCardResponseType(nestedMessageItem);\n\n   case MessageResponseTypes.BUTTON:\n    return rootMessageItem.button_type === ButtonItemType.SHOW_PANEL && isItemSupportedInResponseBody(nestedMessageItem);\n\n   case MessageResponseTypes.GRID:\n    return !isCardResponseType(nestedMessageItem) && isItemSupportedInResponseBody(nestedMessageItem);\n\n   default:\n    return false;\n  }\n}\n\nfunction isSupportedMessageItemInFooter(rootMessageItem, nestedMessageItem) {\n  if (isButtonResponseType(nestedMessageItem)) {\n    if (isShowPanelButtonType(rootMessageItem)) {\n      return !isShowPanelButtonType(nestedMessageItem);\n    }\n    return true;\n  }\n  return false;\n}\n\nexport { createLocalMessageForInlineError, createLocalMessageItemsForNestedMessageItems, outputItemToLocalItem };\n","import FocusTrap from \"focus-trap-react\";\n\nimport React, { useRef, useImperativeHandle } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { IS_MOBILE } from \"../utils/browserUtils.js\";\n\nimport { Header as HeaderExport } from \"./header/Header.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function BasePanelComponent({className: className, children: children, isOpen: isOpen, hidePanelHeader: hidePanelHeader, labelBackButton: labelBackButton, title: title, hideBackButton: hideBackButton, useAITheme: useAITheme, onClickCloseAndRestart: onClickCloseAndRestart, onClickRestart: onClickRestart, testIdPrefix: testIdPrefix, ...headerProps}, ref) {\n  const showRestartButton = useSelector(state => state.config.public.headerConfig?.showRestartButton);\n  const headerRef = useRef();\n  useImperativeHandle(ref, () => headerRef.current);\n  return React.createElement(FocusTrap, {\n    active: isOpen,\n    focusTrapOptions: {\n      clickOutsideDeactivates: true,\n      returnFocusOnDeactivate: !IS_MOBILE,\n      preventScroll: true\n    }\n  }, React.createElement(\"div\", {\n    className: className\n  }, !hidePanelHeader && React.createElement(HeaderExport, {\n    ...headerProps,\n    ref: headerRef,\n    showRestartButton: showRestartButton,\n    onClickRestart: onClickRestart,\n    onCloseAndRestart: onClickCloseAndRestart,\n    showBackButton: !hideBackButton,\n    labelBackButton: labelBackButton,\n    displayName: title,\n    useAITheme: useAITheme,\n    testIdPrefix: testIdPrefix,\n    showCenter: true\n  }), React.createElement(\"div\", {\n    className: \"WACPanelContent\"\n  }, children)));\n}\n\nconst BasePanelComponentExport = React.memo(React.forwardRef(BasePanelComponent));\n\nexport { BasePanelComponentExport as BasePanelComponent };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction withoutEmptyStarters(config) {\n  let newConfig = config;\n  if (config?.starters?.buttons?.length) {\n    newConfig = {\n      allow_return: true,\n      ...config,\n      starters: {\n        ...config.starters,\n        buttons: config.starters.buttons.filter(button => Boolean(button.label?.trim()))\n      }\n    };\n    if (!newConfig?.starters?.buttons?.length) {\n      newConfig.starters.is_on = false;\n    }\n  }\n  return newConfig;\n}\n\nexport { withoutEmptyStarters };\n","import { createIntl } from \"react-intl\";\n\nimport actions from \"../store/actions.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function setIntl(serviceManager, locale, messages) {\n  serviceManager.intl = createIntl({\n    locale: locale,\n    messages: messages\n  });\n  serviceManager.store.dispatch(actions.setAppStateValue(\"languagePack\", messages));\n  serviceManager.store.dispatch(actions.setAppStateValue(\"locale\", locale));\n}\n\nexport { setIntl };\n","import dayjs from \"dayjs\";\n\nimport cloneDeep from \"lodash-es/cloneDeep.js\";\n\nimport actions from \"./store/actions.js\";\n\nimport { selectInputState } from \"./store/selectors.js\";\n\nimport \"../../types/state/AppState.js\";\n\nimport { withoutEmptyStarters } from \"./utils/homeScreenUtils.js\";\n\nimport { loadLocale, loadLanguagePack } from \"./utils/languages.js\";\n\nimport { consoleDebug, debugLog, consoleError, consoleWarn } from \"./utils/miscUtils.js\";\n\nimport { ViewChangeReason, MessageSendSource } from \"../../types/events/eventBusTypes.js\";\n\nimport { setIntl } from \"./utils/intlUtils.js\";\n\nimport { ViewType } from \"../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function createChatInstance({serviceManager: serviceManager, callRender: callRender}) {\n  let wasRendered = false;\n  function getMainWindow() {\n    return {\n      addClassName: name => serviceManager.mainWindow?.addClassName(name),\n      removeClassName: name => serviceManager.mainWindow?.removeClassName(name)\n    };\n  }\n  function getMessageInput() {\n    return {\n      getHTMLElement: () => serviceManager.mainWindow?.getMessageInput()?.getHTMLElement(),\n      setValue: value => serviceManager.mainWindow?.getMessageInput()?.setValue(value),\n      setEnableEnterKey: value => serviceManager.mainWindow?.getMessageInput()?.setEnableEnterKey(value),\n      addChangeListener: listener => serviceManager.mainWindow?.getMessageInput()?.addChangeListener(listener),\n      removeChangeListener: listener => serviceManager.mainWindow?.getMessageInput()?.removeChangeListener(listener)\n    };\n  }\n  function getHomeScreenInput() {\n    return {\n      getHTMLElement: () => serviceManager.mainWindow?.getHomeScreenInput()?.getHTMLElement(),\n      setValue: value => serviceManager.mainWindow?.getHomeScreenInput()?.setValue(value),\n      setEnableEnterKey: value => serviceManager.mainWindow?.getHomeScreenInput()?.setEnableEnterKey(value),\n      addChangeListener: listener => serviceManager.mainWindow?.getHomeScreenInput()?.addChangeListener(listener),\n      removeChangeListener: listener => serviceManager.mainWindow?.getHomeScreenInput()?.removeChangeListener(listener)\n    };\n  }\n  let instance = {\n    render: () => {\n      if (wasRendered) {\n        consoleError(\"The render function has already been called!\");\n        return Promise.resolve(instance);\n      }\n      wasRendered = true;\n      return callRender();\n    },\n    on: handlers => {\n      serviceManager.eventBus.on(handlers);\n      return instance;\n    },\n    off: handlers => {\n      serviceManager.eventBus.off(handlers);\n      return instance;\n    },\n    once: handlers => {\n      serviceManager.eventBus.once(handlers);\n      return instance;\n    },\n    updateLanguagePack: newPack => {\n      debugLog(\"Called instance.updateLanguagePack\", newPack);\n      return serviceManager.actions.updateLanguagePack(newPack);\n    },\n    updateLocale: newLocale => {\n      debugLog(\"Called instance.updateLocale\", newLocale);\n      const localePromise = loadLocale(newLocale);\n      const languagePackPromise = loadLanguagePack(serviceManager.store.getState().languagePack);\n      return Promise.all([ localePromise, languagePackPromise ]).then(([localePack, languagePack]) => {\n        dayjs.locale(localePack);\n        setIntl(serviceManager, localePack.name, languagePack);\n        serviceManager.messageService.pendingLocale = true;\n        serviceManager.messageService.localeIsExplicit = true;\n      });\n    },\n    updateCSSVariables: (variables, whiteLabelVariables) => {\n      debugLog(\"Called instance.updateCSSVariables\", variables);\n      return serviceManager.actions.updateCSSVariables(variables, whiteLabelVariables);\n    },\n    send: async (message, options) => {\n      debugLog(\"Called instance.send\", message, options);\n      if (selectInputState(serviceManager.store.getState()).isReadonly) {\n        throw new Error(\"You are unable to send messages in read only mode.\");\n      }\n      return serviceManager.actions.send(message, MessageSendSource.INSTANCE_SEND, options);\n    },\n    doAutoScroll: (options = {}) => {\n      debugLog(\"Called instance.doAutoScroll\", options);\n      serviceManager.mainWindow?.doAutoScroll?.(options);\n    },\n    destroy: () => {\n      debugLog(\"Called instance.destroy\");\n      serviceManager.store.dispatch(actions.setAppStateValue(\"isDestroyed\", true));\n      serviceManager.container?.remove();\n      instance = undefined;\n    },\n    updateAssistantInputFieldVisibility: isVisible => {\n      debugLog(\"Called instance.updateAssistantInputFieldVisibility\", isVisible);\n      serviceManager.store.dispatch(actions.updateInputState({\n        fieldVisible: isVisible\n      }, false));\n    },\n    updateInputIsDisabled: isDisabled => {\n      debugLog(\"Called instance.updateInputIsDisabled\", isDisabled);\n      serviceManager.store.dispatch(actions.updateInputState({\n        isReadonly: isDisabled\n      }, false));\n    },\n    updateBotUnreadIndicatorVisibility: isVisible => {\n      debugLog(\"Called instance.updateBotUnreadIndicatorVisibility\", isVisible);\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"showUnreadIndicator\", isVisible));\n    },\n    changeView: async newView => {\n      debugLog(\"Called instance.changeView\", newView);\n      let issueWithNewView = false;\n      if (!wasRendered) {\n        consoleError(`You tried to call \"changeView\" without ever having called the \"render\" method. There is no view to change!`);\n        issueWithNewView = true;\n      }\n      const viewTypeValues = Object.values(ViewType);\n      if (typeof newView === \"string\") {\n        if (!viewTypeValues.includes(newView)) {\n          consoleError(`You tried to change the view but the view you specified is not a valid view name. Please use` + ` the valid view names; ${viewTypeValues.join(\", \")}.`);\n          issueWithNewView = true;\n        }\n      } else if (typeof newView === \"object\") {\n        Object.keys(newView).forEach(key => {\n          if (!viewTypeValues.includes(key)) {\n            consoleError(`You tried to change the state of multiple views by providing an object, however you included the key` + ` \"${key}\" within the object which is not a valid view name. Please use the valid view names; ` + `${viewTypeValues.join(\", \")}.`);\n            issueWithNewView = true;\n          }\n        });\n      } else {\n        consoleError(\"You tried to change the view but the view you provided was not a string or an object. You can either change\" + ' to one of the supported views by providing a string, ex. \"launcher\", \"mainWindow\", or \"tour\". Or you can' + ' change the state of multiple views by providing an object, ex. { \"launcher\": true, \"mainWindow\": false,' + ' \"tour\": true }. Please use one of these supported options.');\n        issueWithNewView = true;\n      }\n      if (!issueWithNewView) {\n        await serviceManager.actions.changeView(newView, {\n          viewChangeReason: ViewChangeReason.CALLED_CHANGE_VIEW\n        });\n      }\n    },\n    notifications: {\n      addNotification: notification => {\n        debugLog(\"Called instance.addNotification\", notification);\n        serviceManager.actions.addNotification(notification);\n      },\n      removeNotifications: groupID => {\n        debugLog(\"Called instance.removeNotifications\", groupID);\n        serviceManager.actions.removeNotification(groupID);\n      },\n      removeAllNotifications: () => {\n        debugLog(\"Called instance.removeAllNotifications\");\n        serviceManager.actions.removeAllNotifications();\n      }\n    },\n    updateMainHeaderTitle: title => {\n      debugLog(\"Called instance.updateMainHeaderTitle\", title);\n      if (!title) {\n        title = null;\n      }\n      serviceManager.actions.updateMainHeaderTitle(title);\n    },\n    updateHomeScreenConfig: homeScreenConfig => {\n      debugLog(\"Called instance.updateHomeScreenConfig\", homeScreenConfig);\n      const homeScreenConfigClone = cloneDeep(homeScreenConfig);\n      const isAIThemeEnabled = serviceManager.store.getState().theme.useAITheme;\n      if (isAIThemeEnabled) {\n        if (homeScreenConfig?.background) {\n          consoleWarn(\"The home screen background can not be changed when the AI theme is enabled.\");\n          delete homeScreenConfigClone.background;\n        }\n      }\n      serviceManager.actions.updateHomeScreenConfig(withoutEmptyStarters(homeScreenConfigClone));\n    },\n    getState: () => serviceManager.actions.getPublicWebChatState(),\n    writeableElements: createWriteableElementsProxy(serviceManager),\n    scrollToMessage: (messageID, animate) => {\n      debugLog(\"Called instance.scrollToMessage\", messageID, animate);\n      serviceManager.mainWindow?.doScrollToMessage(messageID, animate);\n    },\n    updateLauncherConfig: config => serviceManager.actions.updateLauncherConfig(config),\n    customPanels: serviceManager.customPanelManager,\n    updateCustomMenuOptions: options => {\n      debugLog(\"Called instance.updateCustomMenuOptions\", options);\n      serviceManager.store.dispatch(actions.setAppStateValue(\"customMenuOptions\", options));\n    },\n    restartConversation: async () => {\n      debugLog(\"Called instance.restartConversation\");\n      return serviceManager.actions.restartConversation();\n    },\n    agentEndConversation: () => {\n      debugLog(\"Called instance.agentEndConversation\");\n      consoleWarn(`The instance.agentEndConversation method is deprecated. Use instance.serviceDesk.endConversation instead.`);\n      return serviceManager.actions.agentEndConversation(false);\n    },\n    updateIsTypingCounter(direction) {\n      debugLog(\"Called instance.updateIsTypingCounter\", direction);\n      const {store: store} = serviceManager;\n      if (direction === \"increase\") {\n        store.dispatch(actions.addIsTypingCounter(1));\n      } else if (direction === \"decrease\") {\n        if (store.getState().botMessageState.isTypingCounter <= 0) {\n          consoleError(\"You cannot decrease the typing counter when it is already <= 0\");\n          return;\n        }\n        store.dispatch(actions.addIsTypingCounter(-1));\n      } else {\n        consoleError(`[updateIsTypingCounter] Invalid direction: ${direction}. Valid values are \"increase\" and \"decrease\".`);\n      }\n    },\n    updateIsLoadingCounter(direction) {\n      debugLog(\"Called instance.updateIsLoadingCounter\", direction);\n      const {store: store} = serviceManager;\n      if (direction === \"increase\") {\n        store.dispatch(actions.addIsLoadingCounter(1));\n      } else if (direction === \"decrease\") {\n        if (store.getState().botMessageState.isLoadingCounter <= 0) {\n          consoleError(\"You cannot decrease the loading counter when it is already <= 0\");\n          return;\n        }\n        store.dispatch(actions.addIsLoadingCounter(-1));\n      } else {\n        consoleError(`[updateIsLoadingCounter] Invalid direction: ${direction}. Valid values are \"increase\" and \"decrease\".`);\n      }\n    },\n    updateIsChatLoadingCounter(direction) {\n      debugLog(\"Called instance.updateIsChatLoadingCounter\", direction);\n      const {store: store} = serviceManager;\n      if (direction === \"increase\") {\n        store.dispatch(actions.addIsHydratingCounter(1));\n      } else if (direction === \"decrease\") {\n        if (store.getState().botMessageState.isHydratingCounter <= 0) {\n          consoleError(\"You cannot decrease the hydrating counter when it is already <= 0\");\n          return;\n        }\n        store.dispatch(actions.addIsHydratingCounter(-1));\n      } else {\n        consoleError(`[updateIsChatLoadingCounter] Invalid direction: ${direction}. Valid values are \"increase\" and \"decrease\".`);\n      }\n    },\n    updateHeaderConfig: config => {\n      const configCopy = cloneDeep(config);\n      serviceManager.store.dispatch(actions.updateChatHeaderConfig(configCopy));\n    },\n    updateMainHeaderAvatar: config => {\n      serviceManager.store.dispatch(actions.updateMainHeaderAvatar(config));\n    },\n    updateBotName: name => serviceManager.actions.updateBotName(name),\n    updateBotAvatarURL: url => serviceManager.actions.updateBotAvatarURL(url),\n    elements: {\n      getMainWindow: getMainWindow,\n      getMessageInput: getMessageInput,\n      getHomeScreenInput: getHomeScreenInput\n    },\n    tours: {\n      startTour: async message => {\n        debugLog(\"Called instance.tours.startTour\", message);\n        await serviceManager.actions.send(message, MessageSendSource.START_TOUR_METHOD, {\n          skipTourCard: true\n        });\n      },\n      endTour: async () => {\n        debugLog(\"Called instance.tours.endTour\");\n        serviceManager.actions.endTour({\n          viewChangeReason: ViewChangeReason.CALLED_END_TOUR\n        });\n      },\n      goToNextStep: async () => {\n        debugLog(\"Called instance.tours.goToNextStep\");\n        serviceManager.actions.changeStepInTour({\n          nextStep: true\n        });\n      },\n      goToStep: async stepId => {\n        debugLog(\"Called instance.tours.goToStep\", stepId);\n        serviceManager.actions.goToSpecificTourStep(stepId);\n      }\n    },\n    messaging: {\n      addMessage: (message, options = {}) => {\n        debugLog(\"Called instance.messaging.addMessage\", message, options);\n        serviceManager.messageService.messageLoadingManager.end();\n        return serviceManager.actions.receive(message, options?.isLatestWelcomeNode ?? false, null, {\n          disableFadeAnimation: options?.disableFadeAnimation\n        });\n      },\n      addMessageChunk: async (chunk, options = {}) => {\n        debugLog(\"Called instance.messaging.addMessageChunk\", chunk, options);\n        serviceManager.messageService.messageLoadingManager.end();\n        await serviceManager.actions.receiveChunk(chunk, null, options);\n      },\n      removeMessages: async messageIDs => {\n        debugLog(\"Called instance.messaging.removeMessages\", messageIDs);\n        return serviceManager.actions.removeMessages(messageIDs);\n      },\n      clearConversation: () => {\n        debugLog(\"Called instance.messaging.clearConversation\");\n        return serviceManager.actions.restartConversation({\n          skipHydration: true,\n          endAgentConversation: false,\n          fireEvents: false\n        });\n      },\n      insertHistory: messages => {\n        debugLog(\"Called instance.messaging.insertHistory\", messages);\n        return serviceManager.actions.insertHistory(messages);\n      }\n    },\n    requestFocus: () => {\n      debugLog(\"Called instance.requestFocus\");\n      serviceManager.appWindow?.requestFocus();\n    },\n    serviceDesk: {\n      endConversation: () => {\n        debugLog(\"Called instance.serviceDesk.endConversation\");\n        return serviceManager.actions.agentEndConversation(false);\n      },\n      updateIsSuspended: async isSuspended => {\n        debugLog(\"Called instance.serviceDesk.updateIsSuspended\", isSuspended);\n        return serviceManager.actions.agentUpdateIsSuspended(isSuspended);\n      }\n    }\n  };\n  if (serviceManager.store.getState().config.public.debug) {\n    consoleDebug(\"[ChatInstanceImpl] Created chat instance\", instance);\n  }\n  return instance;\n}\n\nfunction createWriteableElementsProxy(serviceManager) {\n  const elementSet = new Set;\n  const handler = {\n    get(target, element) {\n      if (!elementSet.has(element)) {\n        elementSet.add(element);\n      }\n      return target[element];\n    }\n  };\n  return new Proxy(serviceManager.writeableElements, handler);\n}\n\nexport { createChatInstance };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst NODE_ENV = \"production\";\n\nconst VERSION = \"0.4.0\";\n\nexport { NODE_ENV, VERSION };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nvar NotificationType;\n\n(function(NotificationType) {\n  NotificationType[\"TEXT_NOTIFICATION\"] = \"text_notification\";\n})(NotificationType || (NotificationType = {}));\n\nconst BOUNCING_ANIMATION_TIMEOUTS = [ 15e3, 6e4 ];\n\nconst TIME_TO_ENTRANCE_ANIMATION_START = 15e3;\n\nexport { BOUNCING_ANIMATION_TIMEOUTS, NotificationType, TIME_TO_ENTRANCE_ANIMATION_START };\n","import isEqual from \"lodash-es/isEqual.js\";\n\nimport { VERSION } from \"../environmentVariables.js\";\n\nimport { NotificationType, TIME_TO_ENTRANCE_ANIMATION_START } from \"../../../types/config/LauncherConfig.js\";\n\nimport { DEFAULT_CUSTOM_PANEL_ID } from \"../utils/constants.js\";\n\nimport { deepFreeze } from \"../utils/lang/objectUtils.js\";\n\nimport \"../../../types/utilities/carbonTypes.js\";\n\nimport { CarbonTheme } from \"../../../types/config/PublicConfig.js\";\n\nimport { CornersType } from \"../../../types/config/CornersType.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const DEFAULT_LAUNCHER = {\n  config: {\n    is_on: true,\n    mobile: {\n      is_on: true,\n      title: \"\",\n      time_to_expand: TIME_TO_ENTRANCE_ANIMATION_START,\n      new_expand_time: false,\n      time_to_reduce: 1e4,\n      notification_type: NotificationType.TEXT_NOTIFICATION\n    },\n    desktop: {\n      is_on: true,\n      title: \"\",\n      new_expand_time: false,\n      time_to_expand: TIME_TO_ENTRANCE_ANIMATION_START,\n      notification_type: NotificationType.TEXT_NOTIFICATION\n    }\n  }\n};\n\ndeepFreeze(DEFAULT_LAUNCHER);\n\nconst DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS = {\n  title: null,\n  hideBackButton: false,\n  hidePanelHeader: false,\n  disableAnimation: false\n};\n\ndeepFreeze(DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS);\n\nconst DEFAULT_CUSTOM_PANEL_STATE = {\n  isOpen: false,\n  panelID: DEFAULT_CUSTOM_PANEL_ID,\n  options: DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS\n};\n\ndeepFreeze(DEFAULT_CUSTOM_PANEL_STATE);\n\nconst DEFAULT_IFRAME_PANEL_STATE = {\n  isOpen: false,\n  messageItem: null\n};\n\ndeepFreeze(DEFAULT_IFRAME_PANEL_STATE);\n\nconst DEFAULT_CITATION_PANEL_STATE = {\n  isOpen: false,\n  citationItem: null\n};\n\ndeepFreeze(DEFAULT_CITATION_PANEL_STATE);\n\nconst DEFAULT_TOUR_STATE = {\n  activeTourStepItems: null\n};\n\ndeepFreeze(DEFAULT_TOUR_STATE);\n\nconst DEFAULT_MESSAGE_PANEL_STATE = {\n  isOpen: false,\n  localMessageItem: null,\n  isMessageForInput: false\n};\n\ndeepFreeze(DEFAULT_MESSAGE_PANEL_STATE);\n\nconst VIEW_STATE_ALL_CLOSED = {\n  launcher: false,\n  mainWindow: false,\n  tour: false\n};\n\ndeepFreeze(VIEW_STATE_ALL_CLOSED);\n\nconst VIEW_STATE_LAUNCHER_OPEN = {\n  launcher: true,\n  mainWindow: false,\n  tour: false\n};\n\ndeepFreeze(VIEW_STATE_LAUNCHER_OPEN);\n\nconst VIEW_STATE_MAIN_WINDOW_OPEN = {\n  mainWindow: true,\n  launcher: false,\n  tour: false\n};\n\ndeepFreeze(VIEW_STATE_MAIN_WINDOW_OPEN);\n\nconst DEFAULT_PERSISTED_TO_BROWSER = {\n  chatState: {\n    version: VERSION,\n    disclaimersAccepted: {},\n    homeScreenState: {\n      isHomeScreenOpen: false,\n      showBackToBot: false\n    },\n    hasSentNonWelcomeMessage: false,\n    persistedTourState: {\n      activeTourID: null,\n      activeTourCurrentStepIndex: null\n    },\n    agentState: {\n      isConnected: false,\n      isSuspended: false,\n      agentProfiles: {}\n    }\n  },\n  launcherState: {\n    wasLoadedFromBrowser: false,\n    version: VERSION,\n    viewState: VIEW_STATE_ALL_CLOSED,\n    activeTour: false,\n    showUnreadIndicator: false,\n    mobileLauncherIsExtended: false,\n    mobileLauncherWasReduced: false,\n    mobileLauncherDisableBounce: false,\n    desktopLauncherIsExpanded: false,\n    desktopLauncherWasMinimized: false,\n    bounceTurn: 1,\n    hasSentNonWelcomeMessage: false\n  }\n};\n\ndeepFreeze(DEFAULT_PERSISTED_TO_BROWSER);\n\nconst DEFAULT_CHAT_MESSAGES_STATE = {\n  localMessageIDs: [],\n  messageIDs: [],\n  isTypingCounter: 0,\n  isLoadingCounter: 0,\n  isHydratingCounter: 0,\n  isScrollAnchored: false\n};\n\ndeepFreeze(DEFAULT_CHAT_MESSAGES_STATE);\n\nconst DEFAULT_MESSAGE_STATE = {\n  allMessageItemsByID: {},\n  allMessagesByID: {},\n  botMessageState: {\n    ...DEFAULT_CHAT_MESSAGES_STATE\n  }\n};\n\ndeepFreeze(DEFAULT_MESSAGE_STATE);\n\nconst DEFAULT_INPUT_STATE = () => ({\n  fieldVisible: true,\n  isReadonly: false,\n  files: [],\n  allowFileUploads: false,\n  allowMultipleFileUploads: false,\n  allowedFileUploadTypes: null,\n  stopStreamingButtonState: {\n    currentStreamID: null,\n    isVisible: false,\n    isDisabled: false\n  }\n});\n\nconst DEFAULT_AGENT_STATE = {\n  isConnecting: false,\n  isReconnecting: false,\n  numUnreadMessages: 0,\n  fileUploadInProgress: false,\n  showScreenShareRequest: false,\n  isScreenSharing: false,\n  isAgentTyping: false,\n  inputState: DEFAULT_INPUT_STATE()\n};\n\ndeepFreeze(DEFAULT_AGENT_STATE);\n\nconst DEFAULT_THEME_STATE = {\n  carbonTheme: CarbonTheme.G10,\n  useAITheme: false,\n  corners: CornersType.ROUND\n};\n\ndeepFreeze(DEFAULT_THEME_STATE);\n\nconst DEFAULT_LAYOUT_STATE = {\n  showFrame: true,\n  hasContentMaxWidth: true\n};\n\ndeepFreeze(DEFAULT_LAYOUT_STATE);\n\nfunction calcAnnouncementForWidgetOpen(previousState, newViewState) {\n  if (isEqual(previousState.persistedToBrowserStorage.launcherState.viewState, newViewState)) {\n    return previousState.announceMessage;\n  }\n  return {\n    messageID: newViewState.mainWindow ? \"window_ariaWindowOpened\" : \"window_ariaWindowClosed\"\n  };\n}\n\nfunction applyBotMessageState(state, newState) {\n  return {\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      ...newState\n    }\n  };\n}\n\nfunction handleViewStateChange(state, viewState) {\n  let {agentState: agentState} = state;\n  let {showUnreadIndicator: showUnreadIndicator} = state.persistedToBrowserStorage.launcherState;\n  if (viewState.mainWindow && state.isBrowserPageVisible) {\n    if (agentState.numUnreadMessages !== 0) {\n      agentState = {\n        ...agentState,\n        numUnreadMessages: 0\n      };\n    }\n    showUnreadIndicator = false;\n  }\n  return {\n    ...state,\n    announceMessage: calcAnnouncementForWidgetOpen(state, viewState),\n    agentState: agentState,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        viewState: viewState,\n        showUnreadIndicator: showUnreadIndicator\n      }\n    }\n  };\n}\n\nfunction setHomeScreenOpenState(state, isOpen, showBackToBot) {\n  if (showBackToBot === undefined) {\n    showBackToBot = state.persistedToBrowserStorage.chatState.homeScreenState.showBackToBot;\n  }\n  return {\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        homeScreenState: {\n          ...state.persistedToBrowserStorage.chatState.homeScreenState,\n          isHomeScreenOpen: isOpen,\n          showBackToBot: showBackToBot\n        }\n      }\n    }\n  };\n}\n\nfunction applyLocalMessageUIState(state, localMessageID, propertyName, propertyValue) {\n  const oldMessage = state.allMessageItemsByID[localMessageID];\n  if (oldMessage) {\n    return {\n      ...state,\n      allMessageItemsByID: {\n        ...state.allMessageItemsByID,\n        [localMessageID]: {\n          ...oldMessage,\n          ui_state: {\n            ...oldMessage.ui_state,\n            [propertyName]: propertyValue\n          }\n        }\n      }\n    };\n  }\n  return state;\n}\n\nfunction applyFullMessage(state, message) {\n  const newState = {\n    ...state,\n    allMessagesByID: {\n      ...state.allMessagesByID,\n      [message.id]: message\n    }\n  };\n  if (!state.allMessagesByID[message.id]) {\n    const currentMessageIDs = state.botMessageState.messageIDs;\n    const newMessageIDs = [ ...currentMessageIDs, message.id ];\n    return applyBotMessageState(newState, {\n      messageIDs: newMessageIDs\n    });\n  }\n  return newState;\n}\n\nexport { DEFAULT_AGENT_STATE, DEFAULT_CHAT_MESSAGES_STATE, DEFAULT_CITATION_PANEL_STATE, DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS, DEFAULT_CUSTOM_PANEL_STATE, DEFAULT_IFRAME_PANEL_STATE, DEFAULT_INPUT_STATE, DEFAULT_LAUNCHER, DEFAULT_LAYOUT_STATE, DEFAULT_MESSAGE_PANEL_STATE, DEFAULT_MESSAGE_STATE, DEFAULT_PERSISTED_TO_BROWSER, DEFAULT_THEME_STATE, DEFAULT_TOUR_STATE, VIEW_STATE_ALL_CLOSED, VIEW_STATE_LAUNCHER_OPEN, VIEW_STATE_MAIN_WINDOW_OPEN, applyBotMessageState, applyFullMessage, applyLocalMessageUIState, handleViewStateChange, setHomeScreenOpenState };\n","import { gray100, white } from \"../../../node_modules/@carbon/colors/es/index.js\";\n\nimport Color from \"color\";\n\nimport { consoleError } from \"./miscUtils.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst MIN_CONTRAST = 4.5;\n\nfunction hexCodeToRGB(color) {\n  if (color.length === 7) {\n    const red = color.substring(1, 3);\n    const blue = color.substring(3, 5);\n    const green = color.substring(5, 7);\n    return [ parseInt(red, 16), parseInt(blue, 16), parseInt(green, 16) ];\n  }\n  if (color.length === 4) {\n    const red = color.substring(1, 2);\n    const blue = color.substring(2, 3);\n    const green = color.substring(3, 4);\n    return [ parseInt(red + red, 16), parseInt(blue + blue, 16), parseInt(green + green, 16) ];\n  }\n  consoleError(`Unsupported color code: \"${color}\"`);\n  return [ 0, 0, 0 ];\n}\n\nfunction calculateContrast(color1, color2) {\n  const rgb1 = hexCodeToRGB(color1);\n  const rgb2 = hexCodeToRGB(color2);\n  const luminance1 = calculateRelativeLuminance(rgb1);\n  const luminance2 = calculateRelativeLuminance(rgb2);\n  let contrast;\n  if (luminance1 > luminance2) {\n    contrast = (luminance1 + .05) / (luminance2 + .05);\n  } else {\n    contrast = (luminance2 + .05) / (luminance1 + .05);\n  }\n  return contrast;\n}\n\nfunction calculateRelativeLuminance([r8, g8, b8]) {\n  const rRGB = r8 / 255;\n  const gRGB = g8 / 255;\n  const bRGB = b8 / 255;\n  const R = rRGB <= .03928 ? rRGB / 12.92 : ((rRGB + .055) / 1.055) ** 2.4;\n  const G = gRGB <= .03928 ? gRGB / 12.92 : ((gRGB + .055) / 1.055) ** 2.4;\n  const B = bRGB <= .03928 ? bRGB / 12.92 : ((bRGB + .055) / 1.055) ** 2.4;\n  const luminance = .2126 * R + .7152 * G + .0722 * B;\n  return luminance;\n}\n\nfunction whiteOrBlackText(background) {\n  return calculateContrast(gray100, background) >= MIN_CONTRAST ? gray100 : white;\n}\n\nfunction adjustLightness(token, shift) {\n  const original = Color(token).hsl().object();\n  return Color({\n    ...original,\n    l: original.l + shift\n  }).round().hex().toLowerCase();\n}\n\nexport { MIN_CONTRAST, adjustLightness, calculateContrast, hexCodeToRGB, whiteOrBlackText };\n","import { white, gray100, gray10, blue60, gray80 } from \"../../../node_modules/@carbon/colors/es/index.js\";\n\nimport { whiteOrBlackText, adjustLightness, calculateContrast, MIN_CONTRAST, hexCodeToRGB } from \"./colors.js\";\n\nimport { WA_CONSOLE_PREFIX } from \"./constants.js\";\n\nimport { CarbonTheme } from \"../../../types/config/PublicConfig.js\";\n\nimport { CarbonThemeClassNames } from \"../../../types/utilities/carbonTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst CSS_VAR_PREFIX = \"--cds-\";\n\nconst CSS_CHAT_PREFIX = \"chat-\";\n\nconst HEXADECIMAL_REGEX = /#([a-f0-9]{3}){1,2}\\b/i;\n\nconst INTERNAL_OVERRIDES_LIGHT_THEME_MAP = {\n  \"$chat-button\": \"#000000\",\n  \"$chat-button-text-hover\": \"#525252\"\n};\n\nconst INTERNAL_OVERRIDES_DARK_THEME_MAP = {\n  \"$chat-button\": \"#ffffff\",\n  \"$chat-button-text-hover\": \"#f4f4f4\"\n};\n\nfunction convertCSSVariablesToString(cssVariables) {\n  const pieces = Object.keys(cssVariables).map(key => {\n    const value = cssVariables[key];\n    if (value === undefined) {\n      return \"\";\n    }\n    const fullName = key.startsWith(\"$\") ? `${CSS_VAR_PREFIX}${key.replace(/^\\$/, \"\")}` : `${CSS_VAR_PREFIX}${CSS_CHAT_PREFIX}${key}`;\n    return `${fullName}:${value};`;\n  });\n  let cssVariablesString = \"\";\n  const allValues = pieces.join(\"\");\n  const prefix = \"\";\n  if (allValues.length > 0) {\n    const rule = `${prefix}.WACContainer .cds--white, ${prefix}.WACContainer .cds--g10, ${prefix}.WACContainer .cds--g90, ${prefix}.WACContainer .cds--g100`;\n    cssVariablesString = `${rule}${`, :host`}{${allValues}}`;\n  }\n  return cssVariablesString;\n}\n\nfunction remoteStylesToCSSVars(whiteLabelVariables, carbonTheme) {\n  const cssOverrides = {};\n  const primaryColor = whiteLabelVariables[\"BASE-primary-color\"];\n  const secondaryColor = whiteLabelVariables[\"BASE-secondary-color\"];\n  const accentColor = whiteLabelVariables[\"BASE-accent-color\"];\n  if (primaryColor) {\n    cssOverrides[\"PRIMARY-color\"] = primaryColor;\n    cssOverrides[\"PRIMARY-color-text\"] = whiteOrBlackText(primaryColor);\n    cssOverrides[\"PRIMARY-color-hover\"] = adjustLightness(primaryColor, -8);\n    cssOverrides[\"PRIMARY-color-active\"] = adjustLightness(primaryColor, -10);\n    const useAccentColor = accentColor || blue60;\n    const tryFocusColor = carbonTheme === CarbonTheme.G90 || carbonTheme === CarbonTheme.G100 ? white : useAccentColor;\n    let useFocusColor;\n    if (calculateContrast(primaryColor, tryFocusColor) >= MIN_CONTRAST) {\n      useFocusColor = tryFocusColor;\n    } else if (tryFocusColor !== useAccentColor && calculateContrast(primaryColor, useAccentColor) >= MIN_CONTRAST) {\n      useFocusColor = useAccentColor;\n    } else if (tryFocusColor !== white && calculateContrast(primaryColor, white) >= MIN_CONTRAST) {\n      useFocusColor = white;\n    } else {\n      useFocusColor = gray100;\n    }\n    if (useFocusColor !== tryFocusColor) {\n      cssOverrides[\"PRIMARY-color-focus\"] = useFocusColor;\n    }\n  }\n  if (secondaryColor) {\n    cssOverrides[\"SECONDARY-color\"] = secondaryColor;\n    cssOverrides[\"SECONDARY-color-text\"] = whiteOrBlackText(secondaryColor);\n  } else if (carbonTheme === CarbonTheme.G90 || carbonTheme === CarbonTheme.G100) {\n    cssOverrides[\"SECONDARY-color\"] = `var(${CSS_VAR_PREFIX}layer-02)`;\n    cssOverrides[\"SECONDARY-color-text\"] = `var(${CSS_VAR_PREFIX}text-primary);`;\n  }\n  if (accentColor) {\n    const colorMap = ACCENT_COLOR_MAPS[carbonTheme];\n    const accentBlue20 = adjustLightness(accentColor, 40);\n    const accentBlue60Hover = adjustLightness(accentColor, -8);\n    const accentBlue80 = adjustLightness(accentColor, -20);\n    fillValues(cssOverrides, colorMap.blue20, accentBlue20);\n    fillValues(cssOverrides, colorMap.blue60, accentColor);\n    fillValues(cssOverrides, colorMap.blue60Hover, accentBlue60Hover);\n    fillValues(cssOverrides, colorMap.blue80, accentBlue80);\n    cssOverrides[\"LAUNCHER-color-background\"] = accentColor;\n    cssOverrides[\"LAUNCHER-color-background-hover\"] = accentBlue60Hover;\n    cssOverrides[\"LAUNCHER-color-background-active\"] = accentBlue80;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-background\"] = accentColor;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-hover\"] = accentBlue60Hover;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-active\"] = accentBlue80;\n    cssOverrides[\"ACCENT-color\"] = accentColor;\n    const accentColorRGB = hexCodeToRGB(accentColor);\n    cssOverrides[\"ACCENT-color-r\"] = accentColorRGB[0].toString();\n    cssOverrides[\"ACCENT-color-g\"] = accentColorRGB[1].toString();\n    cssOverrides[\"ACCENT-color-b\"] = accentColorRGB[2].toString();\n    cssOverrides[\"ACCENT-color-ghost-text\"] = accentColor;\n    const accentColorBW = whiteOrBlackText(accentColor);\n    cssOverrides[\"ACCENT-color-text\"] = accentColorBW;\n    cssOverrides[\"ACCENT-color-background-hover\"] = accentBlue60Hover;\n    cssOverrides[\"ACCENT-color-background-active\"] = accentBlue80;\n    cssOverrides[\"LAUNCHER-color-focus-border\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-color-avatar\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-text\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-EXPANDED-MESSAGE-color-focus-border\"] = accentColorBW;\n    cssOverrides[\"LAUNCHER-MOBILE-color-text\"] = accentColorBW;\n    cssOverrides[\"ACCENT-color-bw\"] = accentColorBW;\n    cssOverrides[\"ACCENT-color-bw-hover\"] = adjustLightness(accentColorBW, -8);\n    cssOverrides[\"ACCENT-color-bw-active\"] = adjustLightness(accentColorBW, -10);\n    cssOverrides[\"ACCENT-color-bw-inverse\"] = accentColorBW === gray100 ? white : gray100;\n    cssOverrides[\"ACCENT-color-bw-gray\"] = accentColorBW === gray100 ? gray80 : gray10;\n    cssOverrides[\"ACCENT-color-pastel\"] = accentColorBW === gray100 ? adjustLightness(accentColor, 20) : adjustLightness(accentColor, -15);\n  }\n  return cssOverrides;\n}\n\nconst ACCENT_COLOR_MAPS = {\n  white: {\n    blue20: [ \"$highlight\" ],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$icon-interactive\", \"$focus\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$button-tertiary-active\" ]\n  },\n  g10: {\n    blue20: [ \"$highlight\" ],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$icon-interactive\", \"$focus\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$button-tertiary-active\" ]\n  },\n  g90: {\n    blue20: [],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$focus-inverse\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$highlight\", \"$button-tertiary-active\" ]\n  },\n  g100: {\n    blue20: [],\n    blue60: [ \"$background-brand\", \"$interactive\", \"$border-interactive\", \"$button-primary\", \"$button-tertiary\", \"$focus-inverse\" ],\n    blue60Hover: [ \"$button-primary-hover\", \"$button-tertiary-hover\" ],\n    blue80: [ \"$button-primary-active\", \"$highlight\", \"$button-tertiary-active\" ]\n  }\n};\n\nfunction fillValues(styles, propertyNames, value) {\n  propertyNames.forEach(propertyName => {\n    styles[propertyName] = value;\n  });\n}\n\nfunction mergeCSSVariables(publicVars, whiteLabelVariables, carbonTheme, useAITheme) {\n  carbonTheme = carbonTheme || CarbonTheme.G10;\n  useAITheme = useAITheme || false;\n  publicVars = publicVars || {};\n  const internalOverrides = createInternalCSSOverridesMap(carbonTheme, useAITheme);\n  const result = {\n    ...internalOverrides,\n    ...publicVars\n  };\n  Object.entries(result).forEach(([key, value]) => {\n    if (key.startsWith(\"$\") && !value.match(HEXADECIMAL_REGEX)) {\n      console.warn(`${WA_CONSOLE_PREFIX} You tried to call \"updateCSSVariables\" with an invalid value for \"${key}\": \"${publicVars[key]}\". You must use hexadecimal values for colors.`);\n      delete result[key];\n    }\n  });\n  const remoteVars = remoteStylesToCSSVars(whiteLabelVariables || {}, carbonTheme);\n  Object.entries(remoteVars).forEach(([key, value]) => {\n    if (value !== \"\" && publicVars[key] === undefined) {\n      result[key] = value;\n    }\n  });\n  return result;\n}\n\nfunction createInternalCSSOverridesMap(carbonTheme, useAITheme) {\n  let internalOverridesMap = {};\n  if (!useAITheme) {\n    if ([ CarbonTheme.G10, CarbonTheme.WHITE ].includes(carbonTheme)) {\n      internalOverridesMap = {\n        ...internalOverridesMap,\n        ...INTERNAL_OVERRIDES_LIGHT_THEME_MAP\n      };\n    } else if ([ CarbonTheme.G90, CarbonTheme.G100 ].includes(carbonTheme)) {\n      internalOverridesMap = {\n        ...internalOverridesMap,\n        ...INTERNAL_OVERRIDES_DARK_THEME_MAP\n      };\n    }\n  }\n  return internalOverridesMap;\n}\n\nfunction getThemeClassNames(themeState) {\n  let themeClassnames;\n  switch (themeState?.carbonTheme) {\n   case CarbonTheme.WHITE:\n    themeClassnames = CarbonThemeClassNames.WHITE;\n    break;\n\n   case CarbonTheme.G10:\n    themeClassnames = CarbonThemeClassNames.G10;\n    break;\n\n   case CarbonTheme.G90:\n    themeClassnames = CarbonThemeClassNames.G90;\n    break;\n\n   case CarbonTheme.G100:\n    themeClassnames = CarbonThemeClassNames.G100;\n    break;\n\n   default:\n    themeClassnames = CarbonThemeClassNames.G10;\n    break;\n  }\n  if (themeState?.useAITheme) {\n    themeClassnames += \" WAC--aiTheme\";\n  }\n  return themeClassnames;\n}\n\nexport { convertCSSVariablesToString, getThemeClassNames, mergeCSSVariables };\n","import { VIEW_STATE_ALL_CLOSED } from \"../store/reducerUtils.js\";\n\nimport { consoleError } from \"./miscUtils.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function constructViewState(newView, appState) {\n  const {viewState: viewState} = appState.persistedToBrowserStorage.launcherState;\n  let newViewState;\n  if (typeof newView === \"string\") {\n    newViewState = {\n      ...VIEW_STATE_ALL_CLOSED,\n      [newView]: true\n    };\n  } else {\n    newViewState = {\n      ...viewState,\n      ...newView\n    };\n  }\n  return newViewState;\n}\n\nfunction validateViewState(viewState, appState) {\n  const {activeTour: activeTour} = appState.persistedToBrowserStorage.launcherState;\n  if (viewState.tour && !activeTour) {\n    consoleError(\"Error changing the view. The new view was supposed to show a tour however there is no active tour to show.\" + \" Changing the view has been canceled.\");\n    return false;\n  }\n  return true;\n}\n\nexport { constructViewState, validateViewState };\n","import cloneDeep from \"lodash-es/cloneDeep.js\";\n\nimport isEqual from \"lodash-es/isEqual.js\";\n\nimport merge from \"lodash-es/merge.js\";\n\nimport inputItemToLocalItem from \"../schema/inputItemToLocalItem.js\";\n\nimport { outputItemToLocalItem, createLocalMessageItemsForNestedMessageItems } from \"../schema/outputItemToLocalItem.js\";\n\nimport { AgentsOnlineStatus } from \"../../../types/config/ServiceDeskConfig.js\";\n\nimport actions from \"../store/actions.js\";\n\nimport { agentUpdateIsSuspended } from \"../store/agentActions.js\";\n\nimport { DEFAULT_PERSISTED_TO_BROWSER, VIEW_STATE_LAUNCHER_OPEN } from \"../store/reducerUtils.js\";\n\nimport \"../../../types/state/AppState.js\";\n\nimport { arrayLastValue, asyncForEach } from \"../utils/lang/arrayUtils.js\";\n\nimport { deepFreeze } from \"../utils/lang/objectUtils.js\";\n\nimport { sleep } from \"../utils/lang/promiseUtils.js\";\n\nimport { uuid } from \"../utils/lang/uuid.js\";\n\nimport { createWelcomeRequest, isLiveAgentMessage, isRequest, createMessageRequestForText, addDefaultsToMessage, isResponse, createMessageResponseForText, isStreamCompleteItem, isStreamPartialItem, isStreamFinalResponse, renderAsUserDefinedMessage, isResponseWithNestedItems, streamItemID, isPause, isConnectToAgent, hasTourUserDefinedType, hasServiceDesk, isTyping } from \"../utils/messageUtils.js\";\n\nimport { debugLog, isEnableDebugLog, consoleError, consoleWarn, callOnError } from \"../utils/miscUtils.js\";\n\nimport { resolvablePromise } from \"../utils/resolvablePromise.js\";\n\nimport { mergeCSSVariables } from \"../utils/styleUtils.js\";\n\nimport { constructViewState, validateViewState } from \"../utils/viewStateUtils.js\";\n\nimport { MessageResponseTypes } from \"../../../types/messaging/Messages.js\";\n\nimport { BusEventType, MessageSendSource, TourStartReason, MainWindowCloseReason, ViewChangeReason, MainWindowOpenReason } from \"../../../types/events/eventBusTypes.js\";\n\nimport { CSSVariable } from \"../../../types/instance/ChatInstance.js\";\n\nimport { OnErrorType } from \"../../../types/config/PublicConfig.js\";\n\nimport { setIntl } from \"../utils/intlUtils.js\";\n\nimport { UUIDType } from \"../utils/lang/UUIDType.js\";\n\nimport { ViewType } from \"../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const VALID_PUBLIC_VARS_IN_AI_THEME_SET = new Set(Object.values(CSSVariable));\n\nconst UPDATE_CSS_VARS_AI_THEME_WARNING_MESSAGE = `[updateCSSVariables] The AI theme is enabled and only ${Object.values(CSSVariable).join(\", \")} can be updated.`;\n\nclass ChatActionsImpl {\n  constructor(serviceManager) {\n    this.hydrating = false;\n    this.restarting = false;\n    this.alreadyHydrated = false;\n    this.chunkQueue = [];\n    this.serviceManager = serviceManager;\n  }\n  async hydrateChat(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions) {\n    let fireReady = false;\n    try {\n      if (!this.hydrationPromise) {\n        this.hydrating = true;\n        this.hydrationPromise = this.doHydrateChat(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions);\n        fireReady = true;\n      }\n      await this.hydrationPromise;\n    } finally {\n      this.hydrating = false;\n    }\n    if (fireReady) {\n      await this.serviceManager.fire({\n        type: BusEventType.CHAT_READY\n      });\n    }\n  }\n  async doHydrateChat(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions) {\n    debugLog(\"Hydrating Carbon AI chat\", alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions);\n    let history;\n    const {serviceManager: serviceManager} = this;\n    serviceManager.store.dispatch(actions.addIsHydratingCounter(1));\n    if (!this.alreadyHydrated) {\n      history = await this.serviceManager.historyService.loadHistory();\n      if (serviceManager.humanAgentService) {\n        debugLog(\"Initializing the human agent service\");\n        await serviceManager.humanAgentService.initialize();\n      } else {\n        debugLog(\"No service desk integrations present\");\n      }\n    }\n    const {config: config} = serviceManager.store.getState();\n    if (!history) {\n      if (!alternateWelcomeRequest) {\n        const state = serviceManager.store.getState();\n        if (state.homeScreenConfig?.is_on) {\n          serviceManager.store.dispatch(actions.setHomeScreenIsOpen(true));\n        } else if (!config.public.messaging?.skipWelcome) {\n          await serviceManager.actions.send(createWelcomeRequest(), MessageSendSource.WELCOME_REQUEST, {\n            returnBeforeStreaming: true\n          }, true);\n        }\n      }\n    } else {\n      serviceManager.store.dispatch(actions.hydrateMessageHistory(history.messageHistory));\n      await this.createElementsForUserDefinedResponses(history.messageHistory);\n      if (history.latestPanelLocalMessageItem) {\n        this.openResponsePanel(history.latestPanelLocalMessageItem, true);\n      }\n    }\n    if (alternateWelcomeRequest) {\n      serviceManager.store.dispatch(actions.setHomeScreenIsOpen(false));\n      await serviceManager.actions.send(alternateWelcomeRequest, alternateWelcomeRequestSource, alternateOptions, true);\n    }\n    serviceManager.store.dispatch(actions.chatWasHydrated());\n    serviceManager.store.dispatch(actions.addIsHydratingCounter(-1));\n    if (history) {\n      const lastMessageID = arrayLastValue(history.messageHistory.botMessageState.localMessageIDs);\n      const lastMessage = history.messageHistory.allMessageItemsByID[lastMessageID];\n      const lastOriginalMessage = history.messageHistory.allMessagesByID[lastMessage?.fullMessageID];\n      if (!isLiveAgentMessage(lastMessage) && isRequest(lastOriginalMessage)) {\n        serviceManager.messageService.resendMessage(lastOriginalMessage, lastMessage.ui_state.id);\n      }\n    }\n    const allowReconnect = config.public.serviceDesk.allowReconnect ?? true;\n    this.serviceManager?.humanAgentService?.handleHydration(allowReconnect, Boolean(history));\n    this.alreadyHydrated = true;\n  }\n  getPublicWebChatState() {\n    const state = this.serviceManager.store.getState();\n    const {persistedToBrowserStorage: persistedToBrowserStorage} = state;\n    const {chatState: chatState, launcherState: launcherState} = persistedToBrowserStorage;\n    const publicWebChatState = {\n      isConnectedWithHumanAgent: chatState.agentState.isConnected,\n      isWebChatOpen: launcherState.viewState.mainWindow,\n      isConnectingWithHumanAgent: state.agentState.isConnecting,\n      isHomeScreenOpen: chatState.homeScreenState.isHomeScreenOpen,\n      isDebugEnabled: isEnableDebugLog(),\n      hasUserSentMessage: chatState.hasSentNonWelcomeMessage,\n      isTourActive: launcherState.activeTour,\n      viewState: {\n        ...launcherState.viewState\n      },\n      serviceDesk: {\n        isConnected: chatState.agentState.isConnected,\n        isConnecting: state.agentState.isConnecting,\n        isSuspended: chatState.agentState.isSuspended ?? false\n      },\n      locale: this.serviceManager.store.getState().locale,\n      intl: this.serviceManager.intl\n    };\n    return publicWebChatState;\n  }\n  async sendWithCatch(message, source, options = {}, ignoreHydration = false) {\n    try {\n      await this.send(message, source, options, ignoreHydration);\n    } catch (error) {\n      consoleError(\"An error occurred sending the message\", error);\n    }\n  }\n  async send(message, source, options = {}, ignoreHydration = false) {\n    const messageRequest = typeof message === \"string\" ? createMessageRequestForText(message) : message;\n    if (this.serviceManager.store.getState().persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen) {\n      this.serviceManager.store.dispatch(actions.setHomeScreenIsOpen(false));\n    }\n    if (this.serviceManager.store.getState().responsePanelState.isOpen) {\n      this.serviceManager.store.dispatch(actions.setResponsePanelIsOpen(false));\n    }\n    if (this.hydrationPromise || ignoreHydration) {\n      if (!ignoreHydration) {\n        await this.hydrationPromise;\n      }\n      await this.doSend(messageRequest, source, options);\n    } else {\n      await this.hydrateChat(messageRequest, source, options);\n    }\n  }\n  async doSend(message, source, options = {}) {\n    const {store: store} = this.serviceManager;\n    addDefaultsToMessage(message);\n    const originalUserText = message.history?.label || message.input.text;\n    if (options.silent) {\n      message.history.silent = true;\n    }\n    const localMessage = inputItemToLocalItem(message, originalUserText);\n    if (!message.history.silent) {\n      store.dispatch(actions.addLocalMessageItem(localMessage, message, true));\n    } else {\n      store.dispatch(actions.addMessage(message));\n    }\n    if (options.setValueSelectedForMessageID) {\n      store.dispatch(actions.messageSetOptionSelected(options.setValueSelectedForMessageID, message));\n    }\n    deepFreeze(message);\n    await this.serviceManager.messageService.send(cloneDeep(message), source, localMessage.ui_state.id, options);\n  }\n  async receive(message, isLatestWelcomeNode = false, requestMessage, requestOptions) {\n    const {restartCount: initialRestartCount} = this.serviceManager;\n    if (!message.id) {\n      message.id = uuid(UUIDType.MESSAGE);\n    }\n    const preReceiveEvent = {\n      type: BusEventType.PRE_RECEIVE,\n      data: message\n    };\n    await this.serviceManager.fire(preReceiveEvent);\n    if (initialRestartCount !== this.serviceManager.restartCount) {\n      return;\n    }\n    if (!isLatestWelcomeNode) {\n      this.serviceManager.store.dispatch(actions.updateHasSentNonWelcomeMessage(true));\n    }\n    if (initialRestartCount !== this.serviceManager.restartCount) {\n      return;\n    }\n    const {languagePack: languagePack} = this.serviceManager.store.getState();\n    if (isResponse(message)) {\n      this.processMessageResponse(message, isLatestWelcomeNode, requestMessage, requestOptions).catch(error => {\n        consoleError(\"Error processing the message response\", error);\n      });\n    } else {\n      const inlineError = createMessageResponseForText(languagePack.errors_singleMessage, message.thread_id, MessageResponseTypes.INLINE_ERROR);\n      this.receive(inlineError, false);\n    }\n    deepFreeze(message);\n    await this.serviceManager.fire({\n      type: BusEventType.RECEIVE,\n      data: message\n    });\n  }\n  async removeMessages(messageIDs) {\n    this.serviceManager.store.dispatch(actions.removeMessages(messageIDs));\n  }\n  async insertHistory(messages) {\n    const scrollBottom = this.serviceManager.mainWindow?.getMessagesScrollBottom();\n    const state = this.serviceManager.store.getState();\n    const notes = {\n      notes: [ {\n        body: messages\n      } ]\n    };\n    const history = await this.serviceManager.historyService.loadHistory(notes);\n    const currentAppStateMessages = {\n      allMessageItemsByID: state.allMessageItemsByID,\n      allMessagesByID: state.allMessagesByID,\n      botMessageState: state.botMessageState\n    };\n    const newAppStateMessages = merge({}, history.messageHistory, currentAppStateMessages);\n    newAppStateMessages.botMessageState.messageIDs = [ ...history.messageHistory.botMessageState.messageIDs, ...currentAppStateMessages.botMessageState.messageIDs ];\n    newAppStateMessages.botMessageState.localMessageIDs = [ ...history.messageHistory.botMessageState.localMessageIDs, ...currentAppStateMessages.botMessageState.localMessageIDs ];\n    this.serviceManager.store.dispatch(actions.hydrateMessageHistory(newAppStateMessages));\n    await this.createElementsForUserDefinedResponses(history.messageHistory);\n    this.serviceManager.mainWindow?.doAutoScroll({\n      scrollToBottom: scrollBottom\n    });\n  }\n  async receiveChunk(chunk, messageID, options = {}) {\n    const chunkPromise = resolvablePromise();\n    this.chunkQueue.push({\n      chunk: chunk,\n      messageID: messageID,\n      options: options,\n      chunkPromise: chunkPromise\n    });\n    if (this.chunkQueue.length === 1) {\n      this.processChunkQueue();\n    }\n    return chunkPromise;\n  }\n  async processChunkQueue() {\n    const {chunk: chunk, options: options, chunkPromise: chunkPromise} = this.chunkQueue[0];\n    let {messageID: messageID} = this.chunkQueue[0];\n    const isCompleteItem = isStreamCompleteItem(chunk);\n    const isPartialItem = isStreamPartialItem(chunk);\n    const {store: store} = this.serviceManager;\n    const isStopGeneratingVisible = store.getState().botInputState.stopStreamingButtonState.isVisible;\n    if (isPartialItem) {\n      const streamingData = chunk.partial_item.streaming_metadata;\n      if (streamingData.cancellable && !isStopGeneratingVisible) {\n        store.dispatch(actions.setStopStreamingButtonVisible(true));\n      }\n    }\n    if (isCompleteItem || isPartialItem) {\n      if (!messageID) {\n        messageID = chunk.streaming_metadata.response_id;\n      }\n      if (!store.getState().allMessagesByID[messageID]) {\n        store.dispatch(actions.streamingStart(messageID));\n      }\n      const item = chunk.partial_item || chunk.complete_item;\n      store.dispatch(actions.streamingAddChunk(messageID, item, isCompleteItem, options.disableFadeAnimation ?? true));\n      if (chunk.partial_response?.history) {\n        if (Object.keys(chunk.partial_response).length > 1) {\n          throw new Error(`The partial_response object only supports the \"history\" property.`);\n        }\n        store.dispatch(actions.streamingMergeHistory(messageID, chunk.partial_response?.history));\n      }\n      await this.handleUserDefinedResponseItemsChunk(messageID, chunk, item);\n    } else if (isStreamFinalResponse(chunk)) {\n      this.receive(chunk.final_response, options.isLatestWelcomeNode, null, {\n        disableFadeAnimation: true\n      });\n    }\n    if ((isCompleteItem || isStreamFinalResponse(chunk)) && isStopGeneratingVisible) {\n      store.dispatch(actions.setStopStreamingButtonDisabled(false));\n      store.dispatch(actions.setStopStreamingButtonVisible(false));\n    }\n    this.chunkQueue.shift();\n    chunkPromise.doResolve();\n    if (this.chunkQueue[0]) {\n      this.processChunkQueue();\n    }\n  }\n  getOrCreateUserDefinedElement(messageItemID) {\n    let userDefinedItem = this.serviceManager.userDefinedElementRegistry.get(messageItemID);\n    if (!userDefinedItem) {\n      userDefinedItem = {\n        element: document.createElement(\"div\"),\n        slotName: `slot-user-defined-${uuid()}`\n      };\n      userDefinedItem.element.setAttribute(\"slot\", userDefinedItem.slotName);\n      this.serviceManager.userDefinedElementRegistry.set(messageItemID, userDefinedItem);\n    }\n    return userDefinedItem;\n  }\n  async handleUserDefinedResponseItems(localMessage, originalMessage) {\n    if (renderAsUserDefinedMessage(localMessage.item)) {\n      let element;\n      let slotName;\n      if (!localMessage.item.user_defined?.silent) {\n        ({element: element, slotName: slotName} = this.getOrCreateUserDefinedElement(localMessage.ui_state.id));\n      }\n      const userDefinedResponseEvent = {\n        type: BusEventType.USER_DEFINED_RESPONSE,\n        data: {\n          message: localMessage.item,\n          fullMessage: originalMessage,\n          element: element,\n          slot: slotName,\n          fullWidth: false\n        }\n      };\n      await this.serviceManager.fire(userDefinedResponseEvent);\n      if (userDefinedResponseEvent.data.fullWidth) {\n        this.serviceManager.store.dispatch(actions.setMessageUIProperty(localMessage.ui_state.id, \"fullWidth\", true));\n      }\n    } else if (isResponseWithNestedItems(localMessage.item)) {\n      const {itemsLocalMessageItemIDs: itemsLocalMessageItemIDs, bodyLocalMessageItemIDs: bodyLocalMessageItemIDs, footerLocalMessageItemIDs: footerLocalMessageItemIDs, gridLocalMessageItemIDs: gridLocalMessageItemIDs} = localMessage.ui_state;\n      const {allMessageItemsByID: allMessageItemsByID} = this.serviceManager.store.getState();\n      const createElementForNestedUserDefinedResponse = localMessageItemID => {\n        const nestedLocalMessage = allMessageItemsByID[localMessageItemID];\n        return this.handleUserDefinedResponseItems(nestedLocalMessage, originalMessage);\n      };\n      if (gridLocalMessageItemIDs?.length) {\n        await asyncForEach(gridLocalMessageItemIDs, row => asyncForEach(row, cell => asyncForEach(cell, itemID => createElementForNestedUserDefinedResponse(itemID))));\n      }\n      if (itemsLocalMessageItemIDs?.length) {\n        await asyncForEach(itemsLocalMessageItemIDs, createElementForNestedUserDefinedResponse);\n      }\n      if (bodyLocalMessageItemIDs?.length) {\n        await asyncForEach(bodyLocalMessageItemIDs, createElementForNestedUserDefinedResponse);\n      }\n      if (footerLocalMessageItemIDs?.length) {\n        await asyncForEach(footerLocalMessageItemIDs, createElementForNestedUserDefinedResponse);\n      }\n    }\n  }\n  async handleUserDefinedResponseItemsChunk(messageID, chunk, messageItem) {\n    if (renderAsUserDefinedMessage(messageItem)) {\n      const {store: store} = this.serviceManager;\n      const itemID = streamItemID(messageID, messageItem);\n      let element;\n      let slotName;\n      if (!messageItem.user_defined?.silent) {\n        ({element: element, slotName: slotName} = this.getOrCreateUserDefinedElement(itemID));\n      }\n      const userDefinedResponseEvent = {\n        type: BusEventType.CHUNK_USER_DEFINED_RESPONSE,\n        data: {\n          messageItem: messageItem,\n          chunk: chunk,\n          element: element,\n          slot: slotName,\n          fullWidth: false\n        }\n      };\n      await this.serviceManager.fire(userDefinedResponseEvent);\n      if (store.getState().allMessageItemsByID[itemID].ui_state.fullWidth !== userDefinedResponseEvent.data.fullWidth) {\n        store.dispatch(actions.setMessageUIProperty(itemID, \"fullWidth\", userDefinedResponseEvent.data.fullWidth));\n      }\n    }\n  }\n  async processMessageResponse(fullMessage, isLatestWelcomeNode, requestMessage, requestOptions = {}) {\n    const {store: store} = this.serviceManager;\n    const {config: config} = store.getState();\n    const initialRestartCount = this.serviceManager.restartCount;\n    const output = fullMessage.output.generic;\n    fullMessage.request_id = requestMessage?.id;\n    addDefaultsToMessage(fullMessage);\n    store.dispatch(actions.addMessage(fullMessage));\n    let previousItemID = null;\n    for (let index = 0; index < output.length && initialRestartCount === this.serviceManager.restartCount; index++) {\n      const messageItem = output[index];\n      if (messageItem) {\n        const pause = isPause(messageItem);\n        const agent = isConnectToAgent(messageItem);\n        const tour = hasTourUserDefinedType(messageItem);\n        const localMessageItem = outputItemToLocalItem(messageItem, fullMessage, isLatestWelcomeNode, requestOptions.disableFadeAnimation);\n        if (tour && (requestOptions.skipTourCard || messageItem.user_defined?.skip_card)) {\n          const startTourReason = requestOptions.skipTourCard ? TourStartReason.START_TOUR_METHOD : TourStartReason.SKIP_CARD;\n          const {viewState: viewState} = store.getState().persistedToBrowserStorage.launcherState;\n          if (viewState.mainWindow) {\n            const mainWindowCloseReason = requestOptions.skipTourCard ? MainWindowCloseReason.CALLED_START_TOUR : MainWindowCloseReason.TOUR_SKIP_CARD;\n            this.startTour(localMessageItem, startTourReason, {\n              mainWindowCloseReason: mainWindowCloseReason\n            }).catch(error => {\n              consoleError(\"Error starting the tour\", error);\n            });\n          } else {\n            const viewChangeReason = requestOptions.skipTourCard ? ViewChangeReason.CALLED_START_TOUR : ViewChangeReason.TOUR_SKIP_CARD;\n            this.startTour(localMessageItem, startTourReason, {\n              viewChangeReason: viewChangeReason\n            }).catch(error => {\n              consoleError(\"Error starting the tour\", error);\n            });\n          }\n        } else if (!tour && requestOptions.skipTourCard) {\n          consoleError(\"The message response received was not a tour, so the tour card was not skipped nor was a tour started by the startTour() call.\");\n        }\n        const nestedLocalMessageItems = [];\n        createLocalMessageItemsForNestedMessageItems(localMessageItem, fullMessage, false, nestedLocalMessageItems, true);\n        store.dispatch(actions.addNestedMessages(nestedLocalMessageItems));\n        if (agent && isResponse(fullMessage)) {\n          store.dispatch(actions.addIsTypingCounter(1));\n          if (!hasServiceDesk(config)) {\n            const message = 'Web chat received a \"connect_to_agent\" message but there is no service desk configured. Check your chat configuration.';\n            this.errorOccurred({\n              errorType: OnErrorType.INTEGRATION_ERROR,\n              message: message\n            });\n            store.dispatch(actions.setMessageHistoryProperty(localMessageItem.fullMessageID, \"agent_no_service_desk\", true));\n          }\n          const agentAvailability = await (this.serviceManager.humanAgentService?.checkAreAnyAgentsOnline(fullMessage));\n          if (initialRestartCount === this.serviceManager.restartCount) {\n            store.dispatch(actions.setMessageHistoryProperty(localMessageItem.fullMessageID, \"agent_availability\", agentAvailability));\n            let shouldAutoRequestAgent = false;\n            if (config.public.serviceDesk?.skipConnectAgentCard) {\n              shouldAutoRequestAgent = true;\n            }\n            store.dispatch(actions.addIsTypingCounter(-1));\n            if (shouldAutoRequestAgent && agentAvailability === AgentsOnlineStatus.ONLINE) {\n              this.serviceManager.humanAgentService.startChat(localMessageItem, fullMessage);\n            }\n          }\n        }\n        if (pause) {\n          const showIsTyping = isTyping(messageItem);\n          if (showIsTyping) {\n            store.dispatch(actions.addIsTypingCounter(1));\n          }\n          await sleep(messageItem.time);\n          if (showIsTyping && initialRestartCount === this.serviceManager.restartCount) {\n            store.dispatch(actions.addIsTypingCounter(-1));\n          }\n        } else {\n          await this.handleUserDefinedResponseItems(localMessageItem, fullMessage);\n          if (!localMessageItem.item.user_defined?.silent && initialRestartCount === this.serviceManager.restartCount) {\n            this.serviceManager.store.dispatch(actions.addLocalMessageItem(localMessageItem, fullMessage, false, previousItemID));\n            previousItemID = localMessageItem.ui_state.id;\n          }\n        }\n      }\n    }\n  }\n  openResponsePanel(localMessageItem, isMessageForInput) {\n    this.serviceManager.store.dispatch(actions.setResponsePanelContent(localMessageItem, isMessageForInput));\n    this.serviceManager.store.dispatch(actions.setResponsePanelIsOpen(true));\n  }\n  async insertLocalMessageResponse(message) {\n    message.id = uuid(UUIDType.MESSAGE);\n    await this.processMessageResponse(message, false, null, {});\n  }\n  updateLanguagePack(changes) {\n    const {languagePack: languagePack, locale: locale} = this.serviceManager.store.getState();\n    const messages = {\n      ...languagePack,\n      ...changes\n    };\n    setIntl(this.serviceManager, locale, messages);\n  }\n  addNotification(notification) {\n    this.serviceManager.store.dispatch(actions.addNotification(notification));\n  }\n  removeNotification(groupID) {\n    this.serviceManager.store.dispatch(actions.removeNotifications({\n      groupID: groupID\n    }));\n  }\n  removeAllNotifications() {\n    this.serviceManager.store.dispatch(actions.removeAllNotifications());\n  }\n  updateCSSVariables(publicVars, whiteLabelVariables = {}) {\n    const {store: store} = this.serviceManager;\n    const {theme: theme} = store.getState();\n    const {carbonTheme: carbonTheme, useAITheme: useAITheme} = theme;\n    if (useAITheme) {\n      const usePublicVars = publicVars;\n      publicVars = {};\n      whiteLabelVariables = {};\n      usePublicVars && Object.entries(usePublicVars).forEach(([variable]) => {\n        if (VALID_PUBLIC_VARS_IN_AI_THEME_SET.has(variable)) {\n          publicVars[variable] = usePublicVars[variable];\n        } else {\n          consoleWarn(UPDATE_CSS_VARS_AI_THEME_WARNING_MESSAGE);\n        }\n      });\n    } else {\n      publicVars = {\n        ...publicVars\n      };\n      whiteLabelVariables = {\n        ...whiteLabelVariables\n      };\n    }\n    const allVariables = mergeCSSVariables(publicVars, whiteLabelVariables, carbonTheme, useAITheme);\n    store.dispatch(actions.updateCSSVariables(allVariables, publicVars, whiteLabelVariables));\n  }\n  updateBotName(name) {\n    this.serviceManager.store.dispatch(actions.updateBotName(name));\n  }\n  updateMainHeaderTitle(title) {\n    this.serviceManager.store.dispatch(actions.updateMainHeaderTitle(title));\n  }\n  updateBotAvatarURL(url) {\n    this.serviceManager.store.dispatch(actions.updateBotAvatarURL(url));\n  }\n  updateHomeScreenConfig(homeScreenConfig) {\n    this.serviceManager.store.dispatch(actions.updateHomeScreenConfig(homeScreenConfig));\n  }\n  updateLauncherConfig(launcherConfig) {\n    this.serviceManager.store.dispatch(actions.updateLauncherConfig(launcherConfig));\n  }\n  async changeView(newView, reason, tryHydrating = true, forceViewChange = false) {\n    const {store: store} = this.serviceManager;\n    const {viewState: viewState} = store.getState().persistedToBrowserStorage.launcherState;\n    let newViewState = constructViewState(newView, store.getState());\n    if (!validateViewState(newViewState, store.getState())) {\n      return viewState;\n    }\n    if (!isEqual(newViewState, viewState) || forceViewChange) {\n      await this.fireViewChangeEventsAndChangeView(newViewState, reason);\n      newViewState = store.getState().persistedToBrowserStorage.launcherState.viewState;\n      if (tryHydrating && (newViewState.mainWindow || newViewState.tour) && !store.getState().isHydrated) {\n        this.hydrateChat().catch(error => {\n          consoleError(\"Error hydrating the chat\", error);\n        });\n      }\n    }\n    return newViewState;\n  }\n  async fireViewChangeEventsAndChangeView(newViewState, reason) {\n    const {store: store} = this.serviceManager;\n    if (store.getState().viewChanging) {\n      throw new Error(\"The view may not be changed while a view change event is already running. Please make sure to resolve any promises from these events.\");\n    }\n    store.dispatch(actions.setViewChanging(true));\n    const {viewState: viewState} = store.getState().persistedToBrowserStorage.launcherState;\n    const {viewChangeReason: viewChangeReason} = reason;\n    const oldViewState = deepFreeze(viewState);\n    try {\n      const preViewChangeEvent = {\n        type: BusEventType.VIEW_PRE_CHANGE,\n        reason: viewChangeReason,\n        oldViewState: oldViewState,\n        newViewState: newViewState,\n        cancelViewChange: false\n      };\n      await this.serviceManager.fire(preViewChangeEvent);\n      if (preViewChangeEvent.cancelViewChange) {\n        debugLog(\"The view changing was cancelled by a view:pre:change event.\");\n        return;\n      }\n      if (!validateViewState(preViewChangeEvent.newViewState, store.getState())) {\n        return;\n      }\n      newViewState = preViewChangeEvent.newViewState;\n      store.dispatch(actions.setViewState(deepFreeze(newViewState)));\n      const viewChangeEvent = {\n        type: BusEventType.VIEW_CHANGE,\n        reason: viewChangeReason,\n        oldViewState: oldViewState,\n        newViewState: newViewState,\n        cancelViewChange: false\n      };\n      await this.serviceManager.fire(viewChangeEvent);\n      if (viewChangeEvent.cancelViewChange) {\n        store.dispatch(actions.setViewState(oldViewState));\n        debugLog(\"The view changing was cancelled by a view:change event.\");\n        return;\n      }\n      if (!validateViewState(viewChangeEvent.newViewState, store.getState())) {\n        store.dispatch(actions.setViewState(oldViewState));\n        return;\n      }\n      newViewState = viewChangeEvent.newViewState;\n      store.dispatch(actions.setViewState(deepFreeze(newViewState)));\n    } finally {\n      store.dispatch(actions.setViewChanging(false));\n    }\n  }\n  async startTour(message, startTourReason, changeViewReason) {\n    this.serviceManager.store.dispatch(actions.setTourData(message.fullMessageID));\n    const newViewState = await this.changeView(ViewType.TOUR, changeViewReason);\n    if (newViewState.tour) {\n      await this.serviceManager.fire({\n        type: BusEventType.TOUR_START,\n        reason: startTourReason\n      });\n      await this.serviceManager.fire({\n        type: BusEventType.TOUR_STEP,\n        step: this.serviceManager.store.getState().tourState.activeTourStepItems[0]\n      });\n    }\n  }\n  async endTour(reason) {\n    const {viewState: viewState} = this.serviceManager.store.getState().persistedToBrowserStorage.launcherState;\n    let newViewState = viewState;\n    if (viewState.tour) {\n      newViewState = await this.changeView(ViewType.LAUNCHER, reason);\n    }\n    if (!newViewState.tour) {\n      this.serviceManager.store.dispatch(actions.clearTourData());\n      return true;\n    }\n    return false;\n  }\n  goToSpecificTourStep(stepId) {\n    const {activeTourStepItems: activeTourStepItems} = this.serviceManager.store.getState().tourState;\n    const newStepIndex = activeTourStepItems.findIndex(stepItem => stepItem.step_id === stepId);\n    if (newStepIndex) {\n      this.changeStepInTour({\n        newStepIndex: newStepIndex\n      });\n    } else {\n      consoleError(`No step with the id \"${stepId}\" was found within the current tour. As a result, goToTourStep() did not change the current tour step.`);\n    }\n  }\n  async changeStepInTour(changeStepOptions) {\n    const {store: store} = this.serviceManager;\n    const {activeTourStepItems: activeTourStepItems} = store.getState().tourState;\n    const {activeTourCurrentStepIndex: activeTourCurrentStepIndex} = store.getState().persistedToBrowserStorage.chatState.persistedTourState;\n    let {newStepIndex: newStepIndex} = changeStepOptions;\n    if (changeStepOptions.nextStep) {\n      newStepIndex = activeTourCurrentStepIndex + 1;\n    } else if (changeStepOptions.previousStep) {\n      newStepIndex = activeTourCurrentStepIndex - 1;\n    }\n    store.dispatch(actions.changeStepInTour(newStepIndex));\n    const actualNewStepIndex = store.getState().persistedToBrowserStorage.chatState.persistedTourState.activeTourCurrentStepIndex;\n    if (actualNewStepIndex === newStepIndex) {\n      await this.serviceManager.fire({\n        type: BusEventType.TOUR_STEP,\n        step: activeTourStepItems[actualNewStepIndex]\n      });\n    } else {\n      consoleWarn(\"The tour tried to change to a step that was out of bounds for the step array, so no step change was made.\");\n    }\n  }\n  errorOccurred(error) {\n    consoleError(\"An error has occurred\", error);\n    if (error.catastrophicErrorType) {\n      this.serviceManager.store.dispatch(actions.setAppStateValue(\"catastrophicErrorType\", error.catastrophicErrorType));\n    }\n    callOnError(this.serviceManager.additionalChatParameters.onError, error);\n  }\n  async restartConversation(options = {}) {\n    const {skipHydration: skipHydration = false, endAgentConversation: endAgentConversation = true, fireEvents: fireEvents = true} = options;\n    debugLog(\"Restarting conversation\");\n    if (this.restarting) {\n      consoleWarn(\"You cannot restart a conversation while a previous restart is still pending.\");\n      return;\n    }\n    this.restarting = true;\n    try {\n      const {serviceManager: serviceManager} = this;\n      const {store: store} = serviceManager;\n      if (fireEvents) {\n        await serviceManager.fire({\n          type: BusEventType.PRE_RESTART_CONVERSATION\n        });\n      }\n      serviceManager.restartCount++;\n      if (this.hydrating) {\n        await this.hydrationPromise;\n      }\n      const currentState = store.getState();\n      const {persistedToBrowserStorage: persistedToBrowserStorage} = currentState;\n      const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n      const {isConnecting: isConnecting} = currentState.agentState;\n      const {isConnected: isConnected} = currentState.persistedToBrowserStorage.chatState.agentState;\n      if ((isConnected || isConnecting) && endAgentConversation) {\n        await serviceManager.humanAgentService.endChat(true, false, false);\n      }\n      if (viewState.tour) {\n        await this.serviceManager.actions.changeView(ViewType.MAIN_WINDOW, {\n          mainWindowOpenReason: MainWindowOpenReason.CALLED_RESTART_CONVERSATION\n        }, false);\n      }\n      this.serviceManager.instance.updateAssistantInputFieldVisibility(true);\n      this.serviceManager.messageService.cancelAllMessageRequests();\n      store.dispatch(actions.restartConversation());\n      if (!skipHydration) {\n        this.hydrationPromise = null;\n      }\n      if (fireEvents) {\n        await serviceManager.fire({\n          type: BusEventType.RESTART_CONVERSATION\n        });\n      }\n      if (this.hydrating) {\n        await this.hydrationPromise;\n      }\n      if (!skipHydration && !serviceManager.store.getState().isHydrated) {\n        this.hydrationPromise = null;\n        if (store.getState().persistedToBrowserStorage.launcherState.viewState.mainWindow) {\n          await serviceManager.actions.hydrateChat();\n        }\n      } else {\n        store.dispatch(actions.chatWasHydrated());\n      }\n    } finally {\n      this.restarting = false;\n    }\n  }\n  async destroySession(keepOpenState) {\n    const {store: store} = this.serviceManager;\n    const {persistedToBrowserStorage: persistedToBrowserStorage} = store.getState();\n    const originalViewState = persistedToBrowserStorage.launcherState.viewState;\n    const newPersistedToBrowserStorage = cloneDeep(DEFAULT_PERSISTED_TO_BROWSER);\n    if (keepOpenState) {\n      newPersistedToBrowserStorage.launcherState.viewState = originalViewState;\n      if (originalViewState.tour) {\n        newPersistedToBrowserStorage.launcherState.viewState = {\n          ...originalViewState,\n          tour: false,\n          mainWindow: true\n        };\n      }\n    } else {\n      newPersistedToBrowserStorage.launcherState.viewState = VIEW_STATE_LAUNCHER_OPEN;\n    }\n    this.serviceManager.messageService.cancelAllMessageRequests();\n    this.serviceManager.userSessionStorageService.clearLauncherSession();\n    this.serviceManager.userSessionStorageService.clearChatSession();\n    this.serviceManager.store.dispatch(actions.setAppStateValue(\"persistedToBrowserStorage\", newPersistedToBrowserStorage));\n  }\n  agentEndConversation(endedByUser) {\n    return this.serviceManager.humanAgentService.endChat(endedByUser);\n  }\n  agentUpdateIsSuspended(isSuspended) {\n    this.serviceManager.store.dispatch(agentUpdateIsSuspended(isSuspended));\n  }\n  async createElementsForUserDefinedResponses(messages) {\n    await asyncForEach(Object.values(messages.allMessageItemsByID), localMessage => {\n      const originalMessage = messages.allMessagesByID[localMessage.fullMessageID];\n      return this.handleUserDefinedResponseItems(localMessage, originalMessage);\n    });\n  }\n}\n\nexport { ChatActionsImpl };\n","import cloneDeep from \"lodash-es/cloneDeep.js\";\n\nimport { asyncForEach, asArray } from \"../utils/lang/arrayUtils.js\";\n\nimport { debugStackTrace, consoleError, consoleLog, consoleWarn, isEnableDebugLog, debugLog } from \"../utils/miscUtils.js\";\n\nimport { resolvablePromise } from \"../utils/resolvablePromise.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const HANDLER_NOT_FUNCTION = \"The event handler is not a function.\";\n\nclass EventBus {\n  constructor() {\n    this.handlersByType = new Map;\n    this.eventsTypesRunning = new Set;\n    this.eventsRunningCount = 0;\n  }\n  async fire(busEvent, instance) {\n    logEvent(\"Before fire\", busEvent);\n    const {type: type} = busEvent;\n    if (!type) {\n      throw new Error(`Attempted to fire an event with no type! ${JSON.stringify(busEvent)}`);\n    }\n    function wrappedHandler(handler) {\n      const result = handler(busEvent, instance);\n      if (result && !(result instanceof Promise)) {\n        consoleWarn(`An event handler for event ${type} returned a non-promise. This might be a mistake.`, result);\n      }\n      return result;\n    }\n    if (this.eventsTypesRunning.has(type)) {\n      throw new Error(`An event of type ${type} is already running. Please make sure that you have resolved the Promises for any earlier events that were fired.`);\n    }\n    try {\n      this.eventsRunningCount++;\n      try {\n        this.eventsTypesRunning.add(type);\n        const handlersForType = this.handlersByType.get(type);\n        if (handlersForType && handlersForType.length) {\n          const handlersCopy = handlersForType.slice();\n          await asyncForEach(handlersCopy, wrappedHandler);\n        }\n      } finally {\n        this.eventsTypesRunning.delete(type);\n      }\n    } finally {\n      this.eventsRunningCount--;\n      if (this.waitForEmptyPromise && this.eventsRunningCount === 0) {\n        this.waitForEmptyPromise.doResolve();\n      }\n    }\n    logEvent(\"After fire\", busEvent);\n  }\n  fireSync(busEvent, instance) {\n    logEvent(\"Before fire\", busEvent);\n    const {type: type} = busEvent;\n    const handlersForType = this.handlersByType.get(type);\n    if (handlersForType && handlersForType.length) {\n      const handlersCopy = handlersForType.slice();\n      handlersCopy.forEach(handler => handler(busEvent, instance));\n    }\n    logEvent(\"After fire\", busEvent);\n  }\n  async waitForEmpty() {\n    if (this.eventsRunningCount === 0) {\n      return;\n    }\n    if (!this.waitForEmptyPromise) {\n      this.waitForEmptyPromise = resolvablePromise();\n    }\n    await this.waitForEmptyPromise;\n    this.waitForEmptyPromise = null;\n  }\n  on(handlers) {\n    const data = asArray(handlers);\n    data.forEach(({type: type, handler: handler}) => {\n      if (!type) {\n        throw new Error(`Attempted to listen to an event with no type: \"${type}\"!`);\n      }\n      if (typeof handler === \"function\") {\n        if (!this.handlersByType.has(type)) {\n          this.handlersByType.set(type, []);\n        }\n        const handlersForType = this.handlersByType.get(type);\n        debugStackTrace(`[EventBus] Adding ${type} event handler`, handler);\n        handlersForType.push(handler);\n      } else {\n        consoleError(HANDLER_NOT_FUNCTION, handler);\n      }\n    });\n    return this;\n  }\n  off(handlers) {\n    const data = asArray(handlers);\n    data.forEach(({type: type, handler: handler}) => {\n      const handlersForType = this.handlersByType.get(type);\n      if (handlersForType) {\n        if (handler) {\n          const index = handlersForType.indexOf(handler);\n          if (index !== -1) {\n            const removed = handlersForType.splice(index, 1);\n            debugStackTrace(`[EventBus] Removing ${type} event handlers`, removed);\n          }\n        } else {\n          debugStackTrace(`[EventBus] Removing all ${type} event handlers`);\n          this.handlersByType.set(type, []);\n        }\n      }\n    });\n    return this;\n  }\n  once(handlers) {\n    const data = asArray(handlers);\n    data.forEach(({type: type, handler: handler}) => {\n      if (typeof handler === \"function\") {\n        const onceHandler = (event, instance) => {\n          this.off({\n            type: type,\n            handler: onceHandler\n          });\n          return handler(event, instance);\n        };\n        this.on({\n          type: type,\n          handler: onceHandler\n        });\n      } else {\n        consoleError(HANDLER_NOT_FUNCTION, handler);\n      }\n    });\n    return this;\n  }\n  logListeners() {\n    this.handlersByType.forEach((listeners, type) => {\n      console.group(`Event ${type} (${listeners.length})`);\n      listeners.forEach(listener => {\n        consoleLog(\"Listener\", listener);\n      });\n      console.groupEnd();\n    });\n  }\n  clear() {\n    this.handlersByType.clear();\n    return this;\n  }\n}\n\nfunction logEvent(message, busEvent) {\n  if (isEnableDebugLog()) {\n    const eventCopy = cloneDeep(busEvent);\n    debugLog(`[EventBus] ${message}`, eventCopy);\n  }\n}\n\nexport { EventBus };\n","import actions from \"../store/actions.js\";\n\nimport { DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS } from \"../store/reducerUtils.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function createCustomPanelInstance(serviceManager) {\n  const customPanelInstance = {\n    open(options = DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS) {\n      const {store: store} = serviceManager;\n      store.dispatch(actions.setCustomPanelConfigOptions(options));\n      store.dispatch(actions.setCustomPanelOpen(true));\n    },\n    close() {\n      serviceManager.store.dispatch(actions.setCustomPanelOpen(false));\n    }\n  };\n  return Object.freeze(customPanelInstance);\n}\n\nexport { createCustomPanelInstance };\n","import { notesToLoadedHistory } from \"../schema/historyToMessages.js\";\n\nimport actions from \"../store/actions.js\";\n\nimport \"../../../types/state/AppState.js\";\n\nimport { consoleError } from \"../utils/miscUtils.js\";\n\nimport { MainWindowOpenReason } from \"../../../types/events/eventBusTypes.js\";\n\nimport { ViewType } from \"../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ class HistoryService {\n  constructor(serviceManager) {\n    this.serviceManager = serviceManager;\n  }\n  async loadHistory(useHistory) {\n    const state = this.serviceManager.store.getState();\n    const {config: config, persistedToBrowserStorage: persistedToBrowserStorage} = state;\n    const publicConfig = config.public;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    try {\n      let resultData;\n      if (useHistory) {\n        resultData = useHistory;\n      } else if (publicConfig.messaging?.customLoadHistory) {\n        const items = await publicConfig.messaging.customLoadHistory(this.serviceManager.instance);\n        const note = {\n          body: items\n        };\n        resultData = {\n          notes: [ note ]\n        };\n      }\n      if (resultData) {\n        const historyNotes = resultData?.notes;\n        return notesToLoadedHistory(historyNotes, this.serviceManager);\n      }\n      if (viewState.tour) {\n        await this.serviceManager.actions.changeView(ViewType.MAIN_WINDOW, {\n          mainWindowOpenReason: MainWindowOpenReason.SESSION_HISTORY\n        }, false);\n        this.serviceManager.store.dispatch(actions.clearTourData());\n      }\n    } catch (error) {\n      consoleError(\"An error occurred while attempting to load the conversation history\", error);\n    }\n    return null;\n  }\n}\n\nexport { HistoryService };\n","import { DEFAULT_CHAT_MESSAGES_STATE } from \"../store/reducerUtils.js\";\n\nimport { MessageErrorState } from \"../../../types/messaging/LocalMessageItem.js\";\n\nimport \"../utils/constants.js\";\n\nimport { findLast } from \"../utils/lang/arrayUtils.js\";\n\nimport { deepFreeze } from \"../utils/lang/objectUtils.js\";\n\nimport { isResponse, isRequest, isPause, isResponseWithNestedItems, THREAD_ID_MAIN, isOptionItem, isDateResponseType, isEventRequest } from \"../utils/messageUtils.js\";\n\nimport inputItemToLocalItem from \"./inputItemToLocalItem.js\";\n\nimport { outputItemToLocalItem, createLocalMessageItemsForNestedMessageItems } from \"./outputItemToLocalItem.js\";\n\nimport { BusEventType } from \"../../../types/events/eventBusTypes.js\";\n\nimport { FileStatusValue } from \"../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ async function notesToLoadedHistory(notes, serviceManager) {\n  const allLocalMessagesByID = {};\n  const allMessagesByID = {};\n  const loadingState = {\n    serviceManager: serviceManager,\n    allMessages: [],\n    allMessagesByID: allMessagesByID,\n    allLocalMessagesByID: allLocalMessagesByID,\n    threadMessagesByThreadID: {},\n    responsesByRequestID: {},\n    relatedMessageByID: {},\n    localMessagesByOriginalMessageID: {},\n    lastThreadID: null,\n    loadedHistory: {\n      messageHistory: {\n        allMessageItemsByID: allLocalMessagesByID,\n        allMessagesByID: allMessagesByID,\n        botMessageState: null\n      },\n      latestTransferToAgentResponse: null,\n      latestPanelLocalMessageItem: null\n    }\n  };\n  await notesToMessages(notes, loadingState);\n  if (!loadingState.allMessages.length) {\n    return null;\n  }\n  createLocalMessages(loadingState);\n  createChatStates(loadingState);\n  markIsLatestWelcomeNode(loadingState);\n  markSelectedOptions(loadingState);\n  return loadingState.loadedHistory;\n}\n\nasync function notesToMessages(notes, loadingState) {\n  const {allMessages: allMessages, allMessagesByID: allMessagesByID, responsesByRequestID: responsesByRequestID, relatedMessageByID: relatedMessageByID, serviceManager: serviceManager, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  if (!notes?.length) {\n    return;\n  }\n  notes.forEach(note => {\n    const sessionHistory = note.body;\n    const pushAndPrepareMessage = historyItem => {\n      const {message: message} = historyItem;\n      if (!isEventRequest(message) && (isRequest(message) || isResponse(message))) {\n        addMessage(message, loadingState, historyItem);\n      }\n    };\n    sessionHistory.forEach(pushAndPrepareMessage);\n  });\n  for (let index = allMessages.length - 1; index >= 0; index--) {\n    const message = allMessages[index];\n    if (message.history?.file_upload_status === FileStatusValue.UPLOADING) {\n      message.history.file_upload_status = FileStatusValue.COMPLETE;\n      message.history.error_state = MessageErrorState.FAILED;\n    }\n    if (isResponse(message) && message.history.silent) {\n      allMessages.splice(index, 1);\n      delete allMessagesByID[message.id];\n    } else {\n      localMessagesByOriginalMessageID[message.id] = [];\n      if (isResponse(message) && message.request_id) {\n        responsesByRequestID[message.request_id] = message;\n      }\n      if (message.history.related_message_id) {\n        relatedMessageByID[message.history.related_message_id] = message;\n      }\n    }\n  }\n  if (!allMessages.length) {\n    return;\n  }\n  Object.freeze(allMessages);\n  const beginEvent = {\n    type: BusEventType.HISTORY_BEGIN,\n    messages: allMessages\n  };\n  await serviceManager.eventBus.fire(beginEvent, serviceManager.instance);\n  allMessages.forEach(deepFreeze);\n  await serviceManager.eventBus.fire({\n    type: BusEventType.HISTORY_END,\n    messages: allMessages\n  }, serviceManager.instance);\n}\n\nfunction addMessage(message, loadingState, historyItem) {\n  message.history = message.history || {};\n  message.history.from_history = true;\n  message.history.timestamp = new Date(historyItem.time).getTime();\n  if (message.thread_id !== THREAD_ID_MAIN) {\n    loadingState.lastThreadID = message.thread_id;\n  }\n  loadingState.allMessagesByID[message.id] = message;\n  loadingState.allMessages.push(message);\n}\n\nfunction createLocalMessages(loadingState) {\n  const {allMessages: allMessages, allLocalMessagesByID: allLocalMessagesByID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  allMessages.forEach(message => {\n    if (isRequest(message)) {\n      if (!message.history?.silent) {\n        const text = message.history?.label || message.input.text;\n        const localMessage = inputItemToLocalItem(message, text);\n        localMessagesByOriginalMessageID[message.id].push(localMessage);\n        allLocalMessagesByID[localMessage.ui_state.id] = localMessage;\n      }\n    } else {\n      const items = getResponseItems(message);\n      if (items?.length) {\n        items.forEach(messageItem => {\n          if (!isPause(messageItem)) {\n            const localMessage = outputItemToLocalItem(messageItem, message, false);\n            localMessagesByOriginalMessageID[message.id].push(localMessage);\n            allLocalMessagesByID[localMessage.ui_state.id] = localMessage;\n            if (isResponseWithNestedItems(localMessage.item)) {\n              const nestedLocalMessageItems = [];\n              createLocalMessageItemsForNestedMessageItems(localMessage, message, true, nestedLocalMessageItems, true);\n              nestedLocalMessageItems.forEach(localMessageItem => {\n                const localMessageID = localMessageItem.ui_state.id;\n                loadingState.loadedHistory.messageHistory.allMessageItemsByID[localMessageID] = localMessageItem;\n              });\n            }\n          }\n        });\n      }\n    }\n    addMessageToThread(message, loadingState);\n  });\n}\n\nfunction getResponseItems(message) {\n  if (isResponse(message)) {\n    return message.output.generic;\n  }\n  return null;\n}\n\nfunction addMessageToThread(message, loadingState) {\n  const {threadMessagesByThreadID: threadMessagesByThreadID} = loadingState;\n  let thread = threadMessagesByThreadID[THREAD_ID_MAIN];\n  if (!thread) {\n    thread = [];\n    threadMessagesByThreadID[THREAD_ID_MAIN] = thread;\n  }\n  thread.push(message);\n}\n\nfunction createChatStates(loadingState) {\n  const {loadedHistory: loadedHistory, threadMessagesByThreadID: threadMessagesByThreadID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  loadedHistory.messageHistory.botMessageState = toChatMessageState(threadMessagesByThreadID[THREAD_ID_MAIN], localMessagesByOriginalMessageID);\n}\n\nfunction toChatMessageState(messages, localMessagesByFullMessageID) {\n  const localMessageIDs = [];\n  const messageIDs = [];\n  if (messages) {\n    messages.forEach(message => {\n      messageIDs.push(message.id);\n      localMessagesByFullMessageID[message.id].forEach(localMessage => {\n        localMessageIDs.push(localMessage.ui_state.id);\n      });\n    });\n  }\n  return {\n    ...DEFAULT_CHAT_MESSAGES_STATE,\n    localMessageIDs: localMessageIDs,\n    messageIDs: messageIDs\n  };\n}\n\nfunction markIsLatestWelcomeNode(loadingState) {\n  const {responsesByRequestID: responsesByRequestID, threadMessagesByThreadID: threadMessagesByThreadID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID} = loadingState;\n  const mainThreadMessages = threadMessagesByThreadID[THREAD_ID_MAIN];\n  const welcomeRequest = findLast(mainThreadMessages, message => isRequest(message) && message.history.is_welcome_request);\n  if (welcomeRequest) {\n    const welcomeResponse = responsesByRequestID[welcomeRequest.id];\n    if (welcomeResponse) {\n      localMessagesByOriginalMessageID[welcomeResponse.id].forEach(localMessage => {\n        localMessage.ui_state.isWelcomeResponse = true;\n      });\n    }\n  }\n}\n\nfunction markSelectedOptions({allMessages: allMessages, relatedMessageByID: relatedMessageByID, localMessagesByOriginalMessageID: localMessagesByOriginalMessageID}) {\n  allMessages.forEach(message => {\n    if (isResponse(message)) {\n      localMessagesByOriginalMessageID[message.id].forEach(localMessage => {\n        if (isOptionItem(localMessage.item)) {\n          const relatedRequest = relatedMessageByID[message.id];\n          if (isRequest(relatedRequest)) {\n            localMessage.ui_state.optionSelected = relatedRequest;\n          }\n        } else if (isDateResponseType(localMessage)) {\n          const relatedRequest = relatedMessageByID[message.id];\n          if (isRequest(relatedRequest)) {\n            localMessage.ui_state.originalUserText = relatedRequest.history.label;\n          }\n        }\n      });\n    }\n  });\n}\n\nexport { notesToLoadedHistory };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nclass MessageLoadingManager {\n  start(onExceededMaxSilentLoading, onEnd, onTimeout, msMaxSilentLoading, msMaxAttempt) {\n    this.hasExceededMaxSilentLoading = false;\n    this.onEnd = onEnd;\n    this.onSilentLoading = setTimeout(() => {\n      this.hasExceededMaxSilentLoading = true;\n      onExceededMaxSilentLoading();\n    }, msMaxSilentLoading);\n    this.onMaxAttempt = setTimeout(() => {\n      onTimeout();\n    }, msMaxAttempt);\n  }\n  end() {\n    if (this.onMaxAttempt) {\n      clearTimeout(this.onMaxAttempt);\n    }\n    if (this.onSilentLoading) {\n      clearTimeout(this.onSilentLoading);\n    }\n    if (this.onEnd) {\n      this.onEnd(this.hasExceededMaxSilentLoading);\n    }\n    this.hasExceededMaxSilentLoading = null;\n    this.onEnd = null;\n  }\n}\n\nexport { MessageLoadingManager };\n","import cloneDeep from \"lodash-es/cloneDeep.js\";\n\nimport inputItemToLocalItem from \"../schema/inputItemToLocalItem.js\";\n\nimport { createLocalMessageForInlineError } from \"../schema/outputItemToLocalItem.js\";\n\nimport actions from \"../store/actions.js\";\n\nimport { MessageErrorState } from \"../../../types/messaging/LocalMessageItem.js\";\n\nimport { deepFreeze } from \"../utils/lang/objectUtils.js\";\n\nimport { MessageLoadingManager } from \"../utils/messageServiceUtils.js\";\n\nimport { getLastBotResponseWithContext, THREAD_ID_MAIN } from \"../utils/messageUtils.js\";\n\nimport { debugLog, consoleError, safeFetchTextWithTimeout } from \"../utils/miscUtils.js\";\n\nimport { resolvablePromise } from \"../utils/resolvablePromise.js\";\n\nimport { MessageInputType } from \"../../../types/messaging/Messages.js\";\n\nimport { MessageSendSource, BusEventType } from \"../../../types/events/eventBusTypes.js\";\n\nimport { OnErrorType } from \"../../../types/config/PublicConfig.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst MS_BETWEEN_RETRIES = [ 1e3, 3e3, 5e3 ];\n\nconst MS_MAX_ATTEMPT = 150 * 1e3;\n\nconst MS_MAX_SILENT_ERROR = 6e3;\n\nconst MS_MAX_SILENT_LOADING = 4e3;\n\nvar RetryType;\n\n(function(RetryType) {\n  RetryType[RetryType[\"SILENT\"] = 1] = \"SILENT\";\n  RetryType[RetryType[\"VISIBLE\"] = 2] = \"VISIBLE\";\n})(RetryType || (RetryType = {}));\n\nclass MessageService {\n  constructor(serviceManager, publicConfig) {\n    this.pendingLocale = false;\n    this.localeIsExplicit = false;\n    this.serviceManager = serviceManager;\n    this.messageLoadingManager = new MessageLoadingManager;\n    this.queue = {\n      waiting: [],\n      current: null\n    };\n    const timeoutOverride = publicConfig.messaging?.messageTimeoutSecs;\n    this.timeoutMS = timeoutOverride ? timeoutOverride * 1e3 : MS_MAX_ATTEMPT;\n  }\n  async processSuccess(current, received) {\n    const {requestOptions: requestOptions, isProcessed: isProcessed} = current;\n    const isWelcomeNode = Boolean(current.message.history.is_welcome_request);\n    if (isProcessed) {\n      return;\n    }\n    this.setMessageErrorState(current, MessageErrorState.NONE);\n    const {message: message} = current;\n    if (received) {\n      if (message.input.message_type !== MessageInputType.EVENT) {\n        if (!isWelcomeNode) {\n          this.messageLoadingManager.end();\n        }\n        received.history = received.history || {};\n        received.history.timestamp = received.history.timestamp || Date.now();\n        current.trackData.lastRequestTime = Date.now() - current.timeLastRequest;\n        current.trackData.totalRequestTime = Date.now() - current.timeFirstRequest;\n        await this.serviceManager.actions.receive(received, isWelcomeNode, message, requestOptions);\n      }\n      this.messageLoadingManager.end();\n    }\n    if (current.isProcessed) {\n      return;\n    }\n    {\n      current.sendMessagePromise.doResolve();\n      current.isProcessed = true;\n    }\n    this.moveToNextQueueItem();\n  }\n  addErrorMessage() {\n    const {store: store} = this.serviceManager;\n    const errorMessage = store.getState().languagePack.errors_singleMessage;\n    const {originalMessage: originalMessage, localMessage: localMessage} = createLocalMessageForInlineError(errorMessage);\n    store.dispatch(actions.addLocalMessageItem(localMessage, originalMessage, true));\n  }\n  async resendMessage(message, localMessageID) {\n    await this.send(cloneDeep(message), MessageSendSource.HYDRATE_RESEND, localMessageID, {\n      skipQueue: true,\n      silent: true\n    });\n  }\n  sendToAssistantAndUpdateErrorState(current) {\n    if (current.isProcessed) {\n      return;\n    }\n    this.sendToAssistant(current);\n    const now = Date.now();\n    const msSinceStarted = now - current.timeFirstRequest;\n    const isSilentErrorWindow = MS_MAX_SILENT_ERROR > msSinceStarted;\n    const type = isSilentErrorWindow ? RetryType.SILENT : RetryType.VISIBLE;\n    if (type === RetryType.VISIBLE) {\n      this.setMessageErrorState(current, MessageErrorState.RETRYING);\n      this.queue.waiting.forEach(waitingMessage => {\n        this.setMessageErrorState(waitingMessage, MessageErrorState.WAITING);\n      });\n    }\n  }\n  async processError(pendingRequest, resultText, allowRetry) {\n    const {message: message, timeFirstRequest: timeFirstRequest, timeLastRequest: timeLastRequest, tryCount: tryCount, isProcessed: isProcessed, trackData: trackData, requestOptions: requestOptions} = pendingRequest;\n    const isWelcome = message.history.is_welcome_request;\n    const now = Date.now();\n    const msSinceStarted = now - timeFirstRequest;\n    const isInAttemptWindow = this.timeoutMS > msSinceStarted && tryCount < MS_BETWEEN_RETRIES.length;\n    if (isProcessed) {\n      return;\n    }\n    trackData.lastRequestTime = Date.now() - timeLastRequest;\n    trackData.totalRequestTime = Date.now() - timeFirstRequest;\n    if (isInAttemptWindow && allowRetry) {\n      trackData.numErrors++;\n      const retryDelay = MS_BETWEEN_RETRIES[pendingRequest.tryCount++];\n      setTimeout(() => {\n        this.sendToAssistantAndUpdateErrorState(pendingRequest);\n      }, retryDelay);\n    } else {\n      let catastrophicErrorType = false;\n      if (isWelcome) {\n        catastrophicErrorType = true;\n      } else if (requestOptions.silent) {\n        this.addErrorMessage();\n      }\n      this.serviceManager.actions.errorOccurred({\n        errorType: OnErrorType.MESSAGE_COMMUNICATION,\n        message: \"An error occurred sending a message\",\n        otherData: resultText,\n        catastrophicErrorType: catastrophicErrorType\n      });\n      this.rejectFinalErrorOnMessage(pendingRequest, resultText);\n    }\n  }\n  rejectFinalErrorOnMessage(pendingRequest, resultText = \"An undefined error occurred trying to send your message.\") {\n    const {sendMessagePromise: sendMessagePromise} = pendingRequest;\n    this.setMessageErrorState(pendingRequest, MessageErrorState.FAILED);\n    const {message: message} = pendingRequest;\n    if (pendingRequest === this.queue.current && message.input.message_type !== MessageInputType.EVENT && !message.history.is_welcome_request) {\n      this.messageLoadingManager.end();\n    }\n    sendMessagePromise.doReject(new Error(resultText));\n    pendingRequest.isProcessed = true;\n    if (pendingRequest === this.queue.current) {\n      this.moveToNextQueueItem();\n    }\n  }\n  async sendToAssistant(current) {\n    const {store: store} = this.serviceManager;\n    const state = store.getState();\n    const {customSendMessage: customSendMessage} = state.config.public.messaging;\n    current.timeLastRequest = Date.now();\n    if (current.isProcessed) {\n      return;\n    }\n    try {\n      const message = cloneDeep(current.message);\n      current.message = message;\n      store.dispatch(actions.updateMessage(message));\n      const controller = new AbortController;\n      current.sendMessageController = controller;\n      debugLog(\"Called customSendMessage\", message);\n      await customSendMessage(message, {\n        signal: controller.signal\n      }, this.serviceManager.instance);\n      await this.processSuccess(current, null);\n    } catch (error) {\n      consoleError(\"An error occurred while sending a message\", error);\n      const resultText = error && (typeof error === \"string\" ? error : JSON.stringify(error)) || \"There was an unidentified error.\";\n      this.processError(current, resultText, !customSendMessage);\n    }\n  }\n  async runQueueIfReady() {\n    if (!this.queue.current && this.queue.waiting.length > 0) {\n      const {eventBus: eventBus, store: store} = this.serviceManager;\n      this.clearCurrentQueueItem();\n      this.queue.current = this.queue.waiting.shift();\n      const {current: current} = this.queue;\n      const {message: message, source: source} = current;\n      const state = store.getState();\n      const {config: config} = store.getState();\n      const {public: publicConfig} = config;\n      current.timeFirstRequest = Date.now();\n      if (message.input.message_type !== MessageInputType.EVENT) {\n        const lastResponse = getLastBotResponseWithContext(state);\n        if (lastResponse) {\n          message.thread_id = THREAD_ID_MAIN;\n        }\n        if (!message.history.is_welcome_request) {\n          const LOADING_INDICATOR_TIMER = !publicConfig.messaging?.messageLoadingIndicatorTimeoutSecs && publicConfig.messaging?.messageLoadingIndicatorTimeoutSecs !== 0 ? MS_MAX_SILENT_LOADING : publicConfig.messaging.messageLoadingIndicatorTimeoutSecs * 1e3;\n          this.messageLoadingManager.start(() => {\n            this.serviceManager.store.dispatch(actions.addIsLoadingCounter(1));\n          }, didExceedMaxLoading => {\n            if (didExceedMaxLoading) {\n              this.serviceManager.store.dispatch(actions.addIsLoadingCounter(-1));\n            }\n          }, () => {\n            this.cancelMessageRequestByID(message.id, true);\n          }, LOADING_INDICATOR_TIMER, this.timeoutMS);\n        }\n        if (current.isProcessed) {\n          return;\n        }\n        const originalUserText = message.history?.label || message.input.text;\n        await eventBus.fire({\n          type: BusEventType.PRE_SEND,\n          data: message,\n          source: source\n        }, this.serviceManager.instance);\n        if (current.isProcessed) {\n          return;\n        }\n        const localMessage = inputItemToLocalItem(message, originalUserText, current.localMessageID);\n        if (!message.history.silent) {\n          store.dispatch(actions.updateLocalMessageItem(localMessage));\n          store.dispatch(actions.updateMessage(message));\n        }\n        deepFreeze(message);\n        await eventBus.fire({\n          type: BusEventType.SEND,\n          data: message,\n          source: source\n        }, this.serviceManager.instance);\n      }\n      this.sendToAssistant(current);\n    }\n  }\n  addToMessageQueue(message, source, localMessageID, sendMessagePromise, requestOptions = {}) {\n    const newPendingMessage = {\n      localMessageID: localMessageID,\n      message: message,\n      sendMessagePromise: sendMessagePromise,\n      requestOptions: requestOptions || {},\n      timeFirstRequest: 0,\n      timeLastRequest: 0,\n      trackData: {\n        numErrors: 0,\n        lastRequestTime: 0,\n        totalRequestTime: 0\n      },\n      tryCount: 0,\n      isProcessed: false,\n      source: source\n    };\n    this.queue.waiting.push(newPendingMessage);\n    if (this.queue.current) {\n      if (message.history?.error_state === MessageErrorState.RETRYING) {\n        this.setMessageErrorState(newPendingMessage, MessageErrorState.WAITING);\n      }\n    }\n  }\n  clearCurrentQueueItem() {\n    if (this.queue.current) {\n      this.queue.current = null;\n    }\n  }\n  moveToNextQueueItem() {\n    this.clearCurrentQueueItem();\n    this.runQueueIfReady();\n  }\n  setMessageErrorState(pendingRequest, errorState) {\n    const {message: message} = pendingRequest;\n    const {allMessagesByID: allMessagesByID} = this.serviceManager.store.getState();\n    const messageToUpdate = allMessagesByID[message.id];\n    if (messageToUpdate) {\n      const currentState = messageToUpdate.history?.error_state;\n      const errorSame = currentState === errorState || errorState === MessageErrorState.NONE && !currentState;\n      if (!errorSame) {\n        let announceMessageID;\n        switch (errorState) {\n         case MessageErrorState.FAILED:\n          {\n            announceMessageID = \"errors_ariaMessageFailed\";\n            break;\n          }\n        }\n        if (announceMessageID) {\n          this.serviceManager.store.dispatch(actions.announceMessage({\n            messageID: announceMessageID\n          }));\n        }\n        this.serviceManager.store.dispatch(actions.setMessageErrorState(message.id, errorState));\n        const {allMessagesByID: allMessagesByID} = this.serviceManager.store.getState();\n        pendingRequest.message = allMessagesByID[message.id];\n      }\n    }\n  }\n  send(message, source, localMessageID, requestOptions) {\n    message.history.timestamp = message.history.timestamp || Date.now();\n    message.input = message.input || {};\n    message.input.message_type = message.input.message_type || MessageInputType.TEXT;\n    const sendMessagePromise = resolvablePromise();\n    this.addToMessageQueue(message, source, localMessageID, sendMessagePromise, requestOptions);\n    this.runQueueIfReady();\n    return sendMessagePromise;\n  }\n  cancelAllMessageRequests() {\n    while (this.queue.waiting.length) {\n      this.cancelMessageRequestByID(this.queue.waiting[0].message.id, false);\n    }\n    if (this.queue.current) {\n      this.cancelMessageRequestByID(this.queue.current.message.id, false);\n      this.clearCurrentQueueItem();\n    }\n  }\n  async cancelMessageRequestByID(messageID, logError) {\n    let pendingRequest;\n    if (this.queue.current?.message.id === messageID) {\n      pendingRequest = this.queue.current;\n    } else {\n      const index = this.queue.waiting.findIndex(item => item.message.id === messageID);\n      if (index !== -1) {\n        pendingRequest = this.queue.waiting[index];\n        this.queue.waiting.splice(index, 1);\n      }\n    }\n    if (pendingRequest) {\n      const {lastResponse: lastResponse, sendMessageController: sendMessageController} = pendingRequest;\n      sendMessageController?.abort(\"Message was cancelled\");\n      this.rejectFinalErrorOnMessage(pendingRequest, \"Message was cancelled\");\n      if (logError) {\n        this.serviceManager.actions.errorOccurred({\n          errorType: OnErrorType.MESSAGE_COMMUNICATION,\n          message: \"Message was cancelled\",\n          otherData: await safeFetchTextWithTimeout(lastResponse)\n        });\n      }\n    }\n  }\n}\n\nexport { MessageService as default };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nclass NamespaceService {\n  constructor(namespace) {\n    this.originalName = namespace;\n    this.attributeSafe = namespace;\n    this.suffix = getSuffix(namespace);\n  }\n}\n\nfunction getSuffix(namespace) {\n  const computedName = computeNamespaceName(namespace);\n  return computedName?.length ? `--${namespace}` : \"\";\n}\n\nfunction computeNamespaceName(namespace) {\n  return namespace ? namespace.trim() : \"\";\n}\n\nexport { NamespaceService };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nclass ServiceManager {\n  constructor() {\n    this.userDefinedElementRegistry = new Map;\n    this.restartCount = 0;\n  }\n  async fire(busEvent) {\n    return this.eventBus.fire(busEvent, this.instance);\n  }\n}\n\nexport { ServiceManager };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nlet innerStorage = {};\n\nconst storage = {\n  getItem(key) {\n    return innerStorage[key];\n  },\n  setItem(key, value) {\n    innerStorage[key] = value;\n  },\n  removeItem(key) {\n    delete innerStorage[key];\n  },\n  length: Object.keys(innerStorage).length,\n  clear() {\n    innerStorage = {};\n  },\n  key(index) {\n    return Object.keys(innerStorage)[index];\n  }\n};\n\nexport { storage as default };\n","import { VERSION } from \"../environmentVariables.js\";\n\nimport { IS_SESSION_STORAGE } from \"../utils/browserUtils.js\";\n\nimport { consoleError } from \"../utils/miscUtils.js\";\n\nimport storage$1 from \"./mockStorage.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst storage = IS_SESSION_STORAGE() ? window.sessionStorage : storage$1;\n\nclass UserSessionStorageService {\n  constructor(serviceManager) {\n    this.serviceManager = serviceManager;\n    this.prefix = `CARBON_CHAT_SESSION${this.serviceManager?.namespace?.suffix || \"\"}`;\n  }\n  loadChatSession() {\n    try {\n      const chatSessionString = storage.getItem(this.getChatSessionKey());\n      const chatSession = chatSessionString ? JSON.parse(chatSessionString) : null;\n      if (chatSession?.version === VERSION) {\n        return chatSession;\n      }\n      this.clearChatSession();\n      return null;\n    } catch (error) {\n      this.clearChatSession();\n      return null;\n    }\n  }\n  loadLauncherSession() {\n    try {\n      const launcherSessionString = storage.getItem(this.getLauncherSessionKey());\n      const launcherSession = launcherSessionString ? JSON.parse(launcherSessionString) : null;\n      if (launcherSession?.version === VERSION) {\n        launcherSession.wasLoadedFromBrowser = true;\n        return launcherSession;\n      }\n      this.clearLauncherSession();\n      return null;\n    } catch (error) {\n      this.clearLauncherSession();\n      return null;\n    }\n  }\n  persistChatSession(session) {\n    try {\n      storage.setItem(this.getChatSessionKey(), JSON.stringify(session));\n    } catch (error) {\n      consoleError(\"Error in persistChatSession\", error);\n    }\n  }\n  persistLauncherSession(session) {\n    try {\n      storage.setItem(this.getLauncherSessionKey(), JSON.stringify(session));\n    } catch (error) {\n      consoleError(\"Error in persistLauncherSession\", error);\n    }\n  }\n  clearChatSession() {\n    try {\n      storage.removeItem(this.getChatSessionKey());\n    } catch (error) {\n      consoleError(\"Error in clearChatSession\", error);\n    }\n  }\n  clearLauncherSession() {\n    try {\n      storage.removeItem(this.getLauncherSessionKey());\n    } catch (error) {\n      consoleError(\"Error in clearLauncherSession\", error);\n    }\n  }\n  getChatSessionKey() {\n    return this.prefix;\n  }\n  getLauncherSessionKey() {\n    return this.prefix;\n  }\n}\n\nexport { UserSessionStorageService };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction replaceCurrentArrayValue(currentValue, newValue) {\n  if (Array.isArray(newValue)) {\n    return newValue;\n  }\n  return undefined;\n}\n\nexport { replaceCurrentArrayValue };\n","import { HA_END_CHAT, HA_UPDATE_FILE_UPLOAD_IN_PROGRESS, HA_SET_IS_SCREEN_SHARING, HA_UPDATE_CAPABILITIES, HA_SET_AGENT_LEFT_CHAT, HA_UPDATE_IS_TYPING, HA_UPDATE_IS_SUSPENDED, HA_SET_PERSISTED_STATE, HA_SET_AGENT_JOINED, HA_SET_SHOW_SCREEN_SHARE_REQUEST, HA_SET_AGENT_AVAILABILITY, HA_SET_IS_RECONNECTING, HA_SET_IS_CONNECTING } from \"./agentActions.js\";\n\nimport { applyLocalMessageUIState } from \"./reducerUtils.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const agentReducers = {\n  [HA_SET_IS_CONNECTING]: (state, action) => {\n    const {isConnecting: isConnecting, localMessageID: localMessageID} = action;\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        isConnecting: isConnecting,\n        activeLocalMessageID: localMessageID,\n        numUnreadMessages: isConnecting ? 0 : state.agentState.numUnreadMessages\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isSuspended: isConnecting ? state.persistedToBrowserStorage.chatState.agentState.isSuspended : false\n          }\n        }\n      }\n    };\n  },\n  [HA_SET_IS_RECONNECTING]: (state, action) => {\n    const {isReconnecting: isReconnecting} = action;\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        isReconnecting: isReconnecting\n      }\n    };\n  },\n  [HA_SET_AGENT_AVAILABILITY]: (state, action) => {\n    if (!state.agentState.isConnecting) {\n      return state;\n    }\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        availability: state.agentState.isConnecting ? action.availability : null\n      }\n    };\n  },\n  [HA_SET_SHOW_SCREEN_SHARE_REQUEST]: (state, {showRequest: showRequest}) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      showScreenShareRequest: showRequest\n    }\n  }),\n  [HA_SET_AGENT_JOINED]: (state, action) => {\n    const agentProfiles = {\n      ...state.persistedToBrowserStorage.chatState.agentState.agentProfiles\n    };\n    const {agentProfile: agentProfile} = action;\n    if (agentProfile) {\n      agentProfiles[agentProfile.id] = agentProfile;\n    }\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        isConnecting: false,\n        isReconnecting: false,\n        availability: null\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isConnected: true,\n            agentProfile: agentProfile,\n            agentProfiles: agentProfiles\n          }\n        }\n      }\n    };\n  },\n  [HA_SET_PERSISTED_STATE]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        agentState: {\n          ...state.persistedToBrowserStorage.chatState.agentState,\n          serviceDeskState: action.state\n        }\n      }\n    }\n  }),\n  [HA_UPDATE_IS_SUSPENDED]: (state, action) => {\n    if (!state.agentState.isConnecting && !state.persistedToBrowserStorage.chatState.agentState.isConnected) {\n      return state;\n    }\n    return {\n      ...state,\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isSuspended: action.isSuspended\n          }\n        }\n      }\n    };\n  },\n  [HA_UPDATE_IS_TYPING]: (state, action) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      isAgentTyping: action.isTyping\n    }\n  }),\n  [HA_SET_AGENT_LEFT_CHAT]: state => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState\n    },\n    agentState: {\n      ...state.agentState,\n      isAgentTyping: false\n    },\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        agentState: {\n          ...state.persistedToBrowserStorage.chatState.agentState,\n          agentProfile: null\n        }\n      }\n    }\n  }),\n  [HA_UPDATE_CAPABILITIES]: (state, action) => {\n    const newInputState = {\n      ...state.agentState.inputState,\n      ...action.capabilities\n    };\n    if (!newInputState.allowFileUploads) {\n      newInputState.files = [];\n    }\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        inputState: newInputState\n      }\n    };\n  },\n  [HA_SET_IS_SCREEN_SHARING]: (state, {isSharing: isSharing}) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      isScreenSharing: isSharing\n    }\n  }),\n  [HA_UPDATE_FILE_UPLOAD_IN_PROGRESS]: (state, action) => ({\n    ...state,\n    agentState: {\n      ...state.agentState,\n      fileUploadInProgress: action.fileUploadInProgress\n    }\n  }),\n  [HA_END_CHAT]: state => {\n    let newState = applyLocalMessageUIState(state, state.agentState.activeLocalMessageID, \"wasAgentChatEnded\", true);\n    newState = {\n      ...newState,\n      agentState: {\n        ...newState.agentState,\n        isConnecting: false,\n        isReconnecting: false,\n        availability: null,\n        activeLocalMessageID: null,\n        isAgentTyping: false,\n        inputState: {\n          ...newState.agentState.inputState,\n          isReadonly: false\n        }\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          agentState: {\n            ...state.persistedToBrowserStorage.chatState.agentState,\n            isConnected: false,\n            isSuspended: false,\n            agentProfile: null\n          }\n        }\n      }\n    };\n    return newState;\n  }\n};\n\nexport { agentReducers };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction populateTourStepItems(state) {\n  const {activeTourID: activeTourID} = state.persistedToBrowserStorage.chatState.persistedTourState;\n  if (activeTourID) {\n    const originalMessage = state.allMessagesByID[activeTourID];\n    const tourMessageItem = originalMessage?.output?.generic?.find(message => Boolean(message.user_defined?.steps));\n    if (tourMessageItem) {\n      return {\n        ...state,\n        tourState: {\n          ...state.tourState,\n          activeTourStepItems: tourMessageItem.user_defined?.steps\n        }\n      };\n    }\n  }\n  return clearTourState(state);\n}\n\nfunction clearTourState(state) {\n  return {\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        persistedTourState: {\n          activeTourID: null,\n          activeTourCurrentStepIndex: null\n        }\n      },\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        activeTour: false\n      }\n    },\n    tourState: {\n      ...state.tourState,\n      activeTourStepItems: null\n    }\n  };\n}\n\nexport { clearTourState, populateTourStepItems };\n","import merge from \"lodash-es/merge.js\";\n\nimport mergeWith from \"lodash-es/mergeWith.js\";\n\nimport { outputItemToLocalItem } from \"../schema/outputItemToLocalItem.js\";\n\nimport \"../utils/constants.js\";\n\nimport { replaceCurrentArrayValue } from \"../utils/customizers.js\";\n\nimport { streamItemID, isResponse, isRequest } from \"../utils/messageUtils.js\";\n\nimport { UPDATE_MAIN_HEADER_AVATAR, SET_STREAM_ID, SET_STOP_STREAMING_BUTTON_DISABLED, SET_STOP_STREAMING_BUTTON_VISIBLE, UPDATE_MAX_VISIBLE_HEADER_OBJECTS, UPDATE_CHAT_HEADER_CONFIG, STREAMING_ADD_CHUNK, STREAMING_MERGE_HISTORY, STREAMING_START, SET_RESPONSE_PANEL_CONTENT, SET_RESPONSE_PANEL_IS_OPEN, ADD_NESTED_MESSAGES, FILE_UPLOAD_INPUT_ERROR, CLEAR_INPUT_FILES, REMOVE_ALL_NOTIFICATIONS, REMOVE_NOTIFICATIONS, ADD_NOTIFICATION, REMOVE_LOCAL_MESSAGE_ITEM, REMOVE_INPUT_FILE, ADD_INPUT_FILE, SET_IS_BROWSER_PAGE_VISIBLE, UPDATE_INPUT_STATE, CHANGE_STEP_IN_TOUR, CLEAR_TOUR_DATA, SET_TOUR_DATA, SET_CUSTOM_PANEL_OPTIONS, SET_CUSTOM_PANEL_OPEN, SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN, CLOSE_IFRAME_PANEL, OPEN_IFRAME_CONTENT, SET_LAUNCHER_MINIMIZED, SET_CHAT_MESSAGES_PROPERTY, SET_LAUNCHER_CONFIG_PROPERTY, SET_LAUNCHER_PROPERTY, UPDATE_LAUNCHER_CONFIG, TOGGLE_HOME_SCREEN, SET_HOME_SCREEN_IS_OPEN, ACCEPTED_DISCLAIMER, ANNOUNCE_MESSAGE, MERGE_HISTORY, SET_MESSAGE_HISTORY_PROPERTY, SET_MESSAGE_UI_PROPERTY, UPDATE_HOME_SCREEN_CONFIG, UPDATE_CSS_VARIABLES, UPDATE_MAIN_HEADER_TITLE, UPDATE_LAUNCHER_AVATAR_URL, UPDATE_BOT_AVATAR_URL, UPDATE_BOT_NAME, SET_INITIAL_VIEW_CHANGE_COMPLETE, SET_VIEW_CHANGING, SET_VIEW_STATE, UPDATE_HAS_SENT_NON_WELCOME_MESSAGE, UPDATE_PERSISTED_CHAT_STATE, SET_APP_STATE_VALUE, ADD_IS_HYDRATING_COUNTER, ADD_IS_LOADING_COUNTER, ADD_IS_TYPING_COUNTER, MESSAGE_SET_OPTION_SELECTED, ADD_MESSAGE, UPDATE_MESSAGE, UPDATE_LOCAL_MESSAGE_ITEM, REMOVE_MESSAGES, ADD_LOCAL_MESSAGE_ITEM, HYDRATE_MESSAGE_HISTORY, RESTART_CONVERSATION, HYDRATE_CHAT, CHANGE_STATE } from \"./actions.js\";\n\nimport { agentReducers } from \"./agentReducers.js\";\n\nimport { setHomeScreenOpenState, applyFullMessage, applyBotMessageState, applyLocalMessageUIState, handleViewStateChange, DEFAULT_CUSTOM_PANEL_STATE, DEFAULT_CITATION_PANEL_STATE, DEFAULT_IFRAME_PANEL_STATE } from \"./reducerUtils.js\";\n\nimport { clearTourState, populateTourStepItems } from \"./tourReducerUtils.js\";\n\nimport { AgentMessageType } from \"../../../types/messaging/Messages.js\";\n\nimport { FileStatusValue, LauncherType } from \"../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst EXCLUDE_AGENT_UNREAD = new Set([ AgentMessageType.USER_ENDED_CHAT, AgentMessageType.CHAT_WAS_ENDED, AgentMessageType.RELOAD_WARNING ]);\n\nconst reducers = {\n  [CHANGE_STATE]: (state, action) => merge({}, state, action.partialState),\n  [HYDRATE_CHAT]: state => ({\n    ...state,\n    isHydrated: true\n  }),\n  [RESTART_CONVERSATION]: state => {\n    let newState = {\n      ...state,\n      botMessageState: {\n        ...state.botMessageState,\n        localMessageIDs: [],\n        messageIDs: [],\n        isTypingCounter: 0,\n        isScrollAnchored: false\n      },\n      allMessageItemsByID: {},\n      allMessagesByID: {},\n      iFramePanelState: {\n        ...DEFAULT_IFRAME_PANEL_STATE\n      },\n      viewSourcePanelState: {\n        ...DEFAULT_CITATION_PANEL_STATE\n      },\n      customPanelState: {\n        ...DEFAULT_CUSTOM_PANEL_STATE\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          homeScreenState: {\n            ...state.persistedToBrowserStorage.chatState.homeScreenState,\n            showBackToBot: false\n          }\n        }\n      },\n      isHydrated: false,\n      catastrophicErrorType: null\n    };\n    newState = clearTourState(newState);\n    if (newState.homeScreenConfig.is_on) {\n      newState = setHomeScreenOpenState(newState, true);\n    }\n    return newState;\n  },\n  [HYDRATE_MESSAGE_HISTORY]: (state, action) => {\n    let newState = {\n      ...state,\n      ...action.messageHistory\n    };\n    if (state.persistedToBrowserStorage.chatState.persistedTourState.activeTourID) {\n      newState = populateTourStepItems(newState);\n    }\n    return newState;\n  },\n  [ADD_LOCAL_MESSAGE_ITEM]: (state, action) => {\n    const {messageItem: messageItem, message: message, addMessage: addMessage, addAfterID: addAfterID} = action;\n    const {id: id} = messageItem.ui_state;\n    const isSilent = message.history.silent;\n    let newState = state;\n    if (addMessage) {\n      newState = applyFullMessage(newState, message);\n    }\n    const currentIndex = newState.botMessageState.localMessageIDs.findIndex(existingID => existingID === id);\n    const newLocalMessageIDs = [ ...newState.botMessageState.localMessageIDs ];\n    let insertAtIndex = currentIndex;\n    if (currentIndex !== -1) {\n      newLocalMessageIDs.splice(currentIndex, 1);\n    } else {\n      insertAtIndex = newLocalMessageIDs.length;\n    }\n    if (addAfterID) {\n      const afterIDIndex = newLocalMessageIDs.findIndex(existingID => existingID === addAfterID);\n      if (afterIDIndex !== -1) {\n        insertAtIndex = afterIDIndex + 1;\n      }\n    }\n    newLocalMessageIDs.splice(insertAtIndex, 0, id);\n    if (!isSilent) {\n      newState = {\n        ...newState,\n        allMessageItemsByID: {\n          ...newState.allMessageItemsByID,\n          [id]: messageItem\n        },\n        botMessageState: {\n          ...newState.botMessageState,\n          localMessageIDs: newLocalMessageIDs\n        }\n      };\n      if (newState.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen) {\n        newState = setHomeScreenOpenState(newState, false);\n      }\n      const isBotMessage = !messageItem.item.agent_message_type;\n      const isMainWindowOpen = state.persistedToBrowserStorage.launcherState.viewState.mainWindow;\n      if (!isBotMessage && (!isMainWindowOpen || !state.isBrowserPageVisible)) {\n        const fromAgent = !isRequest(message);\n        if (fromAgent && !EXCLUDE_AGENT_UNREAD.has(messageItem.item.agent_message_type)) {\n          newState = {\n            ...newState,\n            agentState: {\n              ...newState.agentState,\n              numUnreadMessages: newState.agentState.numUnreadMessages + 1\n            }\n          };\n        }\n      }\n    }\n    return newState;\n  },\n  [REMOVE_MESSAGES]: (state, {messageIDs: messageIDs}) => {\n    const idsSet = new Set(messageIDs);\n    const newAllMessages = {\n      ...state.allMessagesByID\n    };\n    const newAllMessageItems = {\n      ...state.allMessageItemsByID\n    };\n    const newMessageIDs = state.botMessageState.messageIDs.filter(messageID => !idsSet.has(messageID));\n    const newMessageItemsIDs = state.botMessageState.localMessageIDs.filter(messageItemID => {\n      const messageItem = newAllMessageItems[messageItemID];\n      const removeItem = idsSet.has(messageItem?.fullMessageID);\n      if (removeItem) {\n        delete newAllMessageItems[messageItemID];\n      }\n      return !removeItem;\n    });\n    messageIDs.forEach(messageID => {\n      delete newAllMessages[messageID];\n    });\n    const newState = {\n      ...state,\n      allMessagesByID: newAllMessages,\n      allMessageItemsByID: newAllMessageItems,\n      botMessageState: {\n        ...state.botMessageState,\n        messageIDs: newMessageIDs,\n        localMessageIDs: newMessageItemsIDs\n      }\n    };\n    return newState;\n  },\n  [UPDATE_LOCAL_MESSAGE_ITEM]: (state, action) => {\n    const {messageItem: messageItem} = action;\n    return {\n      ...state,\n      allMessageItemsByID: {\n        ...state.allMessageItemsByID,\n        [messageItem.ui_state.id]: messageItem\n      }\n    };\n  },\n  [UPDATE_MESSAGE]: (state, action) => {\n    const {message: message} = action;\n    return {\n      ...state,\n      allMessagesByID: {\n        ...state.allMessagesByID,\n        [message.id]: message\n      }\n    };\n  },\n  [ADD_MESSAGE]: (state, action) => {\n    const {message: message} = action;\n    const messageID = message.id;\n    let newState = state;\n    if (isResponse(message)) {\n      const itemIDsInNewMessage = [];\n      message.output.generic.forEach(item => {\n        const id = streamItemID(messageID, item);\n        if (id) {\n          itemIDsInNewMessage.push(id);\n        }\n      });\n      const newAllMessageItemsByID = {\n        ...state.allMessageItemsByID\n      };\n      const existingItemIDs = [];\n      let firstFoundIndex;\n      const newLocalMessageIDs = state.botMessageState.localMessageIDs.filter((itemID, index) => {\n        const item = state.allMessageItemsByID[itemID];\n        const isItemInMessage = item.fullMessageID === messageID;\n        if (isItemInMessage) {\n          if (firstFoundIndex === undefined) {\n            firstFoundIndex = index;\n          }\n          if (!itemIDsInNewMessage.includes(itemID)) {\n            delete newAllMessageItemsByID[itemID];\n          } else {\n            existingItemIDs.push(itemID);\n          }\n        }\n        return !isItemInMessage;\n      });\n      if (existingItemIDs.length) {\n        const itemIDsToInsert = itemIDsInNewMessage.filter(itemID => existingItemIDs.includes(itemID));\n        if (itemIDsToInsert.length) {\n          newLocalMessageIDs.splice(firstFoundIndex, 0, ...itemIDsToInsert);\n        }\n      }\n      newState = {\n        ...newState,\n        allMessageItemsByID: newAllMessageItemsByID,\n        botMessageState: {\n          ...newState.botMessageState,\n          localMessageIDs: newLocalMessageIDs\n        }\n      };\n    }\n    return applyFullMessage(newState, message);\n  },\n  [MESSAGE_SET_OPTION_SELECTED]: (state, action) => {\n    const newMessagesByID = {\n      ...state.allMessageItemsByID\n    };\n    newMessagesByID[action.messageID] = {\n      ...state.allMessageItemsByID[action.messageID],\n      ui_state: {\n        ...state.allMessageItemsByID[action.messageID].ui_state,\n        optionSelected: action.sentMessage\n      }\n    };\n    return {\n      ...state,\n      allMessageItemsByID: newMessagesByID\n    };\n  },\n  [ADD_IS_TYPING_COUNTER]: (state, action) => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      isTypingCounter: Math.max(state.botMessageState.isTypingCounter + action.addToIsTyping, 0)\n    }\n  }),\n  [ADD_IS_LOADING_COUNTER]: (state, action) => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      isLoadingCounter: Math.max(state.botMessageState.isLoadingCounter + action.addToIsLoading, 0)\n    }\n  }),\n  [ADD_IS_HYDRATING_COUNTER]: (state, action) => ({\n    ...state,\n    botMessageState: {\n      ...state.botMessageState,\n      isHydratingCounter: Math.max(state.botMessageState.isHydratingCounter + action.addToIsHydrating, 0)\n    }\n  }),\n  [SET_APP_STATE_VALUE]: (state, action) => ({\n    ...state,\n    [action.key]: action.value\n  }),\n  [UPDATE_PERSISTED_CHAT_STATE]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        ...action.chatState\n      }\n    }\n  }),\n  [UPDATE_HAS_SENT_NON_WELCOME_MESSAGE]: (state, action) => {\n    if (state.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage === action.hasSentNonWelcomeMessage) {\n      return state;\n    }\n    return {\n      ...state,\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          hasSentNonWelcomeMessage: action.hasSentNonWelcomeMessage\n        },\n        launcherState: {\n          ...state.persistedToBrowserStorage.launcherState,\n          hasSentNonWelcomeMessage: action.hasSentNonWelcomeMessage\n        }\n      }\n    };\n  },\n  [SET_VIEW_STATE]: (state, action) => handleViewStateChange(state, action.viewState),\n  [SET_VIEW_CHANGING]: (state, action) => ({\n    ...state,\n    viewChanging: action.viewChanging\n  }),\n  [SET_INITIAL_VIEW_CHANGE_COMPLETE]: (state, action) => ({\n    ...state,\n    initialViewChangeComplete: action.changeComplete\n  }),\n  [UPDATE_BOT_NAME]: (state, action) => ({\n    ...state,\n    botName: action.name,\n    headerDisplayName: state.theme.useAITheme ? state.headerDisplayName : action.name\n  }),\n  [UPDATE_BOT_AVATAR_URL]: (state, action) => ({\n    ...state,\n    botAvatarURL: action.url\n  }),\n  [UPDATE_LAUNCHER_AVATAR_URL]: (state, action) => ({\n    ...state,\n    launcher: {\n      ...state.launcher,\n      config: {\n        ...state.launcher.config,\n        mobile: {\n          ...state.launcher.config.mobile,\n          avatar_url_override: action.source\n        },\n        desktop: {\n          ...state.launcher.config.desktop,\n          avatar_url_override: action.source\n        }\n      }\n    }\n  }),\n  [UPDATE_MAIN_HEADER_TITLE]: (state, action) => ({\n    ...state,\n    headerDisplayName: action.title\n  }),\n  [UPDATE_CSS_VARIABLES]: (state, action) => {\n    const {config: config} = state;\n    const {variables: variables} = action;\n    const newConfig = {\n      public: {\n        ...config.public\n      }\n    };\n    return {\n      ...state,\n      config: newConfig,\n      cssVariableOverrides: variables\n    };\n  },\n  [UPDATE_HOME_SCREEN_CONFIG]: (state, action) => {\n    const newHomeScreenConfig = action.homeScreenConfig;\n    return {\n      ...state,\n      homeScreenConfig: mergeWith({}, state.homeScreenConfig, newHomeScreenConfig, replaceCurrentArrayValue)\n    };\n  },\n  [SET_MESSAGE_UI_PROPERTY]: (state, action) => applyLocalMessageUIState(state, action.localMessageID, action.propertyName, action.propertyValue),\n  [SET_MESSAGE_HISTORY_PROPERTY]: (state, action) => {\n    const {messageID: messageID, propertyName: propertyName, propertyValue: propertyValue} = action;\n    const oldMessage = state.allMessagesByID[messageID];\n    if (oldMessage) {\n      return {\n        ...state,\n        allMessagesByID: {\n          ...state.allMessagesByID,\n          [messageID]: {\n            ...oldMessage,\n            history: {\n              ...oldMessage.history,\n              [propertyName]: propertyValue\n            }\n          }\n        }\n      };\n    }\n    return state;\n  },\n  [MERGE_HISTORY]: (state, action) => {\n    const oldMessage = state.allMessagesByID[action.messageID];\n    if (oldMessage) {\n      return {\n        ...state,\n        allMessagesByID: {\n          ...state.allMessagesByID,\n          [action.messageID]: {\n            ...oldMessage,\n            history: merge({}, oldMessage.history, action.history)\n          }\n        }\n      };\n    }\n    return state;\n  },\n  [ANNOUNCE_MESSAGE]: (state, action) => ({\n    ...state,\n    announceMessage: action.message\n  }),\n  [ACCEPTED_DISCLAIMER]: state => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        disclaimersAccepted: {\n          ...state.persistedToBrowserStorage.chatState.disclaimersAccepted,\n          [window.location.hostname]: true\n        }\n      }\n    }\n  }),\n  [SET_HOME_SCREEN_IS_OPEN]: (state, {isOpen: isOpen}) => setHomeScreenOpenState(state, isOpen),\n  [TOGGLE_HOME_SCREEN]: state => setHomeScreenOpenState(state, !state.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen, true),\n  [UPDATE_LAUNCHER_CONFIG]: (state, action) => {\n    const newConfig = merge({}, state.launcher.config, action.launcherConfig);\n    return {\n      ...state,\n      launcher: {\n        ...state.launcher,\n        config: newConfig\n      },\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        launcherState: {\n          ...state.persistedToBrowserStorage.launcherState,\n          desktopLauncherIsExpanded: newConfig.is_on && newConfig.desktop.is_on ? state.persistedToBrowserStorage.launcherState.desktopLauncherIsExpanded : false,\n          mobileLauncherIsExtended: newConfig.is_on && newConfig.mobile.is_on ? state.persistedToBrowserStorage.launcherState.mobileLauncherIsExtended : false\n        }\n      }\n    };\n  },\n  [SET_LAUNCHER_PROPERTY]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        [action.propertyName]: action.propertyValue\n      }\n    }\n  }),\n  [SET_LAUNCHER_CONFIG_PROPERTY]: (state, action) => {\n    const newState = {\n      ...state,\n      launcher: {\n        ...state.launcher,\n        config: {\n          ...state.launcher.config\n        }\n      }\n    };\n    if (!action.launcherType || action.launcherType === LauncherType.DESKTOP) {\n      newState.launcher.config.desktop = {\n        ...state.launcher.config.desktop,\n        [action.propertyName]: action.propertyValue\n      };\n    }\n    if (!action.launcherType || action.launcherType === LauncherType.MOBILE) {\n      newState.launcher.config.mobile = {\n        ...state.launcher.config.mobile,\n        [action.propertyName]: action.propertyValue\n      };\n    }\n    return newState;\n  },\n  [SET_CHAT_MESSAGES_PROPERTY]: (state, action) => applyBotMessageState(state, {\n    [action.propertyName]: action.propertyValue\n  }),\n  [SET_LAUNCHER_MINIMIZED]: state => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      launcherState: {\n        ...state.persistedToBrowserStorage.launcherState,\n        desktopLauncherIsExpanded: false,\n        desktopLauncherWasMinimized: true\n      }\n    }\n  }),\n  [OPEN_IFRAME_CONTENT]: (state, {messageItem: messageItem}) => ({\n    ...state,\n    iFramePanelState: {\n      ...state.iFramePanelState,\n      messageItem: messageItem,\n      isOpen: true\n    },\n    announceMessage: {\n      messageID: \"iframe_ariaOpenedPanel\"\n    }\n  }),\n  [CLOSE_IFRAME_PANEL]: state => ({\n    ...state,\n    iFramePanelState: {\n      ...state.iFramePanelState,\n      isOpen: false\n    },\n    announceMessage: {\n      messageID: \"iframe_ariaClosedPanel\"\n    }\n  }),\n  [SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN]: (state, action) => ({\n    ...state,\n    viewSourcePanelState: {\n      ...state.viewSourcePanelState,\n      citationItem: action.citationItem,\n      relatedSearchResult: action.relatedSearchResult,\n      isOpen: action.isOpen\n    }\n  }),\n  [SET_CUSTOM_PANEL_OPEN]: (state, action) => ({\n    ...state,\n    customPanelState: {\n      ...state.customPanelState,\n      isOpen: action.isOpen\n    }\n  }),\n  [SET_CUSTOM_PANEL_OPTIONS]: (state, action) => ({\n    ...state,\n    customPanelState: {\n      ...state.customPanelState,\n      options: action.options\n    }\n  }),\n  [SET_TOUR_DATA]: (state, action) => {\n    const newStateWithPersistedTourData = {\n      ...state,\n      persistedToBrowserStorage: {\n        ...state.persistedToBrowserStorage,\n        chatState: {\n          ...state.persistedToBrowserStorage.chatState,\n          persistedTourState: {\n            activeTourID: action.newActiveTourMessageID,\n            activeTourCurrentStepIndex: 0\n          }\n        },\n        launcherState: {\n          ...state.persistedToBrowserStorage.launcherState,\n          activeTour: true\n        }\n      }\n    };\n    return populateTourStepItems(newStateWithPersistedTourData);\n  },\n  [CLEAR_TOUR_DATA]: state => clearTourState(state),\n  [CHANGE_STEP_IN_TOUR]: (state, action) => ({\n    ...state,\n    persistedToBrowserStorage: {\n      ...state.persistedToBrowserStorage,\n      chatState: {\n        ...state.persistedToBrowserStorage.chatState,\n        persistedTourState: {\n          ...state.persistedToBrowserStorage.chatState.persistedTourState,\n          activeTourCurrentStepIndex: Math.max(Math.min(action.newStepNumber, state.tourState.activeTourStepItems.length - 1), 0)\n        }\n      }\n    }\n  }),\n  [UPDATE_INPUT_STATE]: (state, action) => {\n    const currentInputState = getInputState(state, action.isInputToAgent);\n    const newInputState = {\n      ...currentInputState,\n      ...action.newState\n    };\n    const newState = applyInputState(state, newInputState, action.isInputToAgent);\n    return newState;\n  },\n  [SET_IS_BROWSER_PAGE_VISIBLE]: (state, action) => {\n    let numUnreadMessages;\n    const isMainWindowOpen = state.persistedToBrowserStorage.launcherState.viewState.mainWindow;\n    if (isMainWindowOpen && action.isVisible) {\n      numUnreadMessages = 0;\n    } else {\n      numUnreadMessages = state.agentState.numUnreadMessages;\n    }\n    return {\n      ...state,\n      isBrowserPageVisible: action.isVisible,\n      agentState: {\n        ...state.agentState,\n        numUnreadMessages: numUnreadMessages\n      }\n    };\n  },\n  [ADD_INPUT_FILE]: (state, {file: file, isInputToAgent: isInputToAgent}) => {\n    const currentInputState = getInputState(state, isInputToAgent);\n    return applyInputState(state, {\n      ...currentInputState,\n      files: [ ...currentInputState.files, file ]\n    }, isInputToAgent);\n  },\n  [REMOVE_INPUT_FILE]: (state, {fileID: fileID, isInputToAgent: isInputToAgent}) => {\n    const currentInputState = getInputState(state, isInputToAgent);\n    const newUploads = [ ...currentInputState.files ];\n    const index = newUploads.findIndex(file => file.id === fileID);\n    if (index !== -1) {\n      newUploads.splice(index, 1);\n    }\n    return applyInputState(state, {\n      ...currentInputState,\n      files: newUploads\n    }, isInputToAgent);\n  },\n  [REMOVE_LOCAL_MESSAGE_ITEM]: (state, {localMessageItemID: localMessageItemID}) => {\n    const newLocalMessageIDs = state.botMessageState.localMessageIDs.filter(id => id !== localMessageItemID);\n    const allMessageItemsByID = {\n      ...state.allMessageItemsByID\n    };\n    if (allMessageItemsByID[localMessageItemID]) {\n      delete allMessageItemsByID[localMessageItemID];\n    }\n    return {\n      ...state,\n      allMessageItemsByID: allMessageItemsByID,\n      botMessageState: {\n        ...state.botMessageState,\n        localMessageIDs: newLocalMessageIDs\n      }\n    };\n  },\n  [ADD_NOTIFICATION]: (state, {notification: notification, notificationID: notificationID}) => ({\n    ...state,\n    notifications: state.notifications.concat({\n      id: notificationID,\n      notification: notification\n    })\n  }),\n  [REMOVE_NOTIFICATIONS]: (state, {groupID: groupID, notificationID: notificationID}) => ({\n    ...state,\n    notifications: state.notifications.filter(notification => {\n      if (notificationID) {\n        return notification.id !== notificationID;\n      }\n      return notification.notification.groupID !== groupID;\n    })\n  }),\n  [REMOVE_ALL_NOTIFICATIONS]: state => ({\n    ...state,\n    notifications: []\n  }),\n  [CLEAR_INPUT_FILES]: (state, {isInputToAgent: isInputToAgent}) => {\n    const currentInputState = getInputState(state, isInputToAgent);\n    return applyInputState(state, {\n      ...currentInputState,\n      files: []\n    }, isInputToAgent);\n  },\n  [FILE_UPLOAD_INPUT_ERROR]: (state, {fileID: fileID, errorMessage: errorMessage, isInputToAgent: isInputToAgent}) => {\n    const currentInputSate = getInputState(state, isInputToAgent);\n    const newUploads = [ ...currentInputSate.files ];\n    const index = newUploads.findIndex(file => file.id === fileID);\n    if (index !== -1) {\n      newUploads[index] = {\n        ...newUploads[index],\n        isError: true,\n        errorMessage: errorMessage,\n        status: FileStatusValue.COMPLETE\n      };\n    }\n    return applyInputState(state, {\n      ...currentInputSate,\n      files: newUploads\n    }, isInputToAgent);\n  },\n  [ADD_NESTED_MESSAGES]: (state, {localMessageItems: localMessageItems}) => {\n    const allMessageItemsByID = {\n      ...state.allMessageItemsByID\n    };\n    localMessageItems.forEach(localMessageItem => {\n      allMessageItemsByID[localMessageItem.ui_state.id] = localMessageItem;\n    });\n    return {\n      ...state,\n      allMessageItemsByID: allMessageItemsByID\n    };\n  },\n  [SET_RESPONSE_PANEL_IS_OPEN]: (state, {isOpen: isOpen}) => ({\n    ...state,\n    responsePanelState: {\n      ...state.responsePanelState,\n      isOpen: isOpen\n    }\n  }),\n  [SET_RESPONSE_PANEL_CONTENT]: (state, {localMessageItem: localMessageItem, isMessageForInput: isMessageForInput}) => ({\n    ...state,\n    responsePanelState: {\n      ...state.responsePanelState,\n      localMessageItem: localMessageItem,\n      isMessageForInput: isMessageForInput\n    }\n  }),\n  [STREAMING_START]: (state, {messageID: messageID}) => {\n    const streamIntoResponse = {\n      id: messageID,\n      output: {\n        generic: []\n      },\n      history: {\n        timestamp: Date.now()\n      }\n    };\n    return applyFullMessage(state, streamIntoResponse);\n  },\n  [STREAMING_MERGE_HISTORY]: (state, {messageID: messageID, history: history}) => {\n    const existingMessage = state.allMessagesByID[messageID];\n    const newMessage = merge({}, existingMessage, {\n      history: history\n    });\n    if (existingMessage) {\n      return {\n        ...state,\n        allMessagesByID: {\n          ...state.allMessagesByID,\n          [messageID]: newMessage\n        }\n      };\n    }\n    return state;\n  },\n  [STREAMING_ADD_CHUNK]: (state, {chunkItem: chunkItem, fullMessageID: fullMessageID, isCompleteItem: isCompleteItem, disableFadeAnimation: disableFadeAnimation}) => {\n    const message = state.allMessagesByID[fullMessageID];\n    const localItemID = streamItemID(fullMessageID, chunkItem);\n    const existingLocalMessageItem = state.allMessageItemsByID[localItemID];\n    let {localMessageIDs: localMessageIDs} = state.botMessageState;\n    let newItem;\n    if (!existingLocalMessageItem) {\n      newItem = outputItemToLocalItem(chunkItem, message, false);\n      newItem.ui_state.needsAnnouncement = false;\n      newItem.ui_state.disableFadeAnimation = disableFadeAnimation;\n      newItem.ui_state.isIntermediateStreaming = true;\n      if (isCompleteItem) {\n        newItem.ui_state.streamingState = {\n          chunks: [],\n          isDone: true\n        };\n      } else {\n        newItem.ui_state.streamingState = {\n          chunks: [ chunkItem ],\n          isDone: false\n        };\n      }\n      localMessageIDs = [ ...localMessageIDs, localItemID ];\n      if (!newItem.item.response_type) {\n        throw new Error(`New chunk item does not have a response_type: ${JSON.stringify(chunkItem)}`);\n      }\n    } else if (isCompleteItem) {\n      newItem = outputItemToLocalItem(chunkItem, message, false);\n      newItem.ui_state.needsAnnouncement = false;\n      newItem.ui_state.disableFadeAnimation = disableFadeAnimation;\n      newItem.ui_state.streamingState = {\n        chunks: [],\n        isDone: true\n      };\n    } else {\n      newItem = {\n        ...existingLocalMessageItem,\n        ui_state: {\n          ...existingLocalMessageItem?.ui_state,\n          streamingState: {\n            ...existingLocalMessageItem?.ui_state.streamingState,\n            chunks: [ ...existingLocalMessageItem?.ui_state.streamingState?.chunks || [], chunkItem ]\n          }\n        }\n      };\n    }\n    return {\n      ...state,\n      allMessageItemsByID: {\n        ...state.allMessageItemsByID,\n        [localItemID]: newItem\n      },\n      botMessageState: {\n        ...state.botMessageState,\n        localMessageIDs: localMessageIDs\n      }\n    };\n  },\n  [UPDATE_CHAT_HEADER_CONFIG]: (state, {chatHeaderConfig: chatHeaderConfig}) => ({\n    ...state,\n    chatHeaderState: {\n      ...state.chatHeaderState,\n      config: {\n        ...state.chatHeaderState.config,\n        ...chatHeaderConfig\n      }\n    }\n  }),\n  [UPDATE_MAX_VISIBLE_HEADER_OBJECTS]: (state, {maxTotal: maxTotal}) => ({\n    ...state,\n    chatHeaderState: {\n      ...state.chatHeaderState,\n      maxVisibleHeaderObjects: maxTotal\n    }\n  }),\n  [SET_STOP_STREAMING_BUTTON_VISIBLE]: (state, {isVisible: isVisible}) => ({\n    ...state,\n    botInputState: {\n      ...state.botInputState,\n      stopStreamingButtonState: {\n        ...state.botInputState.stopStreamingButtonState,\n        isVisible: isVisible\n      }\n    }\n  }),\n  [SET_STOP_STREAMING_BUTTON_DISABLED]: (state, {isDisabled: isDisabled}) => ({\n    ...state,\n    botInputState: {\n      ...state.botInputState,\n      stopStreamingButtonState: {\n        ...state.botInputState.stopStreamingButtonState,\n        isDisabled: isDisabled\n      }\n    }\n  }),\n  [SET_STREAM_ID]: (state, {currentStreamID: currentStreamID}) => ({\n    ...state,\n    botInputState: {\n      ...state.botInputState,\n      stopStreamingButtonState: {\n        ...state.botInputState.stopStreamingButtonState,\n        currentStreamID: currentStreamID\n      }\n    }\n  }),\n  [UPDATE_MAIN_HEADER_AVATAR]: (state, {config: config}) => ({\n    ...state,\n    headerAvatarConfig: config\n  })\n};\n\nfunction applyInputState(state, newInputState, isInputToAgent) {\n  if (isInputToAgent) {\n    return {\n      ...state,\n      agentState: {\n        ...state.agentState,\n        inputState: newInputState\n      }\n    };\n  }\n  return {\n    ...state,\n    botInputState: newInputState\n  };\n}\n\nfunction getInputState(state, isInputToAgent) {\n  return isInputToAgent ? state.agentState.inputState : state.botInputState;\n}\n\nObject.assign(reducers, agentReducers);\n\nexport { reducers };\n","import merge from \"lodash-es/merge.js\";\n\nimport { createStore } from \"redux\";\n\nimport { NODE_ENV } from \"../environmentVariables.js\";\n\nimport { IS_PHONE } from \"../utils/browserUtils.js\";\n\nimport \"../utils/constants.js\";\n\nimport { withoutEmptyStarters } from \"../utils/homeScreenUtils.js\";\n\nimport { getBotName } from \"../utils/miscUtils.js\";\n\nimport { mergeCSSVariables } from \"../utils/styleUtils.js\";\n\nimport { reducers } from \"./reducers.js\";\n\nimport { DEFAULT_THEME_STATE, VIEW_STATE_MAIN_WINDOW_OPEN, VIEW_STATE_LAUNCHER_OPEN, DEFAULT_LAUNCHER, DEFAULT_PERSISTED_TO_BROWSER, DEFAULT_INPUT_STATE, VIEW_STATE_ALL_CLOSED, DEFAULT_TOUR_STATE, DEFAULT_MESSAGE_PANEL_STATE, DEFAULT_CUSTOM_PANEL_STATE, DEFAULT_CITATION_PANEL_STATE, DEFAULT_IFRAME_PANEL_STATE, DEFAULT_AGENT_STATE, DEFAULT_MESSAGE_STATE, DEFAULT_LAYOUT_STATE } from \"./reducerUtils.js\";\n\nimport \"../../../types/instance/apiTypes.js\";\n\nimport enLanguagePack from \"../../languages/en.json.js\";\n\nimport { CornersType } from \"../../../types/config/CornersType.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function doCreateStore(config, serviceManager) {\n  let useAITheme;\n  if (config.public.themeConfig?.useAITheme !== undefined) {\n    useAITheme = config.public.themeConfig?.useAITheme;\n  } else {\n    useAITheme = DEFAULT_THEME_STATE.useAITheme;\n  }\n  const themeState = {\n    carbonTheme: config.public.themeConfig?.carbonTheme || DEFAULT_THEME_STATE.carbonTheme,\n    useAITheme: useAITheme,\n    corners: getThemeCornersType(config)\n  };\n  const botName = getBotName(themeState.useAITheme, config);\n  const initialState = {\n    ...DEFAULT_MESSAGE_STATE,\n    notifications: [],\n    botInputState: {\n      ...DEFAULT_INPUT_STATE(),\n      isReadonly: config.public.isReadonly,\n      fieldVisible: !config.public.isReadonly\n    },\n    agentState: {\n      ...DEFAULT_AGENT_STATE\n    },\n    botName: botName,\n    headerDisplayName: null,\n    botAvatarURL: config.public.botAvatarURL || null,\n    headerAvatarConfig: null,\n    chatWidthBreakpoint: null,\n    chatWidth: null,\n    chatHeight: null,\n    cssVariableOverrides: mergeCSSVariables({}, {}, themeState.carbonTheme, themeState.useAITheme),\n    isHydrated: false,\n    languagePack: enLanguagePack,\n    locale: \"en\",\n    config: config,\n    originalConfig: config,\n    suspendScrollDetection: false,\n    homeScreenConfig: withoutEmptyStarters({}),\n    persistedToBrowserStorage: {\n      ...DEFAULT_PERSISTED_TO_BROWSER,\n      chatState: {\n        ...DEFAULT_PERSISTED_TO_BROWSER.chatState,\n        homeScreenState: {\n          ...DEFAULT_PERSISTED_TO_BROWSER.chatState.homeScreenState\n        }\n      }\n    },\n    launcher: merge({}, DEFAULT_LAUNCHER, {\n      config: merge({}, {}, {\n        mobile: {}\n      }, {\n        is_on: config.public.showLauncher\n      })\n    }),\n    iFramePanelState: DEFAULT_IFRAME_PANEL_STATE,\n    viewSourcePanelState: DEFAULT_CITATION_PANEL_STATE,\n    isDestroyed: false,\n    customPanelState: DEFAULT_CUSTOM_PANEL_STATE,\n    viewChanging: false,\n    initialViewChangeComplete: false,\n    targetViewState: config.public.openChatByDefault ? VIEW_STATE_MAIN_WINDOW_OPEN : VIEW_STATE_LAUNCHER_OPEN,\n    responsePanelState: DEFAULT_MESSAGE_PANEL_STATE,\n    customMenuOptions: null,\n    tourState: DEFAULT_TOUR_STATE,\n    isBrowserPageVisible: true,\n    showNonHeaderBackgroundCover: false,\n    theme: themeState,\n    layout: getLayoutState(config),\n    chatHeaderState: {\n      config: null,\n      maxVisibleHeaderObjects: 0\n    }\n  };\n  const sessionStorageLauncherState = serviceManager.userSessionStorageService?.loadLauncherSession();\n  if (sessionStorageLauncherState) {\n    initialState.targetViewState = sessionStorageLauncherState.viewState;\n    sessionStorageLauncherState.viewState = VIEW_STATE_ALL_CLOSED;\n    initialState.persistedToBrowserStorage.launcherState = sessionStorageLauncherState;\n  }\n  const enhancer = config.public.debug || NODE_ENV === \"development\" ? window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__({\n    name: \"CarbonAIChat\",\n    instanceId: `Chat${serviceManager.namespace.suffix}`\n  }) : undefined;\n  return createStore(reducerFunction, initialState, enhancer);\n}\n\nfunction getThemeCornersType(config) {\n  if (getLayoutState(config).showFrame === false || IS_PHONE || config.public.themeConfig?.corners === CornersType.SQUARE) {\n    return CornersType.SQUARE;\n  }\n  return DEFAULT_THEME_STATE.corners;\n}\n\nfunction getLayoutState(config) {\n  if (config.public.themeConfig?.useAITheme) {\n    return {\n      showFrame: config.public.layout?.showFrame ?? true,\n      hasContentMaxWidth: config.public.layout?.hasContentMaxWidth ?? true\n    };\n  }\n  return merge({}, DEFAULT_LAYOUT_STATE, config.public.layout);\n}\n\nfunction reducerFunction(state, action) {\n  return action && reducers[action.type] ? reducers[action.type](state, action) : state;\n}\n\nexport { doCreateStore };\n","import cloneDeep from \"lodash-es/cloneDeep.js\";\n\nimport { consoleDebug, consoleWarn } from \"./utils/miscUtils.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const DEFAULT_PUBLIC_CONFIG = {\n  openChatByDefault: false,\n  showLauncher: true,\n  shouldTakeFocusIfOpensAutomatically: true,\n  serviceDesk: {},\n  messaging: {},\n  themeConfig: {\n    useAITheme: true\n  }\n};\n\nasync function instantiateWidget(pagePublicConfig, chatConstructorPromise, render, element) {\n  const config = cloneDeep(pagePublicConfig);\n  if (!config.messaging?.customSendMessage) {\n    throw new Error(`You must set messaging.customSendMessage in your configuration object.`);\n  }\n  if (config?.debug) {\n    consoleDebug(\"[ChatEntry] Called instantiateWidget\", config);\n  }\n  if (document.location.protocol !== \"https:\") {\n    consoleWarn('Your page is not running with \"https\"; your data will not be sent  securely.');\n  }\n  if (document.compatMode !== \"CSS1Compat\") {\n    consoleWarn('Your page is running in quirks mode; you may experience layout issues with the chat. Add \"<!DOCTYPE html>\" to the page to run in standards mode.');\n  }\n  const {onError: onError, ...publicConfig} = config;\n  const Chat = await chatConstructorPromise(publicConfig);\n  const additionalChatParameters = {\n    onError: onError,\n    render: render\n  };\n  return new Chat(publicConfig, element, additionalChatParameters);\n}\n\nexport { DEFAULT_PUBLIC_CONFIG, instantiateWidget };\n","import dayjs from \"dayjs\";\n\nimport LocalizedFormat from \"dayjs/plugin/localizedFormat.js\";\n\nimport isEqual from \"lodash-es/isEqual.js\";\n\nimport merge from \"lodash-es/merge.js\";\n\nimport { createChatInstance } from \"./ChatInstanceImpl.js\";\n\nimport { createServiceManager } from \"./loadServices.js\";\n\nimport actions from \"./store/actions.js\";\n\nimport { VIEW_STATE_ALL_CLOSED } from \"./store/reducerUtils.js\";\n\nimport { loadLanguagePack, loadLocale } from \"./utils/languages.js\";\n\nimport { hasServiceDesk } from \"./utils/messageUtils.js\";\n\nimport { consoleDebug, consoleError } from \"./utils/miscUtils.js\";\n\nimport { DEFAULT_PUBLIC_CONFIG } from \"./chatEntryFunctions.js\";\n\nimport { MainWindowOpenReason, ViewChangeReason } from \"../../types/events/eventBusTypes.js\";\n\nimport { setIntl } from \"./utils/intlUtils.js\";\n\nimport { loadHAA } from \"../dynamic-imports/dynamic-imports.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\ndayjs.extend(LocalizedFormat);\n\nclass Chat {\n  constructor(publicConfigProvided, customHostElement, additionalChatParametersProvided) {\n    if (publicConfigProvided?.debug) {\n      consoleDebug(\"Constructed chat widget\", publicConfigProvided);\n    }\n    const publicConfig = merge({}, DEFAULT_PUBLIC_CONFIG, publicConfigProvided);\n    this.additionalChatParameters = additionalChatParametersProvided || {};\n    this.appConfig = {\n      public: publicConfig\n    };\n    this.customHostElement = customHostElement;\n  }\n  async start() {\n    try {\n      const result = await this.startInternal();\n      return result.instance;\n    } catch (error) {\n      consoleError(\"There was an error starting your chat\", error);\n      return null;\n    }\n  }\n  async startInternal() {\n    const doesHaveServiceDesk = hasServiceDesk(this.appConfig);\n    this.serviceManager = await createServiceManager(this.appConfig, this.additionalChatParameters);\n    const [languagePack, localePack, render, createHumanAgentService] = await Promise.all([ loadLanguagePack(this.serviceManager.store.getState().languagePack), loadLocale(this.serviceManager.store.getState().locale), Promise.resolve(this.additionalChatParameters.render), doesHaveServiceDesk ? loadHAA() : Promise.resolve(null) ]);\n    this.serviceManager.customHostElement = this.customHostElement;\n    if (createHumanAgentService) {\n      this.serviceManager.humanAgentService = createHumanAgentService(this.serviceManager);\n    }\n    setIntl(this.serviceManager, localePack.name, languagePack);\n    dayjs.locale(localePack);\n    const reallyRenderAndReturnInstance = async () => {\n      await render({\n        serviceManager: this.serviceManager\n      });\n      const initialState = this.serviceManager.store.getState();\n      const {wasLoadedFromBrowser: wasLoadedFromBrowser} = initialState.persistedToBrowserStorage.launcherState;\n      const {targetViewState: targetViewState} = initialState;\n      const {openChatByDefault: openChatByDefault} = initialState.config.public;\n      if (targetViewState.mainWindow) {\n        let mainWindowOpenReason = MainWindowOpenReason.SESSION_HISTORY;\n        if (openChatByDefault && !wasLoadedFromBrowser) {\n          mainWindowOpenReason = MainWindowOpenReason.OPEN_BY_DEFAULT;\n        }\n        await this.serviceManager.actions.changeView(targetViewState, {\n          mainWindowOpenReason: mainWindowOpenReason\n        });\n      } else {\n        const viewChangeReason = ViewChangeReason.WEB_CHAT_LOADED;\n        const tryHydrating = targetViewState.tour;\n        const forceViewChange = isEqual(targetViewState, VIEW_STATE_ALL_CLOSED);\n        await this.serviceManager.actions.changeView(targetViewState, {\n          viewChangeReason: viewChangeReason\n        }, tryHydrating, forceViewChange);\n      }\n      this.serviceManager.store.dispatch(actions.setInitialViewChangeComplete(true));\n      return this.serviceManager.instance;\n    };\n    const renderAndReturnInstance = () => {\n      const promise = reallyRenderAndReturnInstance();\n      this.serviceManager.renderPromise = promise;\n      return promise;\n    };\n    this.serviceManager.instance = createChatInstance({\n      serviceManager: this.serviceManager,\n      callRender: renderAndReturnInstance\n    });\n    return {\n      instance: this.serviceManager.instance,\n      serviceManager: this.serviceManager\n    };\n  }\n}\n\nexport { Chat as default };\n","import { ChatActionsImpl } from \"./events/ChatActionsImpl.js\";\n\nimport { EventBus } from \"./events/EventBus.js\";\n\nimport { createCustomPanelManager } from \"./services/CustomPanelManager.js\";\n\nimport { HistoryService } from \"./services/HistoryService.js\";\n\nimport MessageService from \"./services/MessageService.js\";\n\nimport { NamespaceService } from \"./services/NamespaceService.js\";\n\nimport { ServiceManager } from \"./services/ServiceManager.js\";\n\nimport { UserSessionStorageService } from \"./services/UserSessionStorageService.js\";\n\nimport { doCreateStore } from \"./store/doCreateStore.js\";\n\nimport { copyToSessionStorage, createHandleWindowTitle } from \"./store/subscriptions.js\";\n\nimport \"./utils/constants.js\";\n\nimport { setEnableDebugLog, setEnableDebugStackTracesLog } from \"./utils/miscUtils.js\";\n\nimport { setIntl } from \"./utils/intlUtils.js\";\n\nimport { WriteableElementName } from \"../../types/instance/ChatInstance.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ async function createServiceManager(appConfig, additionalChatParameters) {\n  const publicConfig = appConfig.public;\n  const serviceManager = new ServiceManager;\n  serviceManager.additionalChatParameters = additionalChatParameters;\n  serviceManager.namespace = new NamespaceService(publicConfig.namespace);\n  serviceManager.userSessionStorageService = new UserSessionStorageService(serviceManager);\n  serviceManager.actions = new ChatActionsImpl(serviceManager);\n  serviceManager.eventBus = new EventBus;\n  serviceManager.store = doCreateStore(appConfig, serviceManager);\n  serviceManager.historyService = new HistoryService(serviceManager);\n  serviceManager.messageService = new MessageService(serviceManager, publicConfig);\n  serviceManager.store.subscribe(copyToSessionStorage(serviceManager));\n  if (!publicConfig.disableWindowTitleChanges) {\n    serviceManager.store.subscribe(createHandleWindowTitle(serviceManager));\n  }\n  serviceManager.customPanelManager = createCustomPanelManager(serviceManager);\n  setIntl(serviceManager, serviceManager.store.getState().locale, serviceManager.store.getState().languagePack);\n  serviceManager.writeableElements = {\n    [WriteableElementName.AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.WELCOME_NODE_BEFORE_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HEADER_BOTTOM_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.BEFORE_INPUT_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HOME_SCREEN_HEADER_BOTTOM_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HOME_SCREEN_AFTER_STARTERS_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.HOME_SCREEN_BEFORE_INPUT_ELEMENT]: document.createElement(\"div\"),\n    [WriteableElementName.CUSTOM_PANEL_ELEMENT]: document.createElement(\"div\")\n  };\n  if (publicConfig.debug) {\n    setEnableDebugLog(true);\n  }\n  if (publicConfig.debugStackTraces) {\n    setEnableDebugStackTracesLog(true);\n  }\n  return serviceManager;\n}\n\nexport { createServiceManager };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst UNREAD_COUNT_TITLE_TIME = 1e4;\n\nfunction copyToSessionStorage(serviceManager) {\n  let previousPersistedToBrowserStorage = serviceManager.store.getState().persistedToBrowserStorage;\n  return () => {\n    const {persistedToBrowserStorage: persistedToBrowserStorage} = serviceManager.store.getState();\n    const persistChatSession = previousPersistedToBrowserStorage !== persistedToBrowserStorage;\n    if (persistChatSession) {\n      previousPersistedToBrowserStorage = persistedToBrowserStorage;\n      serviceManager.userSessionStorageService.persistChatSession(persistedToBrowserStorage.chatState);\n      serviceManager.userSessionStorageService.persistLauncherSession(persistedToBrowserStorage.launcherState);\n    }\n  };\n}\n\nfunction createHandleWindowTitle(serviceManager) {\n  const {store: store} = serviceManager;\n  let originalTitle;\n  let changeTitleTimer;\n  let previousState = store.getState();\n  return () => {\n    const state = store.getState();\n    const {agentState: agentState} = store.getState();\n    const {numUnreadMessages: numUnreadMessages} = agentState;\n    if (numUnreadMessages !== previousState.agentState.numUnreadMessages) {\n      if (!numUnreadMessages) {\n        clearTimeout(changeTitleTimer);\n        if (originalTitle) {\n          window.document.title = originalTitle;\n          originalTitle = null;\n        }\n      } else {\n        clearTimeout(changeTitleTimer);\n        if (!originalTitle) {\n          originalTitle = window.document.title;\n        }\n        window.document.title = state.languagePack.agent_newMessage;\n        changeTitleTimer = setTimeout(() => {\n          window.document.title = `(${numUnreadMessages}) ${originalTitle}`;\n        }, UNREAD_COUNT_TITLE_TIME);\n      }\n    }\n    previousState = state;\n  };\n}\n\nexport { copyToSessionStorage, createHandleWindowTitle };\n","import { DEFAULT_CUSTOM_PANEL_ID } from \"../utils/constants.js\";\n\nimport { createCustomPanelInstance } from \"./CustomPanelInstance.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function createCustomPanelManager(serviceManger) {\n  const panels = {\n    [DEFAULT_CUSTOM_PANEL_ID]: createCustomPanelInstance(serviceManger)\n  };\n  return Object.freeze({\n    getPanel() {\n      return panels[DEFAULT_CUSTOM_PANEL_ID];\n    }\n  });\n}\n\nexport { createCustomPanelManager };\n","import React, { useRef, useCallback, useEffect } from \"react\";\n\nimport { useIntl } from \"react-intl\";\n\nimport { AriaAnnouncerContext } from \"../../contexts/AriaAnnouncerContext.js\";\n\nimport { useServiceManager } from \"../../hooks/useServiceManager.js\";\n\nimport { AriaAnnouncerComponent } from \"./AriaAnnouncerComponent.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function AriaAnnouncerProvider(props) {\n  const intl = useIntl();\n  const {store: store} = useServiceManager();\n  const announcerRef = useRef();\n  const announcerFunction = useCallback(value => {\n    if (!announcerRef.current) {\n      setTimeout(() => announcerRef.current.announceValue(value));\n    } else {\n      announcerRef.current.announceValue(value);\n    }\n  }, []);\n  const previousAnnounceMessageRef = useRef();\n  useEffect(() => {\n    const unsubscribe = store.subscribe(() => {\n      const currentAnnounceMessage = store.getState().announceMessage;\n      if (currentAnnounceMessage !== previousAnnounceMessageRef.current) {\n        announcerFunction(currentAnnounceMessage);\n        previousAnnounceMessageRef.current = currentAnnounceMessage;\n      }\n    });\n    return unsubscribe;\n  }, [ store, announcerFunction ]);\n  return React.createElement(AriaAnnouncerContext.Provider, {\n    value: announcerFunction\n  }, props.children, React.createElement(AriaAnnouncerComponent, {\n    intl: intl,\n    ref: announcerRef\n  }));\n}\n\nexport { AriaAnnouncerProvider };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction getLauncherButtonAriaLabel(languagePack, isLauncherHidden, isTourActive) {\n  if (isTourActive) {\n    return isLauncherHidden ? languagePack.launcher_isTourOpen : languagePack.launcher_isTourClosed;\n  }\n  return isLauncherHidden ? languagePack.launcher_isOpen : languagePack.launcher_isClosed;\n}\n\nexport { getLauncherButtonAriaLabel };\n","import AiLaunch from \"@carbon/icons-react/es/AiLaunch.js\";\n\nimport ArrowUpLeft from \"@carbon/icons-react/es/ArrowUpLeft.js\";\n\nimport ChatLaunch from \"@carbon/icons-react/es/ChatLaunch.js\";\n\nimport { Button } from \"@carbon/react\";\n\nimport cx from \"classnames\";\n\nimport React, { forwardRef, useImperativeHandle } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { doFocusRef } from \"../../utils/domUtils.js\";\n\nimport { getLauncherButtonAriaLabel } from \"./launcherUtils.js\";\n\nimport { ButtonKindEnum } from \"../../../../types/utilities/carbonTypes.js\";\n\nimport { PageObjectId } from \"../../utils/PageObjectId.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function Launcher(props, ref) {\n  const {onToggleOpen: onToggleOpen, languagePack: languagePack, unreadAgentCount: unreadAgentCount, intl: intl, showUnreadIndicator: showUnreadIndicator, className: className, tabIndex: tabIndex, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const launcherAvatarURL = useSelector(state => state.theme.useAITheme ? undefined : state.launcher.config.desktop.avatar_url_override);\n  const useAITheme = useSelector(state => state.theme.useAITheme);\n  const buttonRef = React.createRef();\n  useImperativeHandle(ref, () => ({\n    requestFocus: () => {\n      doFocusRef(buttonRef);\n    }\n  }));\n  let ariaLabel = getLauncherButtonAriaLabel(languagePack, launcherHidden, activeTour);\n  if (unreadAgentCount !== 0) {\n    ariaLabel += `. ${intl.formatMessage({\n      id: \"icon_ariaUnreadMessages\"\n    }, {\n      count: unreadAgentCount\n    })}`;\n  }\n  let launcherAvatar = useAITheme ? React.createElement(AiLaunch, {\n    size: 24,\n    className: \"WACLauncher_svg\"\n  }) : React.createElement(ChatLaunch, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  });\n  if (launcherAvatarURL) {\n    launcherAvatar = React.createElement(\"img\", {\n      className: \"WACLauncher__Avatar\",\n      src: launcherAvatarURL,\n      alt: \"\",\n      \"aria-hidden\": true\n    });\n  }\n  return React.createElement(\"div\", {\n    className: cx(\"WACLauncher__ButtonContainer\", \"WACLauncher__ButtonContainer--round\", className, {\n      \"WACLauncher__ButtonContainer--hidden\": launcherHidden\n    })\n  }, React.createElement(Button, {\n    \"aria-label\": ariaLabel,\n    className: cx(\"WACLauncher__Button\", {\n      WACLauncher__TourButton: activeTour\n    }),\n    \"data-testid\": PageObjectId.LAUNCHER,\n    kind: ButtonKindEnum.PRIMARY,\n    type: \"button\",\n    onClick: onToggleOpen,\n    ref: buttonRef,\n    tabIndex: tabIndex\n  }, activeTour ? React.createElement(ArrowUpLeft, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  }) : launcherAvatar, (unreadAgentCount !== 0 || showUnreadIndicator) && React.createElement(\"div\", {\n    className: \"WAC__countIndicator\"\n  }, unreadAgentCount !== 0 ? unreadAgentCount : \"\")));\n}\n\nconst LauncherExport = forwardRef(Launcher);\n\nexport { LauncherExport as Launcher };\n","import Close from \"@carbon/icons-react/es/Close.js\";\n\nimport { Tag } from \"@carbon/react\";\n\nimport cx from \"classnames\";\n\nimport React from \"react\";\n\nimport { Launcher as LauncherExport } from \"./Launcher.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function LauncherComplex(props) {\n  const {languagePack: languagePack, intl: intl, launcherConfig: launcherConfig, launcherComplexRef: launcherComplexRef, launcherRef: launcherRef, onOpen: onOpen, onMinimize: onMinimize, unreadAgentCount: unreadAgentCount, showUnreadIndicator: showUnreadIndicator, desktopLauncherIsExpanded: desktopLauncherIsExpanded, launcherHidden: launcherHidden, activeTour: activeTour, className: className} = props;\n  const {launcher_desktopGreeting: launcher_desktopGreeting, launcher_closeButton: launcher_closeButton, launcher_ariaIsExpanded: launcher_ariaIsExpanded} = languagePack;\n  function getLauncherContent() {\n    if (launcherConfig.desktop.title) {\n      return launcherConfig.desktop.title;\n    }\n    return launcher_desktopGreeting;\n  }\n  return React.createElement(\"div\", {\n    className: cx(\"WACLauncher__ButtonContainer\", \"WACLauncherComplex__Container\", className, {\n      \"WACLauncher__ButtonContainer--hidden\": launcherHidden\n    }),\n    ref: launcherComplexRef\n  }, React.createElement(\"button\", {\n    className: \"WACLauncherComplex__ContentButton\",\n    type: \"button\",\n    onClick: onOpen,\n    disabled: !desktopLauncherIsExpanded\n  }, React.createElement(\"div\", {\n    className: cx(\"WACWidget__textEllipsis\", {\n      WACLauncherComplex__Text: !launcherHidden\n    })\n  }, getLauncherContent())), React.createElement(LauncherExport, {\n    languagePack: languagePack,\n    intl: intl,\n    ref: launcherRef,\n    onToggleOpen: onOpen,\n    className: \"WACLauncherComplex__SmallLauncherContainer\",\n    unreadAgentCount: unreadAgentCount,\n    showUnreadIndicator: showUnreadIndicator,\n    launcherHidden: launcherHidden,\n    activeTour: activeTour\n  }), React.createElement(Tag, {\n    className: \"WACLauncher__CloseButton\",\n    \"aria-label\": launcher_ariaIsExpanded,\n    onClick: onMinimize,\n    disabled: !desktopLauncherIsExpanded\n  }, React.createElement(\"div\", {\n    className: \"WACLauncher__CloseButtonInnerWrapper\"\n  }, React.createElement(Close, {\n    className: \"WACLauncher__CloseButtonIcon\"\n  }), launcher_closeButton)));\n}\n\nexport { LauncherComplex };\n","import React, { useState, useRef, useCallback, useEffect } from \"react\";\n\nimport { useIntl } from \"react-intl\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { useLanguagePack } from \"../../hooks/useLanguagePack.js\";\n\nimport { useOnMount } from \"../../hooks/useOnMount.js\";\n\nimport { usePrevious } from \"../../hooks/usePrevious.js\";\n\nimport { useServiceManager } from \"../../hooks/useServiceManager.js\";\n\nimport actions from \"../../store/actions.js\";\n\nimport { BOUNCING_ANIMATION_TIMEOUTS } from \"../../../../types/config/LauncherConfig.js\";\n\nimport { Launcher as LauncherExport } from \"./Launcher.js\";\n\nimport { LauncherComplex } from \"./LauncherComplex.js\";\n\nimport { LauncherType } from \"../../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst TIME_FOR_MINIMIZE_ANIMATION = 400;\n\nconst TIME_FOR_BOUNCE_ANIMATION = 500;\n\nconst LauncherDesktopContainer = props => {\n  const {launcherRef: launcherRef, onDoToggle: onDoToggle, requestFocus: requestFocus, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const serviceManager = useServiceManager();\n  const languagePack = useLanguagePack();\n  const intl = useIntl();\n  const browserLauncherState = useSelector(state => state.persistedToBrowserStorage.launcherState);\n  const {desktopLauncherWasMinimized: desktopLauncherWasMinimized, desktopLauncherIsExpanded: desktopLauncherIsExpanded, bounceTurn: bounceTurn, showUnreadIndicator: showUnreadIndicator, viewState: viewState} = browserLauncherState;\n  const launcherState = useSelector(state => state.launcher);\n  const launcherConfig = launcherState.config;\n  const {time_to_expand: time_to_expand, new_expand_time: new_expand_time} = launcherConfig.desktop;\n  const isExpandedLauncherEnabled = launcherConfig.desktop.is_on;\n  const unreadAgentCount = useSelector(state => state.agentState.numUnreadMessages);\n  const [smallLauncherClassName, setSmallLauncherClassName] = useState(\"\");\n  const [complexLauncherClassName, setComplexLauncherClassName] = useState(\"\");\n  const launcherComplexRef = useRef();\n  const launcherHiddenRef = useRef();\n  launcherHiddenRef.current = launcherHidden;\n  const animateOnceVisible = useRef(false);\n  const bounceTurnRef = useRef();\n  bounceTurnRef.current = bounceTurn;\n  const animationStartTimerRef = useRef();\n  const animationFinishedTimerRef = useRef();\n  const firstBounceAnimationStartTimerRef = useRef();\n  const firstBounceAnimationFinishedTimerRef = useRef();\n  const secondBounceAnimationStartTimerRef = useRef();\n  const secondBounceAnimationFinishedTimerRef = useRef();\n  const determineLauncherHeight = useCallback(() => {\n    const expandedLauncherHeight = `${launcherComplexRef.current?.offsetHeight}px`;\n    if (launcherComplexRef.current?.style?.setProperty) {\n      launcherComplexRef.current.style.setProperty(\"--cds-chat-LAUNCHER-desktop-expanded-height\", expandedLauncherHeight);\n    }\n  }, []);\n  const startExpandLauncher = useCallback(() => {\n    if (!launcherHiddenRef.current) {\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"desktopLauncherIsExpanded\", true));\n      determineLauncherHeight();\n      setComplexLauncherClassName(\"WACLauncherComplex__Container--introAnimation\");\n    }\n  }, [ determineLauncherHeight, serviceManager.store ]);\n  const setExpandAnimationTimers = useCallback(() => {\n    animationStartTimerRef.current = setTimeout(() => {\n      startExpandLauncher();\n    }, time_to_expand);\n  }, [ time_to_expand, startExpandLauncher ]);\n  const clearExpandAnimationTimers = useCallback(() => {\n    clearTimeout(animationStartTimerRef.current);\n    clearTimeout(animationFinishedTimerRef.current);\n  }, []);\n  const startBounceAnimation = useCallback(() => {\n    if (!launcherHiddenRef.current) {\n      setSmallLauncherClassName(\"WACLauncher__ButtonContainer--bounceAnimation\");\n    }\n  }, []);\n  const finishBounceAnimation = useCallback(() => {\n    if (!launcherHiddenRef.current) {\n      setSmallLauncherClassName(\"WACLauncher__ButtonContainer--noAnimation\");\n      bounceTurnRef.current++;\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"bounceTurn\", bounceTurnRef.current));\n    }\n  }, [ serviceManager.store ]);\n  const setBounceAnimationTimers = useCallback(() => {\n    if (bounceTurnRef.current === 1) {\n      firstBounceAnimationStartTimerRef.current = setTimeout(() => {\n        startBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0]);\n      firstBounceAnimationFinishedTimerRef.current = setTimeout(() => {\n        finishBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0] + TIME_FOR_BOUNCE_ANIMATION);\n      secondBounceAnimationStartTimerRef.current = setTimeout(() => {\n        startBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0] + BOUNCING_ANIMATION_TIMEOUTS[1]);\n      secondBounceAnimationFinishedTimerRef.current = setTimeout(() => {\n        finishBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[0] + BOUNCING_ANIMATION_TIMEOUTS[1] + TIME_FOR_BOUNCE_ANIMATION);\n    } else if (bounceTurnRef.current === 2) {\n      secondBounceAnimationStartTimerRef.current = setTimeout(() => {\n        startBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[1]);\n      secondBounceAnimationFinishedTimerRef.current = setTimeout(() => {\n        finishBounceAnimation();\n      }, BOUNCING_ANIMATION_TIMEOUTS[1] + TIME_FOR_BOUNCE_ANIMATION);\n    }\n  }, [ finishBounceAnimation, startBounceAnimation ]);\n  const clearBounceAnimationTimers = useCallback(() => {\n    clearTimeout(firstBounceAnimationStartTimerRef.current);\n    clearTimeout(firstBounceAnimationFinishedTimerRef.current);\n    clearTimeout(secondBounceAnimationStartTimerRef.current);\n    clearTimeout(secondBounceAnimationFinishedTimerRef.current);\n  }, []);\n  const setDefaultLauncherState = useCallback(() => {\n    clearExpandAnimationTimers();\n    serviceManager.store.dispatch(actions.setLauncherMinimized());\n    clearBounceAnimationTimers();\n    serviceManager.store.dispatch(actions.setLauncherProperty(\"bounceTurn\", 3));\n    animateOnceVisible.current = false;\n    setSmallLauncherClassName(\"WACLauncher__ButtonContainer--noAnimation\");\n  }, [ clearBounceAnimationTimers, clearExpandAnimationTimers, serviceManager.store ]);\n  useOnMount(() => {\n    if (desktopLauncherIsExpanded) {\n      animateOnceVisible.current = true;\n    } else if (!desktopLauncherWasMinimized && isExpandedLauncherEnabled) {\n      setExpandAnimationTimers();\n      return () => {\n        clearExpandAnimationTimers();\n      };\n    } else if (desktopLauncherWasMinimized && bounceTurn !== 3) {\n      setBounceAnimationTimers();\n      return () => {\n        clearBounceAnimationTimers();\n      };\n    }\n    return undefined;\n  });\n  useEffect(() => {\n    if (viewState.launcher && animateOnceVisible.current) {\n      determineLauncherHeight();\n      setComplexLauncherClassName(\"WACLauncherComplex__Container--simpleAnimation\");\n      animateOnceVisible.current = false;\n    }\n  }, [ determineLauncherHeight, viewState.launcher ]);\n  useEffect(() => {\n    if (viewState.mainWindow || viewState.tour) {\n      setDefaultLauncherState();\n    }\n  }, [ viewState, setDefaultLauncherState ]);\n  useEffect(() => {\n    if (new_expand_time) {\n      clearBounceAnimationTimers();\n      clearExpandAnimationTimers();\n      setExpandAnimationTimers();\n      serviceManager.store.dispatch(actions.setLauncherConfigProperty(\"new_expand_time\", false, LauncherType.DESKTOP));\n    }\n  }, [ animationFinishedTimerRef, animationStartTimerRef, new_expand_time, setExpandAnimationTimers, clearExpandAnimationTimers, clearBounceAnimationTimers, serviceManager.store ]);\n  const prevLauncherTitle = usePrevious(launcherConfig.desktop.title);\n  useEffect(() => {\n    if (prevLauncherTitle !== launcherConfig.desktop.title && (launcherConfig.desktop.title || prevLauncherTitle)) {\n      determineLauncherHeight();\n    }\n  }, [ determineLauncherHeight, launcherConfig, prevLauncherTitle ]);\n  const onMinimize = useCallback(() => {\n    setComplexLauncherClassName(\"WACLauncherComplex__Container--closeAnimation\");\n    setTimeout(() => {\n      setSmallLauncherClassName(\"WACLauncher__ButtonContainer--noAnimation\");\n      serviceManager.store.dispatch(actions.setLauncherMinimized());\n      setTimeout(requestFocus);\n    }, TIME_FOR_MINIMIZE_ANIMATION);\n  }, [ requestFocus, serviceManager.store ]);\n  const onOpen = useCallback(() => {\n    setDefaultLauncherState();\n    onDoToggle();\n  }, [ onDoToggle, setDefaultLauncherState ]);\n  let launcher;\n  if (desktopLauncherIsExpanded) {\n    launcher = React.createElement(LauncherComplex, {\n      languagePack: languagePack,\n      intl: intl,\n      launcherComplexRef: launcherComplexRef,\n      launcherRef: launcherRef,\n      launcherConfig: launcherConfig,\n      onOpen: onOpen,\n      onMinimize: onMinimize,\n      unreadAgentCount: unreadAgentCount,\n      showUnreadIndicator: showUnreadIndicator,\n      desktopLauncherIsExpanded: desktopLauncherIsExpanded,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour,\n      className: complexLauncherClassName\n    });\n  } else {\n    launcher = React.createElement(LauncherExport, {\n      languagePack: languagePack,\n      intl: intl,\n      ref: launcherRef,\n      onToggleOpen: onOpen,\n      unreadAgentCount: unreadAgentCount,\n      showUnreadIndicator: showUnreadIndicator,\n      className: smallLauncherClassName,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour\n    });\n  }\n  return launcher;\n};\n\nexport { LauncherDesktopContainer };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction animateWithClass(element, className, endAnimationNameOrDelay, endAnimationCallback) {\n  if (element) {\n    element.classList.add(className);\n    if (typeof endAnimationNameOrDelay === \"number\") {\n      setTimeout(() => {\n        element.classList.remove(className);\n        if (endAnimationCallback) {\n          endAnimationCallback();\n        }\n      }, endAnimationNameOrDelay);\n    } else {\n      const listener = event => {\n        if (!endAnimationNameOrDelay || event.animationName === endAnimationNameOrDelay) {\n          element.removeEventListener(\"animationend\", listener);\n          element.removeEventListener(\"animationcancel\", listener);\n          element.classList.remove(className);\n          if (endAnimationCallback) {\n            endAnimationCallback();\n          }\n        }\n      };\n      element.addEventListener(\"animationend\", listener);\n      element.addEventListener(\"animationcancel\", listener);\n    }\n  }\n}\n\nfunction setAnimationTimeouts(element, animation, timeouts, options) {\n  const {startingIndex: startingIndex, beforeAll: beforeAll, afterAll: afterAll, beforeEach: beforeEach, afterEach: afterEach} = options;\n  let index = startingIndex || 0;\n  let terminate = false;\n  let timeoutID = null;\n  function playAnimation() {\n    if (beforeAll && index === 0) {\n      beforeAll();\n    }\n    const isComplete = index === timeouts.length;\n    if (!isComplete && !terminate) {\n      timeoutID = setTimeout(setAnimationListener, timeouts[index]);\n    } else if (isComplete && afterAll) {\n      afterAll();\n    }\n  }\n  function replayAnimation() {\n    if (afterEach) {\n      afterEach();\n    }\n    index++;\n    element.removeEventListener(\"animationend\", replayAnimation);\n    element.classList.remove(animation);\n    playAnimation();\n  }\n  function setAnimationListener() {\n    if (beforeEach) {\n      beforeEach();\n    }\n    element.addEventListener(\"animationend\", replayAnimation);\n    element.classList.add(animation);\n  }\n  playAnimation();\n  return () => {\n    terminate = true;\n    clearTimeout(timeoutID);\n    element.classList.remove(animation);\n    element.removeEventListener(\"animationend\", replayAnimation);\n  };\n}\n\nexport { animateWithClass, setAnimationTimeouts };\n","import ArrowUpLeft from \"@carbon/icons-react/es/ArrowUpLeft.js\";\n\nimport ChatLaunch from \"@carbon/icons-react/es/ChatLaunch.js\";\n\nimport { Button } from \"@carbon/react\";\n\nimport cx from \"classnames\";\n\nimport React, { forwardRef, useState, useRef, useImperativeHandle, useEffect } from \"react\";\n\nimport { useIntl } from \"react-intl\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { useAriaAnnouncer } from \"../../hooks/useAriaAnnouncer.js\";\n\nimport { useLanguagePack } from \"../../hooks/useLanguagePack.js\";\n\nimport { usePrevious } from \"../../hooks/usePrevious.js\";\n\nimport { animateWithClass } from \"../../utils/animationUtils.js\";\n\nimport { IS_MOBILE } from \"../../utils/browserUtils.js\";\n\nimport { doFocusRef } from \"../../utils/domUtils.js\";\n\nimport { getLauncherButtonAriaLabel } from \"./launcherUtils.js\";\n\nimport { ButtonKindEnum } from \"../../../../types/utilities/carbonTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const MAX_EXTENDED_LAUNCHER_WIDTH = 400;\n\nfunction LauncherExtended(props, ref) {\n  const {unreadAgentCount: unreadAgentCount, showUnreadIndicator: showUnreadIndicator, launcherConfig: launcherConfig, isExtended: isExtended, playExtendAnimation: playExtendAnimation, onToggleOpen: onToggleOpen, onSwipeRight: onSwipeRight, onReduceEnd: onReduceEnd, className: className, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const ariaAnnouncer = useAriaAnnouncer();\n  const languagePack = useLanguagePack();\n  const intl = useIntl();\n  const launcherAvatarURL = useSelector(state => state.theme.useAITheme ? undefined : state.launcher.config.mobile.avatar_url_override);\n  const [animateExtendedState, setAnimateExtendedState] = useState(playExtendAnimation);\n  const [showGreetingMessage, setShowGreetingMessage] = useState(false);\n  const prevIsExtended = usePrevious(isExtended);\n  const buttonRef = useRef();\n  const extendedContainerRef = useRef();\n  const greetingMessageRef = useRef();\n  const textHolderRef = useRef();\n  const touchStartRef = useRef({\n    touchStartX: null,\n    touchStartY: null\n  });\n  const shouldReduceExtendedLauncher = !isExtended && prevIsExtended;\n  const extendWithAnimation = isExtended && animateExtendedState;\n  const extendWithoutAnimation = isExtended && !animateExtendedState;\n  const launcherGreetingMessage = launcherConfig.mobile.title || languagePack.launcher_mobileGreeting;\n  let ariaLabel = getLauncherButtonAriaLabel(languagePack, launcherHidden, activeTour);\n  if (unreadAgentCount !== 0) {\n    ariaLabel += `. ${intl.formatMessage({\n      id: \"icon_ariaUnreadMessages\"\n    }, {\n      count: unreadAgentCount\n    })}`;\n  }\n  let launcherAvatar = React.createElement(ChatLaunch, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  });\n  if (launcherAvatarURL) {\n    launcherAvatar = React.createElement(\"img\", {\n      className: \"WACLauncher__Avatar\",\n      src: launcherAvatarURL,\n      \"aria-hidden\": true,\n      alt: \"\"\n    });\n  }\n  useImperativeHandle(ref, () => ({\n    requestFocus: () => {\n      doFocusRef(buttonRef);\n    },\n    launcherContainerElement: () => extendedContainerRef.current\n  }));\n  useEffect(() => {\n    const textHolderElement = textHolderRef.current;\n    const greetingMessageElement = greetingMessageRef.current;\n    const extendedContainerElement = extendedContainerRef.current;\n    calculateAndSetMaxExtendedLauncherWidth(textHolderElement, greetingMessageElement, extendedContainerElement);\n  }, [ ariaAnnouncer, extendWithoutAnimation, launcherGreetingMessage ]);\n  useEffect(() => {\n    if (isExtended) {\n      if (animateExtendedState) {\n        doFadeAnimationForElements({\n          fadeInElement: greetingMessageRef.current,\n          fadeInTime: 300\n        }, () => {\n          setAnimateExtendedState(false);\n        });\n      } else {\n        setShowGreetingMessage(true);\n      }\n      const buttonEl = buttonRef.current;\n      const handleTouchMove = event => {\n        checkIfUserSwipedRight(event.touches[0], touchStartRef.current, onSwipeRight);\n      };\n      const handleTouchStart = event => {\n        const {clientX: clientX, clientY: clientY} = event.touches[0];\n        const touchStart = touchStartRef.current;\n        touchStart.touchStartX = clientX;\n        touchStart.touchStartY = clientY;\n        buttonRef.current.addEventListener(\"touchmove\", handleTouchMove);\n      };\n      buttonEl.addEventListener(\"touchstart\", handleTouchStart);\n      return () => {\n        buttonEl.removeEventListener(\"touchmove\", handleTouchMove);\n        buttonEl.removeEventListener(\"touchstart\", handleTouchStart);\n      };\n    } else if (shouldReduceExtendedLauncher) {\n      const reduceAnimationEndListener = () => {\n        onReduceEnd();\n        setAnimateExtendedState(true);\n        extendedContainerRef.current.removeEventListener(\"animationend\", reduceAnimationEndListener);\n      };\n      extendedContainerRef.current.addEventListener(\"animationend\", reduceAnimationEndListener);\n      doFadeAnimationForElements({\n        fadeOutElement: greetingMessageRef.current\n      });\n    }\n    return undefined;\n  }, [ animateExtendedState, ariaAnnouncer, isExtended, launcherGreetingMessage, onReduceEnd, onSwipeRight, shouldReduceExtendedLauncher ]);\n  return React.createElement(\"div\", {\n    className: cx(\"WACLauncher__ButtonContainer WACLauncher__ButtonContainer--round WACLauncherExtended__Container\", className, {\n      \"WACLauncher__ButtonContainer--hidden\": launcherHidden,\n      \"WACLauncherExtended__Button--extended\": extendWithoutAnimation,\n      \"WACLauncherExtended__Button--extendedAnimation\": extendWithAnimation,\n      \"WACLauncherExtended__Button--reducedAnimation\": shouldReduceExtendedLauncher\n    }),\n    ref: extendedContainerRef\n  }, React.createElement(Button, {\n    \"aria-label\": ariaLabel,\n    className: cx(\"WACLauncher__Button\", \"WACLauncherExtended__Button\", {\n      WACLauncher__TourButton: activeTour\n    }),\n    kind: activeTour ? ButtonKindEnum.GHOST : ButtonKindEnum.PRIMARY,\n    type: \"button\",\n    ref: buttonRef,\n    onClick: onToggleOpen\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__WrapperContainer\"\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__Wrapper\"\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__TextHolder\",\n    ref: textHolderRef\n  }, React.createElement(\"div\", {\n    className: cx(\"WACLauncherExtended__Greeting\", {\n      \"WACLauncherExtended__Element--hidden\": !showGreetingMessage\n    }),\n    ref: greetingMessageRef\n  }, React.createElement(\"div\", {\n    className: \"WACLauncherExtended__GreetingText\",\n    \"aria-hidden\": !isExtended\n  }, launcherGreetingMessage))), React.createElement(\"div\", {\n    className: \"WACLauncher__IconHolder\"\n  }, activeTour ? React.createElement(ArrowUpLeft, {\n    size: 24,\n    className: \"WACLauncher__svg\"\n  }) : launcherAvatar))), (unreadAgentCount !== 0 || showUnreadIndicator) && React.createElement(\"div\", {\n    className: \"WAC__countIndicator\"\n  }, unreadAgentCount !== 0 ? unreadAgentCount : \"\")));\n}\n\nfunction calculateAndSetMaxExtendedLauncherWidth(textHolderEl, greetingMessageEl, extendedContainerEl) {\n  const nonTextSpace = 68;\n  const maxLauncherExtendedWidth = getMaxLauncherExtendedWidth();\n  const maxTextHolderWidth = maxLauncherExtendedWidth - nonTextSpace + 12;\n  textHolderEl.style.setProperty(\"width\", `${maxTextHolderWidth}px`);\n  greetingMessageEl.style.setProperty(\"width\", `${maxTextHolderWidth - 12}px`);\n  greetingMessageEl.style.setProperty(\"display\", \"flex\");\n  const {clientWidth: clientWidth} = greetingMessageEl.querySelector(\".WACLauncherExtended__GreetingText\");\n  let launcherExtendedWidth = clientWidth + nonTextSpace + 1;\n  if (launcherExtendedWidth > MAX_EXTENDED_LAUNCHER_WIDTH) {\n    launcherExtendedWidth = MAX_EXTENDED_LAUNCHER_WIDTH;\n  }\n  greetingMessageEl.removeAttribute(\"style\");\n  textHolderEl.removeAttribute(\"style\");\n  extendedContainerEl.style.setProperty(\"--cds-chat--LAUNCHER-EXTENDED-width\", `${launcherExtendedWidth}px`);\n}\n\nfunction doFadeAnimationForElements({fadeOutElement: fadeOutElement, fadeInElement: fadeInElement, fadeInTime: fadeInTime = 600}, callback) {\n  if (fadeOutElement) {\n    fadeOutElement.classList.remove(\"WACLauncherExtended__Element--hidden\");\n    animateWithClass(fadeOutElement, \"WACLauncherExtended__Element--FadeOut\", 500, () => {\n      fadeOutElement.classList.add(\"WACLauncherExtended__Element--hidden\");\n      fadeOutElement.classList.remove(\"WACLauncherExtended__Element--FadeOut\");\n      if (!fadeInElement && callback) {\n        callback();\n      }\n    });\n  }\n  if (fadeInElement) {\n    setTimeout(() => {\n      fadeInElement.classList.remove(\"WACLauncherExtended__Element--hidden\");\n      animateWithClass(fadeInElement, \"WACLauncherExtended__Element--FadeIn\", 600, () => {\n        fadeInElement.classList.remove(\"WACLauncherExtended__Element--FadeIn\");\n        if (callback) {\n          callback();\n        }\n      });\n    }, fadeInTime);\n  }\n}\n\nfunction checkIfUserSwipedRight(touchList, touchStartCoordinates, callback) {\n  const {touchStartX: touchStartX, touchStartY: touchStartY} = touchStartCoordinates;\n  if (touchStartX === null || touchStartY === null) {\n    return;\n  }\n  const {clientX: touchEndX, clientY: touchEndY} = touchList;\n  const differenceX = touchEndX - touchStartX;\n  const differenceY = touchEndY - touchStartY;\n  if (Math.abs(differenceX) > Math.abs(differenceY)) {\n    if (differenceX > 0) {\n      callback();\n    }\n  }\n  touchStartCoordinates.touchStartX = null;\n  touchStartCoordinates.touchStartY = null;\n}\n\nfunction getMaxLauncherExtendedWidth() {\n  const launcherPosition = IS_MOBILE ? 32 : 64;\n  const {width: width, height: height} = window.screen;\n  const lowestValue = Math.min(height, width);\n  const extendedWidth = lowestValue - launcherPosition;\n  return Math.min(extendedWidth, MAX_EXTENDED_LAUNCHER_WIDTH);\n}\n\nconst LauncherExtendedExport = React.memo(forwardRef(LauncherExtended));\n\nexport { LauncherExtendedExport as LauncherExtended };\n","import cx from \"classnames\";\n\nimport React, { useState, useRef, useCallback, useEffect } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { useOnMount } from \"../../hooks/useOnMount.js\";\n\nimport { usePrevious } from \"../../hooks/usePrevious.js\";\n\nimport { useServiceManager } from \"../../hooks/useServiceManager.js\";\n\nimport actions from \"../../store/actions.js\";\n\nimport { BOUNCING_ANIMATION_TIMEOUTS } from \"../../../../types/config/LauncherConfig.js\";\n\nimport { setAnimationTimeouts } from \"../../utils/animationUtils.js\";\n\nimport { LauncherExtended as LauncherExtendedExport } from \"./LauncherExtended.js\";\n\nimport { LauncherType } from \"../../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function LauncherMobileContainer(props) {\n  const {launcherRef: launcherRef, onToggleOpen: onToggleOpen, launcherHidden: launcherHidden, activeTour: activeTour} = props;\n  const serviceManager = useServiceManager();\n  const {config: launcherConfig} = useSelector(state => state.launcher);\n  const unreadAgentCount = useSelector(state => state.agentState.numUnreadMessages);\n  const {mobileLauncherIsExtended: isExtended, mobileLauncherWasReduced: wasReduced, mobileLauncherDisableBounce: disableBounce, bounceTurn: bounceTurn, showUnreadIndicator: showUnreadIndicator, viewState: viewState} = useSelector(state => state.persistedToBrowserStorage.launcherState);\n  const [isStartingBounceAnimation, setIsStartingBounceAnimation] = useState(false);\n  const prevIsExtended = usePrevious(isExtended);\n  const prevWasReduced = usePrevious(wasReduced);\n  const initialBounceTurn = useRef(bounceTurn).current;\n  const previouslyPlayedExtendAnimation = useRef(wasReduced).current;\n  const extendLauncherTimeoutIDRef = useRef(null);\n  const reduceLauncherTimeoutIDRef = useRef(null);\n  const endBounceAnimationRef = useRef(null);\n  const shouldBounceRef = useRef(previouslyPlayedExtendAnimation && !disableBounce);\n  const {time_to_expand: time_to_expand, new_expand_time: new_expand_time, time_to_reduce: time_to_reduce} = launcherConfig.mobile;\n  const isExpandedLauncherEnabled = launcherConfig.mobile.is_on;\n  const playExtendAnimation = prevIsExtended === undefined && !isExtended;\n  const isExtending = prevIsExtended !== undefined && !prevIsExtended && isExtended;\n  const hasReduced = prevWasReduced !== undefined && !prevWasReduced && wasReduced;\n  const disableIntroAnimation = isExtending || hasReduced || isStartingBounceAnimation;\n  const setLauncherStateAsReduced = useCallback(() => {\n    if (!wasReduced) {\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherWasReduced\", true));\n    }\n  }, [ wasReduced, serviceManager ]);\n  const reduceLauncher = useCallback(() => {\n    clearTimeouts();\n    if (isExtended) {\n      document.removeEventListener(\"scroll\", reduceLauncher);\n      serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherIsExtended\", false));\n    }\n  }, [ isExtended, serviceManager ]);\n  const setExpandAnimationTimeout = useCallback(() => {\n    extendLauncherTimeoutIDRef.current = setTimeout(() => {\n      if (!isExtended && !isExtending) {\n        serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherWasReduced\", false));\n        serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherIsExtended\", true));\n      }\n    }, time_to_expand);\n  }, [ isExtended, isExtending, serviceManager.store, time_to_expand ]);\n  const setDefaultLauncherState = useCallback(() => {\n    const endBounceAnimation = endBounceAnimationRef.current;\n    if (endBounceAnimation) {\n      endBounceAnimation();\n      endBounceAnimationRef.current = null;\n    }\n    serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherDisableBounce\", true));\n    reduceLauncher();\n    setLauncherStateAsReduced();\n  }, [ reduceLauncher, serviceManager.store, setLauncherStateAsReduced ]);\n  useOnMount(() => {\n    if (!wasReduced && playExtendAnimation && isExpandedLauncherEnabled) {\n      setExpandAnimationTimeout();\n    } else if (shouldBounceRef.current) {\n      const launcherContainerElement = launcherRef?.current?.launcherContainerElement();\n      if (launcherContainerElement) {\n        const startRecurringBounceAnimation = () => {\n          if (shouldBounceRef.current) {\n            let turnCounter = initialBounceTurn;\n            launcherContainerElement.removeEventListener(\"animationend\", startRecurringBounceAnimation);\n            setIsStartingBounceAnimation(true);\n            endBounceAnimationRef.current = setAnimationTimeouts(launcherContainerElement, \"WACLauncher__ButtonContainer--bounceAnimation\", BOUNCING_ANIMATION_TIMEOUTS, {\n              startingIndex: initialBounceTurn - 1,\n              afterEach: () => {\n                turnCounter++;\n                serviceManager.store.dispatch(actions.setLauncherProperty(\"bounceTurn\", turnCounter));\n              },\n              afterAll: () => {\n                serviceManager.store.dispatch(actions.setLauncherProperty(\"mobileLauncherDisableBounce\", true));\n              }\n            });\n          }\n        };\n        launcherContainerElement.addEventListener(\"animationend\", startRecurringBounceAnimation);\n      }\n    }\n  });\n  useEffect(() => {\n    if (viewState.mainWindow || viewState.tour) {\n      setDefaultLauncherState();\n    }\n  }, [ viewState, setDefaultLauncherState ]);\n  useEffect(() => {\n    if (new_expand_time) {\n      if (shouldBounceRef.current) {\n        shouldBounceRef.current = false;\n      }\n      const endBounceAnimation = endBounceAnimationRef.current;\n      if (endBounceAnimation) {\n        endBounceAnimation();\n        endBounceAnimationRef.current = null;\n      }\n      if (extendLauncherTimeoutIDRef.current) {\n        clearTimeout(extendLauncherTimeoutIDRef.current);\n      }\n      setExpandAnimationTimeout();\n      serviceManager.store.dispatch(actions.setLauncherConfigProperty(\"new_expand_time\", false, LauncherType.MOBILE));\n    }\n  }, [ setExpandAnimationTimeout, new_expand_time, serviceManager.store, shouldBounceRef ]);\n  function clearTimeouts() {\n    const extendLauncherTimeoutID = extendLauncherTimeoutIDRef.current;\n    const reduceLauncherTimeoutID = reduceLauncherTimeoutIDRef.current;\n    if (reduceLauncherTimeoutID) {\n      clearTimeout(reduceLauncherTimeoutID);\n      reduceLauncherTimeoutIDRef.current = null;\n    }\n    if (extendLauncherTimeoutID) {\n      clearTimeout(extendLauncherTimeoutID);\n      extendLauncherTimeoutIDRef.current = null;\n    }\n  }\n  const handleToggleOpen = useCallback(() => {\n    setDefaultLauncherState();\n    onToggleOpen();\n  }, [ onToggleOpen, setDefaultLauncherState ]);\n  const handleSwipeRight = useCallback(() => {\n    reduceLauncher();\n  }, [ reduceLauncher ]);\n  useEffect(() => {\n    if (isExtended) {\n      reduceLauncherTimeoutIDRef.current = setTimeout(() => {\n        reduceLauncher();\n      }, time_to_reduce);\n      document.addEventListener(\"scroll\", reduceLauncher);\n    }\n  }, [ isExtended, reduceLauncher, time_to_reduce, serviceManager ]);\n  return React.createElement(LauncherExtendedExport, {\n    className: cx({\n      \"WACLauncher__ButtonContainer--noAnimation\": disableIntroAnimation\n    }),\n    ref: launcherRef,\n    launcherConfig: launcherConfig,\n    showUnreadIndicator: showUnreadIndicator,\n    unreadAgentCount: unreadAgentCount,\n    isExtended: isExtended,\n    playExtendAnimation: playExtendAnimation,\n    onToggleOpen: handleToggleOpen,\n    onSwipeRight: handleSwipeRight,\n    onReduceEnd: setLauncherStateAsReduced,\n    launcherHidden: launcherHidden,\n    activeTour: activeTour\n  });\n}\n\nexport { LauncherMobileContainer };\n","import React, { useRef, useCallback } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { useEffectDidUpdate } from \"../../hooks/useEffectDidUpdate.js\";\n\nimport { useServiceManager } from \"../../hooks/useServiceManager.js\";\n\nimport \"../../../../types/state/AppState.js\";\n\nimport { IS_PHONE } from \"../../utils/browserUtils.js\";\n\nimport { LauncherDesktopContainer } from \"./LauncherDesktopContainer.js\";\n\nimport { LauncherMobileContainer } from \"./LauncherMobileContainer.js\";\n\nimport { ViewChangeReason, MainWindowOpenReason } from \"../../../../types/events/eventBusTypes.js\";\n\nimport { ViewType } from \"../../../../types/instance/apiTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function LauncherContainer() {\n  const serviceManager = useServiceManager();\n  const launcherRef = useRef();\n  const viewState = useSelector(state => state.persistedToBrowserStorage.launcherState.viewState);\n  const initialViewChangeComplete = useSelector(state => state.initialViewChangeComplete);\n  const launcherHidden = !viewState.launcher;\n  const activeTour = useSelector(state => state.persistedToBrowserStorage.launcherState.activeTour);\n  const requestFocus = useCallback(() => {\n    launcherRef.current?.requestFocus();\n  }, [ launcherRef ]);\n  const onDoToggle = useCallback(() => {\n    if (activeTour) {\n      return serviceManager.actions.changeView(ViewType.TOUR, {\n        viewChangeReason: ViewChangeReason.LAUNCHER_CLICKED\n      });\n    }\n    return serviceManager.actions.changeView(ViewType.MAIN_WINDOW, {\n      mainWindowOpenReason: MainWindowOpenReason.DEFAULT_LAUNCHER\n    });\n  }, [ activeTour, serviceManager.actions ]);\n  useEffectDidUpdate(() => {\n    if (viewState.launcher && !viewState.mainWindow && !viewState.tour && initialViewChangeComplete) {\n      launcherRef.current?.requestFocus();\n    }\n  }, [ viewState ]);\n  let launcherContainer;\n  if (IS_PHONE) {\n    launcherContainer = React.createElement(LauncherMobileContainer, {\n      launcherRef: launcherRef,\n      onToggleOpen: onDoToggle,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour\n    });\n  } else {\n    launcherContainer = React.createElement(LauncherDesktopContainer, {\n      launcherRef: launcherRef,\n      onDoToggle: onDoToggle,\n      requestFocus: requestFocus,\n      launcherHidden: launcherHidden,\n      activeTour: activeTour\n    });\n  }\n  return launcherContainer;\n}\n\nexport { LauncherContainer };\n","import { useRef, useEffect } from \"react\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function useEffectDidUpdate(effect, deps) {\n  const hasRunRef = useRef(false);\n  useEffect(() => {\n    if (hasRunRef.current) {\n      return effect();\n    }\n    hasRunRef.current = true;\n    return undefined;\n  }, deps);\n}\n\nexport { useEffectDidUpdate };\n","import { Loading } from \"@carbon/react\";\n\nimport cx from \"classnames\";\n\nimport React, { useContext } from \"react\";\n\nimport { HideComponentContext } from \"../contexts/HideComponentContext.js\";\n\nimport { BotHeader as BotHeaderExport } from \"./header/BotHeader.js\";\n\nimport { HomeScreenHeader as HomeScreenHeaderExport } from \"./homeScreen/HomeScreenHeader.js\";\n\nimport { AnnounceOnMountComponent as AnnounceOnMountComponentExport } from \"./util/AnnounceOnMountComponent.js\";\n\nimport { MountChildrenOnDelay } from \"./util/MountChildrenOnDelay.js\";\n\nimport { OverlayPanelName } from \"./OverlayPanel.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function HydrationPanel({onClose: onClose, languagePack: languagePack, isHydrated: isHydrated, headerDisplayName: headerDisplayName, useHomeScreenVersion: useHomeScreenVersion}) {\n  const isHidden = useContext(HideComponentContext);\n  let header;\n  if (useHomeScreenVersion) {\n    header = React.createElement(HomeScreenHeaderExport, {\n      onClose: onClose\n    });\n  } else {\n    header = React.createElement(BotHeaderExport, {\n      onClose: onClose,\n      headerDisplayName: headerDisplayName,\n      onToggleHomeScreen: null,\n      includeWriteableElement: false,\n      testIdPrefix: OverlayPanelName.HYDRATING\n    });\n  }\n  return React.createElement(\"div\", {\n    className: \"WAC WAC__hydratingContainer\"\n  }, header, React.createElement(\"div\", {\n    className: cx(\"WAC__hydrating\", \"WACPanelContent\", {\n      \"WAC__hydrating--homeScreen\": useHomeScreenVersion\n    })\n  }, !isHidden && React.createElement(MountChildrenOnDelay, {\n    delay: 400\n  }, !isHydrated && React.createElement(AnnounceOnMountComponentExport, {\n    announceOnce: languagePack.window_ariaWindowLoading\n  }), React.createElement(Loading, {\n    withOverlay: false,\n    \"aria-label\": languagePack.window_ariaWindowLoading\n  }))));\n}\n\nexport { HydrationPanel };\n","import React, { useEffect, useCallback } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { BusEventType } from \"../../../../types/events/eventBusTypes.js\";\n\nimport { useAriaAnnouncer } from \"../../hooks/useAriaAnnouncer.js\";\n\nimport { useLanguagePack } from \"../../hooks/useLanguagePack.js\";\n\nimport { usePrevious } from \"../../hooks/usePrevious.js\";\n\nimport { useServiceManager } from \"../../hooks/useServiceManager.js\";\n\nimport actions from \"../../store/actions.js\";\n\nimport { DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS } from \"../../store/reducerUtils.js\";\n\nimport { AnimationInType, AnimationOutType } from \"../../../../types/utilities/Animation.js\";\n\nimport { consoleError } from \"../../utils/miscUtils.js\";\n\nimport { BasePanelComponent as BasePanelComponentExport } from \"../BasePanelComponent.js\";\n\nimport { OverlayPanel, OverlayPanelName } from \"../OverlayPanel.js\";\n\nimport WriteableElement from \"../WriteableElement.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function CustomPanel(props) {\n  const {useAITheme: useAITheme, onPanelOpenEnd: onPanelOpenEnd, onPanelCloseEnd: onPanelCloseEnd, onPanelOpenStart: onPanelOpenStart, onPanelCloseStart: onPanelCloseStart, onClose: onClose, onCloseAndRestart: onCloseAndRestart, onClickRestart: onClickRestart} = props;\n  const languagePack = useLanguagePack();\n  const {isOpen: isOpen, options: options} = useSelector(state => state.customPanelState);\n  const {title: title, hidePanelHeader: hidePanelHeader, disableDefaultCloseAction: disableDefaultCloseAction, disableAnimation: disableAnimation, onClickBack: onClickBack, onClickClose: onClickClose, onClickCloseAndRestart: onClickCloseAndRestart} = options;\n  const serviceManager = useServiceManager();\n  const ariaAnnouncer = useAriaAnnouncer();\n  const prevIsOpen = usePrevious(isOpen);\n  const openAnimation = disableAnimation ? AnimationInType.NONE : AnimationInType.SLIDE_IN_FROM_BOTTOM;\n  const closeAnimation = disableAnimation ? AnimationOutType.NONE : AnimationOutType.SLIDE_OUT_TO_BOTTOM;\n  useEffect(() => {\n    if (prevIsOpen !== isOpen && isOpen) {\n      if (!hidePanelHeader && title) {\n        ariaAnnouncer(title);\n      }\n    }\n  }, [ ariaAnnouncer, hidePanelHeader, isOpen, prevIsOpen, title ]);\n  const onClickBackLocal = useCallback(() => {\n    serviceManager.store.dispatch(actions.setCustomPanelOpen(false));\n    onClickBack?.();\n  }, [ serviceManager, onClickBack ]);\n  const onClickCloseLocal = useCallback(() => {\n    if (!disableDefaultCloseAction) {\n      checkAllowClose(serviceManager.store.getState().viewChanging);\n      onClose();\n    }\n    onClickClose?.();\n  }, [ disableDefaultCloseAction, onClickClose, onClose, serviceManager ]);\n  const onCloseAndRestartLocal = useCallback(() => {\n    if (!disableDefaultCloseAction) {\n      checkAllowClose(serviceManager.store.getState().viewChanging);\n      onCloseAndRestart();\n    }\n    onClickCloseAndRestart?.();\n  }, [ disableDefaultCloseAction, onClickCloseAndRestart, onCloseAndRestart, serviceManager ]);\n  return React.createElement(OverlayPanel, {\n    className: \"WAC__overlay--covering\",\n    onOpenStart: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_PRE_OPEN\n      }, serviceManager.instance);\n      onPanelOpenStart();\n    },\n    onOpenEnd: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_OPEN\n      }, serviceManager.instance);\n      onPanelOpenEnd();\n    },\n    onCloseStart: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_PRE_CLOSE\n      }, serviceManager.instance);\n      onPanelCloseStart();\n    },\n    onCloseEnd: () => {\n      serviceManager.eventBus.fire({\n        type: BusEventType.CUSTOM_PANEL_CLOSE\n      }, serviceManager.instance);\n      onPanelCloseEnd();\n      serviceManager.store.dispatch(actions.setCustomPanelConfigOptions(DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS));\n    },\n    animationOnOpen: openAnimation,\n    animationOnClose: closeAnimation,\n    shouldOpen: isOpen,\n    serviceManager: serviceManager,\n    overlayPanelName: OverlayPanelName.CUSTOM\n  }, React.createElement(BasePanelComponentExport, {\n    className: \"WACCustomPanel\",\n    eventName: \"Custom panel opened\",\n    eventDescription: \"A user opened a custom panel.\",\n    labelBackButton: languagePack.general_returnToAssistant,\n    isOpen: isOpen,\n    title: title,\n    useAITheme: useAITheme,\n    onClickBack: onClickBackLocal,\n    onClickClose: onClickCloseLocal,\n    onClickCloseAndRestart: onCloseAndRestartLocal,\n    onClickRestart: onClickRestart,\n    hidePanelHeader: hidePanelHeader,\n    hideBackButton: options.hideBackButton,\n    hideCloseButton: options.hideCloseButton,\n    hideCloseAndRestartButton: options.hideCloseAndRestartButton,\n    testIdPrefix: OverlayPanelName.CUSTOM\n  }, React.createElement(WriteableElement, {\n    slotName: \"customPanelElement\",\n    className: \"WACCustomPanel__ContentContainer\"\n  })));\n}\n\nfunction checkAllowClose(viewChanging) {\n  if (viewChanging) {\n    const message = \"You are attempting to close Carbon AI chat from a custom panel while Carbon AI chat is currently running a view\" + \" change event which is not permitted. Please use the disableDefaultCloseAction option to disable\" + \" this behavior for the custom panel and then use onClickClose to resolve your Promise that is handling\" + \" the event; that Promise will allow you to close Carbon AI chat.\";\n    consoleError(message);\n    throw new Error(message);\n  }\n}\n\nconst CustomPanelExport = React.memo(CustomPanel);\n\nexport { CustomPanelExport as CustomPanel };\n","import \"intl-pluralrules\";\n\nimport cx from \"classnames\";\n\nimport FocusTrap from \"focus-trap-react\";\n\nimport React, { Component, Suspense } from \"react\";\n\nimport { connect } from \"react-redux\";\n\nimport { HydrationPanel } from \"../../components/HydrationPanel.js\";\n\nimport { OverlayPanel, OverlayPanelName } from \"../../components/OverlayPanel.js\";\n\nimport { CustomPanel as CustomPanelExport } from \"../../components/panels/CustomPanel.js\";\n\nimport { HideComponent } from \"../../components/util/HideComponent.js\";\n\nimport VisuallyHidden from \"../../components/util/VisuallyHidden.js\";\n\nimport { ModalPortalRootContext } from \"../../contexts/ModalPortalRootContext.js\";\n\nimport actions from \"../../store/actions.js\";\n\nimport { selectIsInputToAgent, selectInputState, selectAgentDisplayState } from \"../../store/selectors.js\";\n\nimport { AnimationOutType, AnimationInType } from \"../../../../types/utilities/Animation.js\";\n\nimport { ChatWidthBreakpoint } from \"../../../../types/state/AppState.js\";\n\nimport { addClassNameToState, removeClassNameFromState } from \"../../../../types/utilities/HasAddRemoveClassName.js\";\n\nimport { IS_MOBILE, IS_IOS } from \"../../utils/browserUtils.js\";\n\nimport \"../../utils/constants.js\";\n\nimport { doFocusRef, SCROLLBAR_WIDTH } from \"../../utils/domUtils.js\";\n\nimport { arrayLastValue } from \"../../utils/lang/arrayUtils.js\";\n\nimport { createMessageRequestForText, createMessageRequestForChoice } from \"../../utils/messageUtils.js\";\n\nimport { consoleError, createDidCatchErrorData } from \"../../utils/miscUtils.js\";\n\nimport { MessageSendSource, MainWindowCloseReason } from \"../../../../types/events/eventBusTypes.js\";\n\nimport { lazyChat, lazyCatastrophicError, lazyDisclaimer, lazyHomeScreenContainer, lazyIFramePanel, lazyViewSourcePanel, lazyBodyAndFooterPanelComponent } from \"../../../dynamic-imports/dynamic-imports.js\";\n\nimport { ViewType } from \"../../../../types/instance/apiTypes.js\";\n\nimport { CornersType } from \"../../../../types/config/CornersType.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const Chat = lazyChat();\n\nconst CatastrophicError = lazyCatastrophicError();\n\nconst Disclaimer = lazyDisclaimer();\n\nconst HomeScreenContainer = lazyHomeScreenContainer();\n\nconst IFramePanel = lazyIFramePanel();\n\nconst ViewSourcePanel = lazyViewSourcePanel();\n\nconst BodyAndFooterPanelComponent = lazyBodyAndFooterPanelComponent();\n\nconst WIDTH_BREAKPOINT_STANDARD = \"WAC--standardWidth\";\n\nconst WIDTH_BREAKPOINT_NARROW = \"WAC--narrowWidth\";\n\nconst WIDTH_BREAKPOINT_WIDE = \"WAC--wideWidth\";\n\nclass MainWindow extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      closing: false,\n      open: this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow,\n      modalPortalHostElement: null,\n      numPanelsOpen: 0,\n      numPanelsAnimating: 0,\n      numPanelsCovering: 0,\n      isHydrationAnimationComplete: this.props.isHydrated,\n      shouldAutoFocus: this.props.config.public.shouldTakeFocusIfOpensAutomatically,\n      extraClassNames: [],\n      areModulesLoaded: false\n    };\n    this.mainWindowRef = React.createRef();\n    this.containerRef = React.createRef();\n    this.botChatRef = React.createRef();\n    this.homeScreenInputRef = React.createRef();\n    this.disclaimerRef = React.createRef();\n    this.brandingRef = React.createRef();\n    this.animationContainerRef = React.createRef();\n    this.iframePanelRef = React.createRef();\n    this.viewSourcePanelRef = React.createRef();\n    this.previousBodyVisibility = undefined;\n    this.previousBodyPosition = undefined;\n    this.onResize = () => {\n      let appChatWidthBreakpoint;\n      const height = this.containerRef?.current?.offsetHeight;\n      const width = this.containerRef?.current?.offsetWidth;\n      if (width >= 672 + 16 + 16) {\n        appChatWidthBreakpoint = ChatWidthBreakpoint.WIDE;\n      } else if (width >= 360) {\n        appChatWidthBreakpoint = ChatWidthBreakpoint.STANDARD;\n      } else {\n        appChatWidthBreakpoint = ChatWidthBreakpoint.NARROW;\n      }\n      this.props.serviceManager.store.dispatch(actions.setAppStateValue(\"chatWidth\", width));\n      this.props.serviceManager.store.dispatch(actions.setAppStateValue(\"chatHeight\", height));\n      this.props.serviceManager.store.dispatch(actions.setAppStateValue(\"chatWidthBreakpoint\", appChatWidthBreakpoint));\n    };\n    this.onVisualViewportResize = () => {\n      this.updateFromVisualViewport();\n    };\n    this.updateFromVisualViewport = () => {\n      const element = this.props.serviceManager.container;\n      const {visualViewport: visualViewport} = window;\n      if (visualViewport) {\n        element.style.setProperty(\"--cds-chat-viewport-height\", `${visualViewport.height}px`);\n        element.style.setProperty(\"--cds-chat-viewport-width\", `${visualViewport.width}px`);\n        element.style.setProperty(\"--cds-chat-viewport-offsetTop\", `${visualViewport.offsetTop}px`);\n        element.style.setProperty(\"--cds-chat-viewport-offsetLeft\", `${visualViewport.offsetLeft}px`);\n      } else {\n        const height = \"100vh\";\n        element.style.setProperty(\"--cds-chat-viewport-height\", height);\n        element.style.setProperty(\"--cds-chat-viewport-width\", \"100vw\");\n        element.style.setProperty(\"--cds-chat-viewport-offsetTop\", \"0\");\n        element.style.setProperty(\"--cds-chat-viewport-offsetLeft\", \"0\");\n      }\n    };\n    this.setModalPortalHostElement = ref => {\n      if (this.state.modalPortalHostElement !== ref) {\n        this.setState({\n          modalPortalHostElement: ref\n        });\n      }\n    };\n    this.onSendInput = async (text, source, options) => {\n      const isInputToAgent = selectIsInputToAgent(this.props);\n      const {serviceManager: serviceManager} = this.props;\n      const state = serviceManager.store.getState();\n      const {files: files} = selectInputState(state);\n      if (isInputToAgent) {\n        serviceManager.humanAgentService.sendMessageToAgent(text, files);\n      } else {\n        const messageRequest = createMessageRequestForText(text);\n        serviceManager.actions.sendWithCatch(messageRequest, source, {\n          ...options\n        });\n      }\n      if (files.length) {\n        serviceManager.store.dispatch(actions.clearInputFiles(isInputToAgent));\n      }\n    };\n    this.onSendHomeButtonInput = input => {\n      const messageRequest = createMessageRequestForChoice(input);\n      this.props.serviceManager.actions.sendWithCatch(messageRequest, MessageSendSource.HOME_SCREEN_STARTER);\n    };\n    this.removeChatFromDom = () => {\n      this.containerRef.current.removeEventListener(\"animationend\", this.removeChatFromDom);\n      this.setState({\n        open: false,\n        closing: false\n      });\n    };\n    this.onRestart = async () => {\n      await this.props.serviceManager.actions.restartConversation();\n      this.requestFocus();\n    };\n    this.onClose = async () => this.doClose(false);\n    this.onCloseAndRestart = async () => this.doClose(true);\n    this.onToggleHomeScreen = () => {\n      this.props.serviceManager.store.dispatch(actions.toggleHomeScreen());\n    };\n    this.requestFocus = () => {\n      try {\n        if (this.state.shouldAutoFocus && !IS_MOBILE) {\n          if (this.getShowDisclaimer()) {\n            if (this.disclaimerRef.current) {\n              doFocusRef(this.disclaimerRef);\n            }\n          } else if (this.getShowHomeScreen()) {\n            if (this.homeScreenInputRef.current) {\n              this.homeScreenInputRef.current.takeFocus();\n            }\n          } else if (this.props.iFramePanelState.isOpen) {\n            if (this.iframePanelRef.current) {\n              this.iframePanelRef.current.requestFocus();\n            }\n          } else if (this.botChatRef.current) {\n            this.botChatRef.current.requestInputFocus();\n          }\n        }\n      } catch (error) {\n        consoleError(\"An error occurred in MainWindow.requestFocus\", error);\n      }\n    };\n    this.onUserTyping = isTyping => {\n      if (this.props.serviceManager.store.getState().persistedToBrowserStorage.chatState.agentState.isConnected) {\n        this.props.serviceManager.humanAgentService.userTyping(isTyping);\n      }\n    };\n    this.onAcceptDisclaimer = () => {\n      this.props.serviceManager.store.dispatch(actions.acceptDisclaimer());\n    };\n    this.onPanelOpenStart = coverBackground => {\n      this.setState(prevState => ({\n        numPanelsOpen: prevState.numPanelsOpen + 1,\n        numPanelsAnimating: prevState.numPanelsAnimating + 1,\n        numPanelsCovering: prevState.numPanelsCovering + (coverBackground ? 1 : 0)\n      }), this.requestFocus);\n    };\n    this.onPanelOpenEnd = () => {\n      this.setState(prevState => ({\n        numPanelsAnimating: prevState.numPanelsAnimating - 1\n      }));\n    };\n    this.onPanelCloseStart = () => {\n      this.setState(prevState => ({\n        numPanelsAnimating: prevState.numPanelsAnimating + 1\n      }), this.requestFocus);\n    };\n    this.onPanelCloseEnd = coverBackground => {\n      this.setState(prevState => ({\n        numPanelsOpen: prevState.numPanelsOpen - 1,\n        numPanelsAnimating: prevState.numPanelsAnimating - 1,\n        numPanelsCovering: prevState.numPanelsCovering - (coverBackground ? 1 : 0)\n      }));\n    };\n    this.onHydrationPanelClose = () => {\n      this.setState({\n        isHydrationAnimationComplete: true\n      }, this.requestFocus);\n    };\n  }\n  componentDidMount() {\n    const {persistedToBrowserStorage: persistedToBrowserStorage, config: config, serviceManager: serviceManager, mainWindowRef: mainWindowRef} = this.props;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    const {public: publicConfig} = config;\n    serviceManager.mainWindow = this;\n    mainWindowRef.current = this;\n    this.mainWindowObserver = new ResizeObserver(this.onResize);\n    this.mainWindowObserver.observe(this.containerRef.current);\n    if (IS_MOBILE && !publicConfig.disableCustomElementMobileEnhancements) {\n      const {visualViewport: visualViewport} = window;\n      if (visualViewport) {\n        visualViewport.addEventListener(\"resize\", this.onVisualViewportResize);\n        visualViewport.addEventListener(\"scroll\", this.updateFromVisualViewport);\n      }\n      this.updateFromVisualViewport();\n      this.updateBody(false);\n    }\n    this.containerRef.current.style.setProperty(\"--cds-chat-scrollbar-width\", `${SCROLLBAR_WIDTH()}px`);\n    if (viewState.mainWindow) {\n      this.loadPanels();\n    }\n  }\n  componentWillUnmount() {\n    this.mainWindowObserver.unobserve(this.containerRef.current);\n  }\n  destroy() {\n    if (IS_MOBILE && !this.props.config.public.disableCustomElementMobileEnhancements) {\n      const {visualViewport: visualViewport} = window;\n      if (visualViewport) {\n        visualViewport.removeEventListener(\"resize\", this.onVisualViewportResize);\n        visualViewport.removeEventListener(\"scroll\", this.updateFromVisualViewport);\n      }\n    }\n    this.updateBody(true);\n  }\n  componentDidUpdate(oldProps, oldState) {\n    const newProps = this.props;\n    const newState = this.state;\n    const {persistedToBrowserStorage: persistedToBrowserStorage, useCustomHostElement: useCustomHostElement, isDestroyed: isDestroyed} = newProps;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    const {open: open} = newState;\n    const prevViewState = oldProps.persistedToBrowserStorage.launcherState.viewState;\n    if (viewState.mainWindow !== prevViewState.mainWindow) {\n      this.updateBody(false);\n      this.updateFromVisualViewport();\n    }\n    if (isDestroyed && !oldProps.isDestroyed) {\n      this.destroy();\n    }\n    if ((oldState.areModulesLoaded !== newState.areModulesLoaded || oldProps.isHydrated !== newProps.isHydrated) && newProps.isHydrated && newState.areModulesLoaded) {\n      this.setState({\n        isHydrationAnimationComplete: true\n      }, () => {\n        requestAnimationFrame(() => {\n          this.requestFocus();\n        });\n      });\n    }\n    if (viewState.mainWindow && (!prevViewState.mainWindow || !open)) {\n      this.setState({\n        open: true\n      }, () => {\n        this.requestFocus();\n      });\n      this.loadPanels();\n    } else if (!viewState.mainWindow && prevViewState.mainWindow && oldState.open && open) {\n      this.setState({\n        closing: true\n      });\n      if (useCustomHostElement) {\n        this.removeChatFromDom();\n      } else {\n        this.containerRef.current.addEventListener(\"animationend\", this.removeChatFromDom);\n        this.requestFocus();\n      }\n    }\n    if (newProps.config.public.shouldTakeFocusIfOpensAutomatically) {\n      if (!oldProps.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage && newProps.persistedToBrowserStorage.chatState.hasSentNonWelcomeMessage && !this.state.shouldAutoFocus) {\n        this.setState({\n          shouldAutoFocus: true\n        });\n      } else if (oldProps.botMessageState.localMessageIDs.length > newProps.botMessageState.localMessageIDs.length && this.state.shouldAutoFocus) {\n        this.setState({\n          shouldAutoFocus: false\n        });\n      } else if (oldProps.botMessageState.localMessageIDs.length < newProps.botMessageState.localMessageIDs.length && !this.state.shouldAutoFocus) {\n        this.setState({\n          shouldAutoFocus: true\n        });\n      }\n    }\n    const newLastItemID = arrayLastValue(newProps.botMessageState.localMessageIDs);\n    const oldLastItemID = arrayLastValue(oldProps.botMessageState.localMessageIDs);\n    if (newLastItemID !== oldLastItemID && newState.shouldAutoFocus) {\n      const lastMessageItem = newProps.allMessageItemsByID[newLastItemID];\n      const lastMessage = newProps.allMessagesByID[lastMessageItem?.fullMessageID];\n      if (!lastMessage?.history?.from_history) {\n        this.requestFocus();\n      }\n    }\n  }\n  componentDidCatch(error, errorInfo) {\n    this.props.serviceManager.actions.errorOccurred(createDidCatchErrorData(\"MainWindow\", error, errorInfo, true));\n  }\n  loadPanels() {\n    Promise.all([ Chat.preload(), CatastrophicError.preload(), Disclaimer.preload(), HomeScreenContainer.preload(), IFramePanel.preload(), ViewSourcePanel.preload(), BodyAndFooterPanelComponent.preload() ]).then(() => {\n      this.setState({\n        areModulesLoaded: true\n      });\n    });\n  }\n  updateBody(unmounting) {\n    if (IS_IOS && !this.props.config.public.disableCustomElementMobileEnhancements) {\n      if ((window.screen.width <= 500 || window.screen.height <= 500) && this.props.persistedToBrowserStorage.launcherState.viewState.mainWindow && !unmounting) {\n        this.previousBodyVisibility = document.body.style.getPropertyValue(\"visibility\");\n        this.previousBodyPosition = document.body.style.getPropertyValue(\"position\");\n        document.body.style.setProperty(\"visibility\", \"hidden\", \"important\");\n        document.body.style.setProperty(\"position\", \"fixed\", \"important\");\n      } else {\n        document.body.style.setProperty(\"visibility\", this.previousBodyVisibility);\n        document.body.style.setProperty(\"position\", this.previousBodyPosition);\n      }\n    }\n  }\n  async doClose(fromCloseAndRestart) {\n    const {serviceManager: serviceManager} = this.props;\n    const {activeTour: activeTour} = serviceManager.store.getState().persistedToBrowserStorage.launcherState;\n    if (fromCloseAndRestart) {\n      const newViewState = await serviceManager.actions.changeView(ViewType.LAUNCHER, {\n        mainWindowCloseReason: MainWindowCloseReason.MAIN_WINDOW_CLOSED_AND_RESTARTED\n      });\n      if (!newViewState.mainWindow) {\n        await serviceManager.actions.restartConversation();\n      }\n    } else {\n      await serviceManager.actions.changeView(activeTour ? ViewType.TOUR : ViewType.LAUNCHER, {\n        mainWindowCloseReason: MainWindowCloseReason.DEFAULT_MINIMIZE\n      });\n    }\n  }\n  getShowHomeScreen() {\n    return this.props.homeScreenConfig.is_on && this.props.persistedToBrowserStorage.chatState.homeScreenState.isHomeScreenOpen && !this.getShowDisclaimer();\n  }\n  getShowDisclaimer() {\n    return this.props.config.public.disclaimer?.is_on && !this.props.persistedToBrowserStorage.chatState.disclaimersAccepted[window.location.hostname];\n  }\n  doAutoScroll(options) {\n    this.botChatRef?.current?.doAutoScroll(options);\n  }\n  getMessagesScrollBottom() {\n    return this.botChatRef?.current?.getMessagesScrollBottom();\n  }\n  doScrollToMessage(messageID, animate = true) {\n    this.botChatRef.current?.doScrollToMessage(messageID, animate);\n  }\n  getMessageInput() {\n    return this.botChatRef.current?.getMessageInput();\n  }\n  getHomeScreenInput() {\n    return this.homeScreenInputRef.current?.getMessageInput();\n  }\n  addClassName(name) {\n    this.setState(addClassNameToState(name));\n  }\n  removeClassName(name) {\n    this.setState(removeClassNameFromState(name));\n  }\n  renderChat() {\n    const {isHydrated: isHydrated, config: config, chatWidthBreakpoint: chatWidthBreakpoint} = this.props;\n    const {areModulesLoaded: areModulesLoaded} = this.state;\n    const showCovering = this.state.numPanelsCovering > 0 && config.public.layout?.hasContentMaxWidth && chatWidthBreakpoint === ChatWidthBreakpoint.WIDE;\n    return React.createElement(\"div\", {\n      className: \"WACWidget--content\"\n    }, this.renderCustomPanel(), this.renderHydrationPanel(), isHydrated && areModulesLoaded && React.createElement(React.Fragment, null, this.renderDisclaimerPanel(), this.renderResponsePanel(), this.renderHomeScreenPanel(), this.renderIFramePanel(), this.renderViewSourcePanel(), showCovering && React.createElement(\"div\", {\n      className: \"WACBackgroundCover\"\n    }), this.renderBotChat()));\n  }\n  renderBotChat() {\n    const {botName: botName, languagePack: languagePack, config: config, serviceManager: serviceManager, botMessageState: botMessageState, agentState: agentState, allMessageItemsByID: allMessageItemsByID, isHydrated: isHydrated, locale: locale, theme: theme, headerDisplayName: headerDisplayName, headerAvatarConfig: headerAvatar} = this.props;\n    const {numPanelsAnimating: numPanelsAnimating, numPanelsOpen: numPanelsOpen, isHydrationAnimationComplete: isHydrationAnimationComplete} = this.state;\n    const inputState = selectInputState(this.props);\n    const agentDisplayState = selectAgentDisplayState(this.props);\n    const showDisclaimer = this.getShowDisclaimer();\n    let hideBotContainer;\n    if (!isHydrationAnimationComplete) {\n      hideBotContainer = true;\n    } else if (numPanelsAnimating > 0) {\n      hideBotContainer = false;\n    } else if (numPanelsOpen > 0) {\n      hideBotContainer = true;\n    }\n    return React.createElement(HideComponent, {\n      className: \"WACBotContainer\",\n      hidden: hideBotContainer\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(Chat, {\n      botName: botName,\n      headerDisplayName: headerDisplayName,\n      headerAvatarConfig: headerAvatar,\n      ref: this.botChatRef,\n      languagePack: languagePack,\n      config: config,\n      serviceManager: serviceManager,\n      onClose: this.onClose,\n      onCloseAndRestart: this.onCloseAndRestart,\n      messageState: botMessageState,\n      onSendInput: text => this.onSendInput(text, MessageSendSource.MESSAGE_INPUT),\n      agentState: agentState,\n      agentDisplayState: agentDisplayState,\n      allMessageItemsByID: allMessageItemsByID,\n      onRestart: this.onRestart,\n      isHydrated: isHydrated,\n      isHydrationAnimationComplete: isHydrationAnimationComplete && !showDisclaimer,\n      inputState: inputState,\n      onToggleHomeScreen: this.onToggleHomeScreen,\n      onUserTyping: this.onUserTyping,\n      locale: locale,\n      useAITheme: theme.useAITheme,\n      carbonTheme: theme.carbonTheme\n    })));\n  }\n  renderInnerHydrationPanel() {\n    const {botMessageState: botMessageState, serviceManager: serviceManager, languagePack: languagePack, headerDisplayName: headerDisplayName, persistedToBrowserStorage: persistedToBrowserStorage, homeScreenConfig: homeScreenConfig} = this.props;\n    const {areModulesLoaded: areModulesLoaded} = this.state;\n    const useHomeScreenVersion = homeScreenConfig.is_on && !persistedToBrowserStorage.launcherState.hasSentNonWelcomeMessage;\n    return React.createElement(HydrationPanel, {\n      headerDisplayName: headerDisplayName,\n      isHydrated: botMessageState.isHydratingCounter === 0 && areModulesLoaded,\n      serviceManager: serviceManager,\n      onClose: this.onClose,\n      languagePack: languagePack,\n      useHomeScreenVersion: useHomeScreenVersion\n    });\n  }\n  renderHydrationPanel() {\n    const {botMessageState: botMessageState, serviceManager: serviceManager, catastrophicErrorType: catastrophicErrorType, persistedToBrowserStorage: persistedToBrowserStorage} = this.props;\n    const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n    const {areModulesLoaded: areModulesLoaded} = this.state;\n    return React.createElement(OverlayPanel, {\n      onOpenStart: () => this.onPanelOpenStart(false),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => {\n        this.onHydrationPanelClose();\n        this.onPanelCloseEnd(false);\n      },\n      animationOnOpen: AnimationInType.NONE,\n      animationOnClose: AnimationOutType.NONE,\n      shouldOpen: (botMessageState.isHydratingCounter > 0 || !areModulesLoaded) && !catastrophicErrorType && viewState.mainWindow,\n      shouldHide: false,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.HYDRATING\n    }, this.renderInnerHydrationPanel());\n  }\n  renderCatastrophicPanel() {\n    const {serviceManager: serviceManager, botName: botName, languagePack: languagePack, headerDisplayName: headerDisplayName} = this.props;\n    return React.createElement(OverlayPanel, {\n      animationOnOpen: AnimationInType.NONE,\n      animationOnClose: AnimationOutType.NONE,\n      shouldOpen: true,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.CATASTROPHIC\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(CatastrophicError, {\n      onClose: this.onClose,\n      headerDisplayName: headerDisplayName,\n      languagePack: languagePack,\n      onRestart: this.onRestart,\n      showHeader: true,\n      botName: botName\n    })));\n  }\n  renderDisclaimerPanel() {\n    const {serviceManager: serviceManager, config: config} = this.props;\n    const showDisclaimer = this.getShowDisclaimer();\n    return config.public.disclaimer?.is_on ? React.createElement(OverlayPanel, {\n      onOpenStart: () => this.onPanelOpenStart(false),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => this.onPanelCloseEnd(false),\n      animationOnOpen: AnimationInType.FADE_IN,\n      animationOnClose: AnimationOutType.FADE_OUT,\n      shouldOpen: showDisclaimer,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.DISCLAIMER\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(Disclaimer, {\n      onAcceptDisclaimer: this.onAcceptDisclaimer,\n      onClose: this.onClose,\n      disclaimerHTML: config.public.disclaimer?.disclaimerHTML,\n      disclaimerAcceptButtonRef: this.disclaimerRef\n    }))) : null;\n  }\n  renderHomeScreenPanel() {\n    const {isHydrationAnimationComplete: isHydrationAnimationComplete} = this.state;\n    const showHomeScreen = this.getShowHomeScreen();\n    return React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(HomeScreenContainer, {\n      onPanelOpenStart: () => this.onPanelOpenStart(false),\n      onPanelOpenEnd: this.onPanelOpenEnd,\n      onPanelCloseStart: this.onPanelCloseStart,\n      onPanelCloseEnd: () => this.onPanelCloseEnd(false),\n      onClose: this.onClose,\n      onCloseAndRestart: this.onCloseAndRestart,\n      onSendBotInput: text => this.onSendInput(text, MessageSendSource.HOME_SCREEN_INPUT),\n      onSendButtonInput: this.onSendHomeButtonInput,\n      onRestart: this.onRestart,\n      showHomeScreen: showHomeScreen,\n      isHydrationAnimationComplete: isHydrationAnimationComplete,\n      homeScreenInputRef: this.homeScreenInputRef,\n      onToggleHomeScreen: this.onToggleHomeScreen,\n      requestFocus: this.requestFocus\n    }));\n  }\n  renderIFramePanel() {\n    const {serviceManager: serviceManager, iFramePanelState: iFramePanelState} = this.props;\n    return React.createElement(OverlayPanel, {\n      className: \"WAC__overlay--covering\",\n      onOpenStart: () => this.onPanelOpenStart(true),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => this.onPanelCloseEnd(true),\n      animationOnOpen: AnimationInType.SLIDE_IN_FROM_BOTTOM,\n      animationOnClose: AnimationOutType.SLIDE_OUT_TO_BOTTOM,\n      shouldOpen: iFramePanelState.isOpen,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.IFRAME\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(IFramePanel, {\n      useAITheme: this.props.theme.useAITheme,\n      ref: this.iframePanelRef,\n      onClickClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onClickCloseAndRestart: this.onCloseAndRestart\n    })));\n  }\n  renderViewSourcePanel() {\n    const {serviceManager: serviceManager, viewSourcePanelState: viewSourcePanelState} = this.props;\n    return React.createElement(OverlayPanel, {\n      className: \"WAC__overlay--covering\",\n      onOpenStart: () => this.onPanelOpenStart(true),\n      onCloseStart: this.onPanelCloseStart,\n      onOpenEnd: this.onPanelOpenEnd,\n      onCloseEnd: () => this.onPanelCloseEnd(true),\n      animationOnOpen: AnimationInType.SLIDE_IN_FROM_BOTTOM,\n      animationOnClose: AnimationOutType.SLIDE_OUT_TO_BOTTOM,\n      shouldOpen: viewSourcePanelState.isOpen,\n      serviceManager: serviceManager,\n      overlayPanelName: OverlayPanelName.CONVERSATIONAL_SEARCH_CITATION\n    }, React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(ViewSourcePanel, {\n      ref: this.viewSourcePanelRef,\n      onClickClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onClickCloseAndRestart: this.onCloseAndRestart\n    })));\n  }\n  renderCustomPanel() {\n    return React.createElement(CustomPanelExport, {\n      useAITheme: this.props.theme.useAITheme,\n      onClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onCloseAndRestart: this.onCloseAndRestart,\n      onPanelOpenStart: () => this.onPanelOpenStart(true),\n      onPanelOpenEnd: this.onPanelOpenEnd,\n      onPanelCloseStart: this.onPanelCloseStart,\n      onPanelCloseEnd: () => this.onPanelCloseEnd(true)\n    });\n  }\n  renderResponsePanel() {\n    if (!this.props.responsePanelState.localMessageItem) {\n      return null;\n    }\n    const {isOpen: isOpen, localMessageItem: localMessageItem, isMessageForInput: isMessageForInput} = this.props.responsePanelState;\n    const panelOptions = (localMessageItem?.item).panel;\n    const eventName = `\"Show panel\" opened`;\n    const eventDescription = \"Panel opened through panel response type\";\n    const overlayPanelName = OverlayPanelName.PANEL_RESPONSE;\n    return React.createElement(Suspense, {\n      fallback: null\n    }, React.createElement(BodyAndFooterPanelComponent, {\n      eventName: eventName,\n      eventDescription: eventDescription,\n      overlayPanelName: overlayPanelName,\n      testIdPrefix: overlayPanelName,\n      isOpen: isOpen,\n      isMessageForInput: isMessageForInput,\n      localMessageItem: localMessageItem,\n      title: panelOptions?.title,\n      showAnimations: panelOptions?.show_animations,\n      useAITheme: this.props.theme.useAITheme,\n      requestFocus: this.requestFocus,\n      onClose: this.onClose,\n      onClickRestart: this.onRestart,\n      onCloseAndRestart: this.onCloseAndRestart,\n      onClickBack: () => this.props.serviceManager.store.dispatch(actions.setResponsePanelIsOpen(false)),\n      onPanelOpenStart: () => this.onPanelOpenStart(true),\n      onPanelOpenEnd: this.onPanelOpenEnd,\n      onPanelCloseStart: this.onPanelCloseStart,\n      onPanelCloseEnd: () => {\n        this.onPanelCloseEnd(true);\n        this.props.serviceManager.store.dispatch(actions.setResponsePanelContent(null, false));\n      }\n    }));\n  }\n  renderWidget() {\n    const {serviceManager: serviceManager, useCustomHostElement: useCustomHostElement, locale: locale, catastrophicErrorType: catastrophicErrorType, config: config, isHydrated: isHydrated, theme: theme, chatWidthBreakpoint: chatWidthBreakpoint, layout: layout, languagePack: languagePack} = this.props;\n    const {closing: closing, open: open, extraClassNames: extraClassNames} = this.state;\n    const localeClassName = `WACLocale-${locale || \"en\"}`;\n    const showGlass = config.public.enableFocusTrap && open && !config.public.hideCloseButton && !config.public.headerConfig.hideMinimizeButton;\n    const trapActive = Boolean(showGlass && isHydrated);\n    const isWideWidth = chatWidthBreakpoint === ChatWidthBreakpoint.WIDE;\n    return React.createElement(FocusTrap, {\n      active: trapActive\n    }, React.createElement(\"div\", {\n      className: cx(\"WACMainWindow\", \"WACWidget__FocusTrapContainer\", ...extraClassNames),\n      ref: this.mainWindowRef\n    }, showGlass && React.createElement(\"div\", {\n      className: \"WACWidget__FocusTrapGlass\"\n    }), React.createElement(\"div\", {\n      id: `WACWidget${serviceManager.namespace.suffix}`,\n      className: cx(`WACWidget ${localeClassName}`, {\n        \"WACWidget--rounded\": theme.corners === CornersType.ROUND,\n        \"WACWidget--defaultElement\": !useCustomHostElement,\n        \"WACWidget--launched\": !closing,\n        \"WACWidget--closing\": closing,\n        \"WACWidget--closed\": !open,\n        \"WACWidget--maxWidth\": isWideWidth && layout.hasContentMaxWidth,\n        [WIDTH_BREAKPOINT_NARROW]: chatWidthBreakpoint === ChatWidthBreakpoint.NARROW,\n        [WIDTH_BREAKPOINT_STANDARD]: chatWidthBreakpoint === ChatWidthBreakpoint.STANDARD,\n        [WIDTH_BREAKPOINT_WIDE]: isWideWidth\n      }),\n      ref: this.containerRef\n    }, React.createElement(VisuallyHidden, null, React.createElement(\"h1\", null, languagePack.window_title)), catastrophicErrorType && this.renderCatastrophicPanel(), !catastrophicErrorType && React.createElement(\"div\", {\n      ref: this.animationContainerRef,\n      className: \"WACWidget__animationContainer\",\n      onScroll: () => {\n        if (this.animationContainerRef.current.scrollTop !== 0) {\n          this.animationContainerRef.current.scrollTop = 0;\n        }\n      }\n    }, this.renderChat()), React.createElement(\"div\", {\n      className: \"WACMainWindowModalHost\",\n      ref: this.setModalPortalHostElement\n    }))));\n  }\n  render() {\n    return React.createElement(ModalPortalRootContext.Provider, {\n      value: this.state.modalPortalHostElement\n    }, this.renderWidget());\n  }\n}\n\nvar MainWindow$1 = connect(state => state, null, null, {\n  forwardRef: true\n})(MainWindow);\n\nexport { MainWindow$1 as default };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction addClassNameToState(name) {\n  return previousState => {\n    const currentIndex = previousState.extraClassNames.indexOf(name);\n    if (currentIndex === -1) {\n      return {\n        extraClassNames: [ ...previousState.extraClassNames, name ]\n      };\n    }\n    return null;\n  };\n}\n\nfunction removeClassNameFromState(name) {\n  return previousState => ({\n    extraClassNames: previousState.extraClassNames.filter(value => value !== name)\n  });\n}\n\nexport { addClassNameToState, removeClassNameFromState };\n","import \"intl-pluralrules\";\n\nimport cx from \"classnames\";\n\nimport React, { useState, useMemo, useRef, Suspense } from \"react\";\n\nimport { RawIntlProvider, useIntl } from \"react-intl\";\n\nimport { Provider, useSelector, useDispatch } from \"react-redux\";\n\nimport { AriaAnnouncerProvider } from \"../components/aria/AriaAnnouncerProvider.js\";\n\nimport { LauncherContainer } from \"../components/launcher/LauncherContainer.js\";\n\nimport { LanguagePackContext } from \"../contexts/LanguagePackContext.js\";\n\nimport { WindowSizeContext } from \"../contexts/WindowSizeContext.js\";\n\nimport { ServiceManagerContext } from \"../contexts/ServiceManagerContext.js\";\n\nimport { useOnMount } from \"../hooks/useOnMount.js\";\n\nimport actions from \"../store/actions.js\";\n\nimport { IS_PHONE_IN_PORTRAIT_MODE, IS_PHONE } from \"../utils/browserUtils.js\";\n\nimport { consoleDebug, consoleError } from \"../utils/miscUtils.js\";\n\nimport { convertCSSVariablesToString, getThemeClassNames } from \"../utils/styleUtils.js\";\n\nimport MainWindow from \"./main/MainWindow.js\";\n\nimport { lazyTourComponent } from \"../../dynamic-imports/dynamic-imports.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const TourContainerLazy = lazyTourComponent();\n\nfunction App({serviceManager: serviceManager, hostElement: hostElement, applicationStyles: applicationStyles, fontStyles: fontStyles}) {\n  const {store: store} = serviceManager;\n  const {config: config} = store.getState();\n  if (config.public.debug) {\n    consoleDebug(\"[render] Called render\");\n  }\n  const combinedStyles = `${fontStyles ? `${fontStyles} ` : \"\"}${applicationStyles}`;\n  return React.createElement(Provider, {\n    store: store\n  }, React.createElement(AppContainer, {\n    serviceManager: serviceManager,\n    hostElement: hostElement,\n    applicationStyles: combinedStyles\n  }));\n}\n\nfunction AppContainer({serviceManager: serviceManager, hostElement: hostElement, applicationStyles: applicationStyles}) {\n  const languagePack = useSelector(state => state.languagePack);\n  const cssVariableOverrides = useSelector(state => state.cssVariableOverrides);\n  const theme = useSelector(state => state.theme);\n  const config = useSelector(state => state.config);\n  const layout = useSelector(state => state.layout);\n  const {namespace: namespace} = serviceManager;\n  const {originalName: originalName} = namespace;\n  const dispatch = useDispatch();\n  const [windowSize, setWindowSize] = useState({\n    width: window.innerWidth,\n    height: window.innerHeight\n  });\n  const cssVariableOverrideString = useMemo(() => convertCSSVariablesToString(cssVariableOverrides), [ cssVariableOverrides ]);\n  const dir = document.dir || \"auto\";\n  useOnMount(() => {\n    const windowListener = () => {\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    };\n    window.addEventListener(\"resize\", windowListener);\n    const visibilityListener = () => {\n      dispatch(actions.setIsBrowserPageVisible(document.visibilityState === \"visible\"));\n    };\n    document.addEventListener(\"visibilitychange\", visibilityListener);\n    return () => {\n      window.removeEventListener(\"resize\", windowListener);\n      document.removeEventListener(\"visibilitychange\", visibilityListener);\n    };\n  });\n  return React.createElement(\"div\", {\n    className: \"WACContainer\",\n    \"data-namespace\": originalName,\n    ref: node => {\n      if (node && hostElement) {\n        node.style.setProperty(\"height\", \"100%\", \"important\");\n        node.style.setProperty(\"width\", \"100%\", \"important\");\n      }\n    }\n  }, React.createElement(\"div\", {\n    className: \"WACContainer--styles\"\n  }, React.createElement(\"style\", {\n    \"data-base-styles\": \"true\",\n    nonce: config.public.cspNonce\n  }, applicationStyles || `.WACContainer { visibility: hidden; }`), React.createElement(\"style\", {\n    \"data-variables-custom\": \"true\",\n    nonce: config.public.cspNonce\n  }, cssVariableOverrideString)), React.createElement(\"div\", {\n    className: cx(`WACContainer--render`, getThemeClassNames(theme), {\n      \"WACContainer-disableMobileEnhancements\": hostElement && config.public.disableCustomElementMobileEnhancements,\n      \"WAC-isPhone\": IS_PHONE && !config.public.disableCustomElementMobileEnhancements,\n      \"WAC-isPhonePortraitMode\": IS_PHONE_IN_PORTRAIT_MODE && !config.public.disableCustomElementMobileEnhancements,\n      \"WAC--frameless\": !layout?.showFrame\n    }),\n    dir: dir\n  }, React.createElement(WindowSizeContext.Provider, {\n    value: windowSize\n  }, React.createElement(ServiceManagerContext.Provider, {\n    value: serviceManager\n  }, React.createElement(RawIntlProvider, {\n    value: serviceManager.intl\n  }, React.createElement(LanguagePackContext.Provider, {\n    value: languagePack\n  }, React.createElement(AriaAnnouncerProvider, null, React.createElement(MainContainer, {\n    serviceManager: serviceManager,\n    hostElement: hostElement\n  }))))))));\n}\n\nfunction MainContainer(props) {\n  const {hostElement: hostElement, serviceManager: serviceManager} = props;\n  const showLauncher = useSelector(state => state.launcher.config.is_on);\n  const {viewState: viewState} = useSelector(state => state.persistedToBrowserStorage.launcherState);\n  const tourContainerRef = useRef();\n  const mainWindowRef = useRef();\n  const showTour = viewState.tour;\n  const showedTourOnce = useRef(showTour);\n  showedTourOnce.current = showTour || showedTourOnce.current;\n  const intl = useIntl();\n  const namespace = serviceManager.namespace.originalName;\n  const languageKey = namespace ? \"window_ariaChatRegionNamespace\" : \"window_ariaChatRegion\";\n  const regionLabel = intl.formatMessage({\n    id: languageKey\n  }, {\n    namespace: namespace\n  });\n  useOnMount(() => {\n    function requestFocus() {\n      try {\n        const {persistedToBrowserStorage: persistedToBrowserStorage} = serviceManager.store.getState();\n        const {viewState: viewState} = persistedToBrowserStorage.launcherState;\n        if (viewState.tour) {\n          tourContainerRef.current?.requestFocus();\n        } else if (viewState.mainWindow) {\n          mainWindowRef.current?.requestFocus();\n        }\n      } catch (error) {\n        consoleError(\"An error occurred in App.requestFocus\", error);\n      }\n    }\n    serviceManager.appWindow = {\n      requestFocus: requestFocus\n    };\n  });\n  return React.createElement(\"div\", {\n    className: \"WACWidget__regionContainer\",\n    role: \"region\",\n    \"aria-label\": regionLabel\n  }, React.createElement(MainWindow, {\n    mainWindowRef: mainWindowRef,\n    useCustomHostElement: Boolean(hostElement),\n    serviceManager: serviceManager\n  }), showedTourOnce.current && React.createElement(Suspense, {\n    fallback: null\n  }, React.createElement(TourContainerLazy, {\n    ref: tourContainerRef\n  })), showLauncher && React.createElement(LauncherContainer, null));\n}\n\nexport { App as default };\n","import React from \"react\";\n\nimport ReactDOM from \"react-dom\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function UserDefinedResponsePortalsContainer({chatInstance: chatInstance, renderUserDefinedResponse: renderUserDefinedResponse, userDefinedResponseEventsBySlot: userDefinedResponseEventsBySlot}) {\n  return renderUserDefinedResponse ? Object.entries(userDefinedResponseEventsBySlot).map(([slot, slotState]) => {\n    const {element: element} = slotState;\n    if (!element) {\n      return null;\n    }\n    return React.createElement(UserDefinedResponseComponentPortal, {\n      key: slot,\n      hostElement: element\n    }, renderUserDefinedResponse(slotState, chatInstance));\n  }) : null;\n}\n\nfunction UserDefinedResponseComponentPortal({hostElement: hostElement, children: children}) {\n  return ReactDOM.createPortal(children, hostElement);\n}\n\nconst UserDefinedResponsePortalsContainerExport = React.memo(UserDefinedResponsePortalsContainer);\n\nexport { UserDefinedResponsePortalsContainerExport as UserDefinedResponsePortalsContainer };\n","import React from \"react\";\n\nimport ReactDOM from \"react-dom\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function WriteableElementsPortalsContainer({chatInstance: chatInstance, renderResponseMap: renderResponseMap}) {\n  return React.createElement(React.Fragment, null, Object.keys(chatInstance.writeableElements).map(key => {\n    const responseItem = renderResponseMap[key];\n    return responseItem ? React.createElement(WriteableElementsComponentPortal, {\n      key: key,\n      hostElement: chatInstance.writeableElements[key]\n    }, responseItem) : null;\n  }));\n}\n\nfunction WriteableElementsComponentPortal({hostElement: hostElement, children: children}) {\n  return ReactDOM.createPortal(children, hostElement);\n}\n\nconst WriteableElementsPortalsContainerExport = React.memo(WriteableElementsPortalsContainer);\n\nexport { WriteableElementsPortalsContainerExport as WriteableElementsPortalsContainer };\n","import isEqual from \"lodash-es/isEqual.js\";\n\nimport React, { useState, useRef, useEffect } from \"react\";\n\nimport Chat from \"../../shared/Chat.js\";\n\nimport { instantiateWidget } from \"../../shared/chatEntryFunctions.js\";\n\nimport App from \"../../shared/containers/App.js\";\n\nimport { sleep } from \"../../shared/utils/lang/promiseUtils.js\";\n\nimport { UserDefinedResponsePortalsContainer as UserDefinedResponsePortalsContainerExport } from \"./UserDefinedResponsePortalsContainer.js\";\n\nimport { WriteableElementsPortalsContainer as WriteableElementsPortalsContainerExport } from \"./WriteableElementsPortalsContainer.js\";\n\nimport { BusEventType } from \"../../../types/events/eventBusTypes.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function AppContainer({config: config, onBeforeRender: onBeforeRender, onAfterRender: onAfterRender, renderUserDefinedResponse: renderUserDefinedResponse, renderWriteableElements: renderWriteableElements, container: container, setParentInstance: setParentInstance, element: element}) {\n  const [instance, setInstance] = useState(null);\n  const [renderProps, setRenderProps] = useState(null);\n  const [applicationStyles, setApplicationStyles] = useState(null);\n  const setInstances = instance => {\n    setInstance(instance);\n    setParentInstance?.(instance);\n  };\n  const [userDefinedResponseEventsBySlot, setUserDefinedResponseEventsBySlot] = useState({});\n  const managedWebChatRef = useRef(null);\n  const previousConfigRef = useRef(null);\n  useEffect(() => {\n    const previousConfig = previousConfigRef.current;\n    previousConfigRef.current = config;\n    async function render({serviceManager: serviceManager}) {\n      const applicationStyles = await loadStyles();\n      serviceManager.container = container;\n      if (serviceManager.customHostElement) {\n        container.style.setProperty(\"width\", \"100%\", \"important\");\n        container.style.setProperty(\"height\", \"100%\", \"important\");\n      } else {\n        container.style.setProperty(\"width\", \"0\", \"important\");\n        container.style.setProperty(\"height\", \"0\", \"important\");\n      }\n      setApplicationStyles(applicationStyles);\n      setRenderProps({\n        serviceManager: serviceManager\n      });\n      await sleep(0);\n    }\n    if (!isEqual(previousConfig, config)) {\n      const managedWebChat = {\n        instance: null,\n        shouldDestroy: false,\n        config: config\n      };\n      if (config) {\n        loadChat({\n          managedWebChatRef: managedWebChatRef,\n          managedWebChat: managedWebChat,\n          render: render,\n          setInstance: setInstances,\n          onBeforeRender: onBeforeRender,\n          onAfterRender: onAfterRender,\n          setUserDefinedResponseEventsBySlot: setUserDefinedResponseEventsBySlot,\n          element: element\n        });\n      }\n      return () => {\n        destroyWebChat(managedWebChat, setInstances);\n        previousConfigRef.current = null;\n      };\n    }\n    return undefined;\n  }, [ config, container ]);\n  if (renderProps && instance) {\n    return React.createElement(React.Fragment, null, React.createElement(App, {\n      serviceManager: renderProps.serviceManager,\n      hostElement: renderProps.serviceManager.customHostElement,\n      applicationStyles: applicationStyles\n    }), renderUserDefinedResponse && React.createElement(UserDefinedResponsePortalsContainerExport, {\n      chatInstance: instance,\n      renderUserDefinedResponse: renderUserDefinedResponse,\n      userDefinedResponseEventsBySlot: userDefinedResponseEventsBySlot\n    }), renderWriteableElements && React.createElement(WriteableElementsPortalsContainerExport, {\n      chatInstance: instance,\n      renderResponseMap: renderWriteableElements\n    }));\n  }\n  return null;\n}\n\nasync function destroyWebChat(managedWebChat, setInstance) {\n  if (managedWebChat) {\n    if (managedWebChat.instance) {\n      managedWebChat.instance.destroy();\n      await sleep(0);\n    }\n    managedWebChat.shouldDestroy = true;\n    managedWebChat.instance = null;\n  }\n  setInstance(null);\n  await sleep(0);\n}\n\nfunction addUserDefinedResponseHandler(webChatInstance, setUserDefinedResponseEventsBySlot) {\n  function userDefinedResponseHandler(event) {\n    setUserDefinedResponseEventsBySlot(userDefinedEventsBySlot => ({\n      ...userDefinedEventsBySlot,\n      [event.data.slot]: {\n        fullMessage: event.data.fullMessage,\n        messageItem: event.data.message,\n        element: event.data.element\n      }\n    }));\n  }\n  function userDefinedChunkHandler(event) {\n    if (\"complete_item\" in event.data.chunk) {\n      const messageItem = event.data.chunk.complete_item;\n      setUserDefinedResponseEventsBySlot(userDefinedEventsBySlot => ({\n        ...userDefinedEventsBySlot,\n        [event.data.slot]: {\n          messageItem: messageItem,\n          element: event.data.element\n        }\n      }));\n    } else if (\"partial_item\" in event.data.chunk) {\n      const itemChunk = event.data.chunk.partial_item;\n      setUserDefinedResponseEventsBySlot(userDefinedEventsBySlot => ({\n        ...userDefinedEventsBySlot,\n        [event.data.slot]: {\n          partialItems: [ ...userDefinedEventsBySlot[event.data.slot]?.partialItems || [], itemChunk ],\n          element: event.data.element\n        }\n      }));\n    }\n  }\n  function restartHandler() {\n    setUserDefinedResponseEventsBySlot({});\n  }\n  webChatInstance.on({\n    type: BusEventType.CHUNK_USER_DEFINED_RESPONSE,\n    handler: userDefinedChunkHandler\n  });\n  webChatInstance.on({\n    type: BusEventType.USER_DEFINED_RESPONSE,\n    handler: userDefinedResponseHandler\n  });\n  webChatInstance.on({\n    type: BusEventType.RESTART_CONVERSATION,\n    handler: restartHandler\n  });\n}\n\nasync function loadChat({managedWebChatRef: managedWebChatRef, managedWebChat: managedWebChat, render: render, setInstance: setInstance, onBeforeRender: onBeforeRender, onAfterRender: onAfterRender, setUserDefinedResponseEventsBySlot: setUserDefinedResponseEventsBySlot, element: element}) {\n  await destroyWebChat(managedWebChatRef.current, setInstance);\n  managedWebChatRef.current = managedWebChat;\n  if (managedWebChat.shouldDestroy) {\n    await destroyWebChat(managedWebChat, setInstance);\n    return;\n  }\n  const widget = await instantiateWidget(managedWebChat.config, () => Promise.resolve(Chat), Promise.resolve(render), element);\n  const instance = await widget.start();\n  addUserDefinedResponseHandler(instance, setUserDefinedResponseEventsBySlot);\n  onBeforeRender?.(instance);\n  await instance.render();\n  onAfterRender?.(instance);\n  setInstance(instance);\n  managedWebChat.instance = instance;\n  if (managedWebChat.shouldDestroy) {\n    await destroyWebChat(managedWebChat, setInstance);\n  }\n}\n\nconst AppContainerExport = React.memo(AppContainer);\n\nconst loadBaseStyles = async () => {\n  const {default: styles} = await import(\"../../shared/styles/export.scss.js\");\n  return styles;\n};\n\nconst loadCarbon = async () => {\n  const {default: carbon} = await import(\"../../shared/styles/export.carbon.scss.js\");\n  return carbon;\n};\n\nasync function loadStyles() {\n  const [styles, carbonStyles] = await Promise.all([ loadBaseStyles(), loadCarbon() ]);\n  return carbonStyles + styles;\n}\n\nexport { AppContainerExport as AppContainer };\n","import React, { useContext } from \"react\";\n\nimport { AriaAnnouncerContext } from \"../contexts/AriaAnnouncerContext.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function withAriaAnnouncer(Component) {\n  const Wrapped = React.forwardRef((props, ref) => {\n    const ariaAnnouncer = useContext(AriaAnnouncerContext);\n    return React.createElement(Component, {\n      ...props,\n      ref: ref,\n      ariaAnnouncer: ariaAnnouncer\n    });\n  });\n  Wrapped.displayName = `withAriaAnnouncer(${Component.displayName || Component.name || \"Component\"})`;\n  return Wrapped;\n}\n\nexport { withAriaAnnouncer };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nvar MessageErrorState;\n\n(function(MessageErrorState) {\n  MessageErrorState[MessageErrorState[\"NONE\"] = 1] = \"NONE\";\n  MessageErrorState[MessageErrorState[\"FAILED\"] = 2] = \"FAILED\";\n  MessageErrorState[MessageErrorState[\"RETRYING\"] = 3] = \"RETRYING\";\n  MessageErrorState[MessageErrorState[\"WAITING\"] = 4] = \"WAITING\";\n})(MessageErrorState || (MessageErrorState = {}));\n\nexport { MessageErrorState };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction resolvablePromise() {\n  let resolveFunction;\n  let rejectFunction;\n  const promise = new Promise((resolve, reject) => {\n    resolveFunction = resolve;\n    rejectFunction = reject;\n  });\n  promise.doResolve = resolveValue => {\n    promise.isResolved = true;\n    promise.isComplete = true;\n    resolveFunction(resolveValue);\n  };\n  promise.doReject = rejectValue => {\n    promise.isRejected = true;\n    promise.isComplete = true;\n    rejectFunction(rejectValue);\n  };\n  promise.isResolved = false;\n  promise.isRejected = false;\n  promise.isComplete = false;\n  return promise;\n}\n\nexport { resolvablePromise };\n","import React from \"react\";\n\nimport { isElement, isInputNode, isTextAreaNode, isImageNode, isTextNode } from \"../../utils/domUtils.js\";\n\nimport VisuallyHidden from \"../util/VisuallyHidden.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst ANNOUNCE_INPUT_TYPES = new Set([ \"button\", \"date\", \"datetime-local\", \"email\", \"file\", \"month\", \"number\", \"range\", \"reset\", \"search\", \"submit\", \"tel\", \"text\", \"time\", \"url\", \"week\" ]);\n\nconst ANNOUNCE_NODE_EXCLUDE_ATTRIBUTE = \"data-wac-exclude-node-read\";\n\nclass AriaAnnouncerComponent extends React.PureComponent {\n  constructor() {\n    super(...arguments);\n    this.ref1 = React.createRef();\n    this.ref2 = React.createRef();\n    this.useRef1 = true;\n    this.doAnnouncements = () => {\n      const strings = [];\n      this.pendingValues.forEach(elementToAnnounce => {\n        if (typeof elementToAnnounce === \"string\") {\n          strings.push(elementToAnnounce);\n        } else {\n          nodeToText(elementToAnnounce, strings);\n        }\n      });\n      const useElement = this.useRef1 ? this.ref1.current : this.ref2.current;\n      if (useElement) {\n        useElement.innerText = strings.join(\" \");\n        const clearElement = this.useRef1 ? this.ref2.current : this.ref1.current;\n        clearElement.innerHTML = \"\";\n      }\n      this.useRef1 = !this.useRef1;\n      this.pendingValues = null;\n    };\n  }\n  announceValue(value) {\n    if (!value) {\n      return;\n    }\n    if (!this.pendingValues) {\n      this.pendingValues = [];\n      setTimeout(this.doAnnouncements, 250);\n    }\n    if (typeof value === \"string\" || hasNodeType(value)) {\n      this.pendingValues.push(value);\n    } else if (value.messageID) {\n      const formattedMessage = this.props.intl.formatMessage({\n        id: value.messageID\n      }, value.messageValues);\n      this.pendingValues.push(formattedMessage);\n    } else {\n      this.pendingValues.push(value.messageText);\n    }\n  }\n  render() {\n    return React.createElement(VisuallyHidden, {\n      className: \"WACAriaAnnouncer\"\n    }, React.createElement(\"div\", {\n      ref: this.ref1,\n      \"aria-live\": \"polite\"\n    }), React.createElement(\"div\", {\n      ref: this.ref2,\n      \"aria-live\": \"polite\"\n    }));\n  }\n}\n\nfunction nodeToText(node, strings) {\n  if (isElement(node)) {\n    if (window.getComputedStyle(node).display !== \"none\" && node.getAttribute(\"aria-hidden\") !== \"true\" && !node.hasAttribute(ANNOUNCE_NODE_EXCLUDE_ATTRIBUTE)) {\n      trimAndPush(node.getAttribute(\"aria-label\"), strings);\n      if (isInputNode(node) && ANNOUNCE_INPUT_TYPES.has(node.type.toLowerCase())) {\n        if (node.value === \"\") {\n          trimAndPush(node.placeholder, strings);\n        } else {\n          trimAndPush(node.value, strings);\n        }\n      } else if (isTextAreaNode(node)) {\n        if (node.value === \"\") {\n          trimAndPush(node.placeholder, strings);\n        }\n      } else if (isImageNode(node)) {\n        trimAndPush(node.alt, strings);\n      }\n      if (node.shadowRoot) {\n        node.shadowRoot.childNodes?.forEach(childNode => {\n          nodeToText(childNode, strings);\n        });\n      }\n      if (node.childNodes) {\n        node.childNodes.forEach(childNode => {\n          nodeToText(childNode, strings);\n        });\n      }\n    }\n  } else if (isTextNode(node)) {\n    trimAndPush(node.data, strings);\n  }\n}\n\nfunction trimAndPush(value, strings) {\n  if (value) {\n    value = value.trim();\n    if (value) {\n      strings.push(value.replaceAll(\"\\n\", \" \"));\n    }\n  }\n}\n\nfunction hasNodeType(value) {\n  return value.nodeType !== undefined;\n}\n\nexport { AriaAnnouncerComponent, nodeToText };\n","import React, { forwardRef, useRef, useImperativeHandle, useCallback } from \"react\";\n\nimport { useSelector } from \"react-redux\";\n\nimport { Header as HeaderExport } from \"../header/Header.js\";\n\nimport { OverlayPanelName } from \"../OverlayPanel.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function HomeScreenHeader(props, ref) {\n  const {brandColor: brandColor, onClose: onClose, onRestart: onRestart, onCloseAndRestart: onCloseAndRestart} = props;\n  const showRestartButton = useSelector(state => state.config.public.showRestartButton || state.config.public.headerConfig?.showRestartButton);\n  const showBackButton = useSelector(state => state.persistedToBrowserStorage.chatState.homeScreenState.showBackToBot);\n  const displayName = useSelector(state => state.headerDisplayName);\n  const customMenuOptions = useSelector(state => state.customMenuOptions);\n  const useAITheme = useSelector(state => state.theme.useAITheme);\n  const headerRef = useRef();\n  useImperativeHandle(ref, () => headerRef.current);\n  const hideCloseAndRestartButton = !showBackButton;\n  const overflowClicked = useCallback(index => {\n    const {handler: handler} = customMenuOptions[index];\n    handler();\n  }, [ customMenuOptions ]);\n  const overflowItems = customMenuOptions?.map(option => option.text);\n  return React.createElement(\"div\", {\n    className: \"WACHomeScreenHeader\"\n  }, React.createElement(HeaderExport, {\n    ref: headerRef,\n    displayName: displayName,\n    showCenter: true,\n    showRestartButton: showRestartButton,\n    hideCloseAndRestartButton: hideCloseAndRestartButton,\n    onClickRestart: onRestart,\n    onClickClose: onClose,\n    onCloseAndRestart: onCloseAndRestart,\n    overflowClicked: overflowClicked,\n    overflowItems: overflowItems,\n    useAITheme: useAITheme,\n    brandColor: brandColor,\n    testIdPrefix: OverlayPanelName.HOME_SCREEN\n  }));\n}\n\nconst HomeScreenHeaderExport = React.memo(forwardRef(HomeScreenHeader));\n\nexport { HomeScreenHeaderExport as HomeScreenHeader };\n","import React from \"react\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ const WindowSizeContext = React.createContext(null);\n\nexport { WindowSizeContext };\n","import React, { PureComponent } from \"react\";\n\nimport { withAriaAnnouncer } from \"../../hocs/withAriaAnnouncer.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ class AnnounceOnMountComponent extends PureComponent {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      isMounted: false\n    };\n    this.onceAnnounced = false;\n  }\n  componentDidMount() {\n    this.setState({\n      isMounted: true\n    });\n    if (!this.onceAnnounced) {\n      if (this.props.announceOnce) {\n        setTimeout(() => {\n          this.props.ariaAnnouncer(this.props.announceOnce);\n        });\n      }\n      this.onceAnnounced = true;\n    }\n  }\n  render() {\n    return React.createElement(\"div\", {\n      \"aria-live\": \"polite\"\n    }, this.state.isMounted && this.props.children);\n  }\n}\n\nconst AnnounceOnMountComponentExport = withAriaAnnouncer(AnnounceOnMountComponent);\n\nexport { AnnounceOnMountComponentExport as AnnounceOnMountComponent };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst getBotInputState = state => state.botInputState;\n\nconst getAgentInputState = state => state.agentState.inputState;\n\nconst getAgentState = state => state.agentState;\n\nconst getPersistedAgent = state => state.persistedToBrowserStorage.chatState.agentState;\n\nfunction selectAgentDisplayState(state) {\n  const agentState = getAgentState(state);\n  const persisted = getPersistedAgent(state);\n  if (persisted.isSuspended) {\n    return {\n      isConnectingOrConnected: false,\n      disableInput: false,\n      isAgentTyping: false,\n      inputPlaceholderKey: null\n    };\n  }\n  const {isReconnecting: isReconnecting, isConnecting: isConnecting, isAgentTyping: isAgentTyping} = agentState;\n  const {isConnected: isConnected} = persisted;\n  let inputPlaceholderKey;\n  if (isConnecting) {\n    inputPlaceholderKey = \"agent_inputPlaceholderConnecting\";\n  } else if (isReconnecting) {\n    inputPlaceholderKey = \"agent_inputPlaceholderReconnecting\";\n  } else {\n    inputPlaceholderKey = null;\n  }\n  return {\n    isAgentTyping: isAgentTyping,\n    isConnectingOrConnected: isConnecting || isConnected,\n    disableInput: isConnecting || isReconnecting,\n    inputPlaceholderKey: inputPlaceholderKey\n  };\n}\n\nfunction selectIsInputToAgent(state) {\n  return selectAgentDisplayState(state).isConnectingOrConnected;\n}\n\nfunction selectInputState(state) {\n  return selectIsInputToAgent(state) ? getAgentInputState(state) : getBotInputState(state);\n}\n\nexport { selectAgentDisplayState, selectInputState, selectIsInputToAgent };\n","import Home from \"@carbon/icons-react/es/Home.js\";\n\nimport React, { forwardRef, useRef, useCallback, useImperativeHandle } from \"react\";\n\nimport { useSelector, shallowEqual } from \"react-redux\";\n\nimport { useLanguagePack } from \"../../hooks/useLanguagePack.js\";\n\nimport { useServiceManager } from \"../../hooks/useServiceManager.js\";\n\nimport { selectAgentDisplayState } from \"../../store/selectors.js\";\n\nimport \"../../utils/constants.js\";\n\nimport WriteableElement from \"../WriteableElement.js\";\n\nimport { Header as HeaderExport } from \"./Header.js\";\n\nimport { WriteableElementName } from \"../../../../types/instance/ChatInstance.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function BotHeader(props, ref) {\n  const {onClose: onClose, onCloseAndRestart: onCloseAndRestart, onRestart: onRestart, onToggleHomeScreen: onToggleHomeScreen, headerDisplayName: headerDisplayName, includeWriteableElement: includeWriteableElement, enableChatHeaderConfig: enableChatHeaderConfig, headerAvatarConfig: headerAvatarConfig, testIdPrefix: testIdPrefix} = props;\n  const serviceManager = useServiceManager();\n  const languagePack = useLanguagePack();\n  const homeScreenIsOn = useSelector(state => state.homeScreenConfig.is_on && state.homeScreenConfig.allow_return);\n  const publicConfig = useSelector(state => state.config.public);\n  const customMenuOptions = useSelector(state => state.customMenuOptions);\n  const {isConnectingOrConnected: isConnectingOrConnected} = useSelector(selectAgentDisplayState, shallowEqual);\n  const useAITheme = useSelector(state => state.theme.useAITheme);\n  const maxVisibleHeaderObjects = useSelector(state => state.chatHeaderState.maxVisibleHeaderObjects);\n  const leftObjectsLength = useSelector(state => state.chatHeaderState.config?.left?.length || 0);\n  const rightObjectsLength = useSelector(state => state.chatHeaderState.config?.right?.length || 0);\n  const headerRef = useRef();\n  const isHeaderObjectsInOverflow = leftObjectsLength > maxVisibleHeaderObjects || rightObjectsLength > maxVisibleHeaderObjects;\n  const hasChatHeaderObjects = enableChatHeaderConfig && isHeaderObjectsInOverflow;\n  const showRestartButton = publicConfig.showRestartButton || publicConfig.headerConfig?.showRestartButton;\n  const allowHomeScreen = homeScreenIsOn && !isConnectingOrConnected;\n  const overflowClicked = useCallback(index => {\n    if (index === 0 && allowHomeScreen) {\n      onToggleHomeScreen?.();\n    } else {\n      const {handler: handler} = customMenuOptions[allowHomeScreen ? index - 1 : index];\n      handler();\n    }\n  }, [ customMenuOptions, onToggleHomeScreen, allowHomeScreen ]);\n  let overflowItems = customMenuOptions?.map(option => option.text);\n  if (overflowItems && allowHomeScreen) {\n    overflowItems.splice(0, 0, languagePack.homeScreen_overflowMenuHomeScreen);\n  } else if (!overflowItems && allowHomeScreen && hasChatHeaderObjects) {\n    overflowItems = [ languagePack.homeScreen_overflowMenuHomeScreen ];\n  }\n  useImperativeHandle(ref, () => headerRef.current);\n  return React.createElement(\"div\", {\n    className: \"WACHeader__Container\"\n  }, React.createElement(HeaderExport, {\n    ref: headerRef,\n    showCenter: true,\n    headerAvatarConfig: headerAvatarConfig,\n    displayName: headerDisplayName,\n    showBackButton: Boolean(allowHomeScreen && onToggleHomeScreen),\n    showRestartButton: showRestartButton,\n    useAITheme: useAITheme,\n    backContent: React.createElement(Home, null),\n    labelBackButton: languagePack.homeScreen_returnToHome,\n    onClickRestart: onRestart,\n    onClickClose: onClose,\n    onCloseAndRestart: onCloseAndRestart,\n    onClickBack: onToggleHomeScreen,\n    overflowItems: overflowItems,\n    overflowClicked: overflowClicked,\n    enableChatHeaderConfig: enableChatHeaderConfig,\n    testIdPrefix: testIdPrefix\n  }), includeWriteableElement && React.createElement(WriteableElement, {\n    slotName: WriteableElementName.HEADER_BOTTOM_ELEMENT,\n    id: `headerBottomElement${serviceManager.namespace.suffix}`,\n    className: \"WACHeader__HeaderBottomElement\"\n  }));\n}\n\nconst BotHeaderExport = React.memo(forwardRef(BotHeader));\n\nexport { BotHeaderExport as BotHeader };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nfunction deepFreeze(object) {\n  Object.freeze(object);\n  Object.getOwnPropertyNames(object).forEach(prop => {\n    if (Object.prototype.hasOwnProperty.call(object, prop) && object[prop] !== null && (typeof object[prop] === \"object\" || typeof object[prop] === \"function\") && !Object.isFrozen(object[prop])) {\n      deepFreeze(object[prop]);\n    }\n  });\n  return object;\n}\n\nexport { deepFreeze };\n","import { MessageResponseTypes } from \"../../../types/messaging/Messages.js\";\n\nimport { uuid } from \"../utils/lang/uuid.js\";\n\nimport { UUIDType } from \"../utils/lang/UUIDType.js\";\n\n/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */ function inputItemToLocalItem(message, originalUserText, id = uuid(UUIDType.LOCAL_MESSAGE)) {\n  const localMessage = {\n    item: {\n      response_type: MessageResponseTypes.TEXT,\n      ...message.input\n    },\n    ui_state: {\n      id: id,\n      originalUserText: originalUserText,\n      needsAnnouncement: false\n    },\n    fullMessageID: message.id\n  };\n  return localMessage;\n}\n\nexport { inputItemToLocalItem as default };\n","/*\n *  Copyright IBM Corp. 2025\n *\n *  This source code is licensed under the Apache-2.0 license found in the\n *  LICENSE file in the root directory of this source tree.\n *\n *  @license\n */\nconst HA_SET_AGENT_AVAILABILITY = \"HA_SET_AGENT_AVAILABILITY\";\n\nconst HA_SET_IS_CONNECTING = \"HA_SET_IS_CONNECTING\";\n\nconst HA_SET_IS_RECONNECTING = \"HA_SET_IS_RECONNECTING\";\n\nconst HA_SET_AGENT_JOINED = \"HA_SET_AGENT_JOINED\";\n\nconst HA_SET_AGENT_LEFT_CHAT = \"HA_SET_AGENT_LEFT_CHAT\";\n\nconst HA_END_CHAT = \"HA_END_CHAT\";\n\nconst HA_UPDATE_CAPABILITIES = \"HA_UPDATE_CAPABILITIES\";\n\nconst HA_UPDATE_FILE_UPLOAD_IN_PROGRESS = \"HA_UPDATE_FILE_UPLOAD_IN_PROGRESS\";\n\nconst HA_SET_SHOW_SCREEN_SHARE_REQUEST = \"HA_SET_SHOW_SCREEN_SHARE_REQUEST\";\n\nconst HA_SET_IS_SCREEN_SHARING = \"HA_SET_IS_SCREEN_SHARING\";\n\nconst HA_SET_PERSISTED_STATE = \"HA_SET_PERSISTED_STATE\";\n\nconst HA_UPDATE_IS_SUSPENDED = \"HA_UPDATE_IS_SUSPENDED\";\n\nconst HA_UPDATE_IS_TYPING = \"HA_UPDATE_IS_TYPING\";\n\nfunction setIsConnecting(isConnecting, localMessageID) {\n  return {\n    type: HA_SET_IS_CONNECTING,\n    isConnecting: isConnecting,\n    localMessageID: localMessageID\n  };\n}\n\nfunction setIsReconnecting(isReconnecting) {\n  return {\n    type: HA_SET_IS_RECONNECTING,\n    isReconnecting: isReconnecting\n  };\n}\n\nfunction setAgentLeftChat() {\n  return {\n    type: HA_SET_AGENT_LEFT_CHAT\n  };\n}\n\nfunction endChat() {\n  return {\n    type: HA_END_CHAT\n  };\n}\n\nfunction setAgentAvailability(availability) {\n  return {\n    type: HA_SET_AGENT_AVAILABILITY,\n    availability: availability\n  };\n}\n\nfunction setAgentJoined(agentProfile) {\n  return {\n    type: HA_SET_AGENT_JOINED,\n    agentProfile: agentProfile\n  };\n}\n\nfunction updateCapabilities(capabilities) {\n  return {\n    type: HA_UPDATE_CAPABILITIES,\n    capabilities: capabilities\n  };\n}\n\nfunction updateFilesUploadInProgress(fileUploadInProgress) {\n  return {\n    type: HA_UPDATE_FILE_UPLOAD_IN_PROGRESS,\n    fileUploadInProgress: fileUploadInProgress\n  };\n}\n\nfunction setShowScreenShareRequest(showRequest) {\n  return {\n    type: HA_SET_SHOW_SCREEN_SHARE_REQUEST,\n    showRequest: showRequest\n  };\n}\n\nfunction setIsScreenSharing(isSharing) {\n  return {\n    type: HA_SET_IS_SCREEN_SHARING,\n    isSharing: isSharing\n  };\n}\n\nfunction setPersistedServiceDeskState(state) {\n  return {\n    type: HA_SET_PERSISTED_STATE,\n    state: state\n  };\n}\n\nfunction agentUpdateIsSuspended(isSuspended) {\n  return {\n    type: HA_UPDATE_IS_SUSPENDED,\n    isSuspended: isSuspended\n  };\n}\n\nfunction agentUpdateIsTyping(isTyping) {\n  return {\n    type: HA_UPDATE_IS_TYPING,\n    isTyping: isTyping\n  };\n}\n\nexport { HA_END_CHAT, HA_SET_AGENT_AVAILABILITY, HA_SET_AGENT_JOINED, HA_SET_AGENT_LEFT_CHAT, HA_SET_IS_CONNECTING, HA_SET_IS_RECONNECTING, HA_SET_IS_SCREEN_SHARING, HA_SET_PERSISTED_STATE, HA_SET_SHOW_SCREEN_SHARE_REQUEST, HA_UPDATE_CAPABILITIES, HA_UPDATE_FILE_UPLOAD_IN_PROGRESS, HA_UPDATE_IS_SUSPENDED, HA_UPDATE_IS_TYPING, agentUpdateIsSuspended, agentUpdateIsTyping, endChat, setAgentAvailability, setAgentJoined, setAgentLeftChat, setIsConnecting, setIsReconnecting, setIsScreenSharing, setPersistedServiceDeskState, setShowScreenShareRequest, updateCapabilities, updateFilesUploadInProgress };\n"],"names":["outputItemToLocalItem","messageItem","fullMessage","isLatestWelcomeNode","disableFadeAnimation","localMessage","ui_state","id","streamItemID","uuid","UUIDType","LOCAL_MESSAGE","needsAnnouncement","history","from_history","item","fullMessageID","isWelcomeResponse","createLocalMessageForInlineError","text","originalMessage","createMessageResponseForItem","createLocalMessageForItem","response_type","MessageResponseTypes","INLINE_ERROR","createLocalMessageItemsForNestedMessageItems","localMessageItem","fromHistory","nestedLocalMessageItems","allowFooter","isGridResponseType","gridLocalMessageItemIDs","rows","map","row","cells","cell","cellLocalMessageItemIDs","createLocalMessageItemsForNestedType","items","nestedMessageItem","isSupportedMessageItemInBody","isCarouselResponseType","itemsLocalMessageItemIDs","bodyItems","body","panel","bodyLocalMessageItemIDs","isShowPanelButtonType","footerItems","footer","footerLocalMessageItemIDs","rootMessageItem","isButtonResponseType","isSupportedMessageItemInFooter","type","nestedMessageItemIDs","isSupported","forEach","nestedLocalMessageItem","push","isResponseWithNestedItems","consoleError","CARD","isCardResponseType","isItemSupportedInResponseBody","CAROUSEL","BUTTON","button_type","ButtonItemType","SHOW_PANEL","GRID","BasePanelComponent","className","children","isOpen","hidePanelHeader","labelBackButton","title","hideBackButton","useAITheme","onClickCloseAndRestart","onClickRestart","testIdPrefix","headerProps","ref","showRestartButton","useSelector","state","config","public","headerConfig","headerRef","useRef","useImperativeHandle","current","React","FocusTrap","active","focusTrapOptions","clickOutsideDeactivates","returnFocusOnDeactivate","IS_MOBILE","preventScroll","HeaderExport","onCloseAndRestart","showBackButton","displayName","showCenter","BasePanelComponentExport","withoutEmptyStarters","newConfig","starters","buttons","length","allow_return","filter","button","Boolean","label","trim","is_on","setIntl","serviceManager","locale","messages","intl","createIntl","store","dispatch","actions","setAppStateValue","createWriteableElementsProxy","elementSet","Set","handler","get","target","element","has","add","Proxy","writeableElements","VERSION","NotificationType","BOUNCING_ANIMATION_TIMEOUTS","DEFAULT_LAUNCHER","mobile","time_to_expand","new_expand_time","time_to_reduce","notification_type","TEXT_NOTIFICATION","desktop","deepFreeze","DEFAULT_CUSTOM_PANEL_CONFIG_OPTIONS","disableAnimation","DEFAULT_CUSTOM_PANEL_STATE","panelID","DEFAULT_CUSTOM_PANEL_ID","options","DEFAULT_IFRAME_PANEL_STATE","DEFAULT_CITATION_PANEL_STATE","citationItem","DEFAULT_TOUR_STATE","activeTourStepItems","DEFAULT_MESSAGE_PANEL_STATE","isMessageForInput","VIEW_STATE_ALL_CLOSED","launcher","mainWindow","tour","VIEW_STATE_LAUNCHER_OPEN","VIEW_STATE_MAIN_WINDOW_OPEN","DEFAULT_PERSISTED_TO_BROWSER","chatState","version","disclaimersAccepted","homeScreenState","isHomeScreenOpen","showBackToBot","hasSentNonWelcomeMessage","persistedTourState","activeTourID","activeTourCurrentStepIndex","agentState","isConnected","isSuspended","agentProfiles","launcherState","wasLoadedFromBrowser","viewState","activeTour","showUnreadIndicator","mobileLauncherIsExtended","mobileLauncherWasReduced","mobileLauncherDisableBounce","desktopLauncherIsExpanded","desktopLauncherWasMinimized","bounceTurn","DEFAULT_CHAT_MESSAGES_STATE","localMessageIDs","messageIDs","isTypingCounter","isLoadingCounter","isHydratingCounter","isScrollAnchored","DEFAULT_MESSAGE_STATE","allMessageItemsByID","allMessagesByID","botMessageState","DEFAULT_AGENT_STATE","isConnecting","isReconnecting","numUnreadMessages","fileUploadInProgress","showScreenShareRequest","isScreenSharing","isAgentTyping","inputState","fieldVisible","isReadonly","files","allowFileUploads","allowMultipleFileUploads","allowedFileUploadTypes","stopStreamingButtonState","currentStreamID","isVisible","isDisabled","DEFAULT_THEME_STATE","carbonTheme","CarbonTheme","G10","corners","CornersType","ROUND","DEFAULT_LAYOUT_STATE","showFrame","hasContentMaxWidth","applyBotMessageState","newState","setHomeScreenOpenState","undefined","persistedToBrowserStorage","applyLocalMessageUIState","localMessageID","propertyName","propertyValue","oldMessage","applyFullMessage","message","MIN_CONTRAST","hexCodeToRGB","color","red","substring","blue","green","parseInt","calculateContrast","color1","color2","rgb1","rgb2","luminance1","calculateRelativeLuminance","luminance2","contrast","r8","g8","b8","rRGB","gRGB","bRGB","whiteOrBlackText","background","gray100","white","adjustLightness","token","shift","original","Color","hsl","object","l","round","hex","toLowerCase","CSS_VAR_PREFIX","HEXADECIMAL_REGEX","INTERNAL_OVERRIDES_LIGHT_THEME_MAP","INTERNAL_OVERRIDES_DARK_THEME_MAP","ACCENT_COLOR_MAPS","blue20","blue60","blue60Hover","blue80","g10","g90","g100","fillValues","styles","propertyNames","value","mergeCSSVariables","publicVars","whiteLabelVariables","internalOverrides","internalOverridesMap","WHITE","includes","G90","G100","createInternalCSSOverridesMap","result","Object","entries","key","startsWith","match","console","warn","WA_CONSOLE_PREFIX","remoteVars","cssOverrides","primaryColor","secondaryColor","accentColor","useAccentColor","tryFocusColor","useFocusColor","colorMap","accentBlue20","accentBlue60Hover","accentBlue80","accentColorRGB","toString","accentColorBW","gray80","gray10","remoteStylesToCSSVars","getThemeClassNames","themeState","themeClassnames","CarbonThemeClassNames","validateViewState","appState","VALID_PUBLIC_VARS_IN_AI_THEME_SET","values","CSSVariable","UPDATE_CSS_VARS_AI_THEME_WARNING_MESSAGE","join","ChatActionsImpl","constructor","this","hydrating","restarting","alreadyHydrated","chunkQueue","hydrateChat","alternateWelcomeRequest","alternateWelcomeRequestSource","alternateOptions","fireReady","hydrationPromise","doHydrateChat","fire","BusEventType","CHAT_READY","debugLog","addIsHydratingCounter","historyService","loadHistory","humanAgentService","initialize","getState","hydrateMessageHistory","messageHistory","createElementsForUserDefinedResponses","latestPanelLocalMessageItem","openResponsePanel","homeScreenConfig","setHomeScreenIsOpen","messaging","skipWelcome","send","createWelcomeRequest","MessageSendSource","WELCOME_REQUEST","returnBeforeStreaming","chatWasHydrated","lastMessageID","arrayLastValue","lastMessage","lastOriginalMessage","isLiveAgentMessage","isRequest","messageService","resendMessage","allowReconnect","serviceDesk","handleHydration","getPublicWebChatState","isConnectedWithHumanAgent","isWebChatOpen","isConnectingWithHumanAgent","isDebugEnabled","isEnableDebugLog","hasUserSentMessage","isTourActive","sendWithCatch","source","ignoreHydration","error","messageRequest","createMessageRequestForText","responsePanelState","setResponsePanelIsOpen","doSend","addDefaultsToMessage","originalUserText","input","silent","inputItemToLocalItem","addMessage","addLocalMessageItem","setValueSelectedForMessageID","messageSetOptionSelected","cloneDeep","receive","requestMessage","requestOptions","restartCount","initialRestartCount","MESSAGE","preReceiveEvent","PRE_RECEIVE","data","updateHasSentNonWelcomeMessage","languagePack","isResponse","processMessageResponse","catch","inlineError","createMessageResponseForText","errors_singleMessage","thread_id","RECEIVE","removeMessages","insertHistory","scrollBottom","getMessagesScrollBottom","notes","currentAppStateMessages","newAppStateMessages","merge","doAutoScroll","scrollToBottom","receiveChunk","chunk","messageID","chunkPromise","resolvablePromise","processChunkQueue","isCompleteItem","isStreamCompleteItem","isPartialItem","isStreamPartialItem","isStopGeneratingVisible","botInputState","partial_item","streaming_metadata","cancellable","setStopStreamingButtonVisible","response_id","streamingStart","complete_item","streamingAddChunk","partial_response","keys","Error","streamingMergeHistory","handleUserDefinedResponseItemsChunk","isStreamFinalResponse","final_response","setStopStreamingButtonDisabled","doResolve","getOrCreateUserDefinedElement","messageItemID","userDefinedItem","userDefinedElementRegistry","document","createElement","slotName","setAttribute","set","handleUserDefinedResponseItems","renderAsUserDefinedMessage","user_defined","userDefinedResponseEvent","USER_DEFINED_RESPONSE","slot","fullWidth","setMessageUIProperty","createElementForNestedUserDefinedResponse","localMessageItemID","nestedLocalMessage","asyncForEach","itemID","CHUNK_USER_DEFINED_RESPONSE","output","generic","request_id","previousItemID","index","pause","isPause","agent","isConnectToAgent","hasTourUserDefinedType","skipTourCard","skip_card","startTourReason","TourStartReason","START_TOUR_METHOD","SKIP_CARD","mainWindowCloseReason","MainWindowCloseReason","CALLED_START_TOUR","TOUR_SKIP_CARD","startTour","viewChangeReason","ViewChangeReason","addNestedMessages","addIsTypingCounter","hasServiceDesk","errorOccurred","errorType","OnErrorType","INTEGRATION_ERROR","setMessageHistoryProperty","agentAvailability","checkAreAnyAgentsOnline","shouldAutoRequestAgent","skipConnectAgentCard","AgentsOnlineStatus","ONLINE","startChat","showIsTyping","isTyping","sleep","time","setResponsePanelContent","insertLocalMessageResponse","updateLanguagePack","changes","addNotification","notification","removeNotification","groupID","removeNotifications","removeAllNotifications","updateCSSVariables","theme","usePublicVars","variable","consoleWarn","allVariables","updateBotName","name","updateMainHeaderTitle","updateBotAvatarURL","url","updateHomeScreenConfig","updateLauncherConfig","launcherConfig","changeView","newView","reason","tryHydrating","forceViewChange","newViewState","constructViewState","isEqual","fireViewChangeEventsAndChangeView","isHydrated","viewChanging","setViewChanging","oldViewState","preViewChangeEvent","VIEW_PRE_CHANGE","cancelViewChange","setViewState","viewChangeEvent","VIEW_CHANGE","changeViewReason","setTourData","ViewType","TOUR","TOUR_START","TOUR_STEP","step","tourState","endTour","LAUNCHER","clearTourData","goToSpecificTourStep","stepId","newStepIndex","findIndex","stepItem","step_id","changeStepInTour","changeStepOptions","nextStep","previousStep","actualNewStepIndex","catastrophicErrorType","callOnError","additionalChatParameters","onError","restartConversation","skipHydration","endAgentConversation","fireEvents","PRE_RESTART_CONVERSATION","currentState","endChat","MAIN_WINDOW","mainWindowOpenReason","MainWindowOpenReason","CALLED_RESTART_CONVERSATION","instance","updateAssistantInputFieldVisibility","cancelAllMessageRequests","RESTART_CONVERSATION","destroySession","keepOpenState","originalViewState","newPersistedToBrowserStorage","userSessionStorageService","clearLauncherSession","clearChatSession","agentEndConversation","endedByUser","agentUpdateIsSuspended","HANDLER_NOT_FUNCTION","EventBus","handlersByType","Map","eventsTypesRunning","eventsRunningCount","busEvent","logEvent","JSON","stringify","handlersForType","handlersCopy","slice","Promise","delete","waitForEmptyPromise","fireSync","waitForEmpty","on","handlers","asArray","debugStackTrace","off","indexOf","removed","splice","once","onceHandler","event","logListeners","listeners","group","listener","consoleLog","groupEnd","clear","eventCopy","createCustomPanelInstance","customPanelInstance","open","setCustomPanelConfigOptions","setCustomPanelOpen","close","freeze","HistoryService","useHistory","publicConfig","resultData","customLoadHistory","historyNotes","async","allLocalMessagesByID","loadingState","allMessages","threadMessagesByThreadID","responsesByRequestID","relatedMessageByID","localMessagesByOriginalMessageID","lastThreadID","loadedHistory","latestTransferToAgentResponse","note","historyItem","isEventRequest","timestamp","Date","getTime","THREAD_ID_MAIN","file_upload_status","FileStatusValue","UPLOADING","COMPLETE","error_state","MessageErrorState","FAILED","related_message_id","beginEvent","HISTORY_BEGIN","eventBus","HISTORY_END","notesToMessages","getResponseItems","thread","addMessageToThread","createLocalMessages","localMessagesByFullMessageID","toChatMessageState","createChatStates","mainThreadMessages","welcomeRequest","findLast","is_welcome_request","welcomeResponse","markIsLatestWelcomeNode","isOptionItem","relatedRequest","optionSelected","isDateResponseType","markSelectedOptions","notesToLoadedHistory","SESSION_HISTORY","MessageLoadingManager","start","onExceededMaxSilentLoading","onEnd","onTimeout","msMaxSilentLoading","msMaxAttempt","hasExceededMaxSilentLoading","onSilentLoading","setTimeout","onMaxAttempt","end","clearTimeout","MS_BETWEEN_RETRIES","RetryType","MessageService","pendingLocale","localeIsExplicit","messageLoadingManager","queue","waiting","timeoutOverride","messageTimeoutSecs","timeoutMS","processSuccess","received","isProcessed","isWelcomeNode","setMessageErrorState","NONE","message_type","MessageInputType","EVENT","now","trackData","lastRequestTime","timeLastRequest","totalRequestTime","timeFirstRequest","sendMessagePromise","moveToNextQueueItem","addErrorMessage","errorMessage","HYDRATE_RESEND","skipQueue","sendToAssistantAndUpdateErrorState","sendToAssistant","SILENT","VISIBLE","RETRYING","waitingMessage","WAITING","processError","pendingRequest","resultText","allowRetry","tryCount","isWelcome","msSinceStarted","isInAttemptWindow","numErrors","retryDelay","MESSAGE_COMMUNICATION","otherData","rejectFinalErrorOnMessage","doReject","customSendMessage","updateMessage","controller","AbortController","sendMessageController","signal","runQueueIfReady","clearCurrentQueueItem","getLastBotResponseWithContext","LOADING_INDICATOR_TIMER","messageLoadingIndicatorTimeoutSecs","addIsLoadingCounter","didExceedMaxLoading","cancelMessageRequestByID","PRE_SEND","updateLocalMessageItem","SEND","addToMessageQueue","newPendingMessage","errorState","messageToUpdate","announceMessageID","announceMessage","TEXT","logError","lastResponse","abort","safeFetchTextWithTimeout","NamespaceService","namespace","originalName","attributeSafe","suffix","computedName","computeNamespaceName","getSuffix","ServiceManager","innerStorage","storage","getItem","setItem","removeItem","IS_SESSION_STORAGE","window","sessionStorage","storage$1","UserSessionStorageService","prefix","loadChatSession","chatSessionString","getChatSessionKey","chatSession","parse","loadLauncherSession","launcherSessionString","getLauncherSessionKey","launcherSession","persistChatSession","session","persistLauncherSession","replaceCurrentArrayValue","currentValue","newValue","Array","isArray","agentReducers","HA_SET_IS_CONNECTING","action","activeLocalMessageID","HA_SET_IS_RECONNECTING","HA_SET_AGENT_AVAILABILITY","availability","HA_SET_SHOW_SCREEN_SHARE_REQUEST","showRequest","HA_SET_AGENT_JOINED","agentProfile","HA_SET_PERSISTED_STATE","serviceDeskState","HA_UPDATE_IS_SUSPENDED","HA_UPDATE_IS_TYPING","HA_SET_AGENT_LEFT_CHAT","HA_UPDATE_CAPABILITIES","newInputState","capabilities","HA_SET_IS_SCREEN_SHARING","isSharing","HA_UPDATE_FILE_UPLOAD_IN_PROGRESS","HA_END_CHAT","populateTourStepItems","tourMessageItem","find","steps","clearTourState","EXCLUDE_AGENT_UNREAD","AgentMessageType","USER_ENDED_CHAT","CHAT_WAS_ENDED","RELOAD_WARNING","reducers","CHANGE_STATE","partialState","HYDRATE_CHAT","iFramePanelState","viewSourcePanelState","customPanelState","HYDRATE_MESSAGE_HISTORY","ADD_LOCAL_MESSAGE_ITEM","addAfterID","isSilent","currentIndex","existingID","newLocalMessageIDs","insertAtIndex","afterIDIndex","isBotMessage","agent_message_type","isMainWindowOpen","isBrowserPageVisible","REMOVE_MESSAGES","idsSet","newAllMessages","newAllMessageItems","newMessageIDs","newMessageItemsIDs","UPDATE_LOCAL_MESSAGE_ITEM","UPDATE_MESSAGE","ADD_MESSAGE","itemIDsInNewMessage","newAllMessageItemsByID","existingItemIDs","firstFoundIndex","isItemInMessage","itemIDsToInsert","MESSAGE_SET_OPTION_SELECTED","newMessagesByID","sentMessage","ADD_IS_TYPING_COUNTER","Math","max","addToIsTyping","ADD_IS_LOADING_COUNTER","addToIsLoading","ADD_IS_HYDRATING_COUNTER","addToIsHydrating","SET_APP_STATE_VALUE","UPDATE_PERSISTED_CHAT_STATE","UPDATE_HAS_SENT_NON_WELCOME_MESSAGE","SET_VIEW_STATE","previousState","handleViewStateChange","SET_VIEW_CHANGING","SET_INITIAL_VIEW_CHANGE_COMPLETE","initialViewChangeComplete","changeComplete","UPDATE_BOT_NAME","botName","headerDisplayName","UPDATE_BOT_AVATAR_URL","botAvatarURL","UPDATE_LAUNCHER_AVATAR_URL","avatar_url_override","UPDATE_MAIN_HEADER_TITLE","UPDATE_CSS_VARIABLES","variables","cssVariableOverrides","UPDATE_HOME_SCREEN_CONFIG","newHomeScreenConfig","mergeWith","SET_MESSAGE_UI_PROPERTY","SET_MESSAGE_HISTORY_PROPERTY","MERGE_HISTORY","ANNOUNCE_MESSAGE","ACCEPTED_DISCLAIMER","location","hostname","SET_HOME_SCREEN_IS_OPEN","TOGGLE_HOME_SCREEN","UPDATE_LAUNCHER_CONFIG","SET_LAUNCHER_PROPERTY","SET_LAUNCHER_CONFIG_PROPERTY","launcherType","LauncherType","DESKTOP","MOBILE","SET_CHAT_MESSAGES_PROPERTY","SET_LAUNCHER_MINIMIZED","OPEN_IFRAME_CONTENT","CLOSE_IFRAME_PANEL","SET_CONVERSATIONAL_SEARCH_CITATION_PANEL_IS_OPEN","relatedSearchResult","SET_CUSTOM_PANEL_OPEN","SET_CUSTOM_PANEL_OPTIONS","SET_TOUR_DATA","newActiveTourMessageID","CLEAR_TOUR_DATA","CHANGE_STEP_IN_TOUR","min","newStepNumber","UPDATE_INPUT_STATE","applyInputState","getInputState","isInputToAgent","SET_IS_BROWSER_PAGE_VISIBLE","ADD_INPUT_FILE","file","currentInputState","REMOVE_INPUT_FILE","fileID","newUploads","REMOVE_LOCAL_MESSAGE_ITEM","ADD_NOTIFICATION","notificationID","notifications","concat","REMOVE_NOTIFICATIONS","REMOVE_ALL_NOTIFICATIONS","CLEAR_INPUT_FILES","FILE_UPLOAD_INPUT_ERROR","currentInputSate","isError","status","ADD_NESTED_MESSAGES","localMessageItems","SET_RESPONSE_PANEL_IS_OPEN","SET_RESPONSE_PANEL_CONTENT","STREAMING_START","STREAMING_MERGE_HISTORY","existingMessage","newMessage","STREAMING_ADD_CHUNK","chunkItem","localItemID","existingLocalMessageItem","newItem","streamingState","chunks","isDone","isIntermediateStreaming","UPDATE_CHAT_HEADER_CONFIG","chatHeaderConfig","chatHeaderState","UPDATE_MAX_VISIBLE_HEADER_OBJECTS","maxTotal","maxVisibleHeaderObjects","SET_STOP_STREAMING_BUTTON_VISIBLE","SET_STOP_STREAMING_BUTTON_DISABLED","SET_STREAM_ID","UPDATE_MAIN_HEADER_AVATAR","headerAvatarConfig","assign","getThemeCornersType","getLayoutState","IS_PHONE","themeConfig","SQUARE","layout","reducerFunction","DEFAULT_PUBLIC_CONFIG","openChatByDefault","showLauncher","shouldTakeFocusIfOpensAutomatically","dayjs","LocalizedFormat","Chat","publicConfigProvided","customHostElement","additionalChatParametersProvided","debug","consoleDebug","appConfig","startInternal","doesHaveServiceDesk","getBotName","initialState","chatWidthBreakpoint","chatWidth","chatHeight","enLanguagePack","originalConfig","suspendScrollDetection","isDestroyed","targetViewState","customMenuOptions","showNonHeaderBackgroundCover","sessionStorageLauncherState","enhancer","__REDUX_DEVTOOLS_EXTENSION__","instanceId","createStore","doCreateStore","subscribe","previousPersistedToBrowserStorage","copyToSessionStorage","disableWindowTitleChanges","originalTitle","changeTitleTimer","agent_newMessage","createHandleWindowTitle","customPanelManager","serviceManger","panels","getPanel","createCustomPanelManager","WriteableElementName","AI_TOOLTIP_AFTER_DESCRIPTION_ELEMENT","WELCOME_NODE_BEFORE_ELEMENT","HEADER_BOTTOM_ELEMENT","BEFORE_INPUT_ELEMENT","HOME_SCREEN_HEADER_BOTTOM_ELEMENT","HOME_SCREEN_AFTER_STARTERS_ELEMENT","HOME_SCREEN_BEFORE_INPUT_ELEMENT","CUSTOM_PANEL_ELEMENT","setEnableDebugLog","debugStackTraces","setEnableDebugStackTracesLog","createServiceManager","localePack","render","createHumanAgentService","all","loadLanguagePack","loadLocale","resolve","loadHAA","reallyRenderAndReturnInstance","OPEN_BY_DEFAULT","WEB_CHAT_LOADED","setInitialViewChangeComplete","callRender","wasRendered","newPack","updateLocale","newLocale","localePromise","languagePackPromise","then","selectInputState","INSTANCE_SEND","destroy","container","remove","updateInputState","updateInputIsDisabled","updateBotUnreadIndicatorVisibility","setLauncherProperty","issueWithNewView","viewTypeValues","CALLED_CHANGE_VIEW","homeScreenConfigClone","scrollToMessage","animate","doScrollToMessage","customPanels","updateCustomMenuOptions","updateIsTypingCounter","direction","updateIsLoadingCounter","updateIsChatLoadingCounter","updateHeaderConfig","configCopy","updateChatHeaderConfig","updateMainHeaderAvatar","elements","getMainWindow","addClassName","removeClassName","getMessageInput","getHTMLElement","setValue","setEnableEnterKey","addChangeListener","removeChangeListener","getHomeScreenInput","tours","CALLED_END_TOUR","goToNextStep","goToStep","addMessageChunk","clearConversation","requestFocus","appWindow","endConversation","updateIsSuspended","createChatInstance","renderAndReturnInstance","promise","renderPromise","AriaAnnouncerProvider","props","useIntl","useServiceManager","announcerRef","announcerFunction","useCallback","announceValue","previousAnnounceMessageRef","useEffect","currentAnnounceMessage","AriaAnnouncerContext","Provider","AriaAnnouncerComponent","getLauncherButtonAriaLabel","isLauncherHidden","launcher_isTourOpen","launcher_isTourClosed","launcher_isOpen","launcher_isClosed","Launcher","onToggleOpen","unreadAgentCount","tabIndex","launcherHidden","launcherAvatarURL","buttonRef","doFocusRef","ariaLabel","formatMessage","count","launcherAvatar","AiLaunch","size","ChatLaunch","src","alt","cx","Button","WACLauncher__TourButton","PageObjectId","kind","ButtonKindEnum","PRIMARY","onClick","ArrowUpLeft","LauncherExport","forwardRef","LauncherComplex","launcherComplexRef","launcherRef","onOpen","onMinimize","launcher_desktopGreeting","launcher_closeButton","launcher_ariaIsExpanded","disabled","WACLauncherComplex__Text","Tag","Close","LauncherDesktopContainer","onDoToggle","useLanguagePack","browserLauncherState","isExpandedLauncherEnabled","smallLauncherClassName","setSmallLauncherClassName","useState","complexLauncherClassName","setComplexLauncherClassName","launcherHiddenRef","animateOnceVisible","bounceTurnRef","animationStartTimerRef","animationFinishedTimerRef","firstBounceAnimationStartTimerRef","firstBounceAnimationFinishedTimerRef","secondBounceAnimationStartTimerRef","secondBounceAnimationFinishedTimerRef","determineLauncherHeight","expandedLauncherHeight","offsetHeight","style","setProperty","startExpandLauncher","setExpandAnimationTimers","clearExpandAnimationTimers","startBounceAnimation","finishBounceAnimation","setBounceAnimationTimers","clearBounceAnimationTimers","setDefaultLauncherState","setLauncherMinimized","useOnMount","setLauncherConfigProperty","prevLauncherTitle","usePrevious","animateWithClass","endAnimationNameOrDelay","endAnimationCallback","classList","animationName","removeEventListener","addEventListener","LauncherExtended","isExtended","playExtendAnimation","onSwipeRight","onReduceEnd","ariaAnnouncer","useAriaAnnouncer","animateExtendedState","setAnimateExtendedState","showGreetingMessage","setShowGreetingMessage","prevIsExtended","extendedContainerRef","greetingMessageRef","textHolderRef","touchStartRef","touchStartX","touchStartY","shouldReduceExtendedLauncher","extendWithAnimation","extendWithoutAnimation","launcherGreetingMessage","launcher_mobileGreeting","launcherContainerElement","textHolderEl","greetingMessageEl","extendedContainerEl","maxTextHolderWidth","launcherPosition","width","height","screen","extendedWidth","getMaxLauncherExtendedWidth","clientWidth","querySelector","launcherExtendedWidth","removeAttribute","calculateAndSetMaxExtendedLauncherWidth","doFadeAnimationForElements","fadeInElement","fadeInTime","buttonEl","handleTouchMove","touchList","touchStartCoordinates","callback","clientX","touchEndX","clientY","touchEndY","differenceX","differenceY","abs","checkIfUserSwipedRight","touches","handleTouchStart","touchStart","reduceAnimationEndListener","fadeOutElement","GHOST","LauncherExtendedExport","LauncherMobileContainer","wasReduced","disableBounce","isStartingBounceAnimation","setIsStartingBounceAnimation","prevWasReduced","initialBounceTurn","previouslyPlayedExtendAnimation","extendLauncherTimeoutIDRef","reduceLauncherTimeoutIDRef","endBounceAnimationRef","shouldBounceRef","isExtending","disableIntroAnimation","setLauncherStateAsReduced","reduceLauncher","extendLauncherTimeoutID","reduceLauncherTimeoutID","clearTimeouts","setExpandAnimationTimeout","endBounceAnimation","startRecurringBounceAnimation","turnCounter","animation","timeouts","startingIndex","beforeAll","afterAll","beforeEach","afterEach","terminate","timeoutID","playAnimation","isComplete","setAnimationListener","replayAnimation","setAnimationTimeouts","handleToggleOpen","handleSwipeRight","LauncherContainer","LAUNCHER_CLICKED","launcherContainer","effect","deps","hasRunRef","useEffectDidUpdate","HydrationPanel","onClose","useHomeScreenVersion","isHidden","useContext","HideComponentContext","header","HomeScreenHeaderExport","BotHeaderExport","onToggleHomeScreen","includeWriteableElement","OverlayPanelName","HYDRATING","MountChildrenOnDelay","delay","AnnounceOnMountComponentExport","announceOnce","window_ariaWindowLoading","Loading","withOverlay","CustomPanel","onPanelOpenEnd","onPanelCloseEnd","onPanelOpenStart","onPanelCloseStart","disableDefaultCloseAction","onClickBack","onClickClose","prevIsOpen","openAnimation","AnimationInType","SLIDE_IN_FROM_BOTTOM","closeAnimation","AnimationOutType","SLIDE_OUT_TO_BOTTOM","onClickBackLocal","onClickCloseLocal","checkAllowClose","onCloseAndRestartLocal","OverlayPanel","onOpenStart","CUSTOM_PANEL_PRE_OPEN","onOpenEnd","CUSTOM_PANEL_OPEN","onCloseStart","CUSTOM_PANEL_PRE_CLOSE","onCloseEnd","CUSTOM_PANEL_CLOSE","animationOnOpen","animationOnClose","shouldOpen","overlayPanelName","CUSTOM","eventName","eventDescription","general_returnToAssistant","hideCloseButton","hideCloseAndRestartButton","WriteableElement","CustomPanelExport","lazyChat","CatastrophicError","lazyCatastrophicError","Disclaimer","lazyDisclaimer","HomeScreenContainer","lazyHomeScreenContainer","IFramePanel","lazyIFramePanel","ViewSourcePanel","lazyViewSourcePanel","BodyAndFooterPanelComponent","lazyBodyAndFooterPanelComponent","WIDTH_BREAKPOINT_STANDARD","WIDTH_BREAKPOINT_NARROW","WIDTH_BREAKPOINT_WIDE","MainWindow","Component","super","arguments","closing","modalPortalHostElement","numPanelsOpen","numPanelsAnimating","numPanelsCovering","isHydrationAnimationComplete","shouldAutoFocus","extraClassNames","areModulesLoaded","mainWindowRef","containerRef","botChatRef","homeScreenInputRef","disclaimerRef","brandingRef","animationContainerRef","iframePanelRef","viewSourcePanelRef","previousBodyVisibility","previousBodyPosition","onResize","appChatWidthBreakpoint","offsetWidth","ChatWidthBreakpoint","WIDE","STANDARD","NARROW","onVisualViewportResize","updateFromVisualViewport","visualViewport","offsetTop","offsetLeft","setModalPortalHostElement","setState","onSendInput","selectIsInputToAgent","sendMessageToAgent","clearInputFiles","onSendHomeButtonInput","createMessageRequestForChoice","HOME_SCREEN_STARTER","removeChatFromDom","onRestart","doClose","toggleHomeScreen","getShowDisclaimer","getShowHomeScreen","takeFocus","requestInputFocus","onUserTyping","userTyping","onAcceptDisclaimer","acceptDisclaimer","coverBackground","prevState","onHydrationPanelClose","componentDidMount","mainWindowObserver","ResizeObserver","observe","disableCustomElementMobileEnhancements","updateBody","SCROLLBAR_WIDTH","loadPanels","componentWillUnmount","unobserve","componentDidUpdate","oldProps","oldState","newProps","useCustomHostElement","prevViewState","requestAnimationFrame","newLastItemID","lastMessageItem","componentDidCatch","errorInfo","createDidCatchErrorData","preload","unmounting","IS_IOS","getPropertyValue","fromCloseAndRestart","MAIN_WINDOW_CLOSED_AND_RESTARTED","DEFAULT_MINIMIZE","disclaimer","addClassNameToState","removeClassNameFromState","renderChat","showCovering","renderCustomPanel","renderHydrationPanel","renderDisclaimerPanel","renderResponsePanel","renderHomeScreenPanel","renderIFramePanel","renderViewSourcePanel","renderBotChat","headerAvatar","agentDisplayState","selectAgentDisplayState","showDisclaimer","hideBotContainer","HideComponent","hidden","Suspense","fallback","messageState","MESSAGE_INPUT","renderInnerHydrationPanel","shouldHide","renderCatastrophicPanel","CATASTROPHIC","showHeader","FADE_IN","FADE_OUT","DISCLAIMER","disclaimerHTML","disclaimerAcceptButtonRef","showHomeScreen","onSendBotInput","HOME_SCREEN_INPUT","onSendButtonInput","IFRAME","CONVERSATIONAL_SEARCH_CITATION","panelOptions","PANEL_RESPONSE","showAnimations","show_animations","renderWidget","localeClassName","showGlass","enableFocusTrap","hideMinimizeButton","trapActive","isWideWidth","VisuallyHidden","window_title","onScroll","scrollTop","ModalPortalRootContext","MainWindow$1","connect","TourContainerLazy","lazyTourComponent","App","hostElement","applicationStyles","fontStyles","combinedStyles","AppContainer","useDispatch","windowSize","setWindowSize","innerWidth","innerHeight","cssVariableOverrideString","useMemo","cssVariables","cssVariablesString","allValues","replace","convertCSSVariablesToString","dir","windowListener","visibilityListener","setIsBrowserPageVisible","visibilityState","node","nonce","cspNonce","IS_PHONE_IN_PORTRAIT_MODE","WindowSizeContext","ServiceManagerContext","RawIntlProvider","LanguagePackContext","MainContainer","tourContainerRef","showTour","showedTourOnce","languageKey","regionLabel","role","UserDefinedResponsePortalsContainer","chatInstance","renderUserDefinedResponse","userDefinedResponseEventsBySlot","slotState","UserDefinedResponseComponentPortal","ReactDOM","UserDefinedResponsePortalsContainerExport","WriteableElementsPortalsContainer","renderResponseMap","responseItem","WriteableElementsComponentPortal","WriteableElementsPortalsContainerExport","onBeforeRender","onAfterRender","renderWriteableElements","setParentInstance","setInstance","renderProps","setRenderProps","setApplicationStyles","setInstances","setUserDefinedResponseEventsBySlot","managedWebChatRef","previousConfigRef","previousConfig","managedWebChat","shouldDestroy","destroyWebChat","widget","pagePublicConfig","chatConstructorPromise","protocol","compatMode","instantiateWidget","webChatInstance","userDefinedEventsBySlot","itemChunk","partialItems","addUserDefinedResponseHandler","loadChat","carbonStyles","loadBaseStyles","loadCarbon","loadStyles","AppContainerExport","default","carbon","withAriaAnnouncer","Wrapped","resolveFunction","rejectFunction","reject","resolveValue","isResolved","rejectValue","isRejected","ANNOUNCE_INPUT_TYPES","ANNOUNCE_NODE_EXCLUDE_ATTRIBUTE","ref1","ref2","useRef1","doAnnouncements","strings","pendingValues","elementToAnnounce","nodeToText","useElement","innerText","innerHTML","nodeType","hasNodeType","formattedMessage","messageValues","messageText","isElement","getComputedStyle","display","getAttribute","hasAttribute","trimAndPush","isInputNode","placeholder","isTextAreaNode","isImageNode","shadowRoot","childNodes","childNode","isTextNode","replaceAll","HomeScreenHeader","brandColor","overflowClicked","overflowItems","option","HOME_SCREEN","AnnounceOnMountComponent","PureComponent","isMounted","onceAnnounced","getBotInputState","getAgentInputState","getAgentState","getPersistedAgent","persisted","isConnectingOrConnected","disableInput","inputPlaceholderKey","BotHeader","enableChatHeaderConfig","homeScreenIsOn","shallowEqual","leftObjectsLength","left","rightObjectsLength","right","hasChatHeaderObjects","allowHomeScreen","homeScreen_overflowMenuHomeScreen","backContent","Home","homeScreen_returnToHome","getOwnPropertyNames","prop","prototype","hasOwnProperty","call","isFrozen","setIsConnecting","setIsReconnecting","setAgentLeftChat","setAgentAvailability","setAgentJoined","updateCapabilities","updateFilesUploadInProgress","setShowScreenShareRequest","setIsScreenSharing","setPersistedServiceDeskState","agentUpdateIsTyping"],"sourceRoot":""}