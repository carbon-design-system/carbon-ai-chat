/* 
 *  Copyright IBM Corp. 2025
 *  
 *  This source code is licensed under the Apache-2.0 license found in the
 *  LICENSE file in the root directory of this source tree.
 */

@use "@carbon/layout";
@use "@carbon/styles/scss/motion";
@use "@carbon/styles/scss/theme";
@use "@carbon/styles/scss/components/button/tokens";

.WACInputAndCompletions {
  position: relative;
  inline-size: 100%;
}

.WACInputCompletions {
  position: absolute;
  // This ensures the input field sits on top of the completions.
  z-index: 0;
  border-style: solid;
  border-color: var(--cds-border-subtle-00) var(--cds-border-subtle-00)
    var(--cds-border-subtle-01) var(--cds-border-subtle-00);
  border-block-start-width: var(--cds-chat-BASE-border-width-small);
  inline-size: 100%;
  // The 16px pushes the completions down so it overlaps the text input. This allows us to cover the gaps that occur
  // when there are rounded corners on the input field.
  inset-block-end: calc(100% - 8px);
}

.WACInputCompletions .cds--list-box__menu-item,
.WACInputCompletions .cds--list-box__menu-item__option {
  block-size: unset;
}

.WACInputCompletions .cds--list-box__menu-item__option {
  text-overflow: unset;
  white-space: unset;
  word-break: break-word;
  word-wrap: break-word;
}

.WACInputCompletions,
.WACInputCompletions__Menu {
  border-start-end-radius: var(--cds-chat-BASE-border-radius-med);
  border-start-start-radius: var(--cds-chat-BASE-border-radius-med);
}

.WACWidget--maxWidth.WAC--wideWidth .WACInputCompletions {
  border-width: var(--cds-chat-BASE-border-width-small)
    var(--cds-chat-BASE-border-width-small) 0
    var(--cds-chat-BASE-border-width-small);
}

.WACInputCompletion--afterSelected .WACInputCompletions__MenuItem,
.WACInputCompletion:hover {
  border-color: transparent;
}

.WACInputCompletions__MenuItem {
  display: flex;
  align-items: center;
  min-block-size: 50px;
}

.WACInputCompletions__MenuItemLabel {
  padding-inline-end: layout.$spacing-03;
}

.WACInputCompletions__MenuItemTag {
  flex: none;
  align-self: baseline;
}

.WACInputCompletions .WACInputCompletions__Menu {
  position: relative;
  display: block;
  background-color: var(--cds-chat-prompt-background);
  box-shadow: none;
  margin-block-end: 8px;
  max-block-size: 200px;
}

.WACInputCompletion--selected {
  background-color: theme.$border-subtle-01;
}

.WACInputContainer {
  position: relative;
  // This ensures the input field sits on top of the completions.
  z-index: 1;
  display: flex;
  align-items: center;
  background-color: var(--cds-chat-prompt-background);
  border-block-start: var(--cds-chat-BASE-border-width-small) solid
    var(--cds-border-subtle-00);
  color: theme.$text-primary;
  inline-size: 100%;
  min-block-size: 0;
  outline: var(--cds-chat-BASE-border-width-med) solid transparent;
  outline-offset: -2px;
  padding-block: layout.$spacing-04;
  padding-inline: layout.$spacing-05 layout.$spacing-03;
}

.WACWidget--maxWidth.WAC--wideWidth .WACInputContainer {
  border: var(--cds-chat-BASE-border-width-small) solid
    var(--cds-border-subtle-00);
  border-radius: var(--cds-chat-BASE-border-radius-med);
  margin-block-end: 32px;
}

// For the aiTheme we want a gradient border instead of a top border.
.WAC--aiTheme .WACInputContainer {
  // Lastly create a transparent border. The color of this border will end up being the second linear-gradient specified
  // while the padding and content of the input field will just be the normal background color from the first gradient.
  border: var(--cds-chat-BASE-border-width-small) solid transparent;
  background: 
    // Set a background gradient that is really just a solid color for the input field background color. This gradient
    // covers the input containers padding and content, but not the border. We need a gradient here because that
    // creates an image which is what the background prop requires.
    linear-gradient(
        to bottom,
        var(--cds-chat-prompt-background),
        var(--cds-chat-prompt-background)
      )
      padding-box,
    // Set a background gradient that fades from the border color to the background color. This gradient covers the
    // input containers border, padding, and content and sits beneath the previous background layer. Because this
    // layer is the only one of the two that covers the border it will underlay the transparent border created below.
    linear-gradient(
        to bottom,
        var(--cds-border-subtle-00),
        var(--cds-chat-prompt-background)
      )
      border-box;
}

.WACInputContainer--showUploadButton {
  padding-inline-start: layout.$spacing-03;
}

.WACInputContainer__TextAndUpload {
  display: flex;
  align-items: center;
}

.WACInputContainer__TextAndUpload > *:not(:last-child),
.WACInputContainer > *:not(:last-child) {
  margin-inline-end: layout.$spacing-03;
}

.WACInputContainer__FilesContainer {
  overflow: auto;
  margin-block-start: layout.$spacing-03;
  max-block-size: 200px;
}

.WACInputContainer__UploadButtonContainer {
  display: inline-block;
  inline-size: 32px;
  vertical-align: top;
}

.WACInputContainer .WACInputContainer__UploadButton {
  display: flex;
  align-items: center;
  justify-content: center;
  block-size: 32px;
  color: theme.$text-primary;
  cursor: pointer;
  inline-size: 32px;
}

.WACInputContainer .cds--file__selected-file {
  background-color: theme.$field-02;
}

.WACInputContainer .cds--file__selected-file .cds--popover {
  display: none;
}

.WACInputContainer__UploadInput:focus + .WACInputContainer__UploadButton {
  box-shadow: inset 0 0 0 var(--cds-chat-BASE-border-width-med) theme.$focus;
}

.WACInputContainer__UploadButton:hover {
  background-color: theme.$background-hover;
}

.WACInputContainer__UploadButton:active {
  background-color: theme.$background-active;
}

.WACInputContainer .WACInputContainer__UploadButton--disabled {
  cursor: default;
  opacity: 0.5;
}

label.WACInputContainer__UploadButton--disabled:hover {
  background-color: transparent;
}

.WACInputContainer__LeftContainer {
  position: relative;
  display: flex;
  overflow: hidden;
  flex: 1 0;
  flex-direction: column;
  justify-content: center;
  block-size: 100%;
}

.WACInputContainer--hasFocus {
  outline-color: theme.$focus;
}

.WACInputContainer--error {
  outline-color: theme.$support-error;
}

.WACInputContainer
  .WACInputContainer__LeftContainer
  .WAC__TextArea
  .WAC__TextArea-textarea {
  // The focus border is simulated by adding it to the container.
  border: none;
}

.WACBotContainer .WACInputContainer {
  display: flex;
}

.WACInputContainer .WAC__TextArea {
  display: inline-block;
  overflow: hidden;
  font-size: var(--cds-chat-BASE-font-size-med);
  inline-size: 100%;
  line-height: var(--cds-chat-BASE-line-height-med);
  min-block-size: 0;
}

.WACInputContainer--showUploadButton .WAC__TextArea {
  inline-size: calc(100% - 32px);
}

.WACInputContainer .WAC__TextArea textarea.WAC__TextArea-textarea {
  margin: 0;
  background: transparent;
  color: theme.$text-primary;
  resize: none;
}

.WACInputContainer .WAC__TextArea .WAC__TextArea-textarea,
.WACInputContainer .WAC__TextArea .WAC__TextArea-sizer {
  max-block-size: 157px;
}

.WACInputContainer .WAC__TextArea .WAC__TextArea-textarea::placeholder {
  color: theme.$text-placeholder;
  font-family: inherit;
  font-size: var(--cds-chat-BASE-font-size-med);
  line-height: var(--cds-chat-BASE-line-height-med);
}

.WACInputContainer__SendButtonContainer,
.WACInputContainer__UploadButtonContainer {
  display: flex;
  flex: 0 1;
  align-self: flex-start;
}

button.WACInputContainer__SendButton svg {
  cursor: inherit;
}

button.WACInputContainer__SendButton:enabled svg,
button.WACInputContainer__SendButton:active svg,
button.WACInputContainer__SendButton:focus svg,
button.WACInputContainer__SendButton:active:focus svg {
  fill: theme.$interactive;
}

button.WACInputContainer__SendButton:disabled:hover svg,
button.WACInputContainer__SendButton:disabled svg {
  fill: theme.$icon-disabled;
}

.WACContainer--render[dir="rtl"] .WACInputContainer__SendButton svg {
  transform: scale(-1, 1);
}

.WACInputContainer__SendButton svg {
  block-size: layout.$spacing-05;
  inline-size: layout.$spacing-05;
}
