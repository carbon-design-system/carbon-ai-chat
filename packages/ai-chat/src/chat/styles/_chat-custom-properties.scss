/*
 *  Copyright IBM Corp. 2025
 *
 *  This source code is licensed under the Apache-2.0 license found in the
 *  LICENSE file in the root directory of this source tree.
 */

@use "@carbon/layout";
@use "@carbon/colors";
@use "@carbon/styles/scss/theme";
@use "@carbon/styles/scss/components/button/tokens";
@use "@carbon/styles/scss/motion";

:host {
  /* **************************************************************************************************************** */

  /* Generic variables using for common values that are repeated throughout the widget. */

  /* **************************************************************************************************************** */

  /* Internal properties where reuse is needed */

  /* Application */
  --cds-aichat-max-height: 640px;

  /* WCAG 2.1 states that the widget must be usable at 320x256 (or the equivalent from zoom happening) https://www.w3.org/WAI/WCAG21/Understanding/reflow.html
  We make sure the min-height at least 150px (to show at least the header/footer and one line of text) and is the lower of 256px minus the spacing from the bottom of the view port or 100vh - the bottom position. */
  --cds-aichat-min-height: max(
    150px,
    calc(min(256px, 100vh) - var(--cds-aichat-bottom-position))
  );
  --cds-aichat-max-width: calc(100vw - (2 * var(--cds-aichat-right-position)));
  --cds-aichat-bottom-position: #{layout.$spacing-07};
  --cds-aichat-right-position: #{layout.$spacing-07};
  --cds-aichat-top-position: auto;
  --cds-aichat-left-position: auto;

  /* **************************************************************************************************************** */

  /* Customizations applied by tooling or developer configuration */

  /* Miscellaneous */
  --cds-aichat-z-index: 99999;
  --cds-aichat-border-radius: 0;

  /* AI theming variables */
  --cds-aichat-ai-background-image: linear-gradient(
    to bottom,
    #{theme.$chat-shell-background} 0,
    #{theme.$chat-shell-background} 50%,
    #{theme.$ai-aura-end} 50%,
    #{theme.$ai-aura-start} 100%
  );
  --cds-aichat-ai-box-shadow-inner: inset 0 -80px 70px -65px
    #{theme.$ai-inner-shadow};
  --cds-aichat-ai-box-shadow-outer: 0 4px 10px 2px #{theme.$ai-drop-shadow};

  /* Card variables */
  --cds-aichat-card-border-radius: #{layout.$spacing-03};
  --cds-aichat-card-max-width: 424px;

  /* Box shadow */
  --cds-aichat-box-shadow: 1px 0 4px hsl(0deg 0% 9% / 30%);

  /* Viewport Variables (for phone mode) */
  --cds-aichat-viewport-width: 100vw;
  --cds-aichat-viewport-height: 100vh;
  --cds-aichat-viewport-offsetLeft: 0;
  --cds-aichat-viewport-offsetTop: 0;

  /* The smaller of 380px or the available width of the screen. The is to account for zoom levels pushing us to 320px. */
  --cds-aichat-width: min(380px, var(--cds-aichat-max-width));
  --cds-aichat-height: calc(100vh - (2 * #{layout.$spacing-07}));

  /* Launcher Variables */
  --cds-aichat-launcher-default-size: 56px;
  --cds-aichat-launcher-position-bottom: #{layout.$spacing-07};
  --cds-aichat-launcher-position-right: #{layout.$spacing-07};
  --cds-aichat-launcher-extended-width: 280px;
  --cds-aichat-launcher-desktop-expanded-height: 320px;
  --cds-aichat-launcher-position-bottom-mobile: #{layout.$spacing-05};

  /* Launcher Color Variables */
  --cds-aichat-launcher-color-background: #{tokens.$button-primary};
  --cds-aichat-launcher-color-avatar: #{theme.$text-on-color};
  --cds-aichat-launcher-color-background-hover: #{tokens.$button-primary-hover};
  --cds-aichat-launcher-color-background-active: #{tokens.$button-primary-active};
  --cds-aichat-launcher-color-focus-border: #{theme.$text-on-color};
  --cds-aichat-launcher-mobile-color-text: #{theme.$text-on-color};
  --cds-aichat-launcher-expanded-message-color-text: #{theme.$text-on-color};
  --cds-aichat-launcher-expanded-message-color-background: #{tokens.$button-primary};
  --cds-aichat-launcher-expanded-message-color-background-hover: #{tokens.$button-primary-hover};
  --cds-aichat-launcher-expanded-message-color-background-active: #{tokens.$button-primary-active};
  --cds-aichat-launcher-expanded-message-color-focus-border: #{theme.$text-on-color};

  /* Unread Indicator Variables */
  --cds-aichat-unread-indicator-color-background: #{theme.$support-error};
  --cds-aichat-unread-indicator-color-text: #{theme.$text-on-color};
}

.cds-aichat--widget--rounded {
  --cds-aichat-border-radius: #{layout.$spacing-03};
}

/* We will have to think on what this looks like if we are going to remove these CSS variables and make them SASS based. */
.cds-aichat---is-phone {
  --cds-aichat-width: var(--cds-aichat-viewport-width, 100vw);
  --cds-aichat-height: var(--cds-aichat-viewport-height, 100vh);
  --cds-aichat-left-position: var(--cds-aichat-viewport-offsetLeft, 0);
  --cds-aichat-top-position: var(--cds-aichat-viewport-offsetTop, 0);
  --cds-aichat-max-height: auto;
  --cds-aichat-min-height: auto;
  --cds-aichat-right-position: auto;
}
